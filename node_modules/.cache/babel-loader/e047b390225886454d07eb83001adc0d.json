{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_data-item-container-surface.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataItemContainerSurface = void 0;\n\nvar ko = require(\"knockout\");\n\nvar _data_source_browser_1 = require(\"../../../common/_data-source-browser\");\n\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\n\nvar _undo_engine_helper_1 = require(\"../../../model/internal/_undo-engine-helper\");\n\nvar _accordion_tab_1 = require(\"../../properties-controller/_accordion-tab\");\n\nvar _display_name_provider_1 = require(\"../../_display-name-provider\");\n\nvar _data_item_surface_1 = require(\"./_data-item-surface\");\n\nvar DataItemContainerSurface = function () {\n  function DataItemContainerSurface(model, detailsPropertiesComposer, itemSurface, _removeDataItemContainer) {\n    var _this = this;\n\n    this.detailsPropertiesComposer = detailsPropertiesComposer;\n    this.itemSurface = itemSurface;\n    this._removeDataItemContainer = _removeDataItemContainer;\n    this._disposables = [];\n    this.propertiesTabs = ko.observableArray([]);\n\n    this.selectItem = function (model, binding) {\n      if (model[binding.propertyName]._specifics.isAttribute && _this.model()._getBindingModel().some(function (bindingProp) {\n        return _this.model()[bindingProp.propertyName] !== model[binding.propertyName] && !_this.model()[bindingProp.propertyName].dataItem();\n      })) return;\n      var dataItemSurface = new _data_item_surface_1.DataItemSurface(model[binding.propertyName], binding, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, false, binding.fieldConstraint);\n      dataItemSurface.newItemCreated.add(function (link, newField) {\n        if (!_this.model()._getBindingModel().some(function (bindingProp) {\n          return _this.model()[bindingProp.propertyName] !== link && _this.model()[bindingProp.propertyName].dataItem();\n        })) {\n          _this.dataFieldChoosed.fire(newField, link);\n        }\n      });\n\n      _this.itemSurface.propertiesController.secondaryModel({\n        displayText: binding.emptyPlaceholder,\n        data: dataItemSurface\n      });\n    };\n\n    this.model = ko.observable();\n    this.containerType = ko.observable();\n    this.singleItemSurface = ko.observable();\n    this.dataFieldChoosed = _jquery_helpers_1.createJQueryCallbacks();\n\n    this.removeDataItem = function (dataItemLink) {\n      _this._removeDataItem(dataItemLink);\n    };\n\n    this.dataItemDisplayNameProvider = function (dataItem) {\n      return _display_name_provider_1.getDataItemDisplayName(_this.itemSurface._dataSourceBrowser, _this.itemSurface.dashboardItem, dataItem);\n    };\n\n    if (model.itemType) {\n      this.containerType(model._getContainerType());\n    }\n\n    var updatePropertiesTabs = function (otherTabs) {\n      var promises = [];\n      promises.push(_this.itemSurface._dataSourceBrowser.getDataFieldsArray(_this.itemSurface.dashboardItem.dataSource(), _this.itemSurface.dashboardItem.dataMember(), '', _data_source_browser_1.isNonCollectionDataField));\n\n      _this.model()._getBindingModel().forEach(function (b) {\n        _this.model()[b.propertyName].uniqueName() && promises.push(_this.itemSurface._dataSourceBrowser.findDataField(_this.itemSurface.dashboardItem.dataSource(), _this.itemSurface.dashboardItem.dataMember(), _this.model()[b.propertyName].dataItem().dataMember()));\n      });\n\n      _jquery_helpers_1.jqueryWhenArray(promises).done(function () {\n        var fields = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          fields[_i] = arguments[_i];\n        }\n\n        otherTabs = otherTabs.concat(_this.detailsPropertiesComposer.composeTabs(_this.model(), {\n          dashboardItem: _this.itemSurface.dashboardItem,\n          containerType: _this.containerType,\n          dataSourceBrowser: _this.itemSurface._dataSourceBrowser\n        }));\n\n        _this.propertiesTabs(otherTabs);\n      });\n    };\n\n    this._disposables.push(this.model.subscribe(function (newModel) {\n      if (!!_this.singleItemSurface.peek()) {\n        _this.singleItemSurface.peek().dispose();\n\n        _this.singleItemSurface(null);\n      }\n\n      if (newModel._getBindingModel().length === 1) {\n        var binding = newModel._getBindingModel()[0];\n\n        var dataItemSurface = new _data_item_surface_1.DataItemSurface(newModel[binding.propertyName], binding, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, false, binding.fieldConstraint);\n        dataItemSurface.newItemCreated.add(function (link, newField) {\n          _this.dataFieldChoosed.fire(newField, link);\n        });\n\n        _this.singleItemSurface(dataItemSurface);\n\n        _this._disposables.push(dataItemSurface.propertiesTabs.subscribe(function (newTabs) {\n          updatePropertiesTabs(dataItemSurface.propertiesTabs());\n        }));\n\n        updatePropertiesTabs(dataItemSurface.propertiesTabs());\n      } else if (newModel._getBindingModel().length > 1) {\n        updatePropertiesTabs([new _accordion_tab_1.ItemGroupAccordionTab(_accordion_tab_1.KnownTabs.DataItemsGroup, 'Data Items', _this)]);\n      } else {\n        updatePropertiesTabs([]);\n      }\n    }));\n\n    this.model(model);\n\n    this._disposables.push({\n      dispose: function () {\n        _this.dataFieldChoosed.empty();\n      }\n    });\n  }\n\n  DataItemContainerSurface.prototype._removeDataItem = function (dataItemLink) {\n    var _this = this;\n\n    var dataItem = dataItemLink.dataItem();\n\n    if (!!dataItem) {\n      dataItemLink.uniqueName(undefined);\n\n      this.itemSurface.dashboardItem._removeDataItem(dataItem);\n\n      if (!this.model()._getBindingModel().some(function (b) {\n        return !!_this.model()[b.propertyName].dataItem() && !_this.model()[b.propertyName]._specifics.isAttribute;\n      })) {\n        this.itemSurface.propertiesController.mainModel(null);\n\n        this._removeDataItemContainer(this.model());\n      }\n    }\n  };\n\n  DataItemContainerSurface.prototype.dataItemErrorFactory = function (dataItem) {\n    var _this = this;\n\n    var dataItemLinkErrorState = ko.observable(false);\n\n    this._disposables.push(ko.computed(function () {\n      if (!!dataItem && dataItem.dataMember()) {\n        _this.itemSurface._dataSourceBrowser.findDataField(_this.itemSurface.dashboardItem.dataSource(), _this.itemSurface.dashboardItem.dataMember(), dataItem.dataMember()).done(function (result) {\n          dataItemLinkErrorState(!result);\n        });\n      }\n    }));\n\n    return dataItemLinkErrorState;\n  };\n\n  DataItemContainerSurface.prototype.dispose = function () {\n    this._disposables.forEach(function (d) {\n      d.dispose();\n    });\n  };\n\n  __decorate([_undo_engine_helper_1.wrapWithUndoRedo], DataItemContainerSurface.prototype, \"_removeDataItem\", null);\n\n  return DataItemContainerSurface;\n}();\n\nexports.DataItemContainerSurface = DataItemContainerSurface;\nko.components.register('dx-dashboard-group-data-items', {\n  viewModel: function (params) {\n    var model = ko.unwrap(params.model);\n    var viewModel = {\n      dataItems: model._getBindingModel().map(function (binding) {\n        return {\n          binding: binding,\n          item: model[binding.propertyName],\n          placeholder: binding.emptyPlaceholder,\n          removeDataItem: function (item) {\n            params.holder.removeDataItem && params.holder.removeDataItem(item);\n          },\n          dataItemDisplayNameProvider: function (dataItem) {\n            return params.holder.dataItemDisplayNameProvider && params.holder.dataItemDisplayNameProvider(dataItem) || '';\n          },\n          click: function () {\n            params.holder.selectItem && params.holder.selectItem(model, binding) || '';\n          }\n        };\n      }),\n      holder: params.holder\n    };\n    return viewModel;\n  },\n  template: {\n    element: 'dx-dashboard-group-data-items'\n  }\n});","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/items/binding-details/_data-item-container-surface.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","exports","value","DataItemContainerSurface","ko","require","_data_source_browser_1","_jquery_helpers_1","_undo_engine_helper_1","_accordion_tab_1","_display_name_provider_1","_data_item_surface_1","model","detailsPropertiesComposer","itemSurface","_removeDataItemContainer","_this","_disposables","propertiesTabs","observableArray","selectItem","binding","propertyName","_specifics","isAttribute","_getBindingModel","some","bindingProp","dataItem","dataItemSurface","DataItemSurface","dashboardItem","_dataSourceBrowser","propertiesController","fieldConstraint","newItemCreated","add","link","newField","dataFieldChoosed","fire","secondaryModel","displayText","emptyPlaceholder","data","observable","containerType","singleItemSurface","createJQueryCallbacks","removeDataItem","dataItemLink","_removeDataItem","dataItemDisplayNameProvider","getDataItemDisplayName","itemType","_getContainerType","updatePropertiesTabs","otherTabs","promises","push","getDataFieldsArray","dataSource","dataMember","isNonCollectionDataField","forEach","b","uniqueName","findDataField","jqueryWhenArray","done","fields","_i","concat","composeTabs","dataSourceBrowser","subscribe","newModel","peek","dispose","newTabs","ItemGroupAccordionTab","KnownTabs","DataItemsGroup","empty","prototype","undefined","mainModel","dataItemErrorFactory","dataItemLinkErrorState","computed","result","wrapWithUndoRedo","components","register","viewModel","params","unwrap","dataItems","map","item","placeholder","holder","click","template","element"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_data-item-container-surface.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DataItemContainerSurface = void 0;\nvar ko = require(\"knockout\");\nvar _data_source_browser_1 = require(\"../../../common/_data-source-browser\");\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\nvar _undo_engine_helper_1 = require(\"../../../model/internal/_undo-engine-helper\");\nvar _accordion_tab_1 = require(\"../../properties-controller/_accordion-tab\");\nvar _display_name_provider_1 = require(\"../../_display-name-provider\");\nvar _data_item_surface_1 = require(\"./_data-item-surface\");\nvar DataItemContainerSurface = (function () {\n    function DataItemContainerSurface(model, detailsPropertiesComposer, itemSurface, _removeDataItemContainer) {\n        var _this = this;\n        this.detailsPropertiesComposer = detailsPropertiesComposer;\n        this.itemSurface = itemSurface;\n        this._removeDataItemContainer = _removeDataItemContainer;\n        this._disposables = [];\n        this.propertiesTabs = ko.observableArray([]);\n        this.selectItem = function (model, binding) {\n            if (model[binding.propertyName]._specifics.isAttribute &&\n                _this.model()._getBindingModel().some(function (bindingProp) { return _this.model()[bindingProp.propertyName] !== model[binding.propertyName] && !_this.model()[bindingProp.propertyName].dataItem(); }))\n                return;\n            var dataItemSurface = new _data_item_surface_1.DataItemSurface(model[binding.propertyName], binding, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, false, binding.fieldConstraint);\n            dataItemSurface.newItemCreated.add(function (link, newField) {\n                if (!_this.model()._getBindingModel().some(function (bindingProp) {\n                    return (_this.model()[bindingProp.propertyName] !== link) && _this.model()[bindingProp.propertyName].dataItem();\n                })) {\n                    _this.dataFieldChoosed.fire(newField, link);\n                }\n            });\n            _this.itemSurface.propertiesController.secondaryModel({\n                displayText: binding.emptyPlaceholder,\n                data: dataItemSurface\n            });\n        };\n        this.model = ko.observable();\n        this.containerType = ko.observable();\n        this.singleItemSurface = ko.observable();\n        this.dataFieldChoosed = _jquery_helpers_1.createJQueryCallbacks();\n        this.removeDataItem = function (dataItemLink) {\n            _this._removeDataItem(dataItemLink);\n        };\n        this.dataItemDisplayNameProvider = function (dataItem) {\n            return _display_name_provider_1.getDataItemDisplayName(_this.itemSurface._dataSourceBrowser, _this.itemSurface.dashboardItem, dataItem);\n        };\n        if (model.itemType) {\n            this.containerType(model._getContainerType());\n        }\n        var updatePropertiesTabs = function (otherTabs) {\n            var promises = [];\n            promises.push(_this.itemSurface._dataSourceBrowser.getDataFieldsArray(_this.itemSurface.dashboardItem.dataSource(), _this.itemSurface.dashboardItem.dataMember(), '', _data_source_browser_1.isNonCollectionDataField));\n            _this.model()._getBindingModel().forEach(function (b) {\n                _this.model()[b.propertyName].uniqueName() && promises.push(_this.itemSurface._dataSourceBrowser.findDataField(_this.itemSurface.dashboardItem.dataSource(), _this.itemSurface.dashboardItem.dataMember(), _this.model()[b.propertyName].dataItem().dataMember()));\n            });\n            _jquery_helpers_1.jqueryWhenArray(promises).done(function () {\n                var fields = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    fields[_i] = arguments[_i];\n                }\n                otherTabs = otherTabs.concat(_this.detailsPropertiesComposer.composeTabs(_this.model(), {\n                    dashboardItem: _this.itemSurface.dashboardItem,\n                    containerType: _this.containerType,\n                    dataSourceBrowser: _this.itemSurface._dataSourceBrowser\n                }));\n                _this.propertiesTabs(otherTabs);\n            });\n        };\n        this._disposables.push(this.model.subscribe(function (newModel) {\n            if (!!_this.singleItemSurface.peek()) {\n                _this.singleItemSurface.peek().dispose();\n                _this.singleItemSurface(null);\n            }\n            if (newModel._getBindingModel().length === 1) {\n                var binding = newModel._getBindingModel()[0];\n                var dataItemSurface = new _data_item_surface_1.DataItemSurface(newModel[binding.propertyName], binding, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, false, binding.fieldConstraint);\n                dataItemSurface.newItemCreated.add(function (link, newField) {\n                    _this.dataFieldChoosed.fire(newField, link);\n                });\n                _this.singleItemSurface(dataItemSurface);\n                _this._disposables.push(dataItemSurface.propertiesTabs.subscribe(function (newTabs) {\n                    updatePropertiesTabs(dataItemSurface.propertiesTabs());\n                }));\n                updatePropertiesTabs(dataItemSurface.propertiesTabs());\n            }\n            else if (newModel._getBindingModel().length > 1) {\n                updatePropertiesTabs([new _accordion_tab_1.ItemGroupAccordionTab(_accordion_tab_1.KnownTabs.DataItemsGroup, 'Data Items', _this)]);\n            }\n            else {\n                updatePropertiesTabs([]);\n            }\n        }));\n        this.model(model);\n        this._disposables.push({\n            dispose: function () {\n                _this.dataFieldChoosed.empty();\n            }\n        });\n    }\n    DataItemContainerSurface.prototype._removeDataItem = function (dataItemLink) {\n        var _this = this;\n        var dataItem = dataItemLink.dataItem();\n        if (!!dataItem) {\n            dataItemLink.uniqueName(undefined);\n            this.itemSurface.dashboardItem._removeDataItem(dataItem);\n            if (!this.model()._getBindingModel().some(function (b) { return !!_this.model()[b.propertyName].dataItem() && !_this.model()[b.propertyName]._specifics.isAttribute; })) {\n                this.itemSurface.propertiesController.mainModel(null);\n                this._removeDataItemContainer(this.model());\n            }\n        }\n    };\n    DataItemContainerSurface.prototype.dataItemErrorFactory = function (dataItem) {\n        var _this = this;\n        var dataItemLinkErrorState = ko.observable(false);\n        this._disposables.push(ko.computed(function () {\n            if (!!dataItem && dataItem.dataMember()) {\n                _this.itemSurface._dataSourceBrowser.findDataField(_this.itemSurface.dashboardItem.dataSource(), _this.itemSurface.dashboardItem.dataMember(), dataItem.dataMember()).done(function (result) {\n                    dataItemLinkErrorState(!result);\n                });\n            }\n        }));\n        return dataItemLinkErrorState;\n    };\n    DataItemContainerSurface.prototype.dispose = function () {\n        this._disposables.forEach(function (d) {\n            d.dispose();\n        });\n    };\n    __decorate([\n        _undo_engine_helper_1.wrapWithUndoRedo\n    ], DataItemContainerSurface.prototype, \"_removeDataItem\", null);\n    return DataItemContainerSurface;\n}());\nexports.DataItemContainerSurface = DataItemContainerSurface;\nko.components.register('dx-dashboard-group-data-items', {\n    viewModel: function (params) {\n        var model = ko.unwrap(params.model);\n        var viewModel = {\n            dataItems: model._getBindingModel().map(function (binding) {\n                return {\n                    binding: binding,\n                    item: model[binding.propertyName],\n                    placeholder: binding.emptyPlaceholder,\n                    removeDataItem: function (item) {\n                        params.holder.removeDataItem && params.holder.removeDataItem(item);\n                    },\n                    dataItemDisplayNameProvider: function (dataItem) {\n                        return params.holder.dataItemDisplayNameProvider && params.holder.dataItemDisplayNameProvider(dataItem) || '';\n                    },\n                    click: function () {\n                        params.holder.selectItem && params.holder.selectItem(model, binding) || '';\n                    }\n                };\n            }),\n            holder: params.holder\n        };\n        return viewModel;\n    },\n    template: { element: 'dx-dashboard-group-data-items' }\n});\n"]},"metadata":{},"sourceType":"script"}