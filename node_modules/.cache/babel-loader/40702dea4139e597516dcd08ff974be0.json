{"ast":null,"code":"/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\_treeNodeItemsProvider.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TreeNodeItemsProvider = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar utils_1 = require(\"../../../serializer/utils\");\n\nvar _treeListNode_1 = require(\"./_treeListNode\");\n\nvar pathRequest_1 = require(\"../../../widgets/common/pathRequest\");\n\nvar _utils_1 = require(\"../../../widgets/_utils\");\n\nvar TreeNodeItemsProvider = function (_super) {\n  __extends(TreeNodeItemsProvider, _super);\n\n  function TreeNodeItemsProvider(fieldListProvider, rootItems, generateTreeNode, generateTreeLeafNode) {\n    var _this = _super.call(this) || this;\n\n    _this._fullTreeLoaded = false;\n    _this._rootItems = ko.observableArray([]);\n    _this._checkedRootNodesCount = ko.computed(function () {\n      if (!_this._rootItems || _this._rootItems().length === 0) return 0;\n      var count = 0;\n\n      for (var i = 0; i < _this._rootItems().length && count < 1; i++) {\n        count += _this._rootItems()[i].unChecked() ? 0 : 1;\n      }\n\n      return count;\n    });\n    _this.hasCheckedItems = ko.computed(function () {\n      return !(_this._checkedRootNodesCount() === 0);\n    });\n\n    _this.getRootItems = function () {\n      return _this._rootItems();\n    };\n\n    _this.getItems = function (pathRequest, collectChilds) {\n      if (collectChilds === void 0) {\n        collectChilds = false;\n      }\n\n      var result = $.Deferred();\n\n      if (!pathRequest.fullPath && pathRequest.pathParts.length === 0) {\n        result.resolve(_this._rootItems());\n      } else {\n        fieldListProvider.getItems(pathRequest).done(function (value) {\n          var currentParentNode = _this._getParentNode(pathRequest);\n\n          if (!currentParentNode || !currentParentNode.children) return result.reject();\n\n          if (currentParentNode.children().length === 0) {\n            var array = [];\n            var listPath = [];\n            value.forEach(function (item) {\n              var isChecked = _this._getDefaultTreeNodeCheckState(item);\n\n              if (_this.isList(item, currentParentNode)) {\n                if (pathRequest.pathParts.length <= 5) {\n                  listPath.push([].concat(pathRequest.fullPath.split('.'), [item.name]));\n                  array.push(generateTreeNode(item, isChecked, [pathRequest.fullPath, item.name].join('.')));\n                }\n              } else {\n                array.push(generateTreeLeafNode(item, isChecked, [pathRequest.fullPath, item.name].join('.')));\n              }\n            });\n            currentParentNode.initializeChildren(array);\n            if (collectChilds) $.when.apply($, listPath.map(function (x) {\n              return _this.getItems(new pathRequest_1.PathRequest(x.join('.'), x), collectChilds);\n            })).always(function () {\n              return result.resolve(array);\n            });else result.resolve(array);\n          } else {\n            result.resolve(currentParentNode.children());\n          }\n        });\n      }\n\n      return result.promise();\n    };\n\n    _this._disposables.push(rootItems.subscribe(function (newValue) {\n      _this._fullTreeLoaded = false;\n\n      _this._rootItems(newValue.map(function (item) {\n        var isChecked = _this._getDefaultTreeNodeCheckState(item);\n\n        return generateTreeNode(item, isChecked, item.name);\n      }));\n    }));\n\n    _this._disposables.push(_this.hasCheckedItems);\n\n    return _this;\n  }\n\n  TreeNodeItemsProvider.prototype._createTree = function () {\n    var _this = this;\n\n    if (!this._fullTreeLoaded) return $.when.apply($, this._rootItems().map(function (item) {\n      return _this.getItems(new pathRequest_1.PathRequest(item.path), true);\n    })).always(function () {\n      return _this._fullTreeLoaded = true;\n    });else {\n      return $.Deferred().resolve().promise();\n    }\n  };\n\n  TreeNodeItemsProvider.prototype._createTreePart = function (pathParts, deferred, checkedPath) {\n    var _this = this;\n\n    if (deferred === void 0) {\n      deferred = $.Deferred();\n    }\n\n    if (this._fullTreeLoaded) return deferred.resolve().promise();\n    if (pathParts.length === 0) return deferred.resolve();\n\n    if (!checkedPath) {\n      var deferred = $.Deferred();\n\n      if (pathParts.length === 1) {\n        this.getItems(new pathRequest_1.PathRequest(pathParts[0], pathParts)).done(function () {\n          return deferred.resolve();\n        }).fail(function () {\n          return deferred.reject();\n        });\n      } else this._createTreePart(pathParts.slice(1), deferred, [pathParts[0]]);\n\n      return deferred;\n    } else {\n      var newParentPath = [].concat([], checkedPath, pathParts[0]);\n      var request = new pathRequest_1.PathRequest(newParentPath.join('.'), newParentPath);\n\n      if (!this._getParentNode(request)) {\n        this.getItems(new pathRequest_1.PathRequest(checkedPath.join('.'), checkedPath)).done(function (res) {\n          _this._createTreePart(pathParts.slice(1), deferred, newParentPath);\n        }).fail(function () {\n          return deferred.reject();\n        });\n      } else {\n        this._createTreePart(pathParts.slice(1), deferred, newParentPath);\n      }\n    }\n  };\n\n  TreeNodeItemsProvider.prototype._setChecked = function (item) {\n    var _this = this;\n\n    item.setChecked(true);\n\n    if (item instanceof _treeListNode_1.DataMemberTreeNode) {\n      item.children().forEach(function (x) {\n        return _this._setChecked(x);\n      });\n    }\n  };\n\n  TreeNodeItemsProvider.prototype.selectAllItems = function (onlyRoot) {\n    var _this = this;\n\n    if (onlyRoot === void 0) {\n      onlyRoot = true;\n    }\n\n    var deferred = $.Deferred();\n\n    this._createTree().always(function () {\n      if (onlyRoot) {\n        _this._rootItems().forEach(function (x) {\n          return x.setChecked(true);\n        });\n      } else {\n        _this._rootItems().forEach(function (x) {\n          return _this._setChecked(x);\n        });\n      }\n\n      deferred.resolve();\n    });\n\n    return deferred.promise();\n  };\n\n  TreeNodeItemsProvider.prototype.selectItemsByPath = function (path) {\n    var _this = this;\n\n    var deferred = $.Deferred();\n    var pathParts = path.split('.');\n\n    this._createTreePart(pathParts).done(function () {\n      _this.getItems(new pathRequest_1.PathRequest(pathParts.join('.'), pathParts)).done(function (items) {\n        items.forEach(function (item) {\n          if (item instanceof _treeListNode_1.TreeNodeBase) {\n            item.setChecked(true);\n          }\n        });\n      }).always(function () {\n        return deferred.resolve();\n      });\n    });\n\n    return deferred.promise();\n  };\n\n  TreeNodeItemsProvider.prototype.selectItemByPath = function (path) {\n    var _this = this;\n\n    var deferred = $.Deferred();\n    var pathParts = path.split('.');\n\n    this._createTreePart(pathParts).done(function () {\n      var fieldName = pathParts.pop();\n\n      _this.getItems(new pathRequest_1.PathRequest(pathParts.join('.'), pathParts)).done(function (items) {\n        var item = items.filter(function (x) {\n          return x.name === fieldName;\n        })[0];\n\n        if (item instanceof _treeListNode_1.TreeNodeBase) {\n          item.setChecked(true);\n        }\n      }).always(function () {\n        return deferred.resolve();\n      });\n    });\n\n    return deferred.promise();\n  };\n\n  TreeNodeItemsProvider.prototype._getParentNode = function (pathRequest) {\n    var parentNode = this._rootItems().filter(function (item) {\n      return item.path === (pathRequest.id || pathRequest.ref);\n    })[0];\n\n    if (!parentNode) return;\n    var childPath = parentNode.path;\n\n    for (var index = 1; index < pathRequest.pathParts.length; index++) {\n      if (!parentNode) return;\n      childPath += '.' + pathRequest.pathParts[index];\n      parentNode = parentNode.children().filter(function (item) {\n        return _utils_1.isList(item) && item.path == childPath;\n      })[0];\n    }\n\n    return parentNode;\n  };\n\n  TreeNodeItemsProvider.prototype._getDefaultTreeNodeCheckState = function (item) {\n    return false;\n  };\n\n  TreeNodeItemsProvider.prototype.isList = function (dataMember, parentNode) {\n    return _utils_1.isList(dataMember);\n  };\n\n  return TreeNodeItemsProvider;\n}(utils_1.Disposable);\n\nexports.TreeNodeItemsProvider = TreeNodeItemsProvider;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/query-builder/wizard/internal/_treeNodeItemsProvider.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","TreeNodeItemsProvider","ko","require","$","utils_1","_treeListNode_1","pathRequest_1","_utils_1","_super","fieldListProvider","rootItems","generateTreeNode","generateTreeLeafNode","_this","_fullTreeLoaded","_rootItems","observableArray","_checkedRootNodesCount","computed","length","count","i","unChecked","hasCheckedItems","getRootItems","getItems","pathRequest","collectChilds","result","Deferred","fullPath","pathParts","resolve","done","currentParentNode","_getParentNode","children","reject","array","listPath","forEach","item","isChecked","_getDefaultTreeNodeCheckState","isList","push","concat","split","name","join","initializeChildren","when","apply","map","x","PathRequest","always","promise","_disposables","subscribe","newValue","_createTree","path","_createTreePart","deferred","checkedPath","fail","slice","newParentPath","request","res","_setChecked","setChecked","DataMemberTreeNode","selectAllItems","onlyRoot","selectItemsByPath","items","TreeNodeBase","selectItemByPath","fieldName","pop","filter","parentNode","id","ref","childPath","index","dataMember","Disposable"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\_treeNodeItemsProvider.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TreeNodeItemsProvider = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar utils_1 = require(\"../../../serializer/utils\");\nvar _treeListNode_1 = require(\"./_treeListNode\");\nvar pathRequest_1 = require(\"../../../widgets/common/pathRequest\");\nvar _utils_1 = require(\"../../../widgets/_utils\");\nvar TreeNodeItemsProvider = (function (_super) {\n    __extends(TreeNodeItemsProvider, _super);\n    function TreeNodeItemsProvider(fieldListProvider, rootItems, generateTreeNode, generateTreeLeafNode) {\n        var _this = _super.call(this) || this;\n        _this._fullTreeLoaded = false;\n        _this._rootItems = ko.observableArray([]);\n        _this._checkedRootNodesCount = ko.computed(function () {\n            if (!_this._rootItems || _this._rootItems().length === 0)\n                return 0;\n            var count = 0;\n            for (var i = 0; i < _this._rootItems().length && count < 1; i++) {\n                count += _this._rootItems()[i].unChecked() ? 0 : 1;\n            }\n            return count;\n        });\n        _this.hasCheckedItems = ko.computed(function () {\n            return !(_this._checkedRootNodesCount() === 0);\n        });\n        _this.getRootItems = function () { return _this._rootItems(); };\n        _this.getItems = function (pathRequest, collectChilds) {\n            if (collectChilds === void 0) { collectChilds = false; }\n            var result = $.Deferred();\n            if (!pathRequest.fullPath && pathRequest.pathParts.length === 0) {\n                result.resolve(_this._rootItems());\n            }\n            else {\n                fieldListProvider.getItems(pathRequest).done(function (value) {\n                    var currentParentNode = _this._getParentNode(pathRequest);\n                    if (!currentParentNode || !currentParentNode.children)\n                        return result.reject();\n                    if (currentParentNode.children().length === 0) {\n                        var array = [];\n                        var listPath = [];\n                        value.forEach(function (item) {\n                            var isChecked = _this._getDefaultTreeNodeCheckState(item);\n                            if (_this.isList(item, currentParentNode)) {\n                                if (pathRequest.pathParts.length <= 5) {\n                                    listPath.push([].concat(pathRequest.fullPath.split('.'), [item.name]));\n                                    array.push(generateTreeNode(item, isChecked, [pathRequest.fullPath, item.name].join('.')));\n                                }\n                            }\n                            else {\n                                array.push(generateTreeLeafNode(item, isChecked, [pathRequest.fullPath, item.name].join('.')));\n                            }\n                        });\n                        currentParentNode.initializeChildren(array);\n                        if (collectChilds)\n                            $.when.apply($, listPath.map(function (x) { return _this.getItems(new pathRequest_1.PathRequest(x.join('.'), x), collectChilds); })).always(function () { return result.resolve(array); });\n                        else\n                            result.resolve(array);\n                    }\n                    else {\n                        result.resolve(currentParentNode.children());\n                    }\n                });\n            }\n            return result.promise();\n        };\n        _this._disposables.push(rootItems.subscribe(function (newValue) {\n            _this._fullTreeLoaded = false;\n            _this._rootItems(newValue.map(function (item) {\n                var isChecked = _this._getDefaultTreeNodeCheckState(item);\n                return generateTreeNode(item, isChecked, item.name);\n            }));\n        }));\n        _this._disposables.push(_this.hasCheckedItems);\n        return _this;\n    }\n    TreeNodeItemsProvider.prototype._createTree = function () {\n        var _this = this;\n        if (!this._fullTreeLoaded)\n            return $.when.apply($, this._rootItems().map(function (item) { return _this.getItems(new pathRequest_1.PathRequest(item.path), true); })).always(function () { return _this._fullTreeLoaded = true; });\n        else {\n            return $.Deferred().resolve().promise();\n        }\n    };\n    TreeNodeItemsProvider.prototype._createTreePart = function (pathParts, deferred, checkedPath) {\n        var _this = this;\n        if (deferred === void 0) { deferred = $.Deferred(); }\n        if (this._fullTreeLoaded)\n            return deferred.resolve().promise();\n        if (pathParts.length === 0)\n            return deferred.resolve();\n        if (!checkedPath) {\n            var deferred = $.Deferred();\n            if (pathParts.length === 1) {\n                this.getItems(new pathRequest_1.PathRequest(pathParts[0], pathParts)).done(function () { return deferred.resolve(); }).fail(function () { return deferred.reject(); });\n            }\n            else\n                this._createTreePart(pathParts.slice(1), deferred, [pathParts[0]]);\n            return deferred;\n        }\n        else {\n            var newParentPath = [].concat([], checkedPath, pathParts[0]);\n            var request = new pathRequest_1.PathRequest(newParentPath.join('.'), newParentPath);\n            if (!this._getParentNode(request)) {\n                this.getItems(new pathRequest_1.PathRequest(checkedPath.join('.'), checkedPath)).done(function (res) {\n                    _this._createTreePart(pathParts.slice(1), deferred, newParentPath);\n                }).fail(function () { return deferred.reject(); });\n            }\n            else {\n                this._createTreePart(pathParts.slice(1), deferred, newParentPath);\n            }\n        }\n    };\n    TreeNodeItemsProvider.prototype._setChecked = function (item) {\n        var _this = this;\n        item.setChecked(true);\n        if (item instanceof _treeListNode_1.DataMemberTreeNode) {\n            item.children().forEach(function (x) { return _this._setChecked(x); });\n        }\n    };\n    TreeNodeItemsProvider.prototype.selectAllItems = function (onlyRoot) {\n        var _this = this;\n        if (onlyRoot === void 0) { onlyRoot = true; }\n        var deferred = $.Deferred();\n        this._createTree().always(function () {\n            if (onlyRoot) {\n                _this._rootItems().forEach(function (x) { return x.setChecked(true); });\n            }\n            else {\n                _this._rootItems().forEach(function (x) { return _this._setChecked(x); });\n            }\n            deferred.resolve();\n        });\n        return deferred.promise();\n    };\n    TreeNodeItemsProvider.prototype.selectItemsByPath = function (path) {\n        var _this = this;\n        var deferred = $.Deferred();\n        var pathParts = path.split('.');\n        this._createTreePart(pathParts).done(function () {\n            _this.getItems(new pathRequest_1.PathRequest(pathParts.join('.'), pathParts)).done(function (items) {\n                items.forEach(function (item) {\n                    if (item instanceof _treeListNode_1.TreeNodeBase) {\n                        item.setChecked(true);\n                    }\n                });\n            }).always(function () { return deferred.resolve(); });\n        });\n        return deferred.promise();\n    };\n    TreeNodeItemsProvider.prototype.selectItemByPath = function (path) {\n        var _this = this;\n        var deferred = $.Deferred();\n        var pathParts = path.split('.');\n        this._createTreePart(pathParts).done(function () {\n            var fieldName = pathParts.pop();\n            _this.getItems(new pathRequest_1.PathRequest(pathParts.join('.'), pathParts)).done(function (items) {\n                var item = items.filter(function (x) { return x.name === fieldName; })[0];\n                if (item instanceof _treeListNode_1.TreeNodeBase) {\n                    item.setChecked(true);\n                }\n            }).always(function () { return deferred.resolve(); });\n        });\n        return deferred.promise();\n    };\n    TreeNodeItemsProvider.prototype._getParentNode = function (pathRequest) {\n        var parentNode = this._rootItems().filter(function (item) { return item.path === (pathRequest.id || pathRequest.ref); })[0];\n        if (!parentNode)\n            return;\n        var childPath = parentNode.path;\n        for (var index = 1; index < pathRequest.pathParts.length; index++) {\n            if (!parentNode)\n                return;\n            childPath += '.' + pathRequest.pathParts[index];\n            parentNode = parentNode.children().filter(function (item) { return _utils_1.isList(item) && item.path == childPath; })[0];\n        }\n        return parentNode;\n    };\n    TreeNodeItemsProvider.prototype._getDefaultTreeNodeCheckState = function (item) {\n        return false;\n    };\n    TreeNodeItemsProvider.prototype.isList = function (dataMember, parentNode) {\n        return _utils_1.isList(dataMember);\n    };\n    return TreeNodeItemsProvider;\n}(utils_1.Disposable));\nexports.TreeNodeItemsProvider = TreeNodeItemsProvider;\n"]},"metadata":{},"sourceType":"script"}