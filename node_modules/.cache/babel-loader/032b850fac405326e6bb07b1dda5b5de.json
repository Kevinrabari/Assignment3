{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/drop_down_box.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport DropDownEditor from \"./drop_down_editor/ui.drop_down_editor\";\nimport DataExpressionMixin from \"./editor/ui.data_expression\";\nimport { noop, grep } from \"../core/utils/common\";\nimport { isDefined, isObject } from \"../core/utils/type\";\nimport { map } from \"../core/utils/iterator\";\nimport { tabbable } from \"./widget/selectors\";\nimport { when, Deferred } from \"../core/utils/deferred\";\nimport $ from \"../core/renderer\";\nimport eventsEngine from \"../events/core/events_engine\";\nimport { extend } from \"../core/utils/extend\";\nimport { getElementMaxHeightByWindow } from \"../ui/overlay/utils\";\nimport registerComponent from \"../core/component_registrator\";\nimport { normalizeKeyName } from \"../events/utils/index\";\nimport { keyboard } from \"../events/short\";\nimport devices from \"../core/devices\";\nimport domAdapter from \"../core/dom_adapter\";\nimport { getPublicElement } from \"../core/element\";\nvar getActiveElement = domAdapter.getActiveElement;\nvar DROP_DOWN_BOX_CLASS = \"dx-dropdownbox\";\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\nvar realDevice = devices.real();\nvar DropDownBox = DropDownEditor.inherit({\n  _supportedKeys: function () {\n    return extend({}, this.callBase(), {\n      tab: function (e) {\n        if (!this.option(\"opened\")) {\n          return;\n        }\n\n        var $tabbableElements = this._getTabbableElements();\n\n        var $focusableElement = e.shiftKey ? $tabbableElements.last() : $tabbableElements.first();\n        $focusableElement && eventsEngine.trigger($focusableElement, \"focus\");\n        e.preventDefault();\n      }\n    });\n  },\n  _getTabbableElements: function () {\n    return this._getElements().filter(tabbable);\n  },\n  _getElements: function () {\n    return $(this.content()).find(\"*\");\n  },\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      acceptCustomValue: false,\n      contentTemplate: ANONYMOUS_TEMPLATE_NAME,\n      openOnFieldClick: true,\n      displayValueFormatter: function (value) {\n        return Array.isArray(value) ? value.join(\", \") : value;\n      },\n      useHiddenSubmitElement: true\n    });\n  },\n  _getAnonymousTemplateName: function () {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _initTemplates: function () {\n    this.callBase();\n  },\n  _initMarkup: function () {\n    this._initDataExpressions();\n\n    this.$element().addClass(DROP_DOWN_BOX_CLASS);\n    this.callBase();\n  },\n  _setSubmitValue: function () {\n    var value = this.option(\"value\");\n    var submitValue = this._shouldUseDisplayValue(value) ? this._displayGetter(value) : value;\n\n    this._getSubmitElement().val(submitValue);\n  },\n  _shouldUseDisplayValue: function (value) {\n    return \"this\" === this.option(\"valueExpr\") && isObject(value);\n  },\n  _renderInputValue: function () {\n    this._rejectValueLoading();\n\n    var values = [];\n\n    if (!this._dataSource) {\n      this.callBase(values);\n      return new Deferred().resolve();\n    }\n\n    var currentValue = this._getCurrentValue();\n\n    var keys = null !== currentValue && void 0 !== currentValue ? currentValue : [];\n    keys = Array.isArray(keys) ? keys : [keys];\n    var itemLoadDeferreds = map(keys, key => {\n      var deferred = new Deferred();\n\n      this._loadItem(key).always(item => {\n        var displayValue = this._displayGetter(item);\n\n        if (isDefined(displayValue)) {\n          values.push(displayValue);\n        } else if (this.option(\"acceptCustomValue\")) {\n          values.push(key);\n        }\n\n        deferred.resolve();\n      });\n\n      return deferred;\n    });\n    var callBase = this.callBase.bind(this);\n    return when.apply(this, itemLoadDeferreds).always(() => {\n      this.option(\"displayValue\", values);\n      callBase(values.length && values);\n    });\n  },\n  _loadItem: function (value) {\n    var deferred = new Deferred();\n    var that = this;\n    var selectedItem = grep(this.option(\"items\") || [], function (item) {\n      return this._isValueEquals(this._valueGetter(item), value);\n    }.bind(this))[0];\n\n    if (void 0 !== selectedItem) {\n      deferred.resolve(selectedItem);\n    } else {\n      this._loadValue(value).done(function (item) {\n        deferred.resolve(item);\n      }).fail(function (args) {\n        if (null !== args && void 0 !== args && args.shouldSkipCallback) {\n          return;\n        }\n\n        if (that.option(\"acceptCustomValue\")) {\n          deferred.resolve(value);\n        } else {\n          deferred.reject();\n        }\n      });\n    }\n\n    return deferred.promise();\n  },\n  _popupElementTabHandler: function (e) {\n    if (\"tab\" !== normalizeKeyName(e)) {\n      return;\n    }\n\n    var $firstTabbable = this._getTabbableElements().first().get(0);\n\n    var $lastTabbable = this._getTabbableElements().last().get(0);\n\n    var $target = e.originalEvent.target;\n    var moveBackward = !!($target === $firstTabbable && e.shift);\n    var moveForward = !!($target === $lastTabbable && !e.shift);\n\n    if (moveBackward || moveForward) {\n      this.close();\n      eventsEngine.trigger(this._input(), \"focus\");\n\n      if (moveBackward) {\n        e.originalEvent.preventDefault();\n      }\n    }\n  },\n  _renderPopup: function (e) {\n    this.callBase();\n\n    if (this.option(\"focusStateEnabled\")) {\n      keyboard.on(this.content(), null, e => this._popupElementTabHandler(e));\n    }\n  },\n  _renderPopupContent: function () {\n    if (this.option(\"contentTemplate\") === ANONYMOUS_TEMPLATE_NAME) {\n      return;\n    }\n\n    var contentTemplate = this._getTemplateByOption(\"contentTemplate\");\n\n    if (!(contentTemplate && this.option(\"contentTemplate\"))) {\n      return;\n    }\n\n    var $popupContent = this._popup.$content();\n\n    var templateData = {\n      value: this._fieldRenderData(),\n      component: this\n    };\n    $popupContent.empty();\n    contentTemplate.render({\n      container: getPublicElement($popupContent),\n      model: templateData\n    });\n  },\n  _canShowVirtualKeyboard: function () {\n    return realDevice.mac;\n  },\n  _isNestedElementActive: function () {\n    var activeElement = getActiveElement();\n    return activeElement && this._popup.$content().get(0).contains(activeElement);\n  },\n  _shouldHideOnParentScroll: function () {\n    return \"desktop\" === realDevice.deviceType && this._canShowVirtualKeyboard() && this._isNestedElementActive();\n  },\n  _popupHiddenHandler: function () {\n    this.callBase();\n    this._popupPosition = void 0;\n  },\n  _popupPositionedHandler: function (e) {\n    this.callBase(e);\n    this._popupPosition = e.position;\n  },\n  _getDefaultPopupPosition: function (isRtlEnabled) {\n    var {\n      my: my,\n      at: at\n    } = this.callBase(isRtlEnabled);\n    return {\n      my: my,\n      at: at,\n      offset: {\n        v: -1\n      },\n      collision: \"flipfit\"\n    };\n  },\n  _popupConfig: function () {\n    var {\n      focusStateEnabled: focusStateEnabled\n    } = this.option();\n    return extend(this.callBase(), {\n      tabIndex: -1,\n      dragEnabled: false,\n      focusStateEnabled: focusStateEnabled,\n      contentTemplate: ANONYMOUS_TEMPLATE_NAME,\n      hideOnParentScroll: this._shouldHideOnParentScroll.bind(this),\n      position: extend(this.option(\"popupPosition\"), {\n        of: this.$element()\n      }),\n      onKeyboardHandled: opts => this.option(\"focusStateEnabled\") && this._popupElementTabHandler(opts),\n      _ignoreFunctionValueDeprecation: true,\n      maxHeight: function () {\n        var _this$_popupPosition;\n\n        var popupLocation = null === (_this$_popupPosition = this._popupPosition) || void 0 === _this$_popupPosition ? void 0 : _this$_popupPosition.v.location;\n        return getElementMaxHeightByWindow(this.$element(), popupLocation);\n      }.bind(this)\n    });\n  },\n  _popupShownHandler: function () {\n    this.callBase();\n\n    var $firstElement = this._getTabbableElements().first();\n\n    eventsEngine.trigger($firstElement, \"focus\");\n  },\n  _setCollectionWidgetOption: noop,\n  _optionChanged: function (args) {\n    this._dataExpressionOptionChanged(args);\n\n    switch (args.name) {\n      case \"dataSource\":\n        this._renderInputValue();\n\n        break;\n\n      case \"displayValue\":\n        this.option(\"text\", args.value);\n        break;\n\n      case \"displayExpr\":\n        this._renderValue();\n\n        break;\n\n      case \"contentTemplate\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  }\n}).include(DataExpressionMixin);\nregisterComponent(\"dxDropDownBox\", DropDownBox);\nexport default DropDownBox;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devextreme/esm/ui/drop_down_box.js"],"names":["DropDownEditor","DataExpressionMixin","noop","grep","isDefined","isObject","map","tabbable","when","Deferred","$","eventsEngine","extend","getElementMaxHeightByWindow","registerComponent","normalizeKeyName","keyboard","devices","domAdapter","getPublicElement","getActiveElement","DROP_DOWN_BOX_CLASS","ANONYMOUS_TEMPLATE_NAME","realDevice","real","DropDownBox","inherit","_supportedKeys","callBase","tab","e","option","$tabbableElements","_getTabbableElements","$focusableElement","shiftKey","last","first","trigger","preventDefault","_getElements","filter","content","find","_getDefaultOptions","acceptCustomValue","contentTemplate","openOnFieldClick","displayValueFormatter","value","Array","isArray","join","useHiddenSubmitElement","_getAnonymousTemplateName","_initTemplates","_initMarkup","_initDataExpressions","$element","addClass","_setSubmitValue","submitValue","_shouldUseDisplayValue","_displayGetter","_getSubmitElement","val","_renderInputValue","_rejectValueLoading","values","_dataSource","resolve","currentValue","_getCurrentValue","keys","itemLoadDeferreds","key","deferred","_loadItem","always","item","displayValue","push","bind","apply","length","that","selectedItem","_isValueEquals","_valueGetter","_loadValue","done","fail","args","shouldSkipCallback","reject","promise","_popupElementTabHandler","$firstTabbable","get","$lastTabbable","$target","originalEvent","target","moveBackward","shift","moveForward","close","_input","_renderPopup","on","_renderPopupContent","_getTemplateByOption","$popupContent","_popup","$content","templateData","_fieldRenderData","component","empty","render","container","model","_canShowVirtualKeyboard","mac","_isNestedElementActive","activeElement","contains","_shouldHideOnParentScroll","deviceType","_popupHiddenHandler","_popupPosition","_popupPositionedHandler","position","_getDefaultPopupPosition","isRtlEnabled","my","at","offset","v","collision","_popupConfig","focusStateEnabled","tabIndex","dragEnabled","hideOnParentScroll","of","onKeyboardHandled","opts","_ignoreFunctionValueDeprecation","maxHeight","_this$_popupPosition","popupLocation","location","_popupShownHandler","$firstElement","_setCollectionWidgetOption","_optionChanged","_dataExpressionOptionChanged","name","_renderValue","_invalidate","include"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/drop_down_box.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport DropDownEditor from \"./drop_down_editor/ui.drop_down_editor\";\r\nimport DataExpressionMixin from \"./editor/ui.data_expression\";\r\nimport {\r\n    noop,\r\n    grep\r\n} from \"../core/utils/common\";\r\nimport {\r\n    isDefined,\r\n    isObject\r\n} from \"../core/utils/type\";\r\nimport {\r\n    map\r\n} from \"../core/utils/iterator\";\r\nimport {\r\n    tabbable\r\n} from \"./widget/selectors\";\r\nimport {\r\n    when,\r\n    Deferred\r\n} from \"../core/utils/deferred\";\r\nimport $ from \"../core/renderer\";\r\nimport eventsEngine from \"../events/core/events_engine\";\r\nimport {\r\n    extend\r\n} from \"../core/utils/extend\";\r\nimport {\r\n    getElementMaxHeightByWindow\r\n} from \"../ui/overlay/utils\";\r\nimport registerComponent from \"../core/component_registrator\";\r\nimport {\r\n    normalizeKeyName\r\n} from \"../events/utils/index\";\r\nimport {\r\n    keyboard\r\n} from \"../events/short\";\r\nimport devices from \"../core/devices\";\r\nimport domAdapter from \"../core/dom_adapter\";\r\nimport {\r\n    getPublicElement\r\n} from \"../core/element\";\r\nvar getActiveElement = domAdapter.getActiveElement;\r\nvar DROP_DOWN_BOX_CLASS = \"dx-dropdownbox\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\r\nvar realDevice = devices.real();\r\nvar DropDownBox = DropDownEditor.inherit({\r\n    _supportedKeys: function() {\r\n        return extend({}, this.callBase(), {\r\n            tab: function(e) {\r\n                if (!this.option(\"opened\")) {\r\n                    return\r\n                }\r\n                var $tabbableElements = this._getTabbableElements();\r\n                var $focusableElement = e.shiftKey ? $tabbableElements.last() : $tabbableElements.first();\r\n                $focusableElement && eventsEngine.trigger($focusableElement, \"focus\");\r\n                e.preventDefault()\r\n            }\r\n        })\r\n    },\r\n    _getTabbableElements: function() {\r\n        return this._getElements().filter(tabbable)\r\n    },\r\n    _getElements: function() {\r\n        return $(this.content()).find(\"*\")\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            acceptCustomValue: false,\r\n            contentTemplate: ANONYMOUS_TEMPLATE_NAME,\r\n            openOnFieldClick: true,\r\n            displayValueFormatter: function(value) {\r\n                return Array.isArray(value) ? value.join(\", \") : value\r\n            },\r\n            useHiddenSubmitElement: true\r\n        })\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _initTemplates: function() {\r\n        this.callBase()\r\n    },\r\n    _initMarkup: function() {\r\n        this._initDataExpressions();\r\n        this.$element().addClass(DROP_DOWN_BOX_CLASS);\r\n        this.callBase()\r\n    },\r\n    _setSubmitValue: function() {\r\n        var value = this.option(\"value\");\r\n        var submitValue = this._shouldUseDisplayValue(value) ? this._displayGetter(value) : value;\r\n        this._getSubmitElement().val(submitValue)\r\n    },\r\n    _shouldUseDisplayValue: function(value) {\r\n        return \"this\" === this.option(\"valueExpr\") && isObject(value)\r\n    },\r\n    _renderInputValue: function() {\r\n        this._rejectValueLoading();\r\n        var values = [];\r\n        if (!this._dataSource) {\r\n            this.callBase(values);\r\n            return (new Deferred).resolve()\r\n        }\r\n        var currentValue = this._getCurrentValue();\r\n        var keys = null !== currentValue && void 0 !== currentValue ? currentValue : [];\r\n        keys = Array.isArray(keys) ? keys : [keys];\r\n        var itemLoadDeferreds = map(keys, key => {\r\n            var deferred = new Deferred;\r\n            this._loadItem(key).always(item => {\r\n                var displayValue = this._displayGetter(item);\r\n                if (isDefined(displayValue)) {\r\n                    values.push(displayValue)\r\n                } else if (this.option(\"acceptCustomValue\")) {\r\n                    values.push(key)\r\n                }\r\n                deferred.resolve()\r\n            });\r\n            return deferred\r\n        });\r\n        var callBase = this.callBase.bind(this);\r\n        return when.apply(this, itemLoadDeferreds).always(() => {\r\n            this.option(\"displayValue\", values);\r\n            callBase(values.length && values)\r\n        })\r\n    },\r\n    _loadItem: function(value) {\r\n        var deferred = new Deferred;\r\n        var that = this;\r\n        var selectedItem = grep(this.option(\"items\") || [], function(item) {\r\n            return this._isValueEquals(this._valueGetter(item), value)\r\n        }.bind(this))[0];\r\n        if (void 0 !== selectedItem) {\r\n            deferred.resolve(selectedItem)\r\n        } else {\r\n            this._loadValue(value).done((function(item) {\r\n                deferred.resolve(item)\r\n            })).fail((function(args) {\r\n                if (null !== args && void 0 !== args && args.shouldSkipCallback) {\r\n                    return\r\n                }\r\n                if (that.option(\"acceptCustomValue\")) {\r\n                    deferred.resolve(value)\r\n                } else {\r\n                    deferred.reject()\r\n                }\r\n            }))\r\n        }\r\n        return deferred.promise()\r\n    },\r\n    _popupElementTabHandler: function(e) {\r\n        if (\"tab\" !== normalizeKeyName(e)) {\r\n            return\r\n        }\r\n        var $firstTabbable = this._getTabbableElements().first().get(0);\r\n        var $lastTabbable = this._getTabbableElements().last().get(0);\r\n        var $target = e.originalEvent.target;\r\n        var moveBackward = !!($target === $firstTabbable && e.shift);\r\n        var moveForward = !!($target === $lastTabbable && !e.shift);\r\n        if (moveBackward || moveForward) {\r\n            this.close();\r\n            eventsEngine.trigger(this._input(), \"focus\");\r\n            if (moveBackward) {\r\n                e.originalEvent.preventDefault()\r\n            }\r\n        }\r\n    },\r\n    _renderPopup: function(e) {\r\n        this.callBase();\r\n        if (this.option(\"focusStateEnabled\")) {\r\n            keyboard.on(this.content(), null, e => this._popupElementTabHandler(e))\r\n        }\r\n    },\r\n    _renderPopupContent: function() {\r\n        if (this.option(\"contentTemplate\") === ANONYMOUS_TEMPLATE_NAME) {\r\n            return\r\n        }\r\n        var contentTemplate = this._getTemplateByOption(\"contentTemplate\");\r\n        if (!(contentTemplate && this.option(\"contentTemplate\"))) {\r\n            return\r\n        }\r\n        var $popupContent = this._popup.$content();\r\n        var templateData = {\r\n            value: this._fieldRenderData(),\r\n            component: this\r\n        };\r\n        $popupContent.empty();\r\n        contentTemplate.render({\r\n            container: getPublicElement($popupContent),\r\n            model: templateData\r\n        })\r\n    },\r\n    _canShowVirtualKeyboard: function() {\r\n        return realDevice.mac\r\n    },\r\n    _isNestedElementActive: function() {\r\n        var activeElement = getActiveElement();\r\n        return activeElement && this._popup.$content().get(0).contains(activeElement)\r\n    },\r\n    _shouldHideOnParentScroll: function() {\r\n        return \"desktop\" === realDevice.deviceType && this._canShowVirtualKeyboard() && this._isNestedElementActive()\r\n    },\r\n    _popupHiddenHandler: function() {\r\n        this.callBase();\r\n        this._popupPosition = void 0\r\n    },\r\n    _popupPositionedHandler: function(e) {\r\n        this.callBase(e);\r\n        this._popupPosition = e.position\r\n    },\r\n    _getDefaultPopupPosition: function(isRtlEnabled) {\r\n        var {\r\n            my: my,\r\n            at: at\r\n        } = this.callBase(isRtlEnabled);\r\n        return {\r\n            my: my,\r\n            at: at,\r\n            offset: {\r\n                v: -1\r\n            },\r\n            collision: \"flipfit\"\r\n        }\r\n    },\r\n    _popupConfig: function() {\r\n        var {\r\n            focusStateEnabled: focusStateEnabled\r\n        } = this.option();\r\n        return extend(this.callBase(), {\r\n            tabIndex: -1,\r\n            dragEnabled: false,\r\n            focusStateEnabled: focusStateEnabled,\r\n            contentTemplate: ANONYMOUS_TEMPLATE_NAME,\r\n            hideOnParentScroll: this._shouldHideOnParentScroll.bind(this),\r\n            position: extend(this.option(\"popupPosition\"), {\r\n                of: this.$element()\r\n            }),\r\n            onKeyboardHandled: opts => this.option(\"focusStateEnabled\") && this._popupElementTabHandler(opts),\r\n            _ignoreFunctionValueDeprecation: true,\r\n            maxHeight: function() {\r\n                var _this$_popupPosition;\r\n                var popupLocation = null === (_this$_popupPosition = this._popupPosition) || void 0 === _this$_popupPosition ? void 0 : _this$_popupPosition.v.location;\r\n                return getElementMaxHeightByWindow(this.$element(), popupLocation)\r\n            }.bind(this)\r\n        })\r\n    },\r\n    _popupShownHandler: function() {\r\n        this.callBase();\r\n        var $firstElement = this._getTabbableElements().first();\r\n        eventsEngine.trigger($firstElement, \"focus\")\r\n    },\r\n    _setCollectionWidgetOption: noop,\r\n    _optionChanged: function(args) {\r\n        this._dataExpressionOptionChanged(args);\r\n        switch (args.name) {\r\n            case \"dataSource\":\r\n                this._renderInputValue();\r\n                break;\r\n            case \"displayValue\":\r\n                this.option(\"text\", args.value);\r\n                break;\r\n            case \"displayExpr\":\r\n                this._renderValue();\r\n                break;\r\n            case \"contentTemplate\":\r\n                this._invalidate();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    }\r\n}).include(DataExpressionMixin);\r\nregisterComponent(\"dxDropDownBox\", DropDownBox);\r\nexport default DropDownBox;\r\n"]},"metadata":{},"sourceType":"module"}