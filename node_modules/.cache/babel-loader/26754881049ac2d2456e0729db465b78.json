{"ast":null,"code":"/**\r\n* DevExpress Dashboard (color-scheme-editor-extension.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DashboardColorSchemeEditorExtension = void 0;\n\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\n\nvar ko = require(\"knockout\");\n\nvar control_options_1 = require(\"../../common/control-options\");\n\nvar _default_1 = require(\"../../data/localization/_default\");\n\nvar color_1 = require(\"../../model/color\");\n\nvar _dimension_1 = require(\"../../model/data-item/metadata/_dimension\");\n\nvar _coloring_options_1 = require(\"../../model/items/options/metadata/_coloring-options\");\n\nvar _dashboard_item_coloring_options_1 = require(\"../../model/items/options/metadata/_dashboard-item-coloring-options\");\n\nvar _object_properties_wrapper_1 = require(\"../form-adapter/_object-properties-wrapper\");\n\nvar _accordion_tab_1 = require(\"../properties-controller/_accordion-tab\");\n\nvar toolbox_items_1 = require(\"../toolbox-extension/toolbox-items\");\n\nvar _display_name_provider_1 = require(\"../_display-name-provider\");\n\nvar _color_picker_model_1 = require(\"./internal/_color-picker-model\");\n\nvar _color_scheme_model_1 = require(\"./internal/_color-scheme-model\");\n\nvar _color_tree_view_model_1 = require(\"./internal/_color-tree-view-model\");\n\nvar _entry_editor_model_1 = require(\"./internal/_entry-editor-model\");\n\nvar name = 'dashboard-color-scheme-editor';\nvar nameAlias = 'dashboardColorSchemeEditor';\n\nvar DashboardColorSchemeEditorExtension = function () {\n  function DashboardColorSchemeEditorExtension(dashboardControl) {\n    var _this = this;\n\n    this.dashboardControl = dashboardControl;\n    this.name = name;\n    this._subscriptions = [];\n    this.selected = ko.observable(false);\n    this._colorSchemeModel = ko.observable();\n    this._colorPalette = ko.observableArray();\n    this._entryEditorModel = new _entry_editor_model_1.EntryEditorViewModel(this._colorPalette);\n    this._colorPickerModel = ko.computed(function () {\n      return new _color_picker_model_1.ColorPickerModel(_this._colorSchemeModel(), _this._colorPalette);\n    });\n    this._selectedEntry = ko.observable();\n\n    this._createNewEntry = function () {\n      _this._colorSchemeModel().initNewEntry();\n\n      _this._entryEditorModel.editEntry(_this.dataSourceBrowserExtension._dataSourceBrowserViewModel().dataSourceBrowser, _this._colorSchemeModel().newEntry(), _this._colorSchemeModel().selectedSignatures()[0].colorByMeasures, _this._colorSchemeModel().getAvailableMeasureKeys(), function (editedEntry) {\n        return _this._colorSchemeModel().updateEntry(undefined, editedEntry);\n      }, false);\n    };\n\n    this._menuItem = new toolbox_items_1.DashboardMenuItem(this.name, 'DashboardWebStringId.DashboardMenuColorScheme', 250, 0);\n    this._menuItem.template = 'dx-dashboard-form-color-scheme';\n    this._menuItem.data = {\n      colorSchemeModel: this._colorSchemeModel,\n      selectedEntry: this._selectedEntry,\n      entryEditorModel: this._entryEditorModel,\n      colorPickerModel: this._colorPickerModel,\n      createNewEntry: this._createNewEntry,\n      colorPalette: this._colorPalette,\n      getDataSourceName: function (dataSourceId) {\n        if (_this.dashboardControl.dashboard() && _this.dashboardControl.dashboard().dataSources()) {\n          var dataSource = _this.dashboardControl.dashboard().dataSources().filter(function (dataSource) {\n            return dataSource.componentName() === dataSourceId;\n          })[0];\n\n          if (dataSource) return dataSource.name();\n        }\n\n        return dataSourceId;\n      }\n    };\n    this._menuItem.disabled = ko.computed(function () {\n      return !dashboardControl.dashboard();\n    });\n  }\n\n  DashboardColorSchemeEditorExtension._isColoringSupported = function (item) {\n    return !!item['coloringOptions'];\n  };\n\n  DashboardColorSchemeEditorExtension.prototype._updateExtensionModel = function () {\n    var _this = this;\n\n    if (!!this.dashboardControl.dashboard() && this.dashboardControl.isDesignMode()) {\n      !!this.dashboardControl._serviceClient() && this.dashboardControl._serviceClient().getDashboardPalette().done(function (palette) {\n        _this._colorPalette(analytics_utils_1.deserializeArray(palette, function (colorModel) {\n          return new color_1.Color(colorModel['#text']);\n        })());\n      });\n\n      this._colorSchemeModel(new _color_scheme_model_1.ColorSchemeModel(this.dashboardControl.dashboard(), this.dashboardControl._serviceClient() && this.dashboardControl._serviceClient().getColoringScheme || null, this.dashboardControl._updateHub));\n    } else {\n      this._colorSchemeModel(null);\n    }\n  };\n\n  DashboardColorSchemeEditorExtension.prototype.start = function () {\n    var _this = this;\n\n    this._propertiesPanelExtension = this.dashboardControl.findExtension('item-options-panel');\n    this.dataSourceBrowserExtension = this.dashboardControl.findExtension('data-source-browser');\n    var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n\n    if (toolboxExtension) {\n      toolboxExtension.menuItems.push(this._menuItem);\n    }\n\n    this._subscriptions.push(this.dashboardControl.dashboard.subscribe(this._updateExtensionModel, this));\n\n    this._subscriptions.push(this.dashboardControl.isDesignMode.subscribe(this._updateExtensionModel, this));\n\n    this._subscriptions.push(this._selectedEntry.subscribe(function (entry) {\n      if (entry == null) {\n        _this._entryEditorModel.close();\n      } else {\n        _this._entryEditorModel.editEntry(_this.dataSourceBrowserExtension._dataSourceBrowserViewModel().dataSourceBrowser, entry, _this._colorSchemeModel().selectedSignatures()[0].colorByMeasures, _this._colorSchemeModel().getAvailableMeasureKeys(), function (editedEntry) {\n          return _this._colorSchemeModel().updateEntry(entry, editedEntry);\n        }, _this._colorSchemeModel().isEntryAutogenerated(entry));\n      }\n    }));\n\n    ko.computed(function () {\n      var model = _this._colorSchemeModel();\n\n      if (model) {\n        _this._subscriptions.push(model.selectedSignatures.subscribe(function (v) {\n          _this._entryEditorModel.close();\n\n          model.newEntry(null);\n        }));\n      }\n    });\n    var oldColoringComputed = null;\n\n    if (!!this._propertiesPanelExtension) {\n      this._subscriptions.push(this._propertiesPanelExtension._subscribeTabsChanged(function (tabs) {\n        oldColoringComputed && oldColoringComputed.dispose();\n        var item = _this.dashboardControl._actualLayoutController() && _this.dashboardControl._actualLayoutController().selectedDashboardItem() || null;\n\n        if (item && DashboardColorSchemeEditorExtension._isColoringSupported(item)) {\n          var coloringTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.ColoringOptions, 'DashboardWebStringId.ColoringOptions');\n          tabs.push(coloringTab);\n          oldColoringComputed = ko.computed(function () {\n            coloringTab.tabModel(_this._getColoringWrapper(item));\n          });\n\n          _this._subscriptions.push(oldColoringComputed);\n\n          tabs.push(new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.ColorScheme, 'DashboardWebStringId.DashboardMenuColorScheme', _this._getColorSchemeWrapper(item)));\n        }\n      }));\n    }\n\n    this._updateExtensionModel();\n  };\n\n  DashboardColorSchemeEditorExtension.prototype.stop = function () {\n    this._subscriptions.forEach(function (s) {\n      return s.dispose();\n    });\n\n    this._subscriptions = [];\n    var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n\n    if (toolboxExtension) {\n      toolboxExtension.menuItems.remove(this._menuItem);\n    }\n  };\n\n  DashboardColorSchemeEditorExtension.prototype._getColorSchemeWrapper = function (model) {\n    var _this = this;\n\n    ko.computed(function () {\n      if (!!_this._colorSchemeModel()) _this._colorSchemeModel().selectedSignatures([model._getColoringSignatureOnCurrentDrillDownLevel()]);\n    });\n    var artificialModel = {\n      colorSchemeModel: this._colorSchemeModel(),\n      coloringOptions: model.coloringOptions\n    };\n    var properties = [{\n      propertyName: 'colorSchemeModel',\n      formAdapterItem: _color_tree_view_model_1.colorSchemeTreeViewEditor({\n        dataSource: this._colorSchemeModel().selectedSignatureEntries,\n        editColor: function (entry, event) {\n          _this._colorPickerModel().init(entry, event.target);\n        },\n        colorPalette: this._colorPalette,\n        colorPickerModel: this._colorPickerModel\n      })\n    }, {\n      container: _coloring_options_1.coloringOptions,\n      properties: [_dashboard_item_coloring_options_1.useGlobalColors]\n    }];\n    return new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n      model: artificialModel,\n      properties: properties\n    });\n  };\n\n  DashboardColorSchemeEditorExtension.prototype._getColoringWrapper = function (model) {\n    var _this = this;\n\n    var allColorsModel = {\n      measuresColoringMode: model.coloringOptions.measuresColoringMode,\n      getInfo: function () {\n        return [];\n      }\n    };\n    var properties = [];\n\n    var addColoringOptions = function (item, arr, prefixId) {\n      var prefix = _default_1.getLocalizationById(prefixId);\n\n      arr.forEach(function (arg) {\n        if (arg.dataItem()) {\n          allColorsModel[arg.uniqueName()] = arg.dataItem().coloringMode;\n          properties.push({\n            propertyName: arg.uniqueName(),\n            displayName: prefix + ' - ' + _display_name_provider_1.getDataItemDisplayName(_this.dashboardControl._dataSourceBrowser, item, arg.dataItem()),\n            simpleFormAdapterItem: 'buttonGroupEditor',\n            values: _dimension_1.coloringMode.values\n          });\n        }\n      });\n    };\n\n    var addItemColoringOptions = function (itemsInfo) {\n      itemsInfo.forEach(function (itemInfo) {\n        return addColoringOptions(model, itemInfo.items, itemInfo.prefixId);\n      });\n    };\n\n    addItemColoringOptions(model._getColorizableDataItemsInfo());\n\n    if (model._canColorByMeasures) {\n      properties.push(_dashboard_item_coloring_options_1.measuresColoringMode);\n    }\n\n    return new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n      model: allColorsModel,\n      properties: properties\n    });\n  };\n\n  return DashboardColorSchemeEditorExtension;\n}();\n\nexports.DashboardColorSchemeEditorExtension = DashboardColorSchemeEditorExtension;\n\ncontrol_options_1.designerExtensions[name] = function (dashboardControl, options) {\n  return new DashboardColorSchemeEditorExtension(dashboardControl);\n};\n\ncontrol_options_1.extensionNameMap[name] = nameAlias;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/color-scheme-editor-extension/color-scheme-editor-extension.js"],"names":["Object","defineProperty","exports","value","DashboardColorSchemeEditorExtension","analytics_utils_1","require","ko","control_options_1","_default_1","color_1","_dimension_1","_coloring_options_1","_dashboard_item_coloring_options_1","_object_properties_wrapper_1","_accordion_tab_1","toolbox_items_1","_display_name_provider_1","_color_picker_model_1","_color_scheme_model_1","_color_tree_view_model_1","_entry_editor_model_1","name","nameAlias","dashboardControl","_this","_subscriptions","selected","observable","_colorSchemeModel","_colorPalette","observableArray","_entryEditorModel","EntryEditorViewModel","_colorPickerModel","computed","ColorPickerModel","_selectedEntry","_createNewEntry","initNewEntry","editEntry","dataSourceBrowserExtension","_dataSourceBrowserViewModel","dataSourceBrowser","newEntry","selectedSignatures","colorByMeasures","getAvailableMeasureKeys","editedEntry","updateEntry","undefined","_menuItem","DashboardMenuItem","template","data","colorSchemeModel","selectedEntry","entryEditorModel","colorPickerModel","createNewEntry","colorPalette","getDataSourceName","dataSourceId","dashboard","dataSources","dataSource","filter","componentName","disabled","_isColoringSupported","item","prototype","_updateExtensionModel","isDesignMode","_serviceClient","getDashboardPalette","done","palette","deserializeArray","colorModel","Color","ColorSchemeModel","getColoringScheme","_updateHub","start","_propertiesPanelExtension","findExtension","toolboxExtension","menuItems","push","subscribe","entry","close","isEntryAutogenerated","model","v","oldColoringComputed","_subscribeTabsChanged","tabs","dispose","_actualLayoutController","selectedDashboardItem","coloringTab","AccordionTab","KnownTabs","ColoringOptions","tabModel","_getColoringWrapper","ColorScheme","_getColorSchemeWrapper","stop","forEach","s","remove","_getColoringSignatureOnCurrentDrillDownLevel","artificialModel","coloringOptions","properties","propertyName","formAdapterItem","colorSchemeTreeViewEditor","selectedSignatureEntries","editColor","event","init","target","container","useGlobalColors","ObjectPropertiesWrapper","allColorsModel","measuresColoringMode","getInfo","addColoringOptions","arr","prefixId","prefix","getLocalizationById","arg","dataItem","uniqueName","coloringMode","displayName","getDataItemDisplayName","_dataSourceBrowser","simpleFormAdapterItem","values","addItemColoringOptions","itemsInfo","itemInfo","items","_getColorizableDataItemsInfo","_canColorByMeasures","designerExtensions","options","extensionNameMap"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (color-scheme-editor-extension.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DashboardColorSchemeEditorExtension = void 0;\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\nvar ko = require(\"knockout\");\nvar control_options_1 = require(\"../../common/control-options\");\nvar _default_1 = require(\"../../data/localization/_default\");\nvar color_1 = require(\"../../model/color\");\nvar _dimension_1 = require(\"../../model/data-item/metadata/_dimension\");\nvar _coloring_options_1 = require(\"../../model/items/options/metadata/_coloring-options\");\nvar _dashboard_item_coloring_options_1 = require(\"../../model/items/options/metadata/_dashboard-item-coloring-options\");\nvar _object_properties_wrapper_1 = require(\"../form-adapter/_object-properties-wrapper\");\nvar _accordion_tab_1 = require(\"../properties-controller/_accordion-tab\");\nvar toolbox_items_1 = require(\"../toolbox-extension/toolbox-items\");\nvar _display_name_provider_1 = require(\"../_display-name-provider\");\nvar _color_picker_model_1 = require(\"./internal/_color-picker-model\");\nvar _color_scheme_model_1 = require(\"./internal/_color-scheme-model\");\nvar _color_tree_view_model_1 = require(\"./internal/_color-tree-view-model\");\nvar _entry_editor_model_1 = require(\"./internal/_entry-editor-model\");\nvar name = 'dashboard-color-scheme-editor';\nvar nameAlias = 'dashboardColorSchemeEditor';\nvar DashboardColorSchemeEditorExtension = (function () {\n    function DashboardColorSchemeEditorExtension(dashboardControl) {\n        var _this = this;\n        this.dashboardControl = dashboardControl;\n        this.name = name;\n        this._subscriptions = [];\n        this.selected = ko.observable(false);\n        this._colorSchemeModel = ko.observable();\n        this._colorPalette = ko.observableArray();\n        this._entryEditorModel = new _entry_editor_model_1.EntryEditorViewModel(this._colorPalette);\n        this._colorPickerModel = ko.computed(function () { return new _color_picker_model_1.ColorPickerModel(_this._colorSchemeModel(), _this._colorPalette); });\n        this._selectedEntry = ko.observable();\n        this._createNewEntry = function () {\n            _this._colorSchemeModel().initNewEntry();\n            _this._entryEditorModel.editEntry(_this.dataSourceBrowserExtension._dataSourceBrowserViewModel().dataSourceBrowser, _this._colorSchemeModel().newEntry(), _this._colorSchemeModel().selectedSignatures()[0].colorByMeasures, _this._colorSchemeModel().getAvailableMeasureKeys(), function (editedEntry) { return _this._colorSchemeModel().updateEntry(undefined, editedEntry); }, false);\n        };\n        this._menuItem = new toolbox_items_1.DashboardMenuItem(this.name, 'DashboardWebStringId.DashboardMenuColorScheme', 250, 0);\n        this._menuItem.template = 'dx-dashboard-form-color-scheme';\n        this._menuItem.data = {\n            colorSchemeModel: this._colorSchemeModel,\n            selectedEntry: this._selectedEntry,\n            entryEditorModel: this._entryEditorModel,\n            colorPickerModel: this._colorPickerModel,\n            createNewEntry: this._createNewEntry,\n            colorPalette: this._colorPalette,\n            getDataSourceName: function (dataSourceId) {\n                if (_this.dashboardControl.dashboard() && _this.dashboardControl.dashboard().dataSources()) {\n                    var dataSource = _this.dashboardControl.dashboard().dataSources().filter(function (dataSource) { return dataSource.componentName() === dataSourceId; })[0];\n                    if (dataSource)\n                        return dataSource.name();\n                }\n                return dataSourceId;\n            }\n        };\n        this._menuItem.disabled = ko.computed(function () { return !dashboardControl.dashboard(); });\n    }\n    DashboardColorSchemeEditorExtension._isColoringSupported = function (item) {\n        return !!item['coloringOptions'];\n    };\n    DashboardColorSchemeEditorExtension.prototype._updateExtensionModel = function () {\n        var _this = this;\n        if (!!this.dashboardControl.dashboard() && this.dashboardControl.isDesignMode()) {\n            !!this.dashboardControl._serviceClient() && this.dashboardControl._serviceClient().getDashboardPalette().done(function (palette) {\n                _this._colorPalette(analytics_utils_1.deserializeArray(palette, function (colorModel) { return new color_1.Color(colorModel['#text']); })());\n            });\n            this._colorSchemeModel(new _color_scheme_model_1.ColorSchemeModel(this.dashboardControl.dashboard(), this.dashboardControl._serviceClient() && this.dashboardControl._serviceClient().getColoringScheme || null, this.dashboardControl._updateHub));\n        }\n        else {\n            this._colorSchemeModel(null);\n        }\n    };\n    DashboardColorSchemeEditorExtension.prototype.start = function () {\n        var _this = this;\n        this._propertiesPanelExtension = this.dashboardControl.findExtension('item-options-panel');\n        this.dataSourceBrowserExtension = this.dashboardControl.findExtension('data-source-browser');\n        var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n        if (toolboxExtension) {\n            toolboxExtension.menuItems.push(this._menuItem);\n        }\n        this._subscriptions.push(this.dashboardControl.dashboard.subscribe(this._updateExtensionModel, this));\n        this._subscriptions.push(this.dashboardControl.isDesignMode.subscribe(this._updateExtensionModel, this));\n        this._subscriptions.push(this._selectedEntry.subscribe(function (entry) {\n            if (entry == null) {\n                _this._entryEditorModel.close();\n            }\n            else {\n                _this._entryEditorModel.editEntry(_this.dataSourceBrowserExtension._dataSourceBrowserViewModel().dataSourceBrowser, entry, _this._colorSchemeModel().selectedSignatures()[0].colorByMeasures, _this._colorSchemeModel().getAvailableMeasureKeys(), function (editedEntry) { return _this._colorSchemeModel().updateEntry(entry, editedEntry); }, _this._colorSchemeModel().isEntryAutogenerated(entry));\n            }\n        }));\n        ko.computed(function () {\n            var model = _this._colorSchemeModel();\n            if (model) {\n                _this._subscriptions.push(model.selectedSignatures.subscribe(function (v) {\n                    _this._entryEditorModel.close();\n                    model.newEntry(null);\n                }));\n            }\n        });\n        var oldColoringComputed = null;\n        if (!!this._propertiesPanelExtension) {\n            this._subscriptions.push(this._propertiesPanelExtension._subscribeTabsChanged(function (tabs) {\n                oldColoringComputed && oldColoringComputed.dispose();\n                var item = _this.dashboardControl._actualLayoutController() && _this.dashboardControl._actualLayoutController().selectedDashboardItem() || null;\n                if (item && DashboardColorSchemeEditorExtension._isColoringSupported(item)) {\n                    var coloringTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.ColoringOptions, 'DashboardWebStringId.ColoringOptions');\n                    tabs.push(coloringTab);\n                    oldColoringComputed = ko.computed(function () {\n                        coloringTab.tabModel(_this._getColoringWrapper(item));\n                    });\n                    _this._subscriptions.push(oldColoringComputed);\n                    tabs.push(new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.ColorScheme, 'DashboardWebStringId.DashboardMenuColorScheme', _this._getColorSchemeWrapper(item)));\n                }\n            }));\n        }\n        this._updateExtensionModel();\n    };\n    DashboardColorSchemeEditorExtension.prototype.stop = function () {\n        this._subscriptions.forEach(function (s) { return s.dispose(); });\n        this._subscriptions = [];\n        var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n        if (toolboxExtension) {\n            toolboxExtension.menuItems.remove(this._menuItem);\n        }\n    };\n    DashboardColorSchemeEditorExtension.prototype._getColorSchemeWrapper = function (model) {\n        var _this = this;\n        ko.computed(function () {\n            if (!!_this._colorSchemeModel())\n                _this._colorSchemeModel().selectedSignatures([model._getColoringSignatureOnCurrentDrillDownLevel()]);\n        });\n        var artificialModel = {\n            colorSchemeModel: this._colorSchemeModel(),\n            coloringOptions: model.coloringOptions\n        };\n        var properties = [{\n                propertyName: 'colorSchemeModel',\n                formAdapterItem: _color_tree_view_model_1.colorSchemeTreeViewEditor({\n                    dataSource: this._colorSchemeModel().selectedSignatureEntries,\n                    editColor: function (entry, event) {\n                        _this._colorPickerModel().init(entry, event.target);\n                    },\n                    colorPalette: this._colorPalette,\n                    colorPickerModel: this._colorPickerModel,\n                }),\n            }, {\n                container: _coloring_options_1.coloringOptions,\n                properties: [_dashboard_item_coloring_options_1.useGlobalColors]\n            }];\n        return new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n            model: artificialModel,\n            properties: properties\n        });\n    };\n    DashboardColorSchemeEditorExtension.prototype._getColoringWrapper = function (model) {\n        var _this = this;\n        var allColorsModel = {\n            measuresColoringMode: model.coloringOptions.measuresColoringMode,\n            getInfo: function () { return []; }\n        };\n        var properties = [];\n        var addColoringOptions = function (item, arr, prefixId) {\n            var prefix = _default_1.getLocalizationById(prefixId);\n            arr.forEach(function (arg) {\n                if (arg.dataItem()) {\n                    allColorsModel[arg.uniqueName()] = arg.dataItem().coloringMode;\n                    properties.push({\n                        propertyName: arg.uniqueName(),\n                        displayName: prefix + ' - ' + _display_name_provider_1.getDataItemDisplayName(_this.dashboardControl._dataSourceBrowser, item, arg.dataItem()),\n                        simpleFormAdapterItem: 'buttonGroupEditor',\n                        values: _dimension_1.coloringMode.values\n                    });\n                }\n            });\n        };\n        var addItemColoringOptions = function (itemsInfo) {\n            itemsInfo.forEach(function (itemInfo) { return addColoringOptions(model, itemInfo.items, itemInfo.prefixId); });\n        };\n        addItemColoringOptions(model._getColorizableDataItemsInfo());\n        if (model._canColorByMeasures) {\n            properties.push(_dashboard_item_coloring_options_1.measuresColoringMode);\n        }\n        return new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n            model: allColorsModel,\n            properties: properties\n        });\n    };\n    return DashboardColorSchemeEditorExtension;\n}());\nexports.DashboardColorSchemeEditorExtension = DashboardColorSchemeEditorExtension;\ncontrol_options_1.designerExtensions[name] = function (dashboardControl, options) { return new DashboardColorSchemeEditorExtension(dashboardControl); };\ncontrol_options_1.extensionNameMap[name] = nameAlias;\n"]},"metadata":{},"sourceType":"script"}