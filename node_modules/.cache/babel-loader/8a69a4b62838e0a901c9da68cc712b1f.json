{"ast":null,"code":"/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\_wizardPageProcessor.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WizardPageProcessor = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar utils_1 = require(\"../../../serializer/utils\");\n\nvar stateManager_1 = require(\"../stateManager\");\n\nvar _wizardPageSectionIterator_1 = require(\"./_wizardPageSectionIterator\");\n\nvar eventManager_1 = require(\"../../../serializer/eventManager\");\n\nvar _utils_1 = require(\"./_utils\");\n\nvar _constants_1 = require(\"./_constants\");\n\nvar WizardPageProcessor = function (_super) {\n  __extends(WizardPageProcessor, _super);\n\n  function WizardPageProcessor(pageFactory, _loadingState, _nextAction) {\n    var _this = _super.call(this) || this;\n\n    _this.pageFactory = pageFactory;\n    _this.events = new eventManager_1.EventManager();\n    _this._loadingTimeout = null;\n    _this._changeTimeout = null;\n    _this.sections = [];\n    _this.isLoading = ko.observable(false);\n    if (_loadingState) _this._loadingState = _loadingState;\n    if (_nextAction) _this._extendedNextAction = _nextAction;\n\n    _this._disposables.push(_this.events);\n\n    return _this;\n  }\n\n  WizardPageProcessor.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this.sections.forEach(function (x) {\n      return x.resetPage();\n    });\n    this.sections = [];\n  };\n\n  WizardPageProcessor.prototype._createLoadingState = function (page) {\n    var _this = this;\n\n    if (!page[WizardPageProcessor.__loadingStateFunctionName]) {\n      page[WizardPageProcessor.__loadingStateFunctionName] = function (newVal) {\n        return _this._loadingState(newVal);\n      };\n    }\n  };\n\n  WizardPageProcessor.prototype._createNextAction = function (page) {\n    var _this = this;\n\n    if (!page[_constants_1.__nextActionFunctionName]) page[_constants_1.__nextActionFunctionName] = function () {\n      return _this._extendedNextAction();\n    };\n  };\n\n  WizardPageProcessor.prototype._loadingState = function (active) {\n    var _this = this;\n\n    if (active) {\n      this._loadingTimeout && clearTimeout(this._loadingTimeout);\n      this._loadingTimeout = setTimeout(function () {\n        _this.isLoading(true);\n      }, 100);\n    } else {\n      this._loadingTimeout && clearTimeout(this._loadingTimeout);\n      this.isLoading(false);\n    }\n  };\n\n  WizardPageProcessor.prototype._extendedNextAction = function () {};\n\n  WizardPageProcessor.prototype._resetPageById = function (pageId) {\n    var page = this.getPageById(pageId);\n    page.resetPage();\n  };\n\n  WizardPageProcessor.prototype.initialize = function (state, createIterator) {\n    var _this = this;\n\n    if (createIterator === void 0) {\n      createIterator = function (pageFactory, stateManager) {\n        return new _wizardPageSectionIterator_1.WizardPageSectionIterator(pageFactory, stateManager, function (pageId) {\n          return _this._resetPageById(pageId);\n        });\n      };\n    }\n\n    this.events.call('beforeInitialize', {\n      wizard: this,\n      state: state\n    });\n    this.stateManager = new stateManager_1.StateManager(state, this.pageFactory);\n    this.iterator = createIterator(this.pageFactory, this.stateManager);\n    this.sections = [];\n    Object.keys(this.pageFactory.metadata).forEach(function (key) {\n      _this.sections.push(new _wizardPageSectionIterator_1.WizardPageSection(key, _this.pageFactory.metadata[key]));\n    });\n    this.sections = this.sections.sort(function (a, b) {\n      return a.metadata.position - b.metadata.position;\n    });\n    this.events.call('afterInitialize', {\n      wizard: this\n    });\n  };\n\n  WizardPageProcessor.prototype._canNext = function (currentPage) {\n    var pageMetadata = !this.isLoading() && currentPage && currentPage.page && this.pageFactory.getMetadata(currentPage.pageId);\n    return pageMetadata && pageMetadata.canNext(currentPage.page);\n  };\n\n  WizardPageProcessor.prototype._canFinish = function (currentPage) {\n    return !this.isLoading() && currentPage && this.pageFactory.getMetadata(currentPage.pageId).canFinish(currentPage.page);\n  };\n\n  WizardPageProcessor.prototype._initPage = function (page, force, stateChanged) {\n    var _this = this;\n\n    if (force === void 0) {\n      force = false;\n    }\n\n    if (stateChanged === void 0) {\n      stateChanged = false;\n    }\n\n    this._createNextAction(page.page);\n\n    if (page.onChange) {\n      page.onChange(function () {\n        _this._changeTimeout && clearTimeout(_this._changeTimeout);\n        _this._changeTimeout = setTimeout(function () {\n          _this._nextAction(page);\n        }, 100);\n      });\n    } else throw Error('Page with id ' + page.pageId + ' cannot be used in AutoNavigation, because it does not have method OnChange');\n\n    return page.initialize(this.stateManager.getPageState(page.pageId), force, stateChanged).always(function () {\n      return _this._loadingState(false);\n    });\n  };\n\n  WizardPageProcessor.prototype.getPageById = function (pageId) {\n    return this.sections.filter(function (x) {\n      return x.pageId === pageId;\n    })[0];\n  };\n\n  WizardPageProcessor.prototype.start = function () {\n    var _this = this;\n\n    this.events.call('beforeStart', {\n      wizard: this\n    });\n\n    this._loadingState(true);\n\n    var page = this.iterator.getStartPage();\n    this.events.call('beforePageInitialize', _utils_1._createBeforeInitializePageEventArgs(page, this));\n\n    this._initPage(page).done(function () {\n      var pageSection = _this.getPageById(page.pageId);\n\n      if (pageSection) {\n        pageSection.setPage(page);\n\n        _this.events.call('afterPageInitialize', _utils_1._createPageEventArgs(page, _this));\n\n        _this._nextAction(page);\n      } else {\n        throw Error('Page Section with id ' + page.pageId + ' is not found.');\n      }\n    });\n  };\n\n  WizardPageProcessor.prototype.finishAction = function () {\n    var _this = this;\n\n    var deferred = $.Deferred();\n    var resolved = false;\n\n    for (var i = this.sections.length - 1; i >= 0; i--) {\n      if (this.sections[i].page()) {\n        this.sections[i].page().commit().done(function (result) {\n          if (_this.sections[i].page().isChanged) {\n            _this.events.call('beforeFinish', {\n              wizardModel: _this,\n              state: _this.stateManager.getCurrentState()\n            });\n\n            _this.stateManager.setPageState(_this.sections[i].page().pageId, result);\n\n            _this.events.call('afterFinish', {\n              wizardResult: _this,\n              state: _this.stateManager.getCurrentState()\n            });\n          }\n        }).always(function () {\n          return deferred.resolve();\n        });\n        resolved = true;\n        break;\n      }\n    }\n\n    if (!resolved) deferred.resolve();\n    return deferred.promise();\n  };\n\n  WizardPageProcessor.prototype._nextAction = function (currentPage, parentIsChanged) {\n    var _this = this;\n\n    if (parentIsChanged === void 0) {\n      parentIsChanged = false;\n    }\n\n    if (!this._canNext(currentPage) && !this._canFinish(currentPage)) {\n      currentPage.resetCommitedState();\n      return this.iterator.resetNextPages(currentPage.pageId);\n    }\n\n    this._loadingState(true);\n\n    currentPage.commit().done(function (result) {\n      if (currentPage.isChanged || parentIsChanged || currentPage.page && currentPage.page.changeAlways) {\n        _this.stateManager.setPageState(currentPage.pageId, result);\n\n        _this.iterator.getNextPage(currentPage.pageId).done(function (pages) {\n          if (pages && pages.length > 0) {\n            pages.forEach(function (page) {\n              var containedPage = _this.getPageById(page.pageId);\n\n              var page = containedPage && containedPage.page() || page;\n\n              _this.events.call('beforePageInitialize', _utils_1._createBeforeInitializePageEventArgs(page, _this));\n\n              _this._initPage(page, !!containedPage.page(), currentPage.isChanged || parentIsChanged).done(function () {\n                _this.getPageById(page.pageId).setPage(page);\n\n                _this.events.call('afterPageInitialize', _utils_1._createPageEventArgs(page, _this));\n\n                _this._nextAction(page, currentPage.isChanged);\n              });\n            });\n          } else _this._loadingState(false);\n\n          currentPage.isChanged = false;\n        }).fail(function () {\n          return _this._loadingState(false);\n        });\n      } else _this._loadingState(false);\n    }).fail(function () {\n      return _this._loadingState(false);\n    });\n  };\n\n  WizardPageProcessor.__loadingStateFunctionName = '__loadingState';\n  return WizardPageProcessor;\n}(utils_1.Disposable);\n\nexports.WizardPageProcessor = WizardPageProcessor;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/query-builder/wizard/internal/_wizardPageProcessor.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","WizardPageProcessor","ko","require","$","utils_1","stateManager_1","_wizardPageSectionIterator_1","eventManager_1","_utils_1","_constants_1","_super","pageFactory","_loadingState","_nextAction","_this","events","EventManager","_loadingTimeout","_changeTimeout","sections","isLoading","observable","_extendedNextAction","_disposables","push","dispose","forEach","x","resetPage","_createLoadingState","page","__loadingStateFunctionName","newVal","_createNextAction","__nextActionFunctionName","active","clearTimeout","setTimeout","_resetPageById","pageId","getPageById","initialize","state","createIterator","stateManager","WizardPageSectionIterator","wizard","StateManager","iterator","keys","metadata","key","WizardPageSection","sort","a","position","_canNext","currentPage","pageMetadata","getMetadata","canNext","_canFinish","canFinish","_initPage","force","stateChanged","onChange","Error","getPageState","always","filter","start","getStartPage","_createBeforeInitializePageEventArgs","done","pageSection","setPage","_createPageEventArgs","finishAction","deferred","Deferred","resolved","i","length","commit","result","isChanged","wizardModel","getCurrentState","setPageState","wizardResult","resolve","promise","parentIsChanged","resetCommitedState","resetNextPages","changeAlways","getNextPage","pages","containedPage","fail","Disposable"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\_wizardPageProcessor.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WizardPageProcessor = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar utils_1 = require(\"../../../serializer/utils\");\nvar stateManager_1 = require(\"../stateManager\");\nvar _wizardPageSectionIterator_1 = require(\"./_wizardPageSectionIterator\");\nvar eventManager_1 = require(\"../../../serializer/eventManager\");\nvar _utils_1 = require(\"./_utils\");\nvar _constants_1 = require(\"./_constants\");\nvar WizardPageProcessor = (function (_super) {\n    __extends(WizardPageProcessor, _super);\n    function WizardPageProcessor(pageFactory, _loadingState, _nextAction) {\n        var _this = _super.call(this) || this;\n        _this.pageFactory = pageFactory;\n        _this.events = new eventManager_1.EventManager();\n        _this._loadingTimeout = null;\n        _this._changeTimeout = null;\n        _this.sections = [];\n        _this.isLoading = ko.observable(false);\n        if (_loadingState)\n            _this._loadingState = _loadingState;\n        if (_nextAction)\n            _this._extendedNextAction = _nextAction;\n        _this._disposables.push(_this.events);\n        return _this;\n    }\n    WizardPageProcessor.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this.sections.forEach(function (x) { return x.resetPage(); });\n        this.sections = [];\n    };\n    WizardPageProcessor.prototype._createLoadingState = function (page) {\n        var _this = this;\n        if (!page[WizardPageProcessor.__loadingStateFunctionName]) {\n            page[WizardPageProcessor.__loadingStateFunctionName] = function (newVal) { return _this._loadingState(newVal); };\n        }\n    };\n    WizardPageProcessor.prototype._createNextAction = function (page) {\n        var _this = this;\n        if (!page[_constants_1.__nextActionFunctionName])\n            page[_constants_1.__nextActionFunctionName] = function () { return _this._extendedNextAction(); };\n    };\n    WizardPageProcessor.prototype._loadingState = function (active) {\n        var _this = this;\n        if (active) {\n            this._loadingTimeout && clearTimeout(this._loadingTimeout);\n            this._loadingTimeout = setTimeout(function () {\n                _this.isLoading(true);\n            }, 100);\n        }\n        else {\n            this._loadingTimeout && clearTimeout(this._loadingTimeout);\n            this.isLoading(false);\n        }\n    };\n    WizardPageProcessor.prototype._extendedNextAction = function () { };\n    WizardPageProcessor.prototype._resetPageById = function (pageId) {\n        var page = this.getPageById(pageId);\n        page.resetPage();\n    };\n    WizardPageProcessor.prototype.initialize = function (state, createIterator) {\n        var _this = this;\n        if (createIterator === void 0) { createIterator = function (pageFactory, stateManager) { return new _wizardPageSectionIterator_1.WizardPageSectionIterator(pageFactory, stateManager, function (pageId) { return _this._resetPageById(pageId); }); }; }\n        this.events.call('beforeInitialize', { wizard: this, state: state });\n        this.stateManager = new stateManager_1.StateManager(state, this.pageFactory);\n        this.iterator = createIterator(this.pageFactory, this.stateManager);\n        this.sections = [];\n        Object.keys(this.pageFactory.metadata).forEach(function (key) {\n            _this.sections.push(new _wizardPageSectionIterator_1.WizardPageSection(key, _this.pageFactory.metadata[key]));\n        });\n        this.sections = this.sections.sort(function (a, b) { return a.metadata.position - b.metadata.position; });\n        this.events.call('afterInitialize', { wizard: this });\n    };\n    WizardPageProcessor.prototype._canNext = function (currentPage) {\n        var pageMetadata = !this.isLoading() && currentPage && currentPage.page && this.pageFactory.getMetadata(currentPage.pageId);\n        return pageMetadata && pageMetadata.canNext(currentPage.page);\n    };\n    WizardPageProcessor.prototype._canFinish = function (currentPage) {\n        return !this.isLoading() && currentPage && this.pageFactory.getMetadata(currentPage.pageId).canFinish(currentPage.page);\n    };\n    WizardPageProcessor.prototype._initPage = function (page, force, stateChanged) {\n        var _this = this;\n        if (force === void 0) { force = false; }\n        if (stateChanged === void 0) { stateChanged = false; }\n        this._createNextAction(page.page);\n        if (page.onChange) {\n            page.onChange(function () {\n                _this._changeTimeout && clearTimeout(_this._changeTimeout);\n                _this._changeTimeout = setTimeout(function () {\n                    _this._nextAction(page);\n                }, 100);\n            });\n        }\n        else\n            throw Error('Page with id ' + page.pageId + ' cannot be used in AutoNavigation, because it does not have method OnChange');\n        return page.initialize(this.stateManager.getPageState(page.pageId), force, stateChanged).always(function () { return _this._loadingState(false); });\n    };\n    WizardPageProcessor.prototype.getPageById = function (pageId) {\n        return this.sections.filter(function (x) { return x.pageId === pageId; })[0];\n    };\n    WizardPageProcessor.prototype.start = function () {\n        var _this = this;\n        this.events.call('beforeStart', { wizard: this });\n        this._loadingState(true);\n        var page = this.iterator.getStartPage();\n        this.events.call('beforePageInitialize', _utils_1._createBeforeInitializePageEventArgs(page, this));\n        this._initPage(page).done(function () {\n            var pageSection = _this.getPageById(page.pageId);\n            if (pageSection) {\n                pageSection.setPage(page);\n                _this.events.call('afterPageInitialize', _utils_1._createPageEventArgs(page, _this));\n                _this._nextAction(page);\n            }\n            else {\n                throw Error('Page Section with id ' + page.pageId + ' is not found.');\n            }\n        });\n    };\n    WizardPageProcessor.prototype.finishAction = function () {\n        var _this = this;\n        var deferred = $.Deferred();\n        var resolved = false;\n        for (var i = this.sections.length - 1; i >= 0; i--) {\n            if (this.sections[i].page()) {\n                this.sections[i].page().commit().done(function (result) {\n                    if (_this.sections[i].page().isChanged) {\n                        _this.events.call('beforeFinish', { wizardModel: _this, state: _this.stateManager.getCurrentState() });\n                        _this.stateManager.setPageState(_this.sections[i].page().pageId, result);\n                        _this.events.call('afterFinish', { wizardResult: _this, state: _this.stateManager.getCurrentState() });\n                    }\n                }).always(function () { return deferred.resolve(); });\n                resolved = true;\n                break;\n            }\n        }\n        if (!resolved)\n            deferred.resolve();\n        return deferred.promise();\n    };\n    WizardPageProcessor.prototype._nextAction = function (currentPage, parentIsChanged) {\n        var _this = this;\n        if (parentIsChanged === void 0) { parentIsChanged = false; }\n        if (!this._canNext(currentPage) && !this._canFinish(currentPage)) {\n            currentPage.resetCommitedState();\n            return this.iterator.resetNextPages(currentPage.pageId);\n        }\n        this._loadingState(true);\n        currentPage.commit().done(function (result) {\n            if (currentPage.isChanged || parentIsChanged || currentPage.page && currentPage.page.changeAlways) {\n                _this.stateManager.setPageState(currentPage.pageId, result);\n                _this.iterator.getNextPage(currentPage.pageId).done(function (pages) {\n                    if (pages && pages.length > 0) {\n                        pages.forEach(function (page) {\n                            var containedPage = _this.getPageById(page.pageId);\n                            var page = containedPage && containedPage.page() || page;\n                            _this.events.call('beforePageInitialize', _utils_1._createBeforeInitializePageEventArgs(page, _this));\n                            _this._initPage(page, !!containedPage.page(), currentPage.isChanged || parentIsChanged).done(function () {\n                                _this.getPageById(page.pageId).setPage(page);\n                                _this.events.call('afterPageInitialize', _utils_1._createPageEventArgs(page, _this));\n                                _this._nextAction(page, currentPage.isChanged);\n                            });\n                        });\n                    }\n                    else\n                        _this._loadingState(false);\n                    currentPage.isChanged = false;\n                }).fail(function () { return _this._loadingState(false); });\n            }\n            else\n                _this._loadingState(false);\n        }).fail(function () { return _this._loadingState(false); });\n    };\n    WizardPageProcessor.__loadingStateFunctionName = '__loadingState';\n    return WizardPageProcessor;\n}(utils_1.Disposable));\nexports.WizardPageProcessor = WizardPageProcessor;\n"]},"metadata":{},"sourceType":"script"}