{"ast":null,"code":"/**\r\n* DevExpress Dashboard (undo-engine-extension.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UndoRedoExtension = void 0;\n\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\n\nvar ko = require(\"knockout\");\n\nvar control_options_1 = require(\"../../common/control-options\");\n\nvar _interfaces_1 = require(\"../../common/internal/_interfaces\");\n\nvar _default_1 = require(\"../../data/localization/_default\");\n\nvar _utils_1 = require(\"../../data/_utils\");\n\nvar disposable_object_1 = require(\"../../model/disposable-object\");\n\nvar _knockout_utils_1 = require(\"../../model/internal/_knockout-utils\");\n\nvar _obsolete_helper_1 = require(\"../../model/internal/_obsolete-helper\");\n\nvar _undo_engine_helper_1 = require(\"../../model/internal/_undo-engine-helper\");\n\nvar viewer_parts_1 = require(\"../../viewer-parts\");\n\nvar _toolbar_extension_1 = require(\"../toolbar-extension/_toolbar-extension\");\n\nvar toolbox_items_1 = require(\"../toolbox-extension/toolbox-items\");\n\nvar name = 'undo-redo';\nvar nameAlias = 'undoRedo';\n\nvar UndoRedoExtension = function (_super) {\n  __extends(UndoRedoExtension, _super);\n\n  function UndoRedoExtension(dashboardControl) {\n    var _this = _super.call(this) || this;\n\n    _this.dashboardControl = dashboardControl;\n    _this.name = name;\n    _this._undoEngine = ko.observable();\n    _this._predefinedToolbarItems = [];\n    _this._defaultToolbarItems = [];\n    _this.isChanged = ko.computed({\n      read: function () {\n        return !!(_this._undoEngine() && _this._undoEngine().isDirty());\n      },\n      write: function (value) {\n        return _this._undoEngine() && _this._undoEngine().isDirty(value);\n      }\n    });\n\n    _obsolete_helper_1.defineObsoleteProperty({\n      target: _this,\n      memberName: 'undoEngine',\n      oldMemberDisplayName: 'UndoRedoExtension.undoEngine',\n      warmMessage: 'The undoEngine property is obsolete.',\n      action: function () {\n        return _this._undoEngine;\n      }\n    });\n\n    return _this;\n  }\n\n  UndoRedoExtension.prototype.reset = function () {\n    if (this._undoEngine()) {\n      this._undoEngine().reset();\n    }\n  };\n\n  UndoRedoExtension.prototype.processKeyEvent = function (keyEventType, eventArgs) {\n    if (keyEventType === 'keyup' && eventArgs.ctrlKey) {\n      if (eventArgs.keyCode === _interfaces_1.KeyCodes.Z && this._undoEngine().undoEnabled()) {\n        this._undoEngine().undo();\n\n        return true;\n      } else if (eventArgs.keyCode === _interfaces_1.KeyCodes.Y && this._undoEngine().redoEnabled()) {\n        this._undoEngine().redo();\n\n        return true;\n      }\n    } else if (keyEventType === 'keydown' && eventArgs.ctrlKey && [_interfaces_1.KeyCodes.Z, _interfaces_1.KeyCodes.Y].indexOf(eventArgs.keyCode) !== -1) {\n      eventArgs.preventDefault();\n      return true;\n    }\n\n    return false;\n  };\n\n  UndoRedoExtension.prototype.start = function () {\n    var _this = this;\n\n    this.toDispose(this.dashboardControl.dashboard.subscribe(function (prevDashboard) {\n      _this.reset();\n    }, null, 'beforeChange'));\n    this.toDispose(this.dashboardControl.dashboard.subscribe(function (newDashboard) {\n      var undoEngine = new DashboardUndoEngine(newDashboard, null, 'getInfo');\n      _undo_engine_helper_1.UndoEngineContainer.undoEngine = undoEngine;\n\n      _this._undoEngine(undoEngine);\n    }));\n    this._controlOptionChangedHandler = this._onControlOptionChanged.bind(this);\n    this.dashboardControl.on('optionChanged', this._controlOptionChangedHandler);\n\n    this._setShowConfirmationDialog(this.dashboardControl.showConfirmationOnBrowserClosing);\n\n    var undoButton = this._createToolbarItem('undoButton', function () {\n      return _this.undo();\n    }, 'dx-dashboard-undo', _default_1.getLocalizationById('DashboardStringId.UndoText'), ko.pureComputed(function () {\n      return !_this.undoEnabled();\n    }));\n\n    var redoButton = this._createToolbarItem('redoButton', function () {\n      return _this.redo();\n    }, 'dx-dashboard-redo', _default_1.getLocalizationById('DashboardStringId.RedoText'), ko.pureComputed(function () {\n      return !_this.redoEnabled();\n    }));\n\n    var separator = __assign({\n      name: 'undoRedoSeparator',\n      location: 'before'\n    }, _toolbar_extension_1.createToolbarSeparator());\n\n    this._predefinedToolbarItems = [undoButton, redoButton, separator];\n\n    if (viewer_parts_1.LegacySettings.showUndoRedoButtonsInToolbox) {\n      var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n\n      if (!!toolboxExtension) {\n        var undoItem = new toolbox_items_1.DashboardToolbarItem('undo', function () {\n          return _this.undo();\n        }, 'dx-dashboard-undo', 'DashboardStringId.UndoText');\n        undoItem.disabled = ko.pureComputed(function () {\n          return !_this.undoEnabled();\n        });\n        var redoItem = new toolbox_items_1.DashboardToolbarItem('redo', function () {\n          return _this.redo();\n        }, 'dx-dashboard-redo', 'DashboardStringId.RedoText');\n        redoItem.disabled = ko.pureComputed(function () {\n          return !_this.redoEnabled();\n        });\n        this._toolboxToolbarGroup = new toolbox_items_1.DashboardToolbarGroup('undo-redo', 'Undo/Redo', 50, undoItem, redoItem);\n        toolboxExtension.toolbarGroups.push(this._toolboxToolbarGroup);\n      }\n    } else {\n      this._defaultToolbarItems = this._predefinedToolbarItems.map(function (item, index) {\n        return {\n          name: item.name,\n          index: UndoRedoExtension._toolbarItemsIndex + index\n        };\n      });\n    }\n\n    this._addToolbarItems(this.dashboardControl.findExtension('designerToolbar'));\n  };\n\n  UndoRedoExtension.prototype._createToolbarItem = function (name, action, icon, hint, disabled) {\n    var subscription;\n    return {\n      name: name,\n      location: 'before',\n      widget: 'dxButton',\n      cssClass: \"dx-dashboard-undo-redo-button \" + icon,\n      options: {\n        hint: hint,\n        stylingMode: 'text',\n        onClick: action,\n        focusStateEnabled: false,\n        activeStateEnabled: false,\n        disabled: disabled(),\n        template: function (args) {\n          return _utils_1.createSvgIconElement(icon);\n        },\n        onInitialized: function (args) {\n          subscription = _knockout_utils_1.subscribeAndPerform(disabled, function () {\n            args.component && args.component.option('disabled', disabled());\n          });\n        },\n        onDisposed: function () {\n          subscription.dispose();\n        }\n      }\n    };\n  };\n\n  UndoRedoExtension.prototype._addToolbarItems = function (toolbar) {\n    if (toolbar) {\n      toolbar._unregisterDefaultItems(this._defaultToolbarItems);\n\n      toolbar._unregisterPredefinedItems(this._predefinedToolbarItems);\n\n      toolbar._registerDefaultItems(this._defaultToolbarItems);\n\n      toolbar._registerPredefinedItems(this._predefinedToolbarItems);\n\n      toolbar._update();\n    }\n  };\n\n  UndoRedoExtension.prototype._removeToolbarItems = function (toolbar) {\n    if (toolbar) {\n      toolbar._unregisterDefaultItems(this._defaultToolbarItems);\n\n      toolbar._unregisterPredefinedItems(this._predefinedToolbarItems);\n\n      toolbar._update();\n    }\n  };\n\n  UndoRedoExtension.prototype.undo = function () {\n    this._undoEngine() && this._undoEngine().undo();\n  };\n\n  UndoRedoExtension.prototype.redo = function () {\n    this._undoEngine() && this._undoEngine().redo();\n  };\n\n  UndoRedoExtension.prototype.undoEnabled = function () {\n    return !!(this._undoEngine() && this._undoEngine().undoEnabled());\n  };\n\n  UndoRedoExtension.prototype.redoEnabled = function () {\n    return !!(this._undoEngine() && this._undoEngine().redoEnabled());\n  };\n\n  UndoRedoExtension.prototype.stop = function () {\n    this._removeToolbarItems(this.dashboardControl.findExtension('designerToolbar'));\n\n    var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n\n    if (toolboxExtension && this._toolboxToolbarGroup) {\n      toolboxExtension.toolbarGroups.remove(this._toolboxToolbarGroup);\n    }\n\n    this.reset();\n    if (this._controlOptionChangedHandler) this.dashboardControl.off('optionChanged', this._controlOptionChangedHandler);\n\n    this._setShowConfirmationDialog(false);\n  };\n\n  UndoRedoExtension.prototype._onControlOptionChanged = function (args) {\n    switch (args.name) {\n      case 'showConfirmationOnBrowserClosing':\n        this._setShowConfirmationDialog(args.value);\n\n        break;\n    }\n  };\n\n  UndoRedoExtension.prototype._setShowConfirmationDialog = function (value) {\n    if (value) {\n      this._beforeWindowUnloadHandler = this._onBeforeWindowUnload.bind(this);\n      window.onbeforeunload = this._beforeWindowUnloadHandler;\n    } else {\n      if (this._beforeWindowUnloadHandler) window.onbeforeunload = null;\n      this._beforeWindowUnloadHandler = null;\n    }\n  };\n\n  UndoRedoExtension.prototype._onBeforeWindowUnload = function (e) {\n    if (this.dashboardControl.isDesignMode() && this.isChanged()) {\n      return _default_1.getLocalizationById('DashboardWebStringId.LayoutHasBeenChangedDialogMessage') + ' ' + _default_1.getLocalizationById('DashboardWebStringId.SaveConfirmationDialogMessage');\n    }\n  };\n\n  UndoRedoExtension._toolbarItemsIndex = 0;\n  return UndoRedoExtension;\n}(disposable_object_1.DisposableObject);\n\nexports.UndoRedoExtension = UndoRedoExtension;\n\nvar DashboardUndoEngine = function (_super) {\n  __extends(DashboardUndoEngine, _super);\n\n  function DashboardUndoEngine(target, ignoredProperties, getInfoMethodName) {\n    return _super.call(this, target, ignoredProperties, getInfoMethodName) || this;\n  }\n\n  DashboardUndoEngine.prototype.validatePropertyName = function (target, propertyName) {\n    return propertyName;\n  };\n\n  return DashboardUndoEngine;\n}(analytics_utils_1.UndoEngine);\n\ncontrol_options_1.designerExtensions[name] = function (dashboardControl, options) {\n  return new UndoRedoExtension(dashboardControl);\n};\n\ncontrol_options_1.extensionNameMap[name] = nameAlias;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/extensions/undo-engine-extension.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","defineProperty","exports","value","UndoRedoExtension","analytics_utils_1","require","ko","control_options_1","_interfaces_1","_default_1","_utils_1","disposable_object_1","_knockout_utils_1","_obsolete_helper_1","_undo_engine_helper_1","viewer_parts_1","_toolbar_extension_1","toolbox_items_1","name","nameAlias","_super","dashboardControl","_this","_undoEngine","observable","_predefinedToolbarItems","_defaultToolbarItems","isChanged","computed","read","isDirty","write","defineObsoleteProperty","target","memberName","oldMemberDisplayName","warmMessage","action","reset","processKeyEvent","keyEventType","eventArgs","ctrlKey","keyCode","KeyCodes","Z","undoEnabled","undo","Y","redoEnabled","redo","indexOf","preventDefault","start","toDispose","dashboard","subscribe","prevDashboard","newDashboard","undoEngine","DashboardUndoEngine","UndoEngineContainer","_controlOptionChangedHandler","_onControlOptionChanged","bind","on","_setShowConfirmationDialog","showConfirmationOnBrowserClosing","undoButton","_createToolbarItem","getLocalizationById","pureComputed","redoButton","separator","location","createToolbarSeparator","LegacySettings","showUndoRedoButtonsInToolbox","toolboxExtension","findExtension","undoItem","DashboardToolbarItem","disabled","redoItem","_toolboxToolbarGroup","DashboardToolbarGroup","toolbarGroups","push","map","item","index","_toolbarItemsIndex","_addToolbarItems","icon","hint","subscription","widget","cssClass","options","stylingMode","onClick","focusStateEnabled","activeStateEnabled","template","args","createSvgIconElement","onInitialized","subscribeAndPerform","component","option","onDisposed","dispose","toolbar","_unregisterDefaultItems","_unregisterPredefinedItems","_registerDefaultItems","_registerPredefinedItems","_update","_removeToolbarItems","stop","remove","off","_beforeWindowUnloadHandler","_onBeforeWindowUnload","window","onbeforeunload","e","isDesignMode","DisposableObject","ignoredProperties","getInfoMethodName","validatePropertyName","propertyName","UndoEngine","designerExtensions","extensionNameMap"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (undo-engine-extension.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UndoRedoExtension = void 0;\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\nvar ko = require(\"knockout\");\nvar control_options_1 = require(\"../../common/control-options\");\nvar _interfaces_1 = require(\"../../common/internal/_interfaces\");\nvar _default_1 = require(\"../../data/localization/_default\");\nvar _utils_1 = require(\"../../data/_utils\");\nvar disposable_object_1 = require(\"../../model/disposable-object\");\nvar _knockout_utils_1 = require(\"../../model/internal/_knockout-utils\");\nvar _obsolete_helper_1 = require(\"../../model/internal/_obsolete-helper\");\nvar _undo_engine_helper_1 = require(\"../../model/internal/_undo-engine-helper\");\nvar viewer_parts_1 = require(\"../../viewer-parts\");\nvar _toolbar_extension_1 = require(\"../toolbar-extension/_toolbar-extension\");\nvar toolbox_items_1 = require(\"../toolbox-extension/toolbox-items\");\nvar name = 'undo-redo';\nvar nameAlias = 'undoRedo';\nvar UndoRedoExtension = (function (_super) {\n    __extends(UndoRedoExtension, _super);\n    function UndoRedoExtension(dashboardControl) {\n        var _this = _super.call(this) || this;\n        _this.dashboardControl = dashboardControl;\n        _this.name = name;\n        _this._undoEngine = ko.observable();\n        _this._predefinedToolbarItems = [];\n        _this._defaultToolbarItems = [];\n        _this.isChanged = ko.computed({\n            read: function () { return !!(_this._undoEngine() && _this._undoEngine().isDirty()); },\n            write: function (value) { return _this._undoEngine() && _this._undoEngine().isDirty(value); }\n        });\n        _obsolete_helper_1.defineObsoleteProperty({\n            target: _this,\n            memberName: 'undoEngine',\n            oldMemberDisplayName: 'UndoRedoExtension.undoEngine',\n            warmMessage: 'The undoEngine property is obsolete.',\n            action: function () {\n                return _this._undoEngine;\n            }\n        });\n        return _this;\n    }\n    UndoRedoExtension.prototype.reset = function () {\n        if (this._undoEngine()) {\n            this._undoEngine().reset();\n        }\n    };\n    UndoRedoExtension.prototype.processKeyEvent = function (keyEventType, eventArgs) {\n        if (keyEventType === 'keyup' && eventArgs.ctrlKey) {\n            if (eventArgs.keyCode === _interfaces_1.KeyCodes.Z && this._undoEngine().undoEnabled()) {\n                this._undoEngine().undo();\n                return true;\n            }\n            else if (eventArgs.keyCode === _interfaces_1.KeyCodes.Y && this._undoEngine().redoEnabled()) {\n                this._undoEngine().redo();\n                return true;\n            }\n        }\n        else if (keyEventType === 'keydown' && eventArgs.ctrlKey && [_interfaces_1.KeyCodes.Z, _interfaces_1.KeyCodes.Y].indexOf(eventArgs.keyCode) !== -1) {\n            eventArgs.preventDefault();\n            return true;\n        }\n        return false;\n    };\n    UndoRedoExtension.prototype.start = function () {\n        var _this = this;\n        this.toDispose(this.dashboardControl.dashboard.subscribe(function (prevDashboard) {\n            _this.reset();\n        }, null, 'beforeChange'));\n        this.toDispose(this.dashboardControl.dashboard.subscribe(function (newDashboard) {\n            var undoEngine = new DashboardUndoEngine(newDashboard, null, 'getInfo');\n            _undo_engine_helper_1.UndoEngineContainer.undoEngine = undoEngine;\n            _this._undoEngine(undoEngine);\n        }));\n        this._controlOptionChangedHandler = this._onControlOptionChanged.bind(this);\n        this.dashboardControl.on('optionChanged', this._controlOptionChangedHandler);\n        this._setShowConfirmationDialog(this.dashboardControl.showConfirmationOnBrowserClosing);\n        var undoButton = this._createToolbarItem('undoButton', function () { return _this.undo(); }, 'dx-dashboard-undo', _default_1.getLocalizationById('DashboardStringId.UndoText'), ko.pureComputed(function () { return !_this.undoEnabled(); }));\n        var redoButton = this._createToolbarItem('redoButton', function () { return _this.redo(); }, 'dx-dashboard-redo', _default_1.getLocalizationById('DashboardStringId.RedoText'), ko.pureComputed(function () { return !_this.redoEnabled(); }));\n        var separator = __assign({ name: 'undoRedoSeparator', location: 'before' }, _toolbar_extension_1.createToolbarSeparator());\n        this._predefinedToolbarItems = [undoButton, redoButton, separator];\n        if (viewer_parts_1.LegacySettings.showUndoRedoButtonsInToolbox) {\n            var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n            if (!!toolboxExtension) {\n                var undoItem = new toolbox_items_1.DashboardToolbarItem('undo', function () { return _this.undo(); }, 'dx-dashboard-undo', 'DashboardStringId.UndoText');\n                undoItem.disabled = ko.pureComputed(function () { return !_this.undoEnabled(); });\n                var redoItem = new toolbox_items_1.DashboardToolbarItem('redo', function () { return _this.redo(); }, 'dx-dashboard-redo', 'DashboardStringId.RedoText');\n                redoItem.disabled = ko.pureComputed(function () { return !_this.redoEnabled(); });\n                this._toolboxToolbarGroup = new toolbox_items_1.DashboardToolbarGroup('undo-redo', 'Undo/Redo', 50, undoItem, redoItem);\n                toolboxExtension.toolbarGroups.push(this._toolboxToolbarGroup);\n            }\n        }\n        else {\n            this._defaultToolbarItems = this._predefinedToolbarItems.map(function (item, index) { return ({ name: item.name, index: UndoRedoExtension._toolbarItemsIndex + index }); });\n        }\n        this._addToolbarItems(this.dashboardControl.findExtension('designerToolbar'));\n    };\n    UndoRedoExtension.prototype._createToolbarItem = function (name, action, icon, hint, disabled) {\n        var subscription;\n        return {\n            name: name,\n            location: 'before',\n            widget: 'dxButton',\n            cssClass: \"dx-dashboard-undo-redo-button \" + icon,\n            options: {\n                hint: hint,\n                stylingMode: 'text',\n                onClick: action,\n                focusStateEnabled: false,\n                activeStateEnabled: false,\n                disabled: disabled(),\n                template: function (args) { return _utils_1.createSvgIconElement(icon); },\n                onInitialized: function (args) {\n                    subscription = _knockout_utils_1.subscribeAndPerform(disabled, function () {\n                        args.component && args.component.option('disabled', disabled());\n                    });\n                },\n                onDisposed: function () {\n                    subscription.dispose();\n                }\n            }\n        };\n    };\n    UndoRedoExtension.prototype._addToolbarItems = function (toolbar) {\n        if (toolbar) {\n            toolbar._unregisterDefaultItems(this._defaultToolbarItems);\n            toolbar._unregisterPredefinedItems(this._predefinedToolbarItems);\n            toolbar._registerDefaultItems(this._defaultToolbarItems);\n            toolbar._registerPredefinedItems(this._predefinedToolbarItems);\n            toolbar._update();\n        }\n    };\n    UndoRedoExtension.prototype._removeToolbarItems = function (toolbar) {\n        if (toolbar) {\n            toolbar._unregisterDefaultItems(this._defaultToolbarItems);\n            toolbar._unregisterPredefinedItems(this._predefinedToolbarItems);\n            toolbar._update();\n        }\n    };\n    UndoRedoExtension.prototype.undo = function () {\n        this._undoEngine() && this._undoEngine().undo();\n    };\n    UndoRedoExtension.prototype.redo = function () {\n        this._undoEngine() && this._undoEngine().redo();\n    };\n    UndoRedoExtension.prototype.undoEnabled = function () {\n        return !!(this._undoEngine() && this._undoEngine().undoEnabled());\n    };\n    UndoRedoExtension.prototype.redoEnabled = function () {\n        return !!(this._undoEngine() && this._undoEngine().redoEnabled());\n    };\n    UndoRedoExtension.prototype.stop = function () {\n        this._removeToolbarItems(this.dashboardControl.findExtension('designerToolbar'));\n        var toolboxExtension = this.dashboardControl.findExtension('toolbox');\n        if (toolboxExtension && this._toolboxToolbarGroup) {\n            toolboxExtension.toolbarGroups.remove(this._toolboxToolbarGroup);\n        }\n        this.reset();\n        if (this._controlOptionChangedHandler)\n            this.dashboardControl.off('optionChanged', this._controlOptionChangedHandler);\n        this._setShowConfirmationDialog(false);\n    };\n    UndoRedoExtension.prototype._onControlOptionChanged = function (args) {\n        switch (args.name) {\n            case 'showConfirmationOnBrowserClosing':\n                this._setShowConfirmationDialog(args.value);\n                break;\n        }\n    };\n    UndoRedoExtension.prototype._setShowConfirmationDialog = function (value) {\n        if (value) {\n            this._beforeWindowUnloadHandler = this._onBeforeWindowUnload.bind(this);\n            window.onbeforeunload = this._beforeWindowUnloadHandler;\n        }\n        else {\n            if (this._beforeWindowUnloadHandler)\n                window.onbeforeunload = null;\n            this._beforeWindowUnloadHandler = null;\n        }\n    };\n    UndoRedoExtension.prototype._onBeforeWindowUnload = function (e) {\n        if (this.dashboardControl.isDesignMode() && this.isChanged()) {\n            return _default_1.getLocalizationById('DashboardWebStringId.LayoutHasBeenChangedDialogMessage') + ' ' + _default_1.getLocalizationById('DashboardWebStringId.SaveConfirmationDialogMessage');\n        }\n    };\n    UndoRedoExtension._toolbarItemsIndex = 0;\n    return UndoRedoExtension;\n}(disposable_object_1.DisposableObject));\nexports.UndoRedoExtension = UndoRedoExtension;\nvar DashboardUndoEngine = (function (_super) {\n    __extends(DashboardUndoEngine, _super);\n    function DashboardUndoEngine(target, ignoredProperties, getInfoMethodName) {\n        return _super.call(this, target, ignoredProperties, getInfoMethodName) || this;\n    }\n    DashboardUndoEngine.prototype.validatePropertyName = function (target, propertyName) {\n        return propertyName;\n    };\n    return DashboardUndoEngine;\n}(analytics_utils_1.UndoEngine));\ncontrol_options_1.designerExtensions[name] = function (dashboardControl, options) { return new UndoRedoExtension(dashboardControl); };\ncontrol_options_1.extensionNameMap[name] = nameAlias;\n"]},"metadata":{},"sourceType":"script"}