{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_shared-format-rule-properties-composer.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCommonCellsFormatRuleProperties = exports.addConditionEditor = exports.createDataTypeObservable = exports.createDeltaDataTypeObservable = exports.FormatRulePropertiesComposer = void 0;\n\nvar ko = require(\"knockout\");\n\nvar common_1 = require(\"../../../../common\");\n\nvar _default_1 = require(\"../../../../data/localization/_default\");\n\nvar model_1 = require(\"../../../../model\");\n\nvar dimension_1 = require(\"../../../../model/data-item/dimension\");\n\nvar measure_1 = require(\"../../../../model/data-item/measure\");\n\nvar enums_1 = require(\"../../../../model/enums\");\n\nvar format_condition_average_1 = require(\"../../../../model/format-rules/conditions/format-condition-average\");\n\nvar format_condition_expression_1 = require(\"../../../../model/format-rules/conditions/format-condition-expression\");\n\nvar format_condition_top_bottom_1 = require(\"../../../../model/format-rules/conditions/format-condition-top-bottom\");\n\nvar _format_condition_bar_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-bar\");\n\nvar _format_condition_bar_options_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-bar-options\");\n\nvar _format_condition_date_occuring_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-date-occuring\");\n\nvar _format_condition_expression_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-expression\");\n\nvar _format_condition_min_max_base_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-min-max-base\");\n\nvar _format_condition_top_bottom_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-top-bottom\");\n\nvar _format_condition_value_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-value\");\n\nvar _format_condition_range_base_1 = require(\"../../../../model/format-rules/conditions/range/metadata/_format-condition-range-base\");\n\nvar _format_condition_range_gradient_1 = require(\"../../../../model/format-rules/conditions/range/metadata/_format-condition-range-gradient\");\n\nvar _cells_item_format_rule_1 = require(\"../../../../model/format-rules/metadata/_cells-item-format-rule\");\n\nvar _dashboard_item_format_rule_1 = require(\"../../../../model/format-rules/metadata/_dashboard-item-format-rule\");\n\nvar _format_rules_common_1 = require(\"../../../../model/format-rules/metadata/_format-rules-common\");\n\nvar _helper_classes_1 = require(\"../../../../model/internal/_helper-classes\");\n\nvar _knockout_utils_1 = require(\"../../../../model/internal/_knockout-utils\");\n\nvar _parameters_helper_1 = require(\"../../../../model/parameters/_parameters-helper\");\n\nvar _filter_utils_1 = require(\"../../../filtering/_filter-utils\");\n\nvar _item_filter_display_name_provider_1 = require(\"../../../filtering/_item-filter-display-name-provider\");\n\nvar _item_filter_items_provider_1 = require(\"../../../filtering/_item-filter-items-provider\");\n\nvar _form_adapter_editors_1 = require(\"../../../form-adapter/_form-adapter-editors\");\n\nvar _object_properties_wrapper_1 = require(\"../../../form-adapter/_object-properties-wrapper\");\n\nvar _accordion_tab_1 = require(\"../../../properties-controller/_accordion-tab\");\n\nvar FormatRulePropertiesComposer = function () {\n  function FormatRulePropertiesComposer(_options) {\n    this._options = _options;\n  }\n\n  FormatRulePropertiesComposer.prototype.composeTabs = function (model, args) {\n    var commonTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.FormatRuleCommon, 'DashboardWebStringId.AccordionTab.Common');\n    var conditionTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.FormatRuleCondition, 'DashboardWebStringId.ConditionalFormatting.Condition');\n    var miscTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.FormatRuleMisc, 'DashboardWebStringId.ConditionalFormatting.Miscellaneous');\n    var additionalTabs = [];\n\n    this._fillCommonFormatRuleCommonWrapper(commonTab, model, args.dashboardItem, args.dataSourceBrowser, args.requestRecalculation, args.specificTypeChanged);\n\n    if (ko.unwrap(model && model.condition)) {\n      this._fillConditionWrapper(conditionTab, model, args.dashboardItem, args.dataSourceBrowser);\n\n      additionalTabs = this._options.getAdditionalTabs && this._options.getAdditionalTabs(model, args.dashboardItem, args.dataSourceBrowser);\n\n      this._fillMiscWrapper(miscTab, model, args.dashboardItem, args.dataSourceBrowser);\n    }\n\n    return __spreadArray(__spreadArray([commonTab, conditionTab], additionalTabs || []), [miscTab]).filter(function (tab) {\n      return !!tab;\n    });\n  };\n\n  FormatRulePropertiesComposer.prototype._fillCommonFormatRuleCommonWrapper = function (tab, formatRule, dashboardItem, dataSourceBrowser, requestRecalculation, specificTypeChanged) {\n    var propertiesInfo = this._options.getCommonFormatRuleProperties(formatRule, dashboardItem, dataSourceBrowser, requestRecalculation);\n\n    var disabledRules = {};\n\n    var dataType = this._options.createDataTypeObservable(formatRule, dashboardItem, dataSourceBrowser);\n\n    disabledRules[_cells_item_format_rule_1.formatRuleDataItem.propertyName] = function () {\n      return !!ko.unwrap(formatRule.condition);\n    };\n\n    disabledRules['typeChooser'] = function () {\n      return !!ko.unwrap(formatRule.condition);\n    };\n\n    var wrapper = new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n      model: formatRule,\n      visibilityFilterRules: propertiesInfo.visibilityFilterRules,\n      properties: propertiesInfo.properties,\n      disabledFilterRules: __assign(__assign({}, disabledRules), propertiesInfo.disabledFilterRules)\n    });\n    addConditionEditor(wrapper, dataType, formatRule, dashboardItem, requestRecalculation, specificTypeChanged, this._options.conditionTypeFilter);\n    tab.tabModel(wrapper);\n  };\n\n  FormatRulePropertiesComposer.prototype._fillConditionWrapper = function (tab, model, dashboardItem, dataSourceBrowser) {\n    var p = [];\n    var visibilityRules = {};\n\n    visibilityRules[_format_condition_range_base_1.rangeValueType.propertyName] = function () {\n      return model.condition() && !model.condition().dateTimeGroupInterval();\n    };\n\n    var isChartItem = dashboardItem instanceof model_1.ChartItem || dashboardItem instanceof model_1.ScatterChartItem;\n    var simpleStylesAppearance = isChartItem ? 'RichColors' : 'Appearance';\n    var barStylesAppearance = 'AllColors';\n    var gradientStylesAppearance = 'GradientColors';\n    var simpleStyleSettingsEditorOptions = {\n      allowChangeViewMode: !isChartItem,\n      appearanceMode: simpleStylesAppearance,\n      isEmptyAllowed: false,\n      enableCustomStyles: isChartItem\n    };\n    var barStyleSettingsEditorOptions = {\n      allowChangeViewMode: false,\n      appearanceMode: barStylesAppearance,\n      isEmptyAllowed: false,\n      enableCustomStyles: true\n    };\n\n    switch (model.condition() && model.condition().constructor) {\n      case model_1.FormatConditionValue:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [{\n            container: _format_condition_value_1.formatConditionValue1,\n            properties: [__assign({\n              simpleFormAdapterItem: _parameters_helper_1.ParameterHelper.getEditorType(model.condition()[_format_condition_value_1.formatConditionValue1.propertyName].type()),\n              displayName: 'DashboardStringId.ValueCaption',\n              replacementPropertyName: 'value1_value'\n            }, _format_rules_common_1.complexValueValue)]\n          }, {\n            container: _format_condition_value_1.formatConditionValue2,\n            properties: [__assign({\n              simpleFormAdapterItem: _parameters_helper_1.ParameterHelper.getEditorType(model.condition()[_format_condition_value_1.formatConditionValue1.propertyName].type()),\n              displayName: 'DashboardStringId.Value2Caption',\n              replacementPropertyName: 'value2_value'\n            }, _format_rules_common_1.complexValueValue)]\n          }, __assign(__assign({}, _format_rules_common_1.styleSettings), {\n            formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions)\n          }), _format_condition_value_1.conditionInCondition]\n        });\n        visibilityRules['value2_value'] = [_format_condition_value_1.conditionInCondition.propertyName, 'contains', 'Between'];\n\n        visibilityRules[_format_condition_value_1.conditionInCondition.propertyName] = function () {\n          return false;\n        };\n\n        break;\n\n      case format_condition_top_bottom_1.FormatConditionTopBottom:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [__assign(__assign({}, _format_rules_common_1.styleSettings), {\n            formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions)\n          }), _format_condition_top_bottom_1.rank, _format_condition_top_bottom_1._actualRankType]\n        });\n        break;\n\n      case format_condition_average_1.FormatConditionAverage:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [__assign(__assign({}, _format_rules_common_1.styleSettings), {\n            formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions)\n          })]\n        });\n        break;\n\n      case model_1.FormatConditionDateOccurring:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [__assign(__assign({}, _format_rules_common_1.styleSettings), {\n            formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions)\n          }), __assign(__assign({}, _format_condition_date_occuring_1.dateType), {\n            formAdapterItem: _form_adapter_editors_1.flagsEnumTagBoxEditor({\n              values: _format_condition_date_occuring_1.baseDateTypeValues.concat(common_1.LegacySettings.showExtendedDateOccurringList ? _format_condition_date_occuring_1.extendedDateTypeValues : []),\n              enumDeclaration: enums_1.FilterDateType\n            })\n          })]\n        });\n        break;\n\n      case format_condition_expression_1.FormatConditionExpression:\n        var expressionCondition = model.condition();\n        var ruleExpressionEditorParams = {\n          fieldListProvider: ko.observable(new _item_filter_items_provider_1.ItemFilterItemsProvider(dataSourceBrowser, dataSourceBrowser, dataSourceBrowser.parameters, dashboardItem, function (di) {\n            return dashboardItem._conditionFormattingExpressionEditorFilter(di);\n          })),\n          options: _filter_utils_1.createItemFilterOptions(expressionCondition.expression, expressionCondition, dataSourceBrowser, {\n            text: 'Expression',\n            localizationId: 'DashboardStringId.CommandFormatRuleExpression'\n          }),\n          displayNameProvider: new _item_filter_display_name_provider_1.ItemFilterDisplayNameProvider(dashboardItem, dataSourceBrowser)\n        };\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [__assign(__assign({}, _format_condition_expression_1.formatConditionFilter), {\n            formAdapterItem: _form_adapter_editors_1.filterEditor(ruleExpressionEditorParams)\n          }), __assign(__assign({}, _format_rules_common_1.styleSettings), {\n            formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions)\n          })]\n        });\n        break;\n\n      case model_1.FormatConditionBar:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [_format_condition_min_max_base_1.minimumType, _format_condition_min_max_base_1.formatConditionMinimum, _format_condition_min_max_base_1.maximumType, _format_condition_min_max_base_1.formatConditionMaximum, _format_condition_bar_1.barCurrentStyleSettingsType, __assign(__assign({}, _format_condition_bar_1.barCurrentStyleSettings), {\n            formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(barStyleSettingsEditorOptions)\n          }), {\n            container: _format_rules_common_1.barOptions,\n            properties: [_format_condition_bar_options_1.allowNegativeAxis, _format_condition_bar_options_1.drawAxis, _format_condition_bar_options_1.showBarOnly]\n          }]\n        });\n        visibilityRules[_format_condition_min_max_base_1.formatConditionMinimum.propertyName] = [_format_condition_min_max_base_1.minimumType.propertyName, '<>', 'Automatic'];\n        visibilityRules[_format_condition_min_max_base_1.formatConditionMaximum.propertyName] = [_format_condition_min_max_base_1.maximumType.propertyName, '<>', 'Automatic'];\n        break;\n\n      case model_1.FormatConditionColorRangeBar:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [_format_condition_range_base_1.rangeValueType, __assign(__assign({}, _format_condition_range_base_1.rangeSet), {\n            formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({\n              condition: model.condition(),\n              appearanceMode: barStylesAppearance,\n              enableCustomStyles: true\n            })\n          }), {\n            container: _format_rules_common_1.barOptions,\n            properties: [_format_condition_bar_options_1.allowNegativeAxis, _format_condition_bar_options_1.drawAxis, _format_condition_bar_options_1.showBarOnly]\n          }]\n        });\n        break;\n\n      case model_1.FormatConditionGradientRangeBar:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [_format_condition_range_base_1.rangeValueType, _format_condition_range_gradient_1.segmentNumber, __assign(__assign({}, _format_condition_range_base_1.rangeSet), {\n            formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({\n              condition: model.condition(),\n              appearanceMode: gradientStylesAppearance,\n              enableCustomStyles: true\n            })\n          }), {\n            container: _format_rules_common_1.barOptions,\n            properties: [_format_condition_bar_options_1.allowNegativeAxis, _format_condition_bar_options_1.drawAxis, _format_condition_bar_options_1.showBarOnly]\n          }]\n        });\n        break;\n\n      case model_1.FormatConditionRangeGradient:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [_format_condition_range_base_1.rangeValueType, _format_condition_range_gradient_1.segmentNumber, __assign(__assign({}, _format_condition_range_base_1.rangeSet), {\n            formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({\n              condition: model.condition(),\n              appearanceMode: gradientStylesAppearance,\n              enableCustomStyles: true\n            })\n          })]\n        });\n        break;\n\n      case model_1.FormatConditionRangeSet:\n        p.push({\n          container: _dashboard_item_format_rule_1.condition,\n          properties: [_format_condition_range_base_1.rangeValueType, __assign(__assign({}, _format_condition_range_base_1.rangeSet), {\n            formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({\n              condition: model.condition(),\n              appearanceMode: simpleStylesAppearance,\n              enableCustomStyles: isChartItem\n            })\n          })]\n        });\n        break;\n\n      case undefined:\n        break;\n\n      default:\n        throw new Error('Unsupported formatting rule condition');\n    }\n\n    var additionProperties = this._options.getConditionFormatRuleProperties(model, dashboardItem, dataSourceBrowser);\n\n    var wrapper = new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n      model: model,\n      properties: p.concat(additionProperties.properties),\n      visibilityFilterRules: __assign(__assign({}, visibilityRules), additionProperties.visibilityFilterRules),\n      disabledFilterRules: additionProperties.disabledFilterRules,\n      dynamicEditorRules: additionProperties.dynamicEditorRules\n    });\n    tab.tabModel(wrapper);\n  };\n\n  FormatRulePropertiesComposer.prototype._fillMiscWrapper = function (tab, model, dashboardItem, dataSourceBrowser) {\n    var miscProperties = this._options.getMiscFormatRuleProperties(model, dashboardItem, dataSourceBrowser);\n\n    var wrapper = new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n      model: model,\n      properties: __spreadArray([_dashboard_item_format_rule_1.enabled], miscProperties.properties),\n      disabledFilterRules: miscProperties.disabledFilterRules,\n      dynamicEditorRules: miscProperties.dynamicEditorRules,\n      visibilityFilterRules: miscProperties.visibilityFilterRules\n    });\n    tab.tabModel(wrapper);\n  };\n\n  return FormatRulePropertiesComposer;\n}();\n\nexports.FormatRulePropertiesComposer = FormatRulePropertiesComposer;\n\nfunction createDeltaDataTypeObservable(model, dashboardItem, dataSourceBrowser) {\n  var dataType = ko.observable(model.condition() && model.condition().dataType());\n\n  var fillDataTypeForDelta = function () {\n    var fillDataTypes = function (measure) {\n      dataSourceBrowser.findDataField(dashboardItem.dataSource(), dashboardItem.dataMember(), measure.dataMember()).done(function (field) {\n        var summaryType = measure.summaryType();\n\n        if (summaryType === 'Count' || summaryType === 'CountDistinct') {\n          dataType('Integer');\n          model.condition() && model.condition().dataType(dataType());\n        } else if (['Sum', 'Average', 'StdDev', 'StdDevp', 'Var', 'VarP'].indexOf(summaryType) !== -1) {\n          dataType('Decimal');\n          model.condition() && model.condition().dataType(dataType());\n        } else {\n          dataType(field.fieldType());\n          model.condition() && model.condition().dataType(dataType());\n        }\n      });\n    };\n\n    var kpiElement = dashboardItem.cards().filter(function (card) {\n      return card._getDataId() === model.cardId();\n    })[0];\n    var deltaValueType = model.deltaValueType();\n\n    if (deltaValueType === 'ActualValue') {\n      fillDataTypes(kpiElement.actualValue());\n    } else if (deltaValueType === 'TargetValue') {\n      fillDataTypes(kpiElement.targetValue());\n    } else {\n      dataType('Decimal');\n      model.condition() && model.condition().dataType(dataType());\n    }\n  };\n\n  fillDataTypeForDelta();\n  model.cardId.subscribe(function (containerId) {\n    fillDataTypeForDelta();\n  });\n  model.deltaValueType.subscribe(function (deltaValueTypeId) {\n    fillDataTypeForDelta();\n  });\n  return {\n    dataType: dataType,\n    dateTimeGroupInterval: ko.observable()\n  };\n}\n\nexports.createDeltaDataTypeObservable = createDeltaDataTypeObservable;\n\nfunction createDataTypeObservable(formatRule, dashboardItem, dataSourceBrowser) {\n  var dataItemCalculateBy = dashboardItem.dataItems().filter(function (d) {\n    return formatRule.dataItemName() === d.uniqueName();\n  })[0];\n  var dateTimeGroupInterval = ko.observable(dataItemCalculateBy instanceof dimension_1.Dimension ? dataItemCalculateBy.dateTimeGroupInterval() : undefined);\n  var dataType = ko.observable(formatRule.condition() && formatRule.condition().dataType());\n\n  var fillDataType = function (uniqueName) {\n    return dashboardItem.dataItems().filter(function (dataItem) {\n      return uniqueName === dataItem.uniqueName() && !!dataItem.dataMember();\n    }).map(function (dataItem) {\n      return {\n        dataItem: dataItem,\n        fieldPromise: dataSourceBrowser.findDataField(dashboardItem.dataSource(), dashboardItem.dataMember(), dataItem.dataMember())\n      };\n    }).forEach(function (d) {\n      return d.fieldPromise.done(function (field) {\n        var newDataType = field.fieldType();\n\n        if (d.dataItem instanceof dimension_1.Dimension) {\n          newDataType = _item_filter_items_provider_1.getRealDimensionType(d.dataItem, field);\n          dateTimeGroupInterval(field.fieldType() === 'DateTime' ? d.dataItem.dateTimeGroupInterval() : undefined);\n          formatRule.condition() && formatRule.condition().dateTimeGroupInterval(dateTimeGroupInterval());\n        }\n\n        if (d.dataItem instanceof measure_1.Measure) {\n          var summaryType = d.dataItem.summaryType();\n\n          if (summaryType === 'Count' || summaryType === 'CountDistinct') {\n            newDataType = 'Integer';\n          } else if (['Sum', 'Average', 'StdDev', 'StdDevp', 'let', 'letp'].indexOf(summaryType) !== -1) {\n            newDataType = 'Decimal';\n          }\n        }\n\n        dataType(newDataType);\n        formatRule.condition() && formatRule.condition().dataType(dataType());\n      });\n    });\n  };\n\n  if (!dataType() && formatRule.dataItemName()) fillDataType(formatRule.dataItemName());\n  formatRule.dataItemName.subscribe(fillDataType);\n  return {\n    dataType: dataType,\n    dateTimeGroupInterval: dateTimeGroupInterval\n  };\n}\n\nexports.createDataTypeObservable = createDataTypeObservable;\n\nfunction addConditionEditor(wrapper, dataTypeInfo, formatRuleModel, dashboardItem, requestRecalculation, specificTypeChanged, conditionTypeFilter) {\n  var originalConditionType = formatRuleModel._classId;\n  var conditionType = ko.observable(formatRuleModel._classId).extend({\n    notify: 'always'\n  });\n  var specificType = ko.observable(formatRuleModel.condition() && formatRuleModel.condition().getSpecificType());\n  wrapper.addProperty(ko.observable(), {\n    propertyName: 'typeChooser',\n    displayName: 'DashboardWebStringId.ConditionType',\n    formAdapterItem: _form_adapter_editors_1.conditionTypeEditor({\n      dataType: dataTypeInfo.dataType,\n      conditionType: conditionType,\n      specificType: specificType,\n      filters: conditionTypeFilter\n    })\n  });\n  specificType.subscribe(function (newSpecificType) {\n    var condition = formatRuleModel.condition(),\n        newRule = !condition,\n        changedConditionType = originalConditionType !== conditionType(),\n        realConditionType = conditionType().split('_')[0];\n\n    if (newRule || changedConditionType) {\n      formatRuleModel._changeConditionType(realConditionType);\n\n      condition = formatRuleModel.condition();\n      condition.dataType(dataTypeInfo.dataType());\n      condition.dateTimeGroupInterval(dataTypeInfo.dateTimeGroupInterval());\n    }\n\n    condition.setSpecificType(newSpecificType);\n\n    if (newRule) {\n      formatRuleModel.name(_helper_classes_1.NameGenerator.generateName(_default_1.getLocalizationById('DashboardWebStringId.FormatRule') + ' ', dashboardItem.formatRules(), 'name', 1));\n    }\n\n    if (newRule || changedConditionType) {\n      requestRecalculation.fire();\n    }\n\n    specificTypeChanged();\n  });\n}\n\nexports.addConditionEditor = addConditionEditor;\n\nfunction getCommonCellsFormatRuleProperties(formatRule, getDataItems, getApplyToDataItems) {\n  var dataItems = ko.pureComputed(function () {\n    return getDataItems().map(function (m) {\n      return {\n        value: ko.unwrap(m.uniqueName),\n        displayValueId: ko.unwrap(m.displayName)\n      };\n    });\n  });\n  var applyToDataItems = ko.pureComputed(function () {\n    return getApplyToDataItems().map(function (m) {\n      return {\n        value: ko.unwrap(m.uniqueName),\n        displayValueId: ko.unwrap(m.displayName)\n      };\n    });\n  });\n\n  if (!formatRule.dataItemName() && dataItems().length) {\n    formatRule.dataItemName(ko.unwrap(dataItems()[0].value));\n  }\n\n  var externalUpdateCallback = function (formUpdateHandler) {\n    return _knockout_utils_1.safeSubscribe({\n      dataItemName: formatRule.dataItemApplyToName,\n      applyToDataItems: applyToDataItems\n    }, function () {\n      return formUpdateHandler({\n        forceValidate: true\n      });\n    });\n  };\n\n  var getApplyToPlaceHolder = function () {\n    var dataItemApplyToInfo = applyToDataItems().filter(function (item) {\n      return item.value === formatRule.dataItemApplyToName();\n    })[0];\n    return dataItemApplyToInfo && dataItemApplyToInfo.displayValueId;\n  };\n\n  var commonProperties = [];\n  commonProperties.push(__assign(__assign({}, _cells_item_format_rule_1.formatRuleDataItem), {\n    formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({\n      values: dataItems\n    })\n  }));\n  commonProperties.push(__assign(__assign({}, _cells_item_format_rule_1.dataItemApplyTo), {\n    externalUpdateCallback: externalUpdateCallback,\n    formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({\n      values: applyToDataItems,\n      additionalOptions: function () {\n        return {\n          placeholder: getApplyToPlaceHolder()\n        };\n      },\n      comparableEditorOptions: ['placeholder']\n    }),\n    validationRules: [{\n      type: 'custom',\n      message: _default_1.getLocalizationById('DashboardWebStringId.ConditionalFormatting.InvalidApplyToValue'),\n      reevaluate: true,\n      validationCallback: function (e) {\n        var applyToDataItemsNames = applyToDataItems().map(function (di) {\n          return di.value;\n        });\n        return !e.value && applyToDataItemsNames.indexOf(formatRule.dataItemName()) !== -1 || !!e.value && applyToDataItemsNames.indexOf(e.value) !== -1;\n      }\n    }]\n  }));\n  return {\n    properties: commonProperties\n  };\n}\n\nexports.getCommonCellsFormatRuleProperties = getCommonCellsFormatRuleProperties;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/conditional-formatting/items/properties-composers/_shared-format-rule-properties-composer.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","il","j","defineProperty","exports","value","getCommonCellsFormatRuleProperties","addConditionEditor","createDataTypeObservable","createDeltaDataTypeObservable","FormatRulePropertiesComposer","ko","require","common_1","_default_1","model_1","dimension_1","measure_1","enums_1","format_condition_average_1","format_condition_expression_1","format_condition_top_bottom_1","_format_condition_bar_1","_format_condition_bar_options_1","_format_condition_date_occuring_1","_format_condition_expression_1","_format_condition_min_max_base_1","_format_condition_top_bottom_1","_format_condition_value_1","_format_condition_range_base_1","_format_condition_range_gradient_1","_cells_item_format_rule_1","_dashboard_item_format_rule_1","_format_rules_common_1","_helper_classes_1","_knockout_utils_1","_parameters_helper_1","_filter_utils_1","_item_filter_display_name_provider_1","_item_filter_items_provider_1","_form_adapter_editors_1","_object_properties_wrapper_1","_accordion_tab_1","_options","composeTabs","model","args","commonTab","AccordionTab","KnownTabs","FormatRuleCommon","conditionTab","FormatRuleCondition","miscTab","FormatRuleMisc","additionalTabs","_fillCommonFormatRuleCommonWrapper","dashboardItem","dataSourceBrowser","requestRecalculation","specificTypeChanged","unwrap","condition","_fillConditionWrapper","getAdditionalTabs","_fillMiscWrapper","filter","tab","formatRule","propertiesInfo","getCommonFormatRuleProperties","disabledRules","dataType","formatRuleDataItem","propertyName","wrapper","ObjectPropertiesWrapper","visibilityFilterRules","properties","disabledFilterRules","conditionTypeFilter","tabModel","visibilityRules","rangeValueType","dateTimeGroupInterval","isChartItem","ChartItem","ScatterChartItem","simpleStylesAppearance","barStylesAppearance","gradientStylesAppearance","simpleStyleSettingsEditorOptions","allowChangeViewMode","appearanceMode","isEmptyAllowed","enableCustomStyles","barStyleSettingsEditorOptions","constructor","FormatConditionValue","push","container","formatConditionValue1","simpleFormAdapterItem","ParameterHelper","getEditorType","type","displayName","replacementPropertyName","complexValueValue","formatConditionValue2","styleSettings","formAdapterItem","styleSettingsEditor","conditionInCondition","FormatConditionTopBottom","rank","_actualRankType","FormatConditionAverage","FormatConditionDateOccurring","dateType","flagsEnumTagBoxEditor","values","baseDateTypeValues","concat","LegacySettings","showExtendedDateOccurringList","extendedDateTypeValues","enumDeclaration","FilterDateType","FormatConditionExpression","expressionCondition","ruleExpressionEditorParams","fieldListProvider","observable","ItemFilterItemsProvider","parameters","di","_conditionFormattingExpressionEditorFilter","options","createItemFilterOptions","expression","text","localizationId","displayNameProvider","ItemFilterDisplayNameProvider","formatConditionFilter","filterEditor","FormatConditionBar","minimumType","formatConditionMinimum","maximumType","formatConditionMaximum","barCurrentStyleSettingsType","barCurrentStyleSettings","barOptions","allowNegativeAxis","drawAxis","showBarOnly","FormatConditionColorRangeBar","rangeSet","ruleRangesEditor","FormatConditionGradientRangeBar","segmentNumber","FormatConditionRangeGradient","FormatConditionRangeSet","undefined","Error","additionProperties","getConditionFormatRuleProperties","dynamicEditorRules","miscProperties","getMiscFormatRuleProperties","enabled","fillDataTypeForDelta","fillDataTypes","measure","findDataField","dataSource","dataMember","done","field","summaryType","indexOf","fieldType","kpiElement","cards","card","_getDataId","cardId","deltaValueType","actualValue","targetValue","subscribe","containerId","deltaValueTypeId","dataItemCalculateBy","dataItems","d","dataItemName","uniqueName","Dimension","fillDataType","dataItem","map","fieldPromise","forEach","newDataType","getRealDimensionType","Measure","dataTypeInfo","formatRuleModel","originalConditionType","_classId","conditionType","extend","notify","specificType","getSpecificType","addProperty","conditionTypeEditor","filters","newSpecificType","newRule","changedConditionType","realConditionType","split","_changeConditionType","setSpecificType","name","NameGenerator","generateName","getLocalizationById","formatRules","fire","getDataItems","getApplyToDataItems","pureComputed","m","displayValueId","applyToDataItems","externalUpdateCallback","formUpdateHandler","safeSubscribe","dataItemApplyToName","forceValidate","getApplyToPlaceHolder","dataItemApplyToInfo","item","commonProperties","dynamicSelectBoxEditor","dataItemApplyTo","additionalOptions","placeholder","comparableEditorOptions","validationRules","message","reevaluate","validationCallback","e","applyToDataItemsNames"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_shared-format-rule-properties-composer.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCommonCellsFormatRuleProperties = exports.addConditionEditor = exports.createDataTypeObservable = exports.createDeltaDataTypeObservable = exports.FormatRulePropertiesComposer = void 0;\nvar ko = require(\"knockout\");\nvar common_1 = require(\"../../../../common\");\nvar _default_1 = require(\"../../../../data/localization/_default\");\nvar model_1 = require(\"../../../../model\");\nvar dimension_1 = require(\"../../../../model/data-item/dimension\");\nvar measure_1 = require(\"../../../../model/data-item/measure\");\nvar enums_1 = require(\"../../../../model/enums\");\nvar format_condition_average_1 = require(\"../../../../model/format-rules/conditions/format-condition-average\");\nvar format_condition_expression_1 = require(\"../../../../model/format-rules/conditions/format-condition-expression\");\nvar format_condition_top_bottom_1 = require(\"../../../../model/format-rules/conditions/format-condition-top-bottom\");\nvar _format_condition_bar_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-bar\");\nvar _format_condition_bar_options_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-bar-options\");\nvar _format_condition_date_occuring_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-date-occuring\");\nvar _format_condition_expression_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-expression\");\nvar _format_condition_min_max_base_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-min-max-base\");\nvar _format_condition_top_bottom_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-top-bottom\");\nvar _format_condition_value_1 = require(\"../../../../model/format-rules/conditions/metadata/_format-condition-value\");\nvar _format_condition_range_base_1 = require(\"../../../../model/format-rules/conditions/range/metadata/_format-condition-range-base\");\nvar _format_condition_range_gradient_1 = require(\"../../../../model/format-rules/conditions/range/metadata/_format-condition-range-gradient\");\nvar _cells_item_format_rule_1 = require(\"../../../../model/format-rules/metadata/_cells-item-format-rule\");\nvar _dashboard_item_format_rule_1 = require(\"../../../../model/format-rules/metadata/_dashboard-item-format-rule\");\nvar _format_rules_common_1 = require(\"../../../../model/format-rules/metadata/_format-rules-common\");\nvar _helper_classes_1 = require(\"../../../../model/internal/_helper-classes\");\nvar _knockout_utils_1 = require(\"../../../../model/internal/_knockout-utils\");\nvar _parameters_helper_1 = require(\"../../../../model/parameters/_parameters-helper\");\nvar _filter_utils_1 = require(\"../../../filtering/_filter-utils\");\nvar _item_filter_display_name_provider_1 = require(\"../../../filtering/_item-filter-display-name-provider\");\nvar _item_filter_items_provider_1 = require(\"../../../filtering/_item-filter-items-provider\");\nvar _form_adapter_editors_1 = require(\"../../../form-adapter/_form-adapter-editors\");\nvar _object_properties_wrapper_1 = require(\"../../../form-adapter/_object-properties-wrapper\");\nvar _accordion_tab_1 = require(\"../../../properties-controller/_accordion-tab\");\nvar FormatRulePropertiesComposer = (function () {\n    function FormatRulePropertiesComposer(_options) {\n        this._options = _options;\n    }\n    FormatRulePropertiesComposer.prototype.composeTabs = function (model, args) {\n        var commonTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.FormatRuleCommon, 'DashboardWebStringId.AccordionTab.Common');\n        var conditionTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.FormatRuleCondition, 'DashboardWebStringId.ConditionalFormatting.Condition');\n        var miscTab = new _accordion_tab_1.AccordionTab(_accordion_tab_1.KnownTabs.FormatRuleMisc, 'DashboardWebStringId.ConditionalFormatting.Miscellaneous');\n        var additionalTabs = [];\n        this._fillCommonFormatRuleCommonWrapper(commonTab, model, args.dashboardItem, args.dataSourceBrowser, args.requestRecalculation, args.specificTypeChanged);\n        if (ko.unwrap(model && model.condition)) {\n            this._fillConditionWrapper(conditionTab, model, args.dashboardItem, args.dataSourceBrowser);\n            additionalTabs = this._options.getAdditionalTabs && this._options.getAdditionalTabs(model, args.dashboardItem, args.dataSourceBrowser);\n            this._fillMiscWrapper(miscTab, model, args.dashboardItem, args.dataSourceBrowser);\n        }\n        return __spreadArray(__spreadArray([commonTab, conditionTab], (additionalTabs || [])), [miscTab]).filter(function (tab) { return !!tab; });\n    };\n    FormatRulePropertiesComposer.prototype._fillCommonFormatRuleCommonWrapper = function (tab, formatRule, dashboardItem, dataSourceBrowser, requestRecalculation, specificTypeChanged) {\n        var propertiesInfo = this._options.getCommonFormatRuleProperties(formatRule, dashboardItem, dataSourceBrowser, requestRecalculation);\n        var disabledRules = {};\n        var dataType = this._options.createDataTypeObservable(formatRule, dashboardItem, dataSourceBrowser);\n        disabledRules[_cells_item_format_rule_1.formatRuleDataItem.propertyName] = function () { return !!ko.unwrap(formatRule.condition); };\n        disabledRules['typeChooser'] = function () { return !!ko.unwrap(formatRule.condition); };\n        var wrapper = new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n            model: formatRule,\n            visibilityFilterRules: propertiesInfo.visibilityFilterRules,\n            properties: propertiesInfo.properties,\n            disabledFilterRules: __assign(__assign({}, disabledRules), propertiesInfo.disabledFilterRules)\n        });\n        addConditionEditor(wrapper, dataType, formatRule, dashboardItem, requestRecalculation, specificTypeChanged, this._options.conditionTypeFilter);\n        tab.tabModel(wrapper);\n    };\n    FormatRulePropertiesComposer.prototype._fillConditionWrapper = function (tab, model, dashboardItem, dataSourceBrowser) {\n        var p = [];\n        var visibilityRules = {};\n        visibilityRules[_format_condition_range_base_1.rangeValueType.propertyName] = function () { return model.condition() && !model.condition().dateTimeGroupInterval(); };\n        var isChartItem = dashboardItem instanceof model_1.ChartItem || dashboardItem instanceof model_1.ScatterChartItem;\n        var simpleStylesAppearance = isChartItem ? 'RichColors' : 'Appearance';\n        var barStylesAppearance = 'AllColors';\n        var gradientStylesAppearance = 'GradientColors';\n        var simpleStyleSettingsEditorOptions = {\n            allowChangeViewMode: !isChartItem,\n            appearanceMode: simpleStylesAppearance,\n            isEmptyAllowed: false,\n            enableCustomStyles: isChartItem\n        };\n        var barStyleSettingsEditorOptions = {\n            allowChangeViewMode: false,\n            appearanceMode: barStylesAppearance,\n            isEmptyAllowed: false,\n            enableCustomStyles: true\n        };\n        switch (model.condition() && model.condition().constructor) {\n            case model_1.FormatConditionValue:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [{\n                            container: _format_condition_value_1.formatConditionValue1,\n                            properties: [\n                                __assign({ simpleFormAdapterItem: _parameters_helper_1.ParameterHelper.getEditorType(model.condition()[_format_condition_value_1.formatConditionValue1.propertyName].type()), displayName: 'DashboardStringId.ValueCaption', replacementPropertyName: 'value1_value' }, _format_rules_common_1.complexValueValue)\n                            ]\n                        }, {\n                            container: _format_condition_value_1.formatConditionValue2,\n                            properties: [__assign({ simpleFormAdapterItem: _parameters_helper_1.ParameterHelper.getEditorType(model.condition()[_format_condition_value_1.formatConditionValue1.propertyName].type()), displayName: 'DashboardStringId.Value2Caption', replacementPropertyName: 'value2_value' }, _format_rules_common_1.complexValueValue)]\n                        }, __assign(__assign({}, _format_rules_common_1.styleSettings), { formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions) }), _format_condition_value_1.conditionInCondition,]\n                });\n                visibilityRules['value2_value'] =\n                    [_format_condition_value_1.conditionInCondition.propertyName, 'contains', 'Between'];\n                visibilityRules[_format_condition_value_1.conditionInCondition.propertyName] = function () { return false; };\n                break;\n            case format_condition_top_bottom_1.FormatConditionTopBottom:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        __assign(__assign({}, _format_rules_common_1.styleSettings), { formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions) }),\n                        _format_condition_top_bottom_1.rank,\n                        _format_condition_top_bottom_1._actualRankType\n                    ]\n                });\n                break;\n            case format_condition_average_1.FormatConditionAverage:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        __assign(__assign({}, _format_rules_common_1.styleSettings), { formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions) }),\n                    ]\n                });\n                break;\n            case model_1.FormatConditionDateOccurring:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        __assign(__assign({}, _format_rules_common_1.styleSettings), { formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions) }),\n                        __assign(__assign({}, _format_condition_date_occuring_1.dateType), { formAdapterItem: _form_adapter_editors_1.flagsEnumTagBoxEditor({\n                                values: _format_condition_date_occuring_1.baseDateTypeValues.concat(common_1.LegacySettings.showExtendedDateOccurringList ? _format_condition_date_occuring_1.extendedDateTypeValues : []),\n                                enumDeclaration: enums_1.FilterDateType\n                            }) })\n                    ]\n                });\n                break;\n            case format_condition_expression_1.FormatConditionExpression:\n                var expressionCondition = model.condition();\n                var ruleExpressionEditorParams = {\n                    fieldListProvider: ko.observable(new _item_filter_items_provider_1.ItemFilterItemsProvider(dataSourceBrowser, dataSourceBrowser, dataSourceBrowser.parameters, dashboardItem, function (di) { return dashboardItem._conditionFormattingExpressionEditorFilter(di); })),\n                    options: _filter_utils_1.createItemFilterOptions(expressionCondition.expression, expressionCondition, dataSourceBrowser, { text: 'Expression', localizationId: 'DashboardStringId.CommandFormatRuleExpression' }),\n                    displayNameProvider: new _item_filter_display_name_provider_1.ItemFilterDisplayNameProvider(dashboardItem, dataSourceBrowser)\n                };\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        __assign(__assign({}, _format_condition_expression_1.formatConditionFilter), { formAdapterItem: _form_adapter_editors_1.filterEditor(ruleExpressionEditorParams) }),\n                        __assign(__assign({}, _format_rules_common_1.styleSettings), { formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(simpleStyleSettingsEditorOptions) }),\n                    ]\n                });\n                break;\n            case model_1.FormatConditionBar:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        _format_condition_min_max_base_1.minimumType,\n                        _format_condition_min_max_base_1.formatConditionMinimum,\n                        _format_condition_min_max_base_1.maximumType,\n                        _format_condition_min_max_base_1.formatConditionMaximum,\n                        _format_condition_bar_1.barCurrentStyleSettingsType,\n                        __assign(__assign({}, _format_condition_bar_1.barCurrentStyleSettings), { formAdapterItem: _form_adapter_editors_1.styleSettingsEditor(barStyleSettingsEditorOptions) }),\n                        {\n                            container: _format_rules_common_1.barOptions,\n                            properties: [\n                                _format_condition_bar_options_1.allowNegativeAxis,\n                                _format_condition_bar_options_1.drawAxis,\n                                _format_condition_bar_options_1.showBarOnly\n                            ]\n                        }\n                    ]\n                });\n                visibilityRules[_format_condition_min_max_base_1.formatConditionMinimum.propertyName] = [_format_condition_min_max_base_1.minimumType.propertyName, '<>', 'Automatic'];\n                visibilityRules[_format_condition_min_max_base_1.formatConditionMaximum.propertyName] = [_format_condition_min_max_base_1.maximumType.propertyName, '<>', 'Automatic'];\n                break;\n            case model_1.FormatConditionColorRangeBar:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        _format_condition_range_base_1.rangeValueType,\n                        __assign(__assign({}, _format_condition_range_base_1.rangeSet), { formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({ condition: model.condition(), appearanceMode: barStylesAppearance, enableCustomStyles: true }) }),\n                        {\n                            container: _format_rules_common_1.barOptions,\n                            properties: [\n                                _format_condition_bar_options_1.allowNegativeAxis,\n                                _format_condition_bar_options_1.drawAxis,\n                                _format_condition_bar_options_1.showBarOnly\n                            ]\n                        }\n                    ]\n                });\n                break;\n            case model_1.FormatConditionGradientRangeBar:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        _format_condition_range_base_1.rangeValueType,\n                        _format_condition_range_gradient_1.segmentNumber,\n                        __assign(__assign({}, _format_condition_range_base_1.rangeSet), { formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({ condition: model.condition(), appearanceMode: gradientStylesAppearance, enableCustomStyles: true }) }),\n                        {\n                            container: _format_rules_common_1.barOptions,\n                            properties: [\n                                _format_condition_bar_options_1.allowNegativeAxis,\n                                _format_condition_bar_options_1.drawAxis,\n                                _format_condition_bar_options_1.showBarOnly\n                            ]\n                        }\n                    ]\n                });\n                break;\n            case model_1.FormatConditionRangeGradient:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        _format_condition_range_base_1.rangeValueType,\n                        _format_condition_range_gradient_1.segmentNumber,\n                        __assign(__assign({}, _format_condition_range_base_1.rangeSet), { formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({ condition: model.condition(), appearanceMode: gradientStylesAppearance, enableCustomStyles: true }) }),\n                    ]\n                });\n                break;\n            case model_1.FormatConditionRangeSet:\n                p.push({\n                    container: _dashboard_item_format_rule_1.condition,\n                    properties: [\n                        _format_condition_range_base_1.rangeValueType,\n                        __assign(__assign({}, _format_condition_range_base_1.rangeSet), { formAdapterItem: _form_adapter_editors_1.ruleRangesEditor({ condition: model.condition(), appearanceMode: simpleStylesAppearance, enableCustomStyles: isChartItem }) }),\n                    ]\n                });\n                break;\n            case undefined:\n                break;\n            default:\n                throw new Error('Unsupported formatting rule condition');\n        }\n        var additionProperties = this._options.getConditionFormatRuleProperties(model, dashboardItem, dataSourceBrowser);\n        var wrapper = new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n            model: model,\n            properties: p.concat(additionProperties.properties),\n            visibilityFilterRules: __assign(__assign({}, visibilityRules), additionProperties.visibilityFilterRules),\n            disabledFilterRules: additionProperties.disabledFilterRules,\n            dynamicEditorRules: additionProperties.dynamicEditorRules\n        });\n        tab.tabModel(wrapper);\n    };\n    FormatRulePropertiesComposer.prototype._fillMiscWrapper = function (tab, model, dashboardItem, dataSourceBrowser) {\n        var miscProperties = this._options.getMiscFormatRuleProperties(model, dashboardItem, dataSourceBrowser);\n        var wrapper = new _object_properties_wrapper_1.ObjectPropertiesWrapper({\n            model: model,\n            properties: __spreadArray([\n                _dashboard_item_format_rule_1.enabled\n            ], miscProperties.properties),\n            disabledFilterRules: miscProperties.disabledFilterRules,\n            dynamicEditorRules: miscProperties.dynamicEditorRules,\n            visibilityFilterRules: miscProperties.visibilityFilterRules\n        });\n        tab.tabModel(wrapper);\n    };\n    return FormatRulePropertiesComposer;\n}());\nexports.FormatRulePropertiesComposer = FormatRulePropertiesComposer;\nfunction createDeltaDataTypeObservable(model, dashboardItem, dataSourceBrowser) {\n    var dataType = ko.observable(model.condition() && model.condition().dataType());\n    var fillDataTypeForDelta = function () {\n        var fillDataTypes = function (measure) {\n            dataSourceBrowser.findDataField(dashboardItem.dataSource(), dashboardItem.dataMember(), measure.dataMember()).done(function (field) {\n                var summaryType = measure.summaryType();\n                if ((summaryType === 'Count') || (summaryType === 'CountDistinct')) {\n                    dataType('Integer');\n                    model.condition() && model.condition().dataType(dataType());\n                }\n                else if (['Sum', 'Average', 'StdDev', 'StdDevp', 'Var', 'VarP'].indexOf(summaryType) !== -1) {\n                    dataType('Decimal');\n                    model.condition() && model.condition().dataType(dataType());\n                }\n                else {\n                    dataType(field.fieldType());\n                    model.condition() && model.condition().dataType(dataType());\n                }\n            });\n        };\n        var kpiElement = dashboardItem.cards().filter(function (card) { return card._getDataId() === model.cardId(); })[0];\n        var deltaValueType = model.deltaValueType();\n        if (deltaValueType === 'ActualValue') {\n            fillDataTypes(kpiElement.actualValue());\n        }\n        else if (deltaValueType === 'TargetValue') {\n            fillDataTypes(kpiElement.targetValue());\n        }\n        else {\n            dataType('Decimal');\n            model.condition() && model.condition().dataType(dataType());\n        }\n    };\n    fillDataTypeForDelta();\n    model.cardId.subscribe(function (containerId) {\n        fillDataTypeForDelta();\n    });\n    model.deltaValueType.subscribe(function (deltaValueTypeId) {\n        fillDataTypeForDelta();\n    });\n    return { dataType: dataType, dateTimeGroupInterval: ko.observable() };\n}\nexports.createDeltaDataTypeObservable = createDeltaDataTypeObservable;\nfunction createDataTypeObservable(formatRule, dashboardItem, dataSourceBrowser) {\n    var dataItemCalculateBy = dashboardItem.dataItems().filter(function (d) { return formatRule.dataItemName() === d.uniqueName(); })[0];\n    var dateTimeGroupInterval = ko.observable(dataItemCalculateBy instanceof dimension_1.Dimension ? dataItemCalculateBy.dateTimeGroupInterval() : undefined);\n    var dataType = ko.observable(formatRule.condition() && formatRule.condition().dataType());\n    var fillDataType = function (uniqueName) { return dashboardItem\n        .dataItems()\n        .filter(function (dataItem) { return uniqueName === dataItem.uniqueName() && !!dataItem.dataMember(); })\n        .map(function (dataItem) { return ({\n        dataItem: dataItem,\n        fieldPromise: dataSourceBrowser.findDataField(dashboardItem.dataSource(), dashboardItem.dataMember(), dataItem.dataMember())\n    }); })\n        .forEach(function (d) { return d.fieldPromise.done(function (field) {\n        var newDataType = field.fieldType();\n        if (d.dataItem instanceof dimension_1.Dimension) {\n            newDataType = _item_filter_items_provider_1.getRealDimensionType(d.dataItem, field);\n            dateTimeGroupInterval(field.fieldType() === 'DateTime' ? d.dataItem.dateTimeGroupInterval() : undefined);\n            formatRule.condition() && formatRule.condition().dateTimeGroupInterval(dateTimeGroupInterval());\n        }\n        if (d.dataItem instanceof measure_1.Measure) {\n            var summaryType = d.dataItem.summaryType();\n            if ((summaryType === 'Count') || (summaryType === 'CountDistinct')) {\n                newDataType = 'Integer';\n            }\n            else if (['Sum', 'Average', 'StdDev', 'StdDevp', 'let', 'letp'].indexOf(summaryType) !== -1) {\n                newDataType = 'Decimal';\n            }\n        }\n        dataType(newDataType);\n        formatRule.condition() && formatRule.condition().dataType(dataType());\n    }); }); };\n    if (!dataType() && formatRule.dataItemName())\n        fillDataType(formatRule.dataItemName());\n    formatRule.dataItemName.subscribe(fillDataType);\n    return { dataType: dataType, dateTimeGroupInterval: dateTimeGroupInterval };\n}\nexports.createDataTypeObservable = createDataTypeObservable;\nfunction addConditionEditor(wrapper, dataTypeInfo, formatRuleModel, dashboardItem, requestRecalculation, specificTypeChanged, conditionTypeFilter) {\n    var originalConditionType = formatRuleModel._classId;\n    var conditionType = ko.observable(formatRuleModel._classId).extend({ notify: 'always' });\n    var specificType = ko.observable(formatRuleModel.condition() && formatRuleModel.condition().getSpecificType());\n    wrapper.addProperty(ko.observable(), {\n        propertyName: 'typeChooser',\n        displayName: 'DashboardWebStringId.ConditionType',\n        formAdapterItem: _form_adapter_editors_1.conditionTypeEditor({ dataType: dataTypeInfo.dataType, conditionType: conditionType, specificType: specificType, filters: conditionTypeFilter })\n    });\n    specificType.subscribe(function (newSpecificType) {\n        var condition = formatRuleModel.condition(), newRule = !condition, changedConditionType = originalConditionType !== conditionType(), realConditionType = conditionType().split('_')[0];\n        if (newRule || changedConditionType) {\n            formatRuleModel._changeConditionType(realConditionType);\n            condition = formatRuleModel.condition();\n            condition.dataType(dataTypeInfo.dataType());\n            condition.dateTimeGroupInterval(dataTypeInfo.dateTimeGroupInterval());\n        }\n        condition.setSpecificType(newSpecificType);\n        if (newRule) {\n            formatRuleModel.name(_helper_classes_1.NameGenerator.generateName(_default_1.getLocalizationById('DashboardWebStringId.FormatRule') + ' ', dashboardItem.formatRules(), 'name', 1));\n        }\n        if (newRule || changedConditionType) {\n            requestRecalculation.fire();\n        }\n        specificTypeChanged();\n    });\n}\nexports.addConditionEditor = addConditionEditor;\nfunction getCommonCellsFormatRuleProperties(formatRule, getDataItems, getApplyToDataItems) {\n    var dataItems = ko.pureComputed(function () { return getDataItems().map(function (m) { return ({ value: ko.unwrap(m.uniqueName), displayValueId: ko.unwrap(m.displayName) }); }); });\n    var applyToDataItems = ko.pureComputed(function () { return getApplyToDataItems().map(function (m) { return ({ value: ko.unwrap(m.uniqueName), displayValueId: ko.unwrap(m.displayName) }); }); });\n    if (!formatRule.dataItemName() && dataItems().length) {\n        formatRule.dataItemName(ko.unwrap(dataItems()[0].value));\n    }\n    var externalUpdateCallback = function (formUpdateHandler) {\n        return _knockout_utils_1.safeSubscribe({\n            dataItemName: formatRule.dataItemApplyToName,\n            applyToDataItems: applyToDataItems\n        }, function () { return formUpdateHandler({ forceValidate: true }); });\n    };\n    var getApplyToPlaceHolder = function () {\n        var dataItemApplyToInfo = applyToDataItems().filter(function (item) { return item.value === formatRule.dataItemApplyToName(); })[0];\n        return dataItemApplyToInfo && dataItemApplyToInfo.displayValueId;\n    };\n    var commonProperties = [];\n    commonProperties.push(__assign(__assign({}, _cells_item_format_rule_1.formatRuleDataItem), { formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({ values: dataItems }) }));\n    commonProperties.push(__assign(__assign({}, _cells_item_format_rule_1.dataItemApplyTo), { externalUpdateCallback: externalUpdateCallback, formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({\n            values: applyToDataItems,\n            additionalOptions: function () { return ({\n                placeholder: getApplyToPlaceHolder()\n            }); },\n            comparableEditorOptions: ['placeholder']\n        }), validationRules: [{\n                type: 'custom',\n                message: _default_1.getLocalizationById('DashboardWebStringId.ConditionalFormatting.InvalidApplyToValue'),\n                reevaluate: true,\n                validationCallback: function (e) {\n                    var applyToDataItemsNames = applyToDataItems().map(function (di) { return di.value; });\n                    return !e.value && applyToDataItemsNames.indexOf(formatRule.dataItemName()) !== -1\n                        || !!e.value && applyToDataItemsNames.indexOf(e.value) !== -1;\n                }\n            }] }));\n    return {\n        properties: commonProperties\n    };\n}\nexports.getCommonCellsFormatRuleProperties = getCommonCellsFormatRuleProperties;\n"]},"metadata":{},"sourceType":"script"}