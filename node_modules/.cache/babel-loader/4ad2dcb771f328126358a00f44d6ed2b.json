{"ast":null,"code":"/**\r\n* DevExpress Dashboard (custom-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CustomItem = void 0;\n\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\n\nvar ko = require(\"knockout\");\n\nvar _item_data_axis_point_1 = require(\"../../../data/item-data/_item-data-axis-point\");\n\nvar special_values_1 = require(\"../../../data/special-values\");\n\nvar _formatter_1 = require(\"../../../data/_formatter\");\n\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\n\nvar color_1 = require(\"../../color\");\n\nvar custom_properties_metadata_1 = require(\"../../custom-properties/custom-properties-metadata\");\n\nvar _custom_properties_utils_1 = require(\"../../custom-properties/_custom-properties-utils\");\n\nvar data_item_1 = require(\"../../data-item/data-item\");\n\nvar _data_item_1 = require(\"../../data-item/metadata/_data-item\");\n\nvar custom_item_calc_window_definition_1 = require(\"../../data-item/window-definition/custom-item-calc-window-definition\");\n\nvar _knockout_utils_1 = require(\"../../internal/_knockout-utils\");\n\nvar _utils_1 = require(\"../../internal/_utils\");\n\nvar _base_metadata_1 = require(\"../../metadata/_base-metadata\");\n\nvar data_dashboard_item_1 = require(\"../data-dashboard-item\");\n\nvar interactivity_options_1 = require(\"../options/interactivity-options\");\n\nvar _coloring_options_1 = require(\"../options/metadata/_coloring-options\");\n\nvar _custom_item_1 = require(\"./metadata/_custom-item\");\n\nvar slice_table_1 = require(\"./slice-table\");\n\nvar COLOR_MEASURE_ID = 'ColorMeasure';\n\nvar CustomItem = function (_super) {\n  __extends(CustomItem, _super);\n\n  function CustomItem(_meta, modelJson, serializer) {\n    if (modelJson === void 0) {\n      modelJson = {};\n    }\n\n    if (serializer === void 0) {\n      serializer = new analytics_utils_1.ModelSerializer();\n    }\n\n    var _this = _super.call(this, modelJson, serializer, CustomItem._getInfo(_meta, modelJson['@CustomItemType'])) || this;\n\n    _this._meta = _meta;\n    _this.sliceTables = ko.observableArray();\n    _this.interactivityTargets = ko.observableArray();\n    _this.coloringDimensions = ko.observableArray();\n    _this.coloringMeasures = ko.observableArray();\n    _this.customMetadata = {};\n\n    _this._getMeasureValue = function (dataRow, dataItemUniqueName) {\n      return _this._getStorage().getValue(dataRow, dataItemUniqueName);\n    };\n\n    _this._getMeasureDisplayText = function (dataRow, dataItemUniqueName) {\n      var value = _this._getMeasureValue(dataRow, dataItemUniqueName);\n\n      if (value === null || value === undefined) {\n        return null;\n      }\n\n      var metaData = _this._dataManager().getMetaData(),\n          formatViewModel = metaData.getMeasureFormat(dataItemUniqueName);\n\n      return _this._format(value, formatViewModel);\n    };\n\n    _this._getDimensionUniqueValue = function (dataRow, dataItemUniqueName) {\n      return _this._getStorage().getKeyValue(dataRow, dataItemUniqueName);\n    };\n\n    _this._getDimensionValue = function (dataRow, dataItemUniqueName) {\n      var value = _this._getSpecialValue(dataRow, dataItemUniqueName, _item_data_axis_point_1.dataStorageSpecialIds.Value);\n\n      if (value === null || value === undefined) value = _this._getDimensionUniqueValue(dataRow, dataItemUniqueName);\n      if (value === special_values_1.specialValues.nullValueGuid) value = null;\n      return value;\n    };\n\n    _this._getDimensionDisplayText = function (dataRow, dataItemUniqueName) {\n      var displayText = _this._getServerText(dataRow, dataItemUniqueName),\n          uniqueValue = _this._getDimensionUniqueValue(dataRow, dataItemUniqueName);\n\n      if (uniqueValue === special_values_1.specialValues.olapNullValueGuid) return undefined;\n\n      if (displayText == null) {\n        var metaData = _this._dataManager().getMetaData(),\n            formatViewModel = metaData.getDimensionFormat(dataItemUniqueName);\n\n        displayText = _this._format(_this._getDimensionValue(dataRow, dataItemUniqueName), formatViewModel);\n      }\n\n      return displayText;\n    };\n\n    _this._isExcludingAllFilter = ko.computed(function () {\n      if (_this._isMasterFilter() && !!_this.customInteractivity && !!_this.customInteractivity.applyEmptyFilter) {\n        var selectionValues = _this._selectionValues();\n\n        return !selectionValues || selectionValues.length === 0;\n      }\n\n      return false;\n    });\n    var modelCustomMetadata = modelJson.CustomMetadata || {};\n\n    _this.customBindings.forEach(function (binding) {\n      var linkPropertyName = CustomItem._getBindingLinkName(binding.propertyName);\n\n      if (binding.array) {\n        _this[linkPropertyName] = analytics_utils_1.deserializeArray(modelCustomMetadata[binding.propertyName], function (item) {\n          return new data_item_1.DataItemLink(_this, item, serializer);\n        });\n        _this[binding.propertyName] = ko.observableArray([]);\n\n        _this._subscribeDataItemLinkArrays({\n          propertyName: linkPropertyName,\n          modelName: binding.propertyName\n        });\n\n        _knockout_utils_1.subscribeArrayChange(_this[linkPropertyName], {\n          added: function (item) {\n            return item.itemType(binding.dataItemType);\n          }\n        });\n      } else {\n        _this[binding.propertyName] = ko.observable();\n\n        _this._attachDataItem(_this, linkPropertyName, new data_item_1.DataItemLink(_this, modelCustomMetadata[binding.propertyName], serializer));\n      }\n\n      _this.customMetadata[linkPropertyName] = _this[linkPropertyName];\n    });\n\n    _this.legacyCustomProperties.forEach(function (p) {\n      _this.customMetadata[p.propertyName] = _this[p.propertyName] = ko.pureComputed({\n        read: function () {\n          return _this.customProperties[p.propertyName]();\n        },\n        write: function (value) {\n          return _this.customProperties.setValue(p.propertyName, value);\n        }\n      });\n    });\n\n    ko.computed(function () {\n      var sliceTables = [];\n      var interactivityTargets = [];\n      var coloringDimensions = [];\n      var coloringMeasures = [];\n\n      _this.customBindings.forEach(function (binding) {\n        var prop = _this[CustomItem._getBindingLinkName(binding.propertyName)];\n\n        var bindings = (binding.array ? prop() : [prop]).filter(function (link) {\n          return !!link.dataItem();\n        });\n        var sliceTable = sliceTables.filter(function (sliceTable) {\n          return sliceTable.name() === binding.slice;\n        })[0];\n\n        if (!sliceTable) {\n          sliceTable = new slice_table_1.SliceTable(_this, {\n            '@ItemType': 'SliceTable',\n            '@Name': binding.slice\n          });\n          sliceTables.push(sliceTable);\n        }\n\n        sliceTable.push(bindings, binding.dataItemType);\n\n        if (binding.enableInteractivity) {\n          interactivityTargets = interactivityTargets.concat(bindings);\n        }\n\n        if (binding.enableColoring) {\n          if (binding.dataItemType === 'Dimension') {\n            bindings.forEach(function (link) {\n              return data_dashboard_item_1.DataDashboardItem._addColoringMeta([link]);\n            });\n\n            if (binding.array) {\n              prop.subscribe(function (links) {\n                return data_dashboard_item_1.DataDashboardItem._addColoringMeta(links);\n              });\n            }\n\n            coloringDimensions = coloringDimensions.concat(bindings);\n          }\n\n          if (binding.dataItemType === 'Measure') {\n            coloringMeasures = coloringMeasures.concat(bindings);\n          }\n        }\n      });\n\n      _this.sliceTables(sliceTables);\n\n      _this.interactivityTargets(interactivityTargets);\n\n      _this.coloringDimensions(coloringDimensions);\n\n      _this.coloringMeasures(coloringMeasures);\n    });\n\n    if (!_this.customBindings.length) {\n      _this._supportedUIStates(['error']);\n    }\n\n    return _this;\n  }\n\n  CustomItem.getPropertyInfo = function (p) {\n    return _jquery_helpers_1.deepExtend({\n      modelName: '@' + p.propertyName,\n      category: _base_metadata_1.PropertyCategory.ViewModel\n    }, p);\n  };\n\n  CustomItem._getBindingLinkName = function (propertyName) {\n    return '__' + propertyName;\n  };\n\n  CustomItem._getSerializationsInfo = function (bindings) {\n    return (bindings || []).map(function (binding) {\n      return {\n        propertyName: CustomItem._getBindingLinkName(binding.propertyName),\n        modelName: binding.propertyName,\n        array: binding.array,\n        info: !binding.array ? _data_item_1.dataItemLinkSerializationsInfo : undefined\n      };\n    });\n  };\n\n  CustomItem._hasInteractivityTargets = function (meta) {\n    var bindings = meta && meta['bindings'] || [];\n    return bindings.some(function (binding) {\n      return binding.enableInteractivity;\n    });\n  };\n\n  CustomItem._hasColoringDimensions = function (bindings) {\n    return bindings.some(function (binding) {\n      return binding.enableColoring && binding.dataItemType === 'Dimension';\n    });\n  };\n\n  CustomItem._hasColoringMeasures = function (bindings) {\n    return bindings.some(function (binding) {\n      return binding.enableColoring && binding.dataItemType === 'Measure';\n    });\n  };\n\n  CustomItem._isFilterAllowed = function (meta) {\n    var interactivity = !!meta && meta['interactivity'];\n    return !!interactivity && interactivity.filter && CustomItem._hasInteractivityTargets(meta);\n  };\n\n  CustomItem._isDrillDownAllowed = function (meta) {\n    var interactivity = !!meta && meta['interactivity'];\n    return !!interactivity && interactivity.drillDown && CustomItem._hasInteractivityTargets(meta);\n  };\n\n  CustomItem._getInfo = function (meta, customItemType) {\n    if (!meta) {\n      var staticCustomPropertiesInfo = CustomItem._getCustomPropertiesSerializationInfo(customItemType, []);\n\n      return _custom_item_1.customDashboardItemSerializationsInfo.concat([staticCustomPropertiesInfo]);\n    }\n\n    var dynamicInfo = [];\n    var bindings = meta && meta.bindings || [];\n\n    var isFilterAllowed = CustomItem._isFilterAllowed(meta);\n\n    var isDrillDownAllowed = CustomItem._isDrillDownAllowed(meta);\n\n    var bindingsInfo = CustomItem._getSerializationsInfo(bindings);\n\n    var propertiesMetadata = (meta && meta.properties || []).map(function (p) {\n      return {\n        ownerType: CustomItem,\n        customItemType: customItemType,\n        propertyName: p.propertyName,\n        defaultValue: p.defaultVal\n      };\n    }).concat(meta && meta.customProperties).filter(function (cp) {\n      return !!cp;\n    });\n\n    var customProperties = CustomItem._getCustomPropertiesSerializationInfo(customItemType, propertiesMetadata);\n\n    if (isFilterAllowed && isDrillDownAllowed) {\n      dynamicInfo.push(interactivity_options_1._dashboardItemInteractivityOptionsMeta);\n    } else if (isFilterAllowed) {\n      dynamicInfo.push(interactivity_options_1._masterFilterInteractivityOptionsMeta);\n    } else if (isDrillDownAllowed) {\n      dynamicInfo.push(interactivity_options_1._drillDownInteractivityOptionsMeta);\n    } else {\n      dynamicInfo.push(interactivity_options_1._baseInteractivityOptionsMeta);\n    }\n\n    var hasColoringDimensions = CustomItem._hasColoringDimensions(bindings);\n\n    if (hasColoringDimensions) {\n      dynamicInfo.push(_custom_item_1.coloringDimensions);\n    }\n\n    var hasColoringMeasures = CustomItem._hasColoringMeasures(bindings);\n\n    if (hasColoringMeasures) {\n      dynamicInfo.push(_custom_item_1.coloringMeasures);\n    }\n\n    if (hasColoringDimensions || hasColoringMeasures) {\n      dynamicInfo.push(_coloring_options_1.coloringOptions);\n    }\n\n    return _custom_item_1.customDashboardItemSerializationsInfo.concat([{\n      propertyName: 'customMetadata',\n      modelName: 'CustomMetadata',\n      info: bindingsInfo\n    }]).concat(dynamicInfo).concat(customProperties);\n  };\n\n  CustomItem.prototype._clearBindings = function () {\n    var _this = this;\n\n    _super.prototype._clearBindings.call(this);\n\n    this.customBindings.forEach(function (binding) {\n      if (binding.array) {\n        _this[CustomItem._getBindingLinkName(binding.propertyName)].removeAll();\n      }\n    });\n  };\n\n  CustomItem.prototype.getBindingValue = function (propertyName, index) {\n    var _this = this;\n\n    var binding = ko.unwrap(this[CustomItem._getBindingLinkName(propertyName)]);\n    var bindingValues = undefined;\n\n    var wrapBindingValue = function (binding) {\n      return !binding.dataItem() ? undefined : {\n        displayName: function () {\n          return _this._getDataItemDisplayName(binding.dataItem());\n        },\n        uniqueName: function () {\n          return binding.uniqueName();\n        }\n      };\n    };\n\n    if (Array.isArray(binding)) {\n      bindingValues = index != undefined ? [wrapBindingValue(binding[index])] : binding.map(function (b) {\n        return wrapBindingValue(b);\n      });\n    } else {\n      bindingValues = [wrapBindingValue(binding)];\n    }\n\n    return bindingValues.filter(function (b) {\n      return b !== undefined;\n    });\n  };\n\n  CustomItem.prototype.iterateData = function (action, sliceTableName) {\n    var _this = this;\n\n    if (sliceTableName === void 0) {\n      sliceTableName = null;\n    }\n\n    var slice = this.getSlice(sliceTableName);\n    if (!slice) return;\n\n    var keyIds = slice.getKeyIds() || [],\n        valueIds = slice.getValueIds() || [],\n        processDataRow = function (dataRow, propertyName, measureAction, dimensionAction) {\n      var binding = _this.customBindings.filter(function (b) {\n        return b.propertyName === propertyName;\n      })[0],\n          result = [];\n\n      if (!!binding) {\n        var property = _this[CustomItem._getBindingLinkName(propertyName)];\n\n        (binding.array ? property() : [property]).forEach(function (item) {\n          var uniqueName = item.uniqueName();\n          if (keyIds.indexOf(uniqueName) != -1) result.push(dimensionAction(dataRow, uniqueName));\n          if (valueIds.indexOf(uniqueName) != -1) result.push(measureAction(dataRow, uniqueName));\n        });\n      }\n\n      return result;\n    };\n\n    slice.forEach(function (dataRow) {\n      action({\n        getColor: function (measureBindingName) {\n          if (!measureBindingName) {\n            return [_this._getColor(dataRow, keyIds, COLOR_MEASURE_ID)];\n          } else {\n            return processDataRow(dataRow, measureBindingName, function (dataRow, uniqueName) {\n              return _this._getColor(dataRow, keyIds, _this._getColorMeasureId(uniqueName));\n            }, function (dataRow, uniqueName) {\n              return _this._getColor(dataRow, keyIds, COLOR_MEASURE_ID);\n            });\n          }\n        },\n        getDisplayText: function (property) {\n          return processDataRow(dataRow, property, _this._getMeasureDisplayText, _this._getDimensionDisplayText);\n        },\n        getValue: function (property) {\n          return processDataRow(dataRow, property, _this._getMeasureValue, _this._getDimensionValue);\n        },\n        getUniqueValue: function (property) {\n          return processDataRow(dataRow, property, _this._getMeasureValue, _this._getDimensionUniqueValue);\n        }\n      });\n    });\n  };\n\n  CustomItem.prototype._getDefaultItemType = function () {\n    return CustomItem.ItemType;\n  };\n\n  CustomItem.prototype._getSliceTable = function (name) {\n    var sliceTables = this.sliceTables();\n\n    if (!!name) {\n      return sliceTables.filter(function (slice) {\n        return slice.name() === name;\n      })[0];\n    } else {\n      return sliceTables.length > 0 ? sliceTables[0] : undefined;\n    }\n  };\n\n  CustomItem.prototype._getAllSelectionValues = function (activeDimensions) {\n    var sliceTables = this.sliceTables().filter(function (slice) {\n      return activeDimensions.every(function (id) {\n        return slice.dimensions().map(function (dim) {\n          return dim.uniqueName();\n        }).indexOf(id) !== -1;\n      });\n    }),\n        values = [];\n\n    if (sliceTables.length > 0) {\n      var slice = this.getSlice(sliceTables[0].name());\n\n      if (!!slice) {\n        var keyIds = slice.getKeyIds().filter(function (id) {\n          return activeDimensions.indexOf(id) !== -1;\n        });\n        slice.forEach(function (dataRow) {\n          return values.push(keyIds.map(function (id) {\n            return slice.getKeyValue(dataRow.rowKey, id);\n          }));\n        });\n      }\n    }\n\n    return values;\n  };\n\n  CustomItem.prototype.getSlice = function (sliceTableName) {\n    if (sliceTableName === void 0) {\n      sliceTableName = null;\n    }\n\n    var dimensions = this._getSliceTable(sliceTableName).dimensions();\n\n    var storage = this._getStorage();\n\n    return storage && storage.getSliceByIds && storage.getSliceByIds(this._getValidIds(dimensions));\n  };\n\n  CustomItem.prototype._getStorage = function () {\n    return this._dataManager() && this._dataManager().getDataStorage();\n  };\n\n  CustomItem.prototype._getValidIds = function (dimensionLinks) {\n    var excluded = [];\n\n    if (this.isDrillDownAllowed() && this._isDrillDownEnabled() && this.interactivityTargets().every(function (d) {\n      return dimensionLinks.filter(function (dd) {\n        return d.uniqueName() === dd.uniqueName();\n      }).length > 0;\n    })) {\n      excluded = this.interactivityTargets().slice(this._drillDownValues().length + 1);\n    }\n\n    return dimensionLinks.filter(function (d) {\n      return excluded.filter(function (dd) {\n        return d.uniqueName() === dd.uniqueName();\n      }).length == 0;\n    }).map(function (d) {\n      return d.uniqueName();\n    });\n  };\n\n  CustomItem.prototype._getColor = function (dataRow, keyIds, colorMeasureId) {\n    var coloredDimensionIds = this._coloredDimensions().map(function (dim) {\n      return dim.uniqueName();\n    }).filter(function (id) {\n      return keyIds.indexOf(id) != -1;\n    }),\n        sliceKey = [];\n\n    if (coloredDimensionIds.length > 0) {\n      var lastColored = coloredDimensionIds[coloredDimensionIds.length - 1];\n\n      for (var i = 0; i < keyIds.length; i++) {\n        var currentId = keyIds[i];\n        sliceKey.push(currentId);\n        if (currentId == lastColored) break;\n      }\n    }\n\n    var colorValue = this._getValueBySliceKey(dataRow, sliceKey, colorMeasureId);\n\n    if (colorValue) return color_1.Color.toHex(colorValue);\n    return null;\n  };\n\n  CustomItem.prototype._getColorMeasureId = function (uniqueName) {\n    if (this.coloringOptions && this._coloredByMeasures()) {\n      var metaData = this._dataManager().getMetaData();\n\n      var colorMeasureDescriptors = metaData.getColorMeasures().filter(function (mi) {\n        return mi.dataItemId === uniqueName;\n      });\n      if (colorMeasureDescriptors && colorMeasureDescriptors.length > 0) return colorMeasureDescriptors[0].id;\n    }\n\n    return COLOR_MEASURE_ID;\n  };\n\n  CustomItem.prototype._format = function (value, formatViewModel) {\n    return !!formatViewModel ? _formatter_1.format(value, formatViewModel) : value.toString();\n  };\n\n  CustomItem.prototype._getServerText = function (dataRow, dataItemUniqueName) {\n    return this._getSpecialValue(dataRow, dataItemUniqueName, _item_data_axis_point_1.dataStorageSpecialIds.DisplayText);\n  };\n\n  CustomItem.prototype._getSpecialValue = function (dataRow, dataItemUniqueName, specialId) {\n    return this._getValueBySliceKey(dataRow, [dataItemUniqueName], specialId);\n  };\n\n  CustomItem.prototype._getValueBySliceKey = function (dataRow, sliceKey, valueId) {\n    var storage = this._getStorage(),\n        metaDataSliceKey = storage.getSliceKey(sliceKey);\n\n    if (metaDataSliceKey < 0) return null;\n    var metaDataRowKey = storage.findDataRowKey(metaDataSliceKey, dataRow);\n    return storage.getValue(metaDataRowKey, valueId);\n  };\n\n  Object.defineProperty(CustomItem.prototype, \"customBindings\", {\n    get: function () {\n      return this._meta && this._meta.bindings || [];\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CustomItem.prototype, \"legacyCustomProperties\", {\n    get: function () {\n      return this._meta && this._meta.properties || [];\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CustomItem.prototype, \"customInteractivity\", {\n    get: function () {\n      return !!this._meta && this._meta.interactivity;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CustomItem.prototype, \"_optionsPanelSections\", {\n    get: function () {\n      return !!this._meta && this._meta.optionsPanelSections;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  CustomItem.prototype._getMasterFilterMode = function () {\n    return this.interactivityOptions instanceof interactivity_options_1.DashboardItemMasterFilterInteractivityOptions ? this.interactivityOptions.masterFilterMode() : 'None';\n  };\n\n  CustomItem.prototype._getDrillDownEnabled = function () {\n    return this.interactivityOptions instanceof interactivity_options_1.DashboardItemInteractivityOptions && this.interactivityOptions.isDrillDownEnabled();\n  };\n\n  CustomItem.prototype._getIgnoreMasterFilter = function () {\n    return !!this.interactivityOptions && this.interactivityOptions.ignoreMasterFilters();\n  };\n\n  CustomItem.prototype._getInteractivityDimensionLinks = function () {\n    return this.interactivityTargets();\n  };\n\n  CustomItem.prototype.isDrillDownAllowed = function () {\n    return CustomItem._isDrillDownAllowed(this._meta);\n  };\n\n  CustomItem.prototype.isFilterAllowed = function () {\n    return CustomItem._isFilterAllowed(this._meta);\n  };\n\n  CustomItem.prototype._isInteractivityAllowed = function () {\n    return this.isDrillDownAllowed() || this.isFilterAllowed();\n  };\n\n  CustomItem.prototype._getCanColorByMeasures = function () {\n    return CustomItem._hasColoringMeasures(this.customBindings);\n  };\n\n  CustomItem.prototype._getCanColorByDimensions = function () {\n    return CustomItem._hasColoringDimensions(this.customBindings);\n  };\n\n  CustomItem.prototype._getColorizableDataItemsInfo = function () {\n    var _this = this;\n\n    return this.customBindings.filter(function (binding) {\n      return binding.enableColoring && binding.dataItemType === 'Dimension';\n    }).map(function (binding) {\n      var prop = _this[CustomItem._getBindingLinkName(binding.propertyName)];\n\n      return {\n        items: binding.array ? prop() : [prop],\n        prefixId: binding.displayName\n      };\n    });\n  };\n\n  CustomItem.prototype._getDefaultCalculationWindowDefinition = function () {\n    return new custom_item_calc_window_definition_1.CustomItemWindowDefinition();\n  };\n\n  CustomItem.prototype.getInfo = function () {\n    return CustomItem._getInfo(this._meta, this.customItemType());\n  };\n\n  CustomItem.prototype._getInfoCore = function () {\n    return null;\n  };\n\n  CustomItem._getCustomPropertiesSerializationInfo = function (customItemType, dynamicCustomPropertiesMetadata) {\n    var filterPredicate = function (cp) {\n      return cp.ownerType === CustomItem && cp.customItemType === customItemType || CustomItem.prototype instanceof cp.ownerType;\n    };\n\n    var filteredCustomProperties = custom_properties_metadata_1._customPropertiesMeta.filter(filterPredicate).concat(dynamicCustomPropertiesMetadata);\n\n    return _custom_properties_utils_1._getCustomPropertiesSerializationInfoCore(filteredCustomProperties);\n  };\n\n  CustomItem.ItemType = 'CustomItem';\n\n  __decorate([_utils_1.collectionItemType('Dimension')], CustomItem.prototype, \"interactivityTargets\", void 0);\n\n  __decorate([_utils_1.collectionItemType('Dimension')], CustomItem.prototype, \"coloringDimensions\", void 0);\n\n  __decorate([_utils_1.collectionItemType('Measure')], CustomItem.prototype, \"coloringMeasures\", void 0);\n\n  return CustomItem;\n}(data_dashboard_item_1.DataDashboardItem);\n\nexports.CustomItem = CustomItem;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/model/items/custom-item/custom-item.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","exports","value","CustomItem","analytics_utils_1","require","ko","_item_data_axis_point_1","special_values_1","_formatter_1","_jquery_helpers_1","color_1","custom_properties_metadata_1","_custom_properties_utils_1","data_item_1","_data_item_1","custom_item_calc_window_definition_1","_knockout_utils_1","_utils_1","_base_metadata_1","data_dashboard_item_1","interactivity_options_1","_coloring_options_1","_custom_item_1","slice_table_1","COLOR_MEASURE_ID","_super","_meta","modelJson","serializer","ModelSerializer","_this","_getInfo","sliceTables","observableArray","interactivityTargets","coloringDimensions","coloringMeasures","customMetadata","_getMeasureValue","dataRow","dataItemUniqueName","_getStorage","getValue","_getMeasureDisplayText","undefined","metaData","_dataManager","getMetaData","formatViewModel","getMeasureFormat","_format","_getDimensionUniqueValue","getKeyValue","_getDimensionValue","_getSpecialValue","dataStorageSpecialIds","Value","specialValues","nullValueGuid","_getDimensionDisplayText","displayText","_getServerText","uniqueValue","olapNullValueGuid","getDimensionFormat","_isExcludingAllFilter","computed","_isMasterFilter","customInteractivity","applyEmptyFilter","selectionValues","_selectionValues","modelCustomMetadata","CustomMetadata","customBindings","forEach","binding","linkPropertyName","_getBindingLinkName","propertyName","array","deserializeArray","item","DataItemLink","_subscribeDataItemLinkArrays","modelName","subscribeArrayChange","added","itemType","dataItemType","observable","_attachDataItem","legacyCustomProperties","pureComputed","read","customProperties","write","setValue","prop","bindings","filter","link","dataItem","sliceTable","name","slice","SliceTable","push","enableInteractivity","concat","enableColoring","DataDashboardItem","_addColoringMeta","subscribe","links","_supportedUIStates","getPropertyInfo","deepExtend","category","PropertyCategory","ViewModel","_getSerializationsInfo","map","info","dataItemLinkSerializationsInfo","_hasInteractivityTargets","meta","some","_hasColoringDimensions","_hasColoringMeasures","_isFilterAllowed","interactivity","_isDrillDownAllowed","drillDown","customItemType","staticCustomPropertiesInfo","_getCustomPropertiesSerializationInfo","customDashboardItemSerializationsInfo","dynamicInfo","isFilterAllowed","isDrillDownAllowed","bindingsInfo","propertiesMetadata","properties","ownerType","defaultValue","defaultVal","cp","_dashboardItemInteractivityOptionsMeta","_masterFilterInteractivityOptionsMeta","_drillDownInteractivityOptionsMeta","_baseInteractivityOptionsMeta","hasColoringDimensions","hasColoringMeasures","coloringOptions","_clearBindings","removeAll","getBindingValue","index","unwrap","bindingValues","wrapBindingValue","displayName","_getDataItemDisplayName","uniqueName","isArray","iterateData","action","sliceTableName","getSlice","keyIds","getKeyIds","valueIds","getValueIds","processDataRow","measureAction","dimensionAction","result","property","indexOf","getColor","measureBindingName","_getColor","_getColorMeasureId","getDisplayText","getUniqueValue","_getDefaultItemType","ItemType","_getSliceTable","_getAllSelectionValues","activeDimensions","every","id","dimensions","dim","values","rowKey","storage","getSliceByIds","_getValidIds","getDataStorage","dimensionLinks","excluded","_isDrillDownEnabled","dd","_drillDownValues","colorMeasureId","coloredDimensionIds","_coloredDimensions","sliceKey","lastColored","currentId","colorValue","_getValueBySliceKey","Color","toHex","_coloredByMeasures","colorMeasureDescriptors","getColorMeasures","mi","dataItemId","format","toString","DisplayText","specialId","valueId","metaDataSliceKey","getSliceKey","metaDataRowKey","findDataRowKey","get","enumerable","configurable","optionsPanelSections","_getMasterFilterMode","interactivityOptions","DashboardItemMasterFilterInteractivityOptions","masterFilterMode","_getDrillDownEnabled","DashboardItemInteractivityOptions","isDrillDownEnabled","_getIgnoreMasterFilter","ignoreMasterFilters","_getInteractivityDimensionLinks","_isInteractivityAllowed","_getCanColorByMeasures","_getCanColorByDimensions","_getColorizableDataItemsInfo","items","prefixId","_getDefaultCalculationWindowDefinition","CustomItemWindowDefinition","getInfo","_getInfoCore","dynamicCustomPropertiesMetadata","filterPredicate","filteredCustomProperties","_customPropertiesMeta","_getCustomPropertiesSerializationInfoCore","collectionItemType"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (custom-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CustomItem = void 0;\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\nvar ko = require(\"knockout\");\nvar _item_data_axis_point_1 = require(\"../../../data/item-data/_item-data-axis-point\");\nvar special_values_1 = require(\"../../../data/special-values\");\nvar _formatter_1 = require(\"../../../data/_formatter\");\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\nvar color_1 = require(\"../../color\");\nvar custom_properties_metadata_1 = require(\"../../custom-properties/custom-properties-metadata\");\nvar _custom_properties_utils_1 = require(\"../../custom-properties/_custom-properties-utils\");\nvar data_item_1 = require(\"../../data-item/data-item\");\nvar _data_item_1 = require(\"../../data-item/metadata/_data-item\");\nvar custom_item_calc_window_definition_1 = require(\"../../data-item/window-definition/custom-item-calc-window-definition\");\nvar _knockout_utils_1 = require(\"../../internal/_knockout-utils\");\nvar _utils_1 = require(\"../../internal/_utils\");\nvar _base_metadata_1 = require(\"../../metadata/_base-metadata\");\nvar data_dashboard_item_1 = require(\"../data-dashboard-item\");\nvar interactivity_options_1 = require(\"../options/interactivity-options\");\nvar _coloring_options_1 = require(\"../options/metadata/_coloring-options\");\nvar _custom_item_1 = require(\"./metadata/_custom-item\");\nvar slice_table_1 = require(\"./slice-table\");\nvar COLOR_MEASURE_ID = 'ColorMeasure';\nvar CustomItem = (function (_super) {\n    __extends(CustomItem, _super);\n    function CustomItem(_meta, modelJson, serializer) {\n        if (modelJson === void 0) { modelJson = {}; }\n        if (serializer === void 0) { serializer = new analytics_utils_1.ModelSerializer(); }\n        var _this = _super.call(this, modelJson, serializer, CustomItem._getInfo(_meta, modelJson['@CustomItemType'])) || this;\n        _this._meta = _meta;\n        _this.sliceTables = ko.observableArray();\n        _this.interactivityTargets = ko.observableArray();\n        _this.coloringDimensions = ko.observableArray();\n        _this.coloringMeasures = ko.observableArray();\n        _this.customMetadata = {};\n        _this._getMeasureValue = function (dataRow, dataItemUniqueName) {\n            return _this._getStorage().getValue(dataRow, dataItemUniqueName);\n        };\n        _this._getMeasureDisplayText = function (dataRow, dataItemUniqueName) {\n            var value = _this._getMeasureValue(dataRow, dataItemUniqueName);\n            if (value === null || value === undefined) {\n                return null;\n            }\n            var metaData = _this._dataManager().getMetaData(), formatViewModel = metaData.getMeasureFormat(dataItemUniqueName);\n            return _this._format(value, formatViewModel);\n        };\n        _this._getDimensionUniqueValue = function (dataRow, dataItemUniqueName) {\n            return _this._getStorage().getKeyValue(dataRow, dataItemUniqueName);\n        };\n        _this._getDimensionValue = function (dataRow, dataItemUniqueName) {\n            var value = _this._getSpecialValue(dataRow, dataItemUniqueName, _item_data_axis_point_1.dataStorageSpecialIds.Value);\n            if (value === null || value === undefined)\n                value = _this._getDimensionUniqueValue(dataRow, dataItemUniqueName);\n            if (value === special_values_1.specialValues.nullValueGuid)\n                value = null;\n            return value;\n        };\n        _this._getDimensionDisplayText = function (dataRow, dataItemUniqueName) {\n            var displayText = _this._getServerText(dataRow, dataItemUniqueName), uniqueValue = _this._getDimensionUniqueValue(dataRow, dataItemUniqueName);\n            if (uniqueValue === special_values_1.specialValues.olapNullValueGuid)\n                return undefined;\n            if (displayText == null) {\n                var metaData = _this._dataManager().getMetaData(), formatViewModel = metaData.getDimensionFormat(dataItemUniqueName);\n                displayText = _this._format(_this._getDimensionValue(dataRow, dataItemUniqueName), formatViewModel);\n            }\n            return displayText;\n        };\n        _this._isExcludingAllFilter = ko.computed(function () {\n            if (_this._isMasterFilter() && !!_this.customInteractivity && !!_this.customInteractivity.applyEmptyFilter) {\n                var selectionValues = _this._selectionValues();\n                return !selectionValues || selectionValues.length === 0;\n            }\n            return false;\n        });\n        var modelCustomMetadata = modelJson.CustomMetadata || {};\n        _this.customBindings.forEach(function (binding) {\n            var linkPropertyName = CustomItem._getBindingLinkName(binding.propertyName);\n            if (binding.array) {\n                _this[linkPropertyName] = analytics_utils_1.deserializeArray(modelCustomMetadata[binding.propertyName], function (item) { return new data_item_1.DataItemLink(_this, item, serializer); });\n                _this[binding.propertyName] = ko.observableArray([]);\n                _this._subscribeDataItemLinkArrays({ propertyName: linkPropertyName, modelName: binding.propertyName });\n                _knockout_utils_1.subscribeArrayChange(_this[linkPropertyName], {\n                    added: function (item) { return item.itemType(binding.dataItemType); }\n                });\n            }\n            else {\n                _this[binding.propertyName] = ko.observable();\n                _this._attachDataItem(_this, linkPropertyName, new data_item_1.DataItemLink(_this, modelCustomMetadata[binding.propertyName], serializer));\n            }\n            _this.customMetadata[linkPropertyName] = _this[linkPropertyName];\n        });\n        _this.legacyCustomProperties.forEach(function (p) {\n            _this.customMetadata[p.propertyName] = _this[p.propertyName] = ko.pureComputed({\n                read: function () { return _this.customProperties[p.propertyName](); },\n                write: function (value) { return _this.customProperties.setValue(p.propertyName, value); },\n            });\n        });\n        ko.computed(function () {\n            var sliceTables = [];\n            var interactivityTargets = [];\n            var coloringDimensions = [];\n            var coloringMeasures = [];\n            _this.customBindings.forEach(function (binding) {\n                var prop = _this[CustomItem._getBindingLinkName(binding.propertyName)];\n                var bindings = (binding.array ? prop() : [prop]).filter(function (link) { return !!link.dataItem(); });\n                var sliceTable = sliceTables.filter(function (sliceTable) { return sliceTable.name() === binding.slice; })[0];\n                if (!sliceTable) {\n                    sliceTable = new slice_table_1.SliceTable(_this, { '@ItemType': 'SliceTable', '@Name': binding.slice });\n                    sliceTables.push(sliceTable);\n                }\n                sliceTable.push(bindings, binding.dataItemType);\n                if (binding.enableInteractivity) {\n                    interactivityTargets = interactivityTargets.concat(bindings);\n                }\n                if (binding.enableColoring) {\n                    if (binding.dataItemType === 'Dimension') {\n                        bindings.forEach(function (link) { return data_dashboard_item_1.DataDashboardItem._addColoringMeta([link]); });\n                        if (binding.array) {\n                            prop.subscribe(function (links) { return data_dashboard_item_1.DataDashboardItem._addColoringMeta(links); });\n                        }\n                        coloringDimensions = coloringDimensions.concat(bindings);\n                    }\n                    if (binding.dataItemType === 'Measure') {\n                        coloringMeasures = coloringMeasures.concat(bindings);\n                    }\n                }\n            });\n            _this.sliceTables(sliceTables);\n            _this.interactivityTargets(interactivityTargets);\n            _this.coloringDimensions(coloringDimensions);\n            _this.coloringMeasures(coloringMeasures);\n        });\n        if (!_this.customBindings.length) {\n            _this._supportedUIStates(['error']);\n        }\n        return _this;\n    }\n    CustomItem.getPropertyInfo = function (p) {\n        return _jquery_helpers_1.deepExtend({ modelName: '@' + p.propertyName, category: _base_metadata_1.PropertyCategory.ViewModel }, p);\n    };\n    CustomItem._getBindingLinkName = function (propertyName) {\n        return '__' + propertyName;\n    };\n    CustomItem._getSerializationsInfo = function (bindings) {\n        return (bindings || []).map(function (binding) {\n            return {\n                propertyName: CustomItem._getBindingLinkName(binding.propertyName),\n                modelName: binding.propertyName,\n                array: binding.array,\n                info: !binding.array ? _data_item_1.dataItemLinkSerializationsInfo : undefined\n            };\n        });\n    };\n    CustomItem._hasInteractivityTargets = function (meta) {\n        var bindings = (meta && meta['bindings']) || [];\n        return bindings.some(function (binding) { return binding.enableInteractivity; });\n    };\n    CustomItem._hasColoringDimensions = function (bindings) {\n        return bindings.some(function (binding) { return binding.enableColoring && binding.dataItemType === 'Dimension'; });\n    };\n    CustomItem._hasColoringMeasures = function (bindings) {\n        return bindings.some(function (binding) { return binding.enableColoring && binding.dataItemType === 'Measure'; });\n    };\n    CustomItem._isFilterAllowed = function (meta) {\n        var interactivity = !!meta && meta['interactivity'];\n        return !!interactivity && interactivity.filter && CustomItem._hasInteractivityTargets(meta);\n    };\n    CustomItem._isDrillDownAllowed = function (meta) {\n        var interactivity = !!meta && meta['interactivity'];\n        return !!interactivity && interactivity.drillDown && CustomItem._hasInteractivityTargets(meta);\n    };\n    CustomItem._getInfo = function (meta, customItemType) {\n        if (!meta) {\n            var staticCustomPropertiesInfo = CustomItem._getCustomPropertiesSerializationInfo(customItemType, []);\n            return _custom_item_1.customDashboardItemSerializationsInfo.concat([staticCustomPropertiesInfo]);\n        }\n        var dynamicInfo = [];\n        var bindings = (meta && meta.bindings) || [];\n        var isFilterAllowed = CustomItem._isFilterAllowed(meta);\n        var isDrillDownAllowed = CustomItem._isDrillDownAllowed(meta);\n        var bindingsInfo = CustomItem._getSerializationsInfo(bindings);\n        var propertiesMetadata = ((meta && meta.properties) || [])\n            .map(function (p) { return ({\n            ownerType: CustomItem,\n            customItemType: customItemType,\n            propertyName: p.propertyName,\n            defaultValue: p.defaultVal,\n        }); })\n            .concat((meta && meta.customProperties))\n            .filter(function (cp) { return !!cp; });\n        var customProperties = CustomItem._getCustomPropertiesSerializationInfo(customItemType, propertiesMetadata);\n        if (isFilterAllowed && isDrillDownAllowed) {\n            dynamicInfo.push(interactivity_options_1._dashboardItemInteractivityOptionsMeta);\n        }\n        else if (isFilterAllowed) {\n            dynamicInfo.push(interactivity_options_1._masterFilterInteractivityOptionsMeta);\n        }\n        else if (isDrillDownAllowed) {\n            dynamicInfo.push(interactivity_options_1._drillDownInteractivityOptionsMeta);\n        }\n        else {\n            dynamicInfo.push(interactivity_options_1._baseInteractivityOptionsMeta);\n        }\n        var hasColoringDimensions = CustomItem._hasColoringDimensions(bindings);\n        if (hasColoringDimensions) {\n            dynamicInfo.push(_custom_item_1.coloringDimensions);\n        }\n        var hasColoringMeasures = CustomItem._hasColoringMeasures(bindings);\n        if (hasColoringMeasures) {\n            dynamicInfo.push(_custom_item_1.coloringMeasures);\n        }\n        if (hasColoringDimensions || hasColoringMeasures) {\n            dynamicInfo.push(_coloring_options_1.coloringOptions);\n        }\n        return _custom_item_1.customDashboardItemSerializationsInfo\n            .concat([{ propertyName: 'customMetadata', modelName: 'CustomMetadata', info: bindingsInfo }])\n            .concat(dynamicInfo)\n            .concat(customProperties);\n    };\n    CustomItem.prototype._clearBindings = function () {\n        var _this = this;\n        _super.prototype._clearBindings.call(this);\n        this.customBindings.forEach(function (binding) {\n            if (binding.array) {\n                _this[CustomItem._getBindingLinkName(binding.propertyName)].removeAll();\n            }\n        });\n    };\n    CustomItem.prototype.getBindingValue = function (propertyName, index) {\n        var _this = this;\n        var binding = ko.unwrap(this[CustomItem._getBindingLinkName(propertyName)]);\n        var bindingValues = undefined;\n        var wrapBindingValue = function (binding) {\n            return !binding.dataItem() ? undefined : {\n                displayName: function () { return _this._getDataItemDisplayName(binding.dataItem()); },\n                uniqueName: function () { return binding.uniqueName(); }\n            };\n        };\n        if (Array.isArray(binding)) {\n            bindingValues = index != undefined ? [wrapBindingValue(binding[index])] : binding.map(function (b) { return wrapBindingValue(b); });\n        }\n        else {\n            bindingValues = [wrapBindingValue(binding)];\n        }\n        return bindingValues.filter(function (b) { return b !== undefined; });\n    };\n    CustomItem.prototype.iterateData = function (action, sliceTableName) {\n        var _this = this;\n        if (sliceTableName === void 0) { sliceTableName = null; }\n        var slice = this.getSlice(sliceTableName);\n        if (!slice)\n            return;\n        var keyIds = slice.getKeyIds() || [], valueIds = slice.getValueIds() || [], processDataRow = function (dataRow, propertyName, measureAction, dimensionAction) {\n            var binding = _this.customBindings.filter(function (b) { return b.propertyName === propertyName; })[0], result = [];\n            if (!!binding) {\n                var property = _this[CustomItem._getBindingLinkName(propertyName)];\n                (binding.array ? property() : [property]).forEach(function (item) {\n                    var uniqueName = item.uniqueName();\n                    if (keyIds.indexOf(uniqueName) != -1)\n                        result.push(dimensionAction(dataRow, uniqueName));\n                    if (valueIds.indexOf(uniqueName) != -1)\n                        result.push(measureAction(dataRow, uniqueName));\n                });\n            }\n            return result;\n        };\n        slice.forEach(function (dataRow) {\n            action({\n                getColor: function (measureBindingName) {\n                    if (!measureBindingName) {\n                        return [_this._getColor(dataRow, keyIds, COLOR_MEASURE_ID)];\n                    }\n                    else {\n                        return processDataRow(dataRow, measureBindingName, function (dataRow, uniqueName) { return _this._getColor(dataRow, keyIds, _this._getColorMeasureId(uniqueName)); }, function (dataRow, uniqueName) { return _this._getColor(dataRow, keyIds, COLOR_MEASURE_ID); });\n                    }\n                },\n                getDisplayText: function (property) {\n                    return processDataRow(dataRow, property, _this._getMeasureDisplayText, _this._getDimensionDisplayText);\n                },\n                getValue: function (property) {\n                    return processDataRow(dataRow, property, _this._getMeasureValue, _this._getDimensionValue);\n                },\n                getUniqueValue: function (property) {\n                    return processDataRow(dataRow, property, _this._getMeasureValue, _this._getDimensionUniqueValue);\n                }\n            });\n        });\n    };\n    CustomItem.prototype._getDefaultItemType = function () {\n        return CustomItem.ItemType;\n    };\n    CustomItem.prototype._getSliceTable = function (name) {\n        var sliceTables = this.sliceTables();\n        if (!!name) {\n            return sliceTables.filter(function (slice) { return slice.name() === name; })[0];\n        }\n        else {\n            return sliceTables.length > 0 ? sliceTables[0] : undefined;\n        }\n    };\n    CustomItem.prototype._getAllSelectionValues = function (activeDimensions) {\n        var sliceTables = this.sliceTables().filter(function (slice) { return activeDimensions.every(function (id) { return slice.dimensions().map(function (dim) { return dim.uniqueName(); }).indexOf(id) !== -1; }); }), values = [];\n        if (sliceTables.length > 0) {\n            var slice = this.getSlice(sliceTables[0].name());\n            if (!!slice) {\n                var keyIds = slice.getKeyIds().filter(function (id) { return activeDimensions.indexOf(id) !== -1; });\n                slice.forEach(function (dataRow) { return values.push(keyIds.map(function (id) { return slice.getKeyValue(dataRow.rowKey, id); })); });\n            }\n        }\n        return values;\n    };\n    CustomItem.prototype.getSlice = function (sliceTableName) {\n        if (sliceTableName === void 0) { sliceTableName = null; }\n        var dimensions = this._getSliceTable(sliceTableName).dimensions();\n        var storage = this._getStorage();\n        return storage && storage.getSliceByIds && storage.getSliceByIds(this._getValidIds(dimensions));\n    };\n    CustomItem.prototype._getStorage = function () {\n        return this._dataManager() && this._dataManager().getDataStorage();\n    };\n    CustomItem.prototype._getValidIds = function (dimensionLinks) {\n        var excluded = [];\n        if (this.isDrillDownAllowed() && this._isDrillDownEnabled() && this.interactivityTargets().every(function (d) { return dimensionLinks.filter(function (dd) { return d.uniqueName() === dd.uniqueName(); }).length > 0; })) {\n            excluded = this.interactivityTargets().slice(this._drillDownValues().length + 1);\n        }\n        return dimensionLinks.filter(function (d) { return excluded.filter(function (dd) { return d.uniqueName() === dd.uniqueName(); }).length == 0; }).map(function (d) { return d.uniqueName(); });\n    };\n    CustomItem.prototype._getColor = function (dataRow, keyIds, colorMeasureId) {\n        var coloredDimensionIds = this._coloredDimensions().map(function (dim) { return dim.uniqueName(); }).filter(function (id) { return keyIds.indexOf(id) != -1; }), sliceKey = [];\n        if (coloredDimensionIds.length > 0) {\n            var lastColored = coloredDimensionIds[coloredDimensionIds.length - 1];\n            for (var i = 0; i < keyIds.length; i++) {\n                var currentId = keyIds[i];\n                sliceKey.push(currentId);\n                if (currentId == lastColored)\n                    break;\n            }\n        }\n        var colorValue = this._getValueBySliceKey(dataRow, sliceKey, colorMeasureId);\n        if (colorValue)\n            return color_1.Color.toHex(colorValue);\n        return null;\n    };\n    CustomItem.prototype._getColorMeasureId = function (uniqueName) {\n        if (this.coloringOptions && this._coloredByMeasures()) {\n            var metaData = this._dataManager().getMetaData();\n            var colorMeasureDescriptors = metaData.getColorMeasures().filter(function (mi) { return mi.dataItemId === uniqueName; });\n            if (colorMeasureDescriptors && colorMeasureDescriptors.length > 0)\n                return colorMeasureDescriptors[0].id;\n        }\n        return COLOR_MEASURE_ID;\n    };\n    CustomItem.prototype._format = function (value, formatViewModel) {\n        return !!formatViewModel ? _formatter_1.format(value, formatViewModel) : value.toString();\n    };\n    CustomItem.prototype._getServerText = function (dataRow, dataItemUniqueName) {\n        return this._getSpecialValue(dataRow, dataItemUniqueName, _item_data_axis_point_1.dataStorageSpecialIds.DisplayText);\n    };\n    CustomItem.prototype._getSpecialValue = function (dataRow, dataItemUniqueName, specialId) {\n        return this._getValueBySliceKey(dataRow, [dataItemUniqueName], specialId);\n    };\n    CustomItem.prototype._getValueBySliceKey = function (dataRow, sliceKey, valueId) {\n        var storage = this._getStorage(), metaDataSliceKey = storage.getSliceKey(sliceKey);\n        if (metaDataSliceKey < 0)\n            return null;\n        var metaDataRowKey = storage.findDataRowKey(metaDataSliceKey, dataRow);\n        return storage.getValue(metaDataRowKey, valueId);\n    };\n    Object.defineProperty(CustomItem.prototype, \"customBindings\", {\n        get: function () {\n            return (this._meta && this._meta.bindings) || [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(CustomItem.prototype, \"legacyCustomProperties\", {\n        get: function () {\n            return (this._meta && this._meta.properties) || [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(CustomItem.prototype, \"customInteractivity\", {\n        get: function () {\n            return !!this._meta && this._meta.interactivity;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(CustomItem.prototype, \"_optionsPanelSections\", {\n        get: function () {\n            return !!this._meta && this._meta.optionsPanelSections;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    CustomItem.prototype._getMasterFilterMode = function () {\n        return this.interactivityOptions instanceof interactivity_options_1.DashboardItemMasterFilterInteractivityOptions ? this.interactivityOptions.masterFilterMode() : 'None';\n    };\n    CustomItem.prototype._getDrillDownEnabled = function () {\n        return this.interactivityOptions instanceof interactivity_options_1.DashboardItemInteractivityOptions && this.interactivityOptions.isDrillDownEnabled();\n    };\n    CustomItem.prototype._getIgnoreMasterFilter = function () { return !!this.interactivityOptions && this.interactivityOptions.ignoreMasterFilters(); };\n    CustomItem.prototype._getInteractivityDimensionLinks = function () { return this.interactivityTargets(); };\n    CustomItem.prototype.isDrillDownAllowed = function () {\n        return CustomItem._isDrillDownAllowed(this._meta);\n    };\n    CustomItem.prototype.isFilterAllowed = function () {\n        return CustomItem._isFilterAllowed(this._meta);\n    };\n    CustomItem.prototype._isInteractivityAllowed = function () {\n        return this.isDrillDownAllowed() || this.isFilterAllowed();\n    };\n    CustomItem.prototype._getCanColorByMeasures = function () { return CustomItem._hasColoringMeasures(this.customBindings); };\n    CustomItem.prototype._getCanColorByDimensions = function () { return CustomItem._hasColoringDimensions(this.customBindings); };\n    CustomItem.prototype._getColorizableDataItemsInfo = function () {\n        var _this = this;\n        return this.customBindings.filter(function (binding) { return binding.enableColoring && binding.dataItemType === 'Dimension'; }).map(function (binding) {\n            var prop = _this[CustomItem._getBindingLinkName(binding.propertyName)];\n            return {\n                items: binding.array ? prop() : [prop],\n                prefixId: binding.displayName\n            };\n        });\n    };\n    CustomItem.prototype._getDefaultCalculationWindowDefinition = function () {\n        return new custom_item_calc_window_definition_1.CustomItemWindowDefinition();\n    };\n    CustomItem.prototype.getInfo = function () {\n        return CustomItem._getInfo(this._meta, this.customItemType());\n    };\n    CustomItem.prototype._getInfoCore = function () {\n        return null;\n    };\n    CustomItem._getCustomPropertiesSerializationInfo = function (customItemType, dynamicCustomPropertiesMetadata) {\n        var filterPredicate = function (cp) { return cp.ownerType === CustomItem && cp.customItemType === customItemType || CustomItem.prototype instanceof cp.ownerType; };\n        var filteredCustomProperties = custom_properties_metadata_1._customPropertiesMeta\n            .filter(filterPredicate)\n            .concat(dynamicCustomPropertiesMetadata);\n        return _custom_properties_utils_1._getCustomPropertiesSerializationInfoCore(filteredCustomProperties);\n    };\n    CustomItem.ItemType = 'CustomItem';\n    __decorate([\n        _utils_1.collectionItemType('Dimension')\n    ], CustomItem.prototype, \"interactivityTargets\", void 0);\n    __decorate([\n        _utils_1.collectionItemType('Dimension')\n    ], CustomItem.prototype, \"coloringDimensions\", void 0);\n    __decorate([\n        _utils_1.collectionItemType('Measure')\n    ], CustomItem.prototype, \"coloringMeasures\", void 0);\n    return CustomItem;\n}(data_dashboard_item_1.DataDashboardItem));\nexports.CustomItem = CustomItem;\n"]},"metadata":{},"sourceType":"script"}