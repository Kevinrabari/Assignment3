{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_drag-controller.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LayoutDragController = void 0;\n\nvar events_1 = require(\"devextreme/events\");\n\nvar ko = require(\"knockout\");\n\nvar _layout_item_1 = require(\"../core/_layout-item\");\n\nvar _layout_drag_over_state_1 = require(\"./_layout-drag-over-state\");\n\nvar _layout_item_drag_item_1 = require(\"./_layout-item-drag-item\");\n\nvar _scroll_animator_1 = require(\"./_scroll-animator\");\n\nvar LayoutDragController = function () {\n  function LayoutDragController() {\n    this._dragOverState = new _layout_drag_over_state_1.DragOverStateController();\n    this._layoutMainElement = null;\n    this._externalElements = [];\n    this._firstOverEvent = false;\n  }\n\n  LayoutDragController.prototype.initScrollAnimator = function (scrollViewProvider) {\n    this._scrollAnimator = new _scroll_animator_1.ScrollAnimator(scrollViewProvider);\n  };\n\n  LayoutDragController.prototype.cleanScrollAnimator = function () {\n    this._scrollAnimator && this._scrollAnimator.dispose();\n    this._scrollAnimator = null;\n  };\n\n  LayoutDragController.prototype.initLayoutMainElement = function (element) {\n    var _this = this;\n\n    if (this._layoutMainElement) {\n      throw new Error('Layout main element already initialized');\n    }\n\n    this._layoutMainElement = element;\n    events_1.on(element, 'dragstart.dx-layout-drag', '.dx-layout-item-plate', function (args) {\n      var originalEvent = args.originalEvent;\n      var item = ko.dataFor(originalEvent.target);\n\n      if (item instanceof _layout_item_1.LayoutItem) {\n        _this._onDragStart(args, new _layout_item_drag_item_1.LayoutItemDragItemInfo(item));\n\n        return true;\n      }\n    });\n    events_1.on(element, 'dragover.dx-layout-drag', function (args) {\n      var originalEvent = args.originalEvent;\n      var item = ko.dataFor(originalEvent.target);\n\n      _this._onDragOver(args, item);\n    });\n    events_1.on(element, 'drag.dx-layout-drag', function (args) {\n      return _this._onDrag(args);\n    });\n    events_1.on(element, 'dragleave.dx-layout-drag', function (args) {\n      return _this._onDragLeave();\n    });\n    events_1.on(element, 'drop.dx-layout-drag', function (args) {\n      return _this._onDrop(args);\n    });\n    events_1.on(element, 'dragend.dx-layout-drag', function (args) {\n      return _this._onDragEnd();\n    });\n  };\n\n  LayoutDragController.prototype.cleanLayoutMainElement = function (element) {\n    if (this._layoutMainElement === element) {\n      events_1.off(element, '.dx-layout-drag');\n      this._layoutMainElement = null;\n    }\n  };\n\n  LayoutDragController.prototype.initExternalElement = function (element, dragItemInfo) {\n    var _this = this;\n\n    this._externalElements.push(element);\n\n    events_1.on(element, 'dragstart.dx-layout-drag', function (args) {\n      _this._onDragStart(args, dragItemInfo);\n    });\n    events_1.on(element, 'drag.dx-layout-drag', function (args) {\n      return _this._onDrag(args);\n    });\n    events_1.on(element, 'dragend.dx-layout-drag', function (args) {\n      return _this._onDragEnd();\n    });\n  };\n\n  LayoutDragController.prototype.cleanExternalElement = function (element) {\n    this._externalElements && this._externalElements.splice(this._externalElements.indexOf(element), 1);\n    events_1.off(element, '.dx-layout-drag');\n  };\n\n  LayoutDragController.prototype.dispose = function () {\n    var _this = this;\n\n    this.cleanScrollAnimator();\n    this.cleanLayoutMainElement(this._layoutMainElement);\n    this._externalElements && this._externalElements.slice().forEach(function (element) {\n      return _this.cleanExternalElement(element);\n    });\n    this._externalElements = null;\n  };\n\n  LayoutDragController.prototype._onDragStart = function (eventArgs, dragData) {\n    var originalEvent = eventArgs.originalEvent;\n    originalEvent.dataTransfer.effectAllowed = 'move';\n    this._dragData = dragData;\n    this._firstOverEvent = true;\n\n    this._dragOverState.reset();\n\n    this._scrollAnimator && this._scrollAnimator.start();\n  };\n\n  LayoutDragController.prototype._onDragOver = function (eventArgs, targetLayoutItem) {\n    var originalEvent = eventArgs.originalEvent;\n    var cursorClientX = originalEvent.clientX;\n    var cursorClientY = originalEvent.clientY;\n    var targetElement = eventArgs.target;\n\n    if (this._firstOverEvent) {\n      this._dragData.dragStart();\n\n      this._firstOverEvent = false;\n    }\n\n    if (targetLayoutItem instanceof _layout_item_1.LayoutItem && this._dragData && this._dragData.canDrop(targetLayoutItem)) {\n      var dragOverController = targetLayoutItem.viewModel.dragOverInnerElementController;\n\n      if (dragOverController) {\n        var index = findElementIndex(targetElement, dragOverController.selector, cursorClientX, cursorClientY);\n\n        if (index !== -1) {\n          dragOverController.onDragOver(index);\n        }\n      }\n\n      var itemBounds = targetElement.getBoundingClientRect();\n      var currentHoverLocation = getLocation(cursorClientX - itemBounds.left, cursorClientY - itemBounds.top, itemBounds.width, itemBounds.height);\n\n      this._dragOverState.update(targetLayoutItem, currentHoverLocation);\n\n      eventArgs.preventDefault();\n      return true;\n    } else {\n      this._dragOverState.reset();\n    }\n  };\n\n  LayoutDragController.prototype._onDragLeave = function () {\n    this._dragOverState.reset();\n  };\n\n  LayoutDragController.prototype._onDrop = function (eventArgs) {\n    var dragOverState = this._dragOverState.getState();\n\n    if (dragOverState) {\n      this._dragData.drop(dragOverState);\n\n      eventArgs.stopPropagation();\n    }\n\n    this._onDragEnd();\n  };\n\n  LayoutDragController.prototype._onDrag = function (eventArgs) {\n    if (this._scrollAnimator) {\n      var originalEvent = eventArgs.originalEvent;\n\n      this._scrollAnimator.updateCursorPosition(originalEvent.clientX, originalEvent.clientY);\n    }\n  };\n\n  LayoutDragController.prototype._onDragEnd = function () {\n    this._scrollAnimator && this._scrollAnimator.stop();\n\n    this._dragOverState.reset();\n\n    this._dragData && this._dragData.dragEnd();\n    this._dragData = null;\n  };\n\n  return LayoutDragController;\n}();\n\nexports.LayoutDragController = LayoutDragController;\n\nvar getLocation = function (x, y, width, height) {\n  if (y >= height / width * x) {\n    return y >= -height / width * x + height ? 'bottom' : 'left';\n  } else {\n    return y >= -height / width * x + height ? 'right' : 'top';\n  }\n};\n\nvar findElementIndex = function (originalElement, selector, mouseClientX, mouseClientY) {\n  var elements = originalElement.parentElement.querySelectorAll(selector);\n\n  for (var index = 0; index < elements.length; index++) {\n    var element = elements[index];\n    var rect = element.getBoundingClientRect();\n\n    if (rect.left < mouseClientX && rect.right > mouseClientX && rect.top < mouseClientY && rect.bottom > mouseClientY) {\n      return index;\n    }\n  }\n\n  return -1;\n};","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/common/docking-layout/drag-and-drop/_drag-controller.js"],"names":["Object","defineProperty","exports","value","LayoutDragController","events_1","require","ko","_layout_item_1","_layout_drag_over_state_1","_layout_item_drag_item_1","_scroll_animator_1","_dragOverState","DragOverStateController","_layoutMainElement","_externalElements","_firstOverEvent","prototype","initScrollAnimator","scrollViewProvider","_scrollAnimator","ScrollAnimator","cleanScrollAnimator","dispose","initLayoutMainElement","element","_this","Error","on","args","originalEvent","item","dataFor","target","LayoutItem","_onDragStart","LayoutItemDragItemInfo","_onDragOver","_onDrag","_onDragLeave","_onDrop","_onDragEnd","cleanLayoutMainElement","off","initExternalElement","dragItemInfo","push","cleanExternalElement","splice","indexOf","slice","forEach","eventArgs","dragData","dataTransfer","effectAllowed","_dragData","reset","start","targetLayoutItem","cursorClientX","clientX","cursorClientY","clientY","targetElement","dragStart","canDrop","dragOverController","viewModel","dragOverInnerElementController","index","findElementIndex","selector","onDragOver","itemBounds","getBoundingClientRect","currentHoverLocation","getLocation","left","top","width","height","update","preventDefault","dragOverState","getState","drop","stopPropagation","updateCursorPosition","stop","dragEnd","x","y","originalElement","mouseClientX","mouseClientY","elements","parentElement","querySelectorAll","length","rect","right","bottom"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_drag-controller.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LayoutDragController = void 0;\nvar events_1 = require(\"devextreme/events\");\nvar ko = require(\"knockout\");\nvar _layout_item_1 = require(\"../core/_layout-item\");\nvar _layout_drag_over_state_1 = require(\"./_layout-drag-over-state\");\nvar _layout_item_drag_item_1 = require(\"./_layout-item-drag-item\");\nvar _scroll_animator_1 = require(\"./_scroll-animator\");\nvar LayoutDragController = (function () {\n    function LayoutDragController() {\n        this._dragOverState = new _layout_drag_over_state_1.DragOverStateController();\n        this._layoutMainElement = null;\n        this._externalElements = [];\n        this._firstOverEvent = false;\n    }\n    LayoutDragController.prototype.initScrollAnimator = function (scrollViewProvider) {\n        this._scrollAnimator = new _scroll_animator_1.ScrollAnimator(scrollViewProvider);\n    };\n    LayoutDragController.prototype.cleanScrollAnimator = function () {\n        this._scrollAnimator && this._scrollAnimator.dispose();\n        this._scrollAnimator = null;\n    };\n    LayoutDragController.prototype.initLayoutMainElement = function (element) {\n        var _this = this;\n        if (this._layoutMainElement) {\n            throw new Error('Layout main element already initialized');\n        }\n        this._layoutMainElement = element;\n        events_1.on(element, 'dragstart.dx-layout-drag', '.dx-layout-item-plate', function (args) {\n            var originalEvent = args.originalEvent;\n            var item = ko.dataFor(originalEvent.target);\n            if (item instanceof _layout_item_1.LayoutItem) {\n                _this._onDragStart(args, new _layout_item_drag_item_1.LayoutItemDragItemInfo(item));\n                return true;\n            }\n        });\n        events_1.on(element, 'dragover.dx-layout-drag', function (args) {\n            var originalEvent = args.originalEvent;\n            var item = ko.dataFor(originalEvent.target);\n            _this._onDragOver(args, item);\n        });\n        events_1.on(element, 'drag.dx-layout-drag', function (args) { return _this._onDrag(args); });\n        events_1.on(element, 'dragleave.dx-layout-drag', function (args) { return _this._onDragLeave(); });\n        events_1.on(element, 'drop.dx-layout-drag', function (args) { return _this._onDrop(args); });\n        events_1.on(element, 'dragend.dx-layout-drag', function (args) { return _this._onDragEnd(); });\n    };\n    LayoutDragController.prototype.cleanLayoutMainElement = function (element) {\n        if (this._layoutMainElement === element) {\n            events_1.off(element, '.dx-layout-drag');\n            this._layoutMainElement = null;\n        }\n    };\n    LayoutDragController.prototype.initExternalElement = function (element, dragItemInfo) {\n        var _this = this;\n        this._externalElements.push(element);\n        events_1.on(element, 'dragstart.dx-layout-drag', function (args) {\n            _this._onDragStart(args, dragItemInfo);\n        });\n        events_1.on(element, 'drag.dx-layout-drag', function (args) { return _this._onDrag(args); });\n        events_1.on(element, 'dragend.dx-layout-drag', function (args) { return _this._onDragEnd(); });\n    };\n    LayoutDragController.prototype.cleanExternalElement = function (element) {\n        this._externalElements && this._externalElements.splice(this._externalElements.indexOf(element), 1);\n        events_1.off(element, '.dx-layout-drag');\n    };\n    LayoutDragController.prototype.dispose = function () {\n        var _this = this;\n        this.cleanScrollAnimator();\n        this.cleanLayoutMainElement(this._layoutMainElement);\n        this._externalElements && this._externalElements.slice().forEach(function (element) { return _this.cleanExternalElement(element); });\n        this._externalElements = null;\n    };\n    LayoutDragController.prototype._onDragStart = function (eventArgs, dragData) {\n        var originalEvent = eventArgs.originalEvent;\n        originalEvent.dataTransfer.effectAllowed = 'move';\n        this._dragData = dragData;\n        this._firstOverEvent = true;\n        this._dragOverState.reset();\n        this._scrollAnimator && this._scrollAnimator.start();\n    };\n    LayoutDragController.prototype._onDragOver = function (eventArgs, targetLayoutItem) {\n        var originalEvent = eventArgs.originalEvent;\n        var cursorClientX = originalEvent.clientX;\n        var cursorClientY = originalEvent.clientY;\n        var targetElement = eventArgs.target;\n        if (this._firstOverEvent) {\n            this._dragData.dragStart();\n            this._firstOverEvent = false;\n        }\n        if (targetLayoutItem instanceof _layout_item_1.LayoutItem && this._dragData && this._dragData.canDrop(targetLayoutItem)) {\n            var dragOverController = targetLayoutItem.viewModel.dragOverInnerElementController;\n            if (dragOverController) {\n                var index = findElementIndex(targetElement, dragOverController.selector, cursorClientX, cursorClientY);\n                if (index !== -1) {\n                    dragOverController.onDragOver(index);\n                }\n            }\n            var itemBounds = targetElement.getBoundingClientRect();\n            var currentHoverLocation = getLocation(cursorClientX - itemBounds.left, cursorClientY - itemBounds.top, itemBounds.width, itemBounds.height);\n            this._dragOverState.update(targetLayoutItem, currentHoverLocation);\n            eventArgs.preventDefault();\n            return true;\n        }\n        else {\n            this._dragOverState.reset();\n        }\n    };\n    LayoutDragController.prototype._onDragLeave = function () {\n        this._dragOverState.reset();\n    };\n    LayoutDragController.prototype._onDrop = function (eventArgs) {\n        var dragOverState = this._dragOverState.getState();\n        if (dragOverState) {\n            this._dragData.drop(dragOverState);\n            eventArgs.stopPropagation();\n        }\n        this._onDragEnd();\n    };\n    LayoutDragController.prototype._onDrag = function (eventArgs) {\n        if (this._scrollAnimator) {\n            var originalEvent = eventArgs.originalEvent;\n            this._scrollAnimator.updateCursorPosition(originalEvent.clientX, originalEvent.clientY);\n        }\n    };\n    LayoutDragController.prototype._onDragEnd = function () {\n        this._scrollAnimator && this._scrollAnimator.stop();\n        this._dragOverState.reset();\n        this._dragData && this._dragData.dragEnd();\n        this._dragData = null;\n    };\n    return LayoutDragController;\n}());\nexports.LayoutDragController = LayoutDragController;\nvar getLocation = function (x, y, width, height) {\n    if (y >= height / width * x) {\n        return (y >= -height / width * x + height) ? 'bottom' : 'left';\n    }\n    else {\n        return (y >= -height / width * x + height) ? 'right' : 'top';\n    }\n};\nvar findElementIndex = function (originalElement, selector, mouseClientX, mouseClientY) {\n    var elements = originalElement\n        .parentElement\n        .querySelectorAll(selector);\n    for (var index = 0; index < elements.length; index++) {\n        var element = elements[index];\n        var rect = element.getBoundingClientRect();\n        if (rect.left < mouseClientX && rect.right > mouseClientX\n            && rect.top < mouseClientY && rect.bottom > mouseClientY) {\n            return index;\n        }\n    }\n    return -1;\n};\n"]},"metadata":{},"sourceType":"script"}