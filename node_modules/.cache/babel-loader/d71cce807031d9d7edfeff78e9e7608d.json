{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/diagram/ui.diagram.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getOuterWidth, getHeight, getOuterHeight } from \"../../core/utils/size\";\nimport $ from \"../../core/renderer\";\nimport Widget from \"../widget/ui.widget\";\nimport LoadIndicator from \"../load_indicator\";\nimport registerComponent from \"../../core/component_registrator\";\nimport { extend } from \"../../core/utils/extend\";\nimport { isFunction, isDefined } from \"../../core/utils/type\";\nimport { compileSetter, compileGetter } from \"../../core/utils/data\";\nimport positionUtils from \"../../animation/position\";\nimport { getDiagram } from \"./diagram.importer\";\nimport { getWindow, hasWindow } from \"../../core/utils/window\";\nimport { getPublicElement } from \"../../core/element\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { addNamespace } from \"../../events/utils/index\";\nimport messageLocalization from \"../../localization/message\";\nimport numberLocalization from \"../../localization/number\";\nimport * as zIndexPool from \"../overlay/z_index\";\nimport Overlay from \"../overlay/ui.overlay\";\nimport DiagramToolbar from \"./ui.diagram.toolbar\";\nimport DiagramMainToolbar from \"./ui.diagram.main_toolbar\";\nimport DiagramHistoryToolbar from \"./ui.diagram.history_toolbar\";\nimport DiagramViewToolbar from \"./ui.diagram.view_toolbar\";\nimport DiagramPropertiesToolbar from \"./ui.diagram.properties_toolbar\";\nimport diagramContextMenuModule from \"./ui.diagram.context_menu\";\nimport DiagramContextToolbox from \"./ui.diagram.context_toolbox\";\nimport DiagramDialog from \"./ui.diagram.dialogs\";\nimport DiagramScrollView from \"./ui.diagram.scroll_view\";\nimport DiagramToolboxManager from \"./diagram.toolbox_manager\";\nimport DiagramToolbox from \"./ui.diagram.toolbox\";\nimport DiagramPropertiesPanel from \"./ui.diagram.properties_panel\";\nimport DiagramOptionsUpdateBar from \"./diagram.options_update\";\nimport DiagramDialogManager from \"./ui.diagram.dialog_manager\";\nimport DiagramCommandsManager from \"./diagram.commands_manager\";\nimport NodesOption from \"./diagram.nodes_option\";\nimport EdgesOption from \"./diagram.edges_option\";\nvar DIAGRAM_CLASS = \"dx-diagram\";\nvar DIAGRAM_FULLSCREEN_CLASS = \"dx-diagram-fullscreen\";\nvar DIAGRAM_TOOLBAR_WRAPPER_CLASS = DIAGRAM_CLASS + \"-toolbar-wrapper\";\nvar DIAGRAM_CONTENT_WRAPPER_CLASS = DIAGRAM_CLASS + \"-content-wrapper\";\nvar DIAGRAM_CONTENT_CLASS = DIAGRAM_CLASS + \"-content\";\nvar DIAGRAM_SCROLL_VIEW_CLASS = DIAGRAM_CLASS + \"-scroll-view\";\nvar DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS = DIAGRAM_CLASS + \"-floating-toolbar-container\";\nvar DIAGRAM_PROPERTIES_PANEL_TOOLBAR_CONTAINER_CLASS = DIAGRAM_CLASS + \"-properties-panel-toolbar-container\";\nvar DIAGRAM_LOADING_INDICATOR_CLASS = DIAGRAM_CLASS + \"-loading-indicator\";\nvar DIAGRAM_FLOATING_PANEL_OFFSET = 12;\nvar DIAGRAM_DEFAULT_UNIT = \"in\";\nvar DIAGRAM_DEFAULT_ZOOMLEVEL = 1;\nvar DIAGRAM_DEFAULT_AUTOZOOM_MODE = \"disabled\";\nvar DIAGRAM_DEFAULT_PAGE_ORIENTATION = \"portrait\";\nvar DIAGRAM_DEFAULT_PAGE_COLOR = \"#ffffff\";\nvar DIAGRAM_MAX_MOBILE_WINDOW_WIDTH = 576;\nvar DIAGRAM_TOOLBOX_SHAPE_SPACING = 12;\nvar DIAGRAM_TOOLBOX_SHAPES_PER_ROW = 3;\nvar DIAGRAM_CONTEXT_TOOLBOX_SHAPE_SPACING = 12;\nvar DIAGRAM_CONTEXT_TOOLBOX_SHAPES_PER_ROW = 4;\nvar DIAGRAM_CONTEXT_TOOLBOX_DEFAULT_WIDTH = 152;\nvar DIAGRAM_NAMESPACE = \"dxDiagramEvent\";\nvar FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"fullscreenchange\", DIAGRAM_NAMESPACE);\nvar IE_FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"msfullscreenchange\", DIAGRAM_NAMESPACE);\nvar WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"webkitfullscreenchange\", DIAGRAM_NAMESPACE);\nvar MOZ_FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"mozfullscreenchange\", DIAGRAM_NAMESPACE);\n\nclass Diagram extends Widget {\n  _init() {\n    this._updateDiagramLockCount = 0;\n    this.toggleFullscreenLock = 0;\n    this._toolbars = [];\n\n    super._init();\n\n    this._initDiagram();\n\n    this._createCustomCommand();\n  }\n\n  _initMarkup() {\n    super._initMarkup();\n\n    this._toolbars = [];\n    delete this._isMobileScreenSize;\n    var isServerSide = !hasWindow();\n    this.$element().addClass(DIAGRAM_CLASS);\n    delete this._mainToolbar;\n\n    if (this.option(\"mainToolbar.visible\")) {\n      this._renderMainToolbar();\n    }\n\n    var $contentWrapper = $(\"<div>\").addClass(DIAGRAM_CONTENT_WRAPPER_CLASS).appendTo(this.$element());\n    delete this._historyToolbar;\n    delete this._historyToolbarResizeCallback;\n\n    if (this._isHistoryToolbarVisible()) {\n      this._renderHistoryToolbar($contentWrapper);\n    }\n\n    delete this._propertiesToolbar;\n    delete this._propertiesToolbarResizeCallback;\n\n    if (this._isPropertiesPanelEnabled()) {\n      this._renderPropertiesToolbar($contentWrapper);\n    }\n\n    delete this._viewToolbar;\n    delete this._viewToolbarResizeCallback;\n\n    if (this.option(\"viewToolbar.visible\")) {\n      this._renderViewToolbar($contentWrapper);\n    }\n\n    delete this._toolbox;\n    delete this._toolboxResizeCallback;\n\n    if (this._isToolboxEnabled()) {\n      this._renderToolbox($contentWrapper);\n    }\n\n    delete this._propertiesPanel;\n    delete this._propertiesPanelResizeCallback;\n\n    if (this._isPropertiesPanelEnabled()) {\n      this._renderPropertiesPanel($contentWrapper);\n    }\n\n    this._$content = $(\"<div>\").addClass(DIAGRAM_CONTENT_CLASS).appendTo($contentWrapper);\n    delete this._contextMenu;\n    this._diagramInstance.settings.contextMenuEnabled = this.option(\"contextMenu.enabled\");\n\n    if (this._diagramInstance.settings.contextMenuEnabled) {\n      this._renderContextMenu($contentWrapper);\n    }\n\n    delete this._contextToolbox;\n\n    if (this.option(\"contextToolbox.enabled\")) {\n      this._renderContextToolbox($contentWrapper);\n    }\n\n    this._renderDialog($contentWrapper);\n\n    if (!isServerSide) {\n      var $scrollViewWrapper = $(\"<div>\").addClass(DIAGRAM_SCROLL_VIEW_CLASS).appendTo(this._$content);\n\n      this._createComponent($scrollViewWrapper, DiagramScrollView, {\n        useNativeScrolling: this.option(\"useNativeScrolling\"),\n        onCreateDiagram: e => {\n          this._diagramInstance.createDocument(e.$parent[0], e.scrollView, $contentWrapper[0]);\n        }\n      });\n    }\n\n    this._setCustomCommandChecked(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME, this._isPropertiesPanelVisible());\n\n    this._setCustomCommandChecked(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME, this._isToolboxVisible());\n\n    this._createOptionsUpdateBar();\n  }\n\n  _dimensionChanged() {\n    this._isMobileScreenSize = void 0;\n\n    this._processDiagramResize();\n  }\n\n  _visibilityChanged(visible) {\n    if (visible) {\n      this._bindDiagramData();\n\n      this.repaint();\n    }\n  }\n\n  _processDiagramResize() {\n    this._diagramInstance.onDimensionChanged();\n\n    if (this._historyToolbarResizeCallback) {\n      this._historyToolbarResizeCallback.call(this);\n    }\n\n    if (this._propertiesToolbarResizeCallback) {\n      this._propertiesToolbarResizeCallback.call(this);\n    }\n\n    if (this._propertiesPanelResizeCallback) {\n      this._propertiesPanelResizeCallback.call(this);\n    }\n\n    if (this._viewToolbarResizeCallback) {\n      this._viewToolbarResizeCallback.call(this);\n    }\n\n    if (this._toolboxResizeCallback) {\n      this._toolboxResizeCallback.call(this);\n    }\n  }\n\n  isMobileScreenSize() {\n    if (void 0 === this._isMobileScreenSize) {\n      this._isMobileScreenSize = hasWindow() && getOuterWidth(this.$element()) < DIAGRAM_MAX_MOBILE_WINDOW_WIDTH;\n    }\n\n    return this._isMobileScreenSize;\n  }\n\n  _captureFocus() {\n    if (this._diagramInstance) {\n      this._diagramInstance.captureFocus();\n    }\n  }\n\n  _captureFocusOnTimeout() {\n    this._captureFocusTimeout = setTimeout(() => {\n      this._captureFocus();\n\n      delete this._captureFocusTimeout;\n    }, 100);\n  }\n\n  _killCaptureFocusTimeout() {\n    if (this._captureFocusTimeout) {\n      clearTimeout(this._captureFocusTimeout);\n      delete this._captureFocusTimeout;\n    }\n  }\n\n  notifyBarCommandExecuted() {\n    this._captureFocusOnTimeout();\n  }\n\n  _registerToolbar(component) {\n    this._registerBar(component);\n\n    this._toolbars.push(component);\n  }\n\n  _registerBar(component) {\n    component.bar.onChanged.add(this);\n\n    this._diagramInstance.registerBar(component.bar);\n  }\n\n  _getExcludeCommands() {\n    var excludeCommands = [];\n\n    if (!this._isToolboxEnabled()) {\n      excludeCommands.push(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME);\n    }\n\n    if (!this._isPropertiesPanelEnabled()) {\n      excludeCommands.push(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME);\n    }\n\n    return excludeCommands;\n  }\n\n  _getToolbarBaseOptions() {\n    return {\n      onContentReady: _ref => {\n        var {\n          component: component\n        } = _ref;\n        return this._registerToolbar(component);\n      },\n      onSubMenuVisibilityChanging: _ref2 => {\n        var {\n          component: component\n        } = _ref2;\n        return this._diagramInstance.updateBarItemsState(component.bar);\n      },\n      onPointerUp: this._onPanelPointerUp.bind(this),\n      export: this.option(\"export\"),\n      excludeCommands: this._getExcludeCommands(),\n      onInternalCommand: this._onInternalCommand.bind(this),\n      onCustomCommand: this._onCustomCommand.bind(this),\n      isMobileView: this.isMobileScreenSize()\n    };\n  }\n\n  _onInternalCommand(e) {\n    switch (e.command) {\n      case DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME:\n        if (this._toolbox) {\n          this._toolbox.toggle();\n        }\n\n        break;\n\n      case DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME:\n        if (this._propertiesPanel) {\n          this._propertiesPanel.toggle();\n        }\n\n    }\n  }\n\n  _onCustomCommand(e) {\n    this._customCommandAction({\n      name: e.name\n    });\n  }\n\n  _renderMainToolbar() {\n    var $toolbarWrapper = $(\"<div>\").addClass(DIAGRAM_TOOLBAR_WRAPPER_CLASS).appendTo(this.$element());\n    this._mainToolbar = this._createComponent($toolbarWrapper, DiagramMainToolbar, extend(this._getToolbarBaseOptions(), {\n      commands: this.option(\"mainToolbar.commands\"),\n      skipAdjustSize: true\n    }));\n  }\n\n  _isHistoryToolbarVisible() {\n    return this.option(\"historyToolbar.visible\") && !this.isReadOnlyMode();\n  }\n\n  _renderHistoryToolbar($parent) {\n    var $container = $(\"<div>\").addClass(DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS).appendTo($parent);\n    this._historyToolbar = this._createComponent($container, DiagramHistoryToolbar, extend(this._getToolbarBaseOptions(), {\n      commands: this.option(\"historyToolbar.commands\"),\n      locateInMenu: \"never\"\n    }));\n\n    this._updateHistoryToolbarPosition();\n\n    this._historyToolbarResizeCallback = () => {\n      this._historyToolbar.option(\"isMobileView\", this.isMobileScreenSize());\n    };\n  }\n\n  _updateHistoryToolbarPosition() {\n    if (!hasWindow()) {\n      return;\n    }\n\n    positionUtils.setup(this._historyToolbar.$element(), {\n      my: \"left top\",\n      at: \"left top\",\n      of: this._historyToolbar.$element().parent(),\n      offset: DIAGRAM_FLOATING_PANEL_OFFSET + \" \" + DIAGRAM_FLOATING_PANEL_OFFSET\n    });\n  }\n\n  _isToolboxEnabled() {\n    return \"disabled\" !== this.option(\"toolbox.visibility\") && !this.isReadOnlyMode();\n  }\n\n  _isToolboxVisible() {\n    return \"visible\" === this.option(\"toolbox.visibility\") || \"auto\" === this.option(\"toolbox.visibility\") && !this.isMobileScreenSize();\n  }\n\n  _renderToolbox($parent) {\n    var isServerSide = !hasWindow();\n    var $toolBox = $(\"<div>\").appendTo($parent);\n\n    var bounds = this._getToolboxBounds($parent, isServerSide);\n\n    this._toolbox = this._createComponent($toolBox, DiagramToolbox, {\n      isMobileView: this.isMobileScreenSize(),\n      isVisible: this._isToolboxVisible(),\n      container: this.$element(),\n      height: bounds.height,\n      offsetParent: $parent,\n      offsetX: bounds.offsetX,\n      offsetY: bounds.offsetY,\n      showSearch: this.option(\"toolbox.showSearch\"),\n      toolboxGroups: this._getToolboxGroups(),\n      toolboxWidth: this.option(\"toolbox.width\"),\n      onShapeCategoryRendered: e => {\n        if (isServerSide) {\n          return;\n        }\n\n        this._diagramInstance.createToolbox(e.$element[0], \"texts\" === e.displayMode, e.shapes || e.category, {\n          shapeIconSpacing: DIAGRAM_TOOLBOX_SHAPE_SPACING,\n          shapeIconCountInRow: this.option(\"toolbox.shapeIconsPerRow\"),\n          shapeIconAttributes: {\n            \"data-toggle\": e.dataToggle\n          }\n        });\n      },\n      onFilterChanged: e => {\n        if (isServerSide) {\n          return;\n        }\n\n        this._diagramInstance.applyToolboxFilter(e.text, e.filteringToolboxes);\n      },\n      onVisibilityChanging: e => {\n        if (isServerSide) {\n          return;\n        }\n\n        this._setCustomCommandChecked(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME, e.visible);\n\n        if (this._propertiesPanel) {\n          if (e.visible && this.isMobileScreenSize()) {\n            this._propertiesPanel.hide();\n          }\n        }\n\n        if (this._historyToolbar) {\n          if (e.visible && this.isMobileScreenSize()) {\n            this._historyToolbarZIndex = zIndexPool.create(Overlay.baseZIndex());\n\n            this._historyToolbar.$element().css(\"zIndex\", this._historyToolbarZIndex);\n\n            this._historyToolbar.$element().css(\"boxShadow\", \"none\");\n          }\n        }\n\n        if (this._viewToolbar) {\n          this._viewToolbar.$element().css(\"opacity\", e.visible && this.isMobileScreenSize() ? \"0\" : \"1\");\n\n          this._viewToolbar.$element().css(\"pointerEvents\", e.visible && this.isMobileScreenSize() ? \"none\" : \"\");\n        }\n      },\n      onVisibilityChanged: e => {\n        if (!e.visible && !this._textInputStarted) {\n          this._captureFocus();\n        }\n\n        if (!isServerSide) {\n          if (this._historyToolbar) {\n            if (!e.visible && this.isMobileScreenSize() && this._historyToolbarZIndex) {\n              zIndexPool.remove(this._historyToolbarZIndex);\n\n              this._historyToolbar.$element().css(\"zIndex\", \"\");\n\n              this._historyToolbar.$element().css(\"boxShadow\", \"\");\n\n              this._historyToolbarZIndex = void 0;\n            }\n          }\n        }\n      },\n      onPointerUp: this._onPanelPointerUp.bind(this)\n    });\n\n    this._toolbox._popup.option(\"propagateOutsideClick\", !this.option(\"fullScreen\"));\n\n    this._toolboxResizeCallback = () => {\n      var bounds = this._getToolboxBounds($parent, isServerSide);\n\n      this._toolbox.option(\"height\", bounds.height);\n\n      var prevIsMobileView = this._toolbox.option(\"isMobileView\");\n\n      if (prevIsMobileView !== this.isMobileScreenSize()) {\n        this._toolbox.option({\n          isMobileView: this.isMobileScreenSize(),\n          isVisible: this._isToolboxVisible()\n        });\n\n        this._setCustomCommandChecked(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME, this._isToolboxVisible());\n      }\n\n      this._toolbox.updateMaxHeight();\n    };\n  }\n\n  _getToolboxBounds($parent, isServerSide) {\n    var result = {\n      offsetX: DIAGRAM_FLOATING_PANEL_OFFSET,\n      offsetY: DIAGRAM_FLOATING_PANEL_OFFSET,\n      height: !isServerSide ? getHeight($parent) - 2 * DIAGRAM_FLOATING_PANEL_OFFSET : 0\n    };\n\n    if (this._historyToolbar && !isServerSide) {\n      result.offsetY += getOuterHeight(this._historyToolbar.$element()) + DIAGRAM_FLOATING_PANEL_OFFSET;\n      result.height -= getOuterHeight(this._historyToolbar.$element()) + DIAGRAM_FLOATING_PANEL_OFFSET;\n    }\n\n    if (this._viewToolbar && !isServerSide) {\n      result.height -= getOuterHeight(this._viewToolbar.$element()) + this._getViewToolbarYOffset(isServerSide);\n    }\n\n    return result;\n  }\n\n  _renderViewToolbar($parent) {\n    var isServerSide = !hasWindow();\n    var $container = $(\"<div>\").addClass(DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS).appendTo($parent);\n    this._viewToolbar = this._createComponent($container, DiagramViewToolbar, extend(this._getToolbarBaseOptions(), {\n      commands: this.option(\"viewToolbar.commands\"),\n      locateInMenu: \"never\"\n    }));\n\n    this._updateViewToolbarPosition($container, $parent, isServerSide);\n\n    this._viewToolbarResizeCallback = () => {\n      this._updateViewToolbarPosition($container, $parent, isServerSide);\n    };\n  }\n\n  _getViewToolbarYOffset(isServerSide) {\n    if (isServerSide) {\n      return;\n    }\n\n    var result = DIAGRAM_FLOATING_PANEL_OFFSET;\n\n    if (this._viewToolbar && this._propertiesToolbar) {\n      result += (getOuterHeight(this._propertiesToolbar.$element()) - getOuterHeight(this._viewToolbar.$element())) / 2;\n    }\n\n    return result;\n  }\n\n  _updateViewToolbarPosition($container, $parent, isServerSide) {\n    if (isServerSide) {\n      return;\n    }\n\n    positionUtils.setup($container, {\n      my: \"left bottom\",\n      at: \"left bottom\",\n      of: $parent,\n      offset: DIAGRAM_FLOATING_PANEL_OFFSET + \" -\" + this._getViewToolbarYOffset(isServerSide)\n    });\n  }\n\n  _isPropertiesPanelEnabled() {\n    return \"disabled\" !== this.option(\"propertiesPanel.visibility\") && !this.isReadOnlyMode();\n  }\n\n  _isPropertiesPanelVisible() {\n    return \"visible\" === this.option(\"propertiesPanel.visibility\");\n  }\n\n  _renderPropertiesToolbar($parent) {\n    var isServerSide = !hasWindow();\n    var $container = $(\"<div>\").addClass(DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS).addClass(DIAGRAM_PROPERTIES_PANEL_TOOLBAR_CONTAINER_CLASS).appendTo($parent);\n    this._propertiesToolbar = this._createComponent($container, DiagramPropertiesToolbar, extend(this._getToolbarBaseOptions(), {\n      buttonStylingMode: \"contained\",\n      buttonType: \"default\",\n      locateInMenu: \"never\"\n    }));\n\n    this._updatePropertiesToolbarPosition($container, $parent, isServerSide);\n\n    this._propertiesToolbarResizeCallback = () => {\n      this._updatePropertiesToolbarPosition($container, $parent, isServerSide);\n    };\n  }\n\n  _updatePropertiesToolbarPosition($container, $parent, isServerSide) {\n    if (isServerSide) {\n      return;\n    }\n\n    positionUtils.setup($container, {\n      my: \"right bottom\",\n      at: \"right bottom\",\n      of: $parent,\n      offset: \"-\" + DIAGRAM_FLOATING_PANEL_OFFSET + \" -\" + DIAGRAM_FLOATING_PANEL_OFFSET\n    });\n  }\n\n  _renderPropertiesPanel($parent) {\n    var isServerSide = !hasWindow();\n    var $propertiesPanel = $(\"<div>\").appendTo($parent);\n    var offsetX = DIAGRAM_FLOATING_PANEL_OFFSET;\n    var offsetY = 2 * DIAGRAM_FLOATING_PANEL_OFFSET + (!isServerSide ? getOuterHeight(this._propertiesToolbar.$element()) : 0);\n    this._propertiesPanel = this._createComponent($propertiesPanel, DiagramPropertiesPanel, {\n      isMobileView: this.isMobileScreenSize(),\n      isVisible: this._isPropertiesPanelVisible(),\n      container: this.$element(),\n      offsetParent: $parent,\n      offsetX: offsetX,\n      offsetY: offsetY,\n      propertyTabs: this.option(\"propertiesPanel.tabs\"),\n      onCreateToolbar: e => {\n        e.toolbar = this._createComponent(e.$parent, DiagramToolbar, extend(this._getToolbarBaseOptions(), {\n          commands: e.commands,\n          locateInMenu: \"never\",\n          editorStylingMode: \"outlined\"\n        }));\n      },\n      onVisibilityChanging: e => {\n        if (isServerSide) {\n          return;\n        }\n\n        this._updatePropertiesPanelGroupBars(e.component);\n\n        this._setCustomCommandChecked(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME, e.visible);\n\n        if (this._toolbox) {\n          if (e.visible && this.isMobileScreenSize()) {\n            this._toolbox.hide();\n          }\n        }\n      },\n      onVisibilityChanged: e => {\n        if (!e.visible && !this._textInputStarted) {\n          this._captureFocus();\n        }\n      },\n      onSelectedGroupChanged: _ref3 => {\n        var {\n          component: component\n        } = _ref3;\n        return this._updatePropertiesPanelGroupBars(component);\n      },\n      onPointerUp: this._onPanelPointerUp.bind(this)\n    });\n\n    this._propertiesPanelResizeCallback = () => {\n      var prevIsMobileView = this._propertiesPanel.option(\"isMobileView\");\n\n      if (prevIsMobileView !== this.isMobileScreenSize()) {\n        this._propertiesPanel.option({\n          isMobileView: this.isMobileScreenSize(),\n          isVisible: this._isPropertiesPanelVisible()\n        });\n\n        this._setCustomCommandChecked(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME, this._isPropertiesPanelVisible());\n      }\n    };\n  }\n\n  _updatePropertiesPanelGroupBars(component) {\n    component.getActiveToolbars().forEach(toolbar => {\n      this._diagramInstance.updateBarItemsState(toolbar.bar);\n    });\n  }\n\n  _onPanelPointerUp() {\n    this._captureFocusOnTimeout();\n  }\n\n  _renderContextMenu($parent) {\n    var $contextMenu = $(\"<div>\").appendTo($parent);\n    this._contextMenu = this._createComponent($contextMenu, diagramContextMenuModule.DiagramContextMenuWrapper, {\n      commands: this.option(\"contextMenu.commands\"),\n      onContentReady: _ref4 => {\n        var {\n          component: component\n        } = _ref4;\n        return this._registerBar(component);\n      },\n      onVisibilityChanging: _ref5 => {\n        var {\n          component: component\n        } = _ref5;\n        return this._diagramInstance.updateBarItemsState(component.bar);\n      },\n      onItemClick: itemData => this._onBeforeCommandExecuted(itemData.command),\n      export: this.option(\"export\"),\n      excludeCommands: this._getExcludeCommands(),\n      onInternalCommand: this._onInternalCommand.bind(this),\n      onCustomCommand: this._onCustomCommand.bind(this)\n    });\n  }\n\n  _renderContextToolbox($parent) {\n    var isServerSide = !hasWindow();\n    var category = this.option(\"contextToolbox.category\");\n    var displayMode = this.option(\"contextToolbox.displayMode\");\n    var shapes = this.option(\"contextToolbox.shapes\");\n    var $contextToolbox = $(\"<div>\").appendTo($parent);\n    this._contextToolbox = this._createComponent($contextToolbox, DiagramContextToolbox, {\n      toolboxWidth: this.option(\"contextToolbox.width\"),\n      onShown: e => {\n        if (isServerSide) {\n          return;\n        }\n\n        var $toolboxContainer = $(e.$element);\n        var isTextGroup = \"texts\" === displayMode;\n\n        if (!shapes && !category && !isTextGroup) {\n          var group = this._getToolboxGroups().filter(function (g) {\n            return g.category === e.category;\n          })[0];\n\n          if (group) {\n            isTextGroup = \"texts\" === group.displayMode;\n          }\n        }\n\n        this._diagramInstance.createContextToolbox($toolboxContainer[0], isTextGroup, shapes || category || e.category, {\n          shapeIconSpacing: DIAGRAM_CONTEXT_TOOLBOX_SHAPE_SPACING,\n          shapeIconCountInRow: this.option(\"contextToolbox.shapeIconsPerRow\")\n        }, shapeType => {\n          e.callback(shapeType);\n\n          this._captureFocus();\n\n          e.hide();\n        });\n      }\n    });\n  }\n\n  _setCustomCommandChecked(command, checked) {\n    this._toolbars.forEach(tb => {\n      tb.setCommandChecked(command, checked);\n    });\n  }\n\n  _onBeforeCommandExecuted(command) {\n    var dialogParameters = DiagramDialogManager.getDialogParameters(command);\n\n    if (dialogParameters) {\n      this._showDialog(dialogParameters);\n    }\n\n    return !!dialogParameters;\n  }\n\n  _renderDialog($parent) {\n    var $dialogElement = $(\"<div>\").appendTo($parent);\n    this._dialogInstance = this._createComponent($dialogElement, DiagramDialog, {});\n  }\n\n  _showDialog(dialogParameters) {\n    if (this._dialogInstance) {\n      this._dialogInstance.option(\"onGetContent\", dialogParameters.onGetContent);\n\n      this._dialogInstance.option(\"onHidden\", function () {\n        this._captureFocus();\n      }.bind(this));\n\n      this._dialogInstance.option(\"command\", this._diagramInstance.getCommand(dialogParameters.command));\n\n      this._dialogInstance.option(\"title\", dialogParameters.title);\n\n      this._dialogInstance._show();\n    }\n  }\n\n  _showLoadingIndicator() {\n    this._loadingIndicator = $(\"<div>\").addClass(DIAGRAM_LOADING_INDICATOR_CLASS);\n\n    this._createComponent(this._loadingIndicator, LoadIndicator, {});\n\n    var $parent = this._$content || this.$element();\n    $parent.append(this._loadingIndicator);\n  }\n\n  _hideLoadingIndicator() {\n    if (!this._loadingIndicator) {\n      return;\n    }\n\n    this._loadingIndicator.remove();\n\n    this._loadingIndicator = null;\n  }\n\n  _initDiagram() {\n    var {\n      DiagramControl: DiagramControl\n    } = getDiagram();\n    this._diagramInstance = new DiagramControl();\n    this._diagramInstance.onChanged = this._raiseDataChangeAction.bind(this);\n    this._diagramInstance.onEdgeInserted = this._raiseEdgeInsertedAction.bind(this);\n    this._diagramInstance.onEdgeUpdated = this._raiseEdgeUpdatedAction.bind(this);\n    this._diagramInstance.onEdgeRemoved = this._raiseEdgeRemovedAction.bind(this);\n    this._diagramInstance.onNodeInserted = this._raiseNodeInsertedAction.bind(this);\n    this._diagramInstance.onNodeUpdated = this._raiseNodeUpdatedAction.bind(this);\n    this._diagramInstance.onNodeRemoved = this._raiseNodeRemovedAction.bind(this);\n    this._diagramInstance.onToolboxDragStart = this._raiseToolboxDragStart.bind(this);\n    this._diagramInstance.onToolboxDragEnd = this._raiseToolboxDragEnd.bind(this);\n    this._diagramInstance.onTextInputStart = this._raiseTextInputStart.bind(this);\n    this._diagramInstance.onTextInputEnd = this._raiseTextInputEnd.bind(this);\n    this._diagramInstance.onToggleFullscreen = this._onToggleFullScreen.bind(this);\n    this._diagramInstance.onShowContextMenu = this._onShowContextMenu.bind(this);\n    this._diagramInstance.onHideContextMenu = this._onHideContextMenu.bind(this);\n    this._diagramInstance.onShowContextToolbox = this._onShowContextToolbox.bind(this);\n    this._diagramInstance.onHideContextToolbox = this._onHideContextToolbox.bind(this);\n\n    this._diagramInstance.onNativeAction.add({\n      notifyItemClick: this._raiseItemClickAction.bind(this),\n      notifyItemDblClick: this._raiseItemDblClickAction.bind(this),\n      notifySelectionChanged: this._raiseSelectionChanged.bind(this)\n    });\n\n    this._diagramInstance.onRequestOperation = this._raiseRequestEditOperation.bind(this);\n\n    this._updateEventSubscriptionMethods();\n\n    this._updateDefaultItemProperties();\n\n    this._updateEditingSettings();\n\n    this._updateShapeTexts();\n\n    this._updateUnitItems();\n\n    this._updateFormatUnitsMethod();\n\n    if (this.option(\"units\") !== DIAGRAM_DEFAULT_UNIT) {\n      this._updateUnitsState();\n    }\n\n    if (this.isReadOnlyMode()) {\n      this._updateReadOnlyState();\n    }\n\n    if (this.option(\"pageSize\")) {\n      if (this.option(\"pageSize.items\")) {\n        this._updatePageSizeItemsState();\n      }\n\n      if (this.option(\"pageSize.width\") && this.option(\"pageSize.height\")) {\n        this._updatePageSizeState();\n      }\n    }\n\n    if (this.option(\"pageOrientation\") !== DIAGRAM_DEFAULT_PAGE_ORIENTATION) {\n      this._updatePageOrientationState();\n    }\n\n    if (this.option(\"pageColor\") !== DIAGRAM_DEFAULT_PAGE_COLOR) {\n      this._updatePageColorState();\n    }\n\n    if (this.option(\"viewUnits\") !== DIAGRAM_DEFAULT_UNIT) {\n      this._updateViewUnitsState();\n    }\n\n    if (!this.option(\"showGrid\")) {\n      this._updateShowGridState();\n    }\n\n    if (!this.option(\"snapToGrid\")) {\n      this._updateSnapToGridState();\n    }\n\n    if (this.option(\"gridSize\")) {\n      this._updateGridSizeState();\n    }\n\n    if (this.option(\"zoomLevel\") !== DIAGRAM_DEFAULT_ZOOMLEVEL) {\n      this._updateZoomLevelState();\n    }\n\n    if (this.option(\"simpleView\")) {\n      this._updateSimpleViewState();\n    }\n\n    if (this.option(\"autoZoomMode\") !== DIAGRAM_DEFAULT_AUTOZOOM_MODE) {\n      this._updateAutoZoomState();\n    }\n\n    if (this.option(\"fullScreen\")) {\n      var window = getWindow();\n\n      if (window && window.self !== window.top) {\n        this.option(\"fullScreen\", false);\n      } else {\n        this._updateFullscreenState();\n      }\n    }\n\n    this._createOptionsUpdateBar();\n\n    if (hasWindow()) {\n      this._diagramInstance.initMeasurer(this.$element()[0]);\n    }\n\n    this._updateCustomShapes(this._getCustomShapes());\n\n    this._refreshDataSources();\n  }\n\n  _createOptionsUpdateBar() {\n    if (!this.optionsUpdateBar) {\n      this.optionsUpdateBar = new DiagramOptionsUpdateBar(this);\n\n      this._diagramInstance.registerBar(this.optionsUpdateBar);\n    }\n  }\n\n  _deleteOptionsUpdateBar() {\n    delete this.optionsUpdateBar;\n  }\n\n  _clean() {\n    if (this._diagramInstance) {\n      this._diagramInstance.cleanMarkup(element => {\n        $(element).empty();\n      });\n\n      this._deleteOptionsUpdateBar();\n    }\n\n    super._clean();\n  }\n\n  _dispose() {\n    this._killCaptureFocusTimeout();\n\n    super._dispose();\n\n    this._diagramInstance = void 0;\n  }\n\n  _executeDiagramCommand(command, parameter) {\n    this._diagramInstance.getCommand(command).execute(parameter);\n  }\n\n  getNodeDataSource() {\n    return this._nodesOption && this._nodesOption.getDataSource();\n  }\n\n  getEdgeDataSource() {\n    return this._edgesOption && this._edgesOption.getDataSource();\n  }\n\n  _refreshDataSources() {\n    this._beginUpdateDiagram();\n\n    this._refreshNodesDataSource();\n\n    this._refreshEdgesDataSource();\n\n    this._endUpdateDiagram();\n  }\n\n  _refreshNodesDataSource() {\n    if (this._nodesOption) {\n      this._nodesOption._disposeDataSource();\n\n      delete this._nodesOption;\n    }\n\n    if (this.option(\"nodes.dataSource\")) {\n      this._nodesOption = new NodesOption(this);\n\n      this._nodesOption.option(\"dataSource\", this.option(\"nodes.dataSource\"));\n\n      this._nodesOption._refreshDataSource();\n    }\n  }\n\n  _refreshEdgesDataSource() {\n    if (this._edgesOption) {\n      this._edgesOption._disposeDataSource();\n\n      delete this._edgesOption;\n    }\n\n    if (this.option(\"edges.dataSource\")) {\n      this._edgesOption = new EdgesOption(this);\n\n      this._edgesOption.option(\"dataSource\", this.option(\"edges.dataSource\"));\n\n      this._edgesOption._refreshDataSource();\n    }\n  }\n\n  _getDiagramData() {\n    var value;\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.Export, function (data) {\n      value = data;\n    });\n\n    return value;\n  }\n\n  _setDiagramData(data, keepExistingItems) {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.Import, {\n      data: data,\n      keepExistingItems: keepExistingItems\n    });\n  }\n\n  isReadOnlyMode() {\n    return this.option(\"readOnly\") || this.option(\"disabled\");\n  }\n\n  _onDataSourceChanged() {\n    this._bindDiagramData();\n  }\n\n  _getChangesKeys(changes) {\n    return changes.map(change => {\n      if (isDefined(change.internalKey)) {\n        return change.internalKey;\n      } else if (isDefined(change.key)) {\n        return change.key;\n      } else {\n        return null;\n      }\n    }).filter(key => isDefined(key));\n  }\n\n  _createOptionGetter(optionName) {\n    var expr = this.option(optionName);\n    return expr && compileGetter(expr);\n  }\n\n  _onRequestUpdateLayout(changes) {\n    if (!this._requestLayoutUpdateAction) {\n      this._createRequestLayoutUpdateAction();\n    }\n\n    var eventArgs = {\n      changes: changes,\n      allowed: false\n    };\n\n    this._requestLayoutUpdateAction(eventArgs);\n\n    return eventArgs.allowed;\n  }\n\n  _createOptionSetter(optionName) {\n    var expr = this.option(optionName);\n\n    if (isFunction(expr)) {\n      return expr;\n    }\n\n    return expr && compileSetter(expr);\n  }\n\n  _bindDiagramData() {\n    if (this._updateDiagramLockCount || !this._isBindingMode()) {\n      return;\n    }\n\n    var {\n      DiagramCommand: DiagramCommand,\n      ConnectorLineOption: ConnectorLineOption,\n      ConnectorLineEnding: ConnectorLineEnding\n    } = getDiagram();\n    var lineOptionGetter;\n    var lineOptionSetter;\n    var startLineEndingGetter;\n    var startLineEndingSetter;\n    var endLineEndingGetter;\n    var endLineEndingSetter;\n    var containerChildrenGetter;\n    var containerChildrenSetter;\n    var data = {\n      nodeDataSource: this._nodesOption && this._nodesOption.getItems(),\n      edgeDataSource: this._edgesOption && this._edgesOption.getItems(),\n      nodeDataImporter: {\n        getKey: this._createOptionGetter(\"nodes.keyExpr\"),\n        setKey: this._createOptionSetter(\"nodes.keyExpr\"),\n        getCustomData: this._createOptionGetter(\"nodes.customDataExpr\"),\n        setCustomData: this._createOptionSetter(\"nodes.customDataExpr\"),\n        getLocked: this._createOptionGetter(\"nodes.lockedExpr\"),\n        setLocked: this._createOptionSetter(\"nodes.lockedExpr\"),\n        getStyle: this._createOptionGetter(\"nodes.styleExpr\"),\n        setStyle: this._createOptionSetter(\"nodes.styleExpr\"),\n        getStyleText: this._createOptionGetter(\"nodes.textStyleExpr\"),\n        setStyleText: this._createOptionSetter(\"nodes.textStyleExpr\"),\n        getZIndex: this._createOptionGetter(\"nodes.zIndexExpr\"),\n        setZIndex: this._createOptionSetter(\"nodes.zIndexExpr\"),\n        getType: this._createOptionGetter(\"nodes.typeExpr\"),\n        setType: this._createOptionSetter(\"nodes.typeExpr\"),\n        getText: this._createOptionGetter(\"nodes.textExpr\"),\n        setText: this._createOptionSetter(\"nodes.textExpr\"),\n        getImage: this._createOptionGetter(\"nodes.imageUrlExpr\"),\n        setImage: this._createOptionSetter(\"nodes.imageUrlExpr\"),\n        getLeft: this._createOptionGetter(\"nodes.leftExpr\"),\n        setLeft: this._createOptionSetter(\"nodes.leftExpr\"),\n        getTop: this._createOptionGetter(\"nodes.topExpr\"),\n        setTop: this._createOptionSetter(\"nodes.topExpr\"),\n        getWidth: this._createOptionGetter(\"nodes.widthExpr\"),\n        setWidth: this._createOptionSetter(\"nodes.widthExpr\"),\n        getHeight: this._createOptionGetter(\"nodes.heightExpr\"),\n        setHeight: this._createOptionSetter(\"nodes.heightExpr\"),\n        getParentKey: this._createOptionGetter(\"nodes.parentKeyExpr\"),\n        setParentKey: this._createOptionSetter(\"nodes.parentKeyExpr\"),\n        getItems: this._createOptionGetter(\"nodes.itemsExpr\"),\n        setItems: this._createOptionSetter(\"nodes.itemsExpr\"),\n        getChildren: containerChildrenGetter = this._createOptionGetter(\"nodes.containerChildrenExpr\"),\n        setChildren: containerChildrenSetter = this._createOptionSetter(\"nodes.containerChildrenExpr\"),\n        getContainerKey: !containerChildrenGetter && !containerChildrenSetter && this._createOptionGetter(\"nodes.containerKeyExpr\"),\n        setContainerKey: !containerChildrenGetter && !containerChildrenSetter && this._createOptionSetter(\"nodes.containerKeyExpr\")\n      },\n      edgeDataImporter: {\n        getKey: this._createOptionGetter(\"edges.keyExpr\"),\n        setKey: this._createOptionSetter(\"edges.keyExpr\"),\n        getCustomData: this._createOptionGetter(\"edges.customDataExpr\"),\n        setCustomData: this._createOptionSetter(\"edges.customDataExpr\"),\n        getLocked: this._createOptionGetter(\"edges.lockedExpr\"),\n        setLocked: this._createOptionSetter(\"edges.lockedExpr\"),\n        getStyle: this._createOptionGetter(\"edges.styleExpr\"),\n        setStyle: this._createOptionSetter(\"edges.styleExpr\"),\n        getStyleText: this._createOptionGetter(\"edges.textStyleExpr\"),\n        setStyleText: this._createOptionSetter(\"edges.textStyleExpr\"),\n        getZIndex: this._createOptionGetter(\"edges.zIndexExpr\"),\n        setZIndex: this._createOptionSetter(\"edges.zIndexExpr\"),\n        getFrom: this._createOptionGetter(\"edges.fromExpr\"),\n        setFrom: this._createOptionSetter(\"edges.fromExpr\"),\n        getFromPointIndex: this._createOptionGetter(\"edges.fromPointIndexExpr\"),\n        setFromPointIndex: this._createOptionSetter(\"edges.fromPointIndexExpr\"),\n        getTo: this._createOptionGetter(\"edges.toExpr\"),\n        setTo: this._createOptionSetter(\"edges.toExpr\"),\n        getToPointIndex: this._createOptionGetter(\"edges.toPointIndexExpr\"),\n        setToPointIndex: this._createOptionSetter(\"edges.toPointIndexExpr\"),\n        getPoints: this._createOptionGetter(\"edges.pointsExpr\"),\n        setPoints: this._createOptionSetter(\"edges.pointsExpr\"),\n        getText: this._createOptionGetter(\"edges.textExpr\"),\n        setText: this._createOptionSetter(\"edges.textExpr\"),\n        getLineOption: (lineOptionGetter = this._createOptionGetter(\"edges.lineTypeExpr\")) && function (obj) {\n          var lineType = lineOptionGetter(obj);\n          return this._getConnectorLineOption(lineType);\n        }.bind(this),\n        setLineOption: (lineOptionSetter = this._createOptionSetter(\"edges.lineTypeExpr\")) && function (obj, value) {\n          switch (value) {\n            case ConnectorLineOption.Straight:\n              value = \"straight\";\n              break;\n\n            case ConnectorLineOption.Orthogonal:\n              value = \"orthogonal\";\n          }\n\n          lineOptionSetter(obj, value);\n        }.bind(this),\n        getStartLineEnding: (startLineEndingGetter = this._createOptionGetter(\"edges.fromLineEndExpr\")) && function (obj) {\n          var lineEnd = startLineEndingGetter(obj);\n          return this._getConnectorLineEnding(lineEnd);\n        }.bind(this),\n        setStartLineEnding: (startLineEndingSetter = this._createOptionSetter(\"edges.fromLineEndExpr\")) && function (obj, value) {\n          switch (value) {\n            case ConnectorLineEnding.Arrow:\n              value = \"arrow\";\n              break;\n\n            case ConnectorLineEnding.OutlinedTriangle:\n              value = \"outlinedTriangle\";\n              break;\n\n            case ConnectorLineEnding.FilledTriangle:\n              value = \"filledTriangle\";\n              break;\n\n            case ConnectorLineEnding.None:\n              value = \"none\";\n          }\n\n          startLineEndingSetter(obj, value);\n        }.bind(this),\n        getEndLineEnding: (endLineEndingGetter = this._createOptionGetter(\"edges.toLineEndExpr\")) && function (obj) {\n          var lineEnd = endLineEndingGetter(obj);\n          return this._getConnectorLineEnding(lineEnd);\n        }.bind(this),\n        setEndLineEnding: (endLineEndingSetter = this._createOptionSetter(\"edges.toLineEndExpr\")) && function (obj, value) {\n          switch (value) {\n            case ConnectorLineEnding.Arrow:\n              value = \"arrow\";\n              break;\n\n            case ConnectorLineEnding.OutlinedTriangle:\n              value = \"outlinedTriangle\";\n              break;\n\n            case ConnectorLineEnding.FilledTriangle:\n              value = \"filledTriangle\";\n              break;\n\n            case ConnectorLineEnding.None:\n              value = \"none\";\n          }\n\n          endLineEndingSetter(obj, value);\n        }.bind(this)\n      },\n      layoutParameters: this._getDataBindingLayoutParameters()\n    };\n\n    this._executeDiagramCommand(DiagramCommand.BindDocument, data);\n  }\n\n  _reloadContentByChanges(changes, isExternalChanges) {\n    var keys = this._getChangesKeys(changes);\n\n    var applyLayout = this._onRequestUpdateLayout(changes);\n\n    this._reloadContent(keys, applyLayout, isExternalChanges);\n  }\n\n  _reloadContent(itemKeys, applyLayout, isExternalChanges) {\n    this._diagramInstance.reloadContent(itemKeys, () => {\n      var nodeDataSource;\n      var edgeDataSource;\n\n      if (this._nodesOption && isExternalChanges) {\n        nodeDataSource = this._nodesOption.getItems();\n      }\n\n      if (this._edgesOption && isExternalChanges) {\n        edgeDataSource = this._edgesOption.getItems();\n      }\n\n      return {\n        nodeDataSource: nodeDataSource,\n        edgeDataSource: edgeDataSource\n      };\n    }, applyLayout && this._getDataBindingLayoutParameters(), isExternalChanges);\n  }\n\n  _getConnectorLineOption(lineType) {\n    var {\n      ConnectorLineOption: ConnectorLineOption\n    } = getDiagram();\n\n    switch (lineType) {\n      case \"straight\":\n        return ConnectorLineOption.Straight;\n\n      default:\n        return ConnectorLineOption.Orthogonal;\n    }\n  }\n\n  _getConnectorLineEnding(lineEnd) {\n    var {\n      ConnectorLineEnding: ConnectorLineEnding\n    } = getDiagram();\n\n    switch (lineEnd) {\n      case \"arrow\":\n        return ConnectorLineEnding.Arrow;\n\n      case \"outlinedTriangle\":\n        return ConnectorLineEnding.OutlinedTriangle;\n\n      case \"filledTriangle\":\n        return ConnectorLineEnding.FilledTriangle;\n\n      default:\n        return ConnectorLineEnding.None;\n    }\n  }\n\n  _getDataBindingLayoutParameters() {\n    var {\n      DataLayoutType: DataLayoutType,\n      DataLayoutOrientation: DataLayoutOrientation\n    } = getDiagram();\n    var layoutParametersOption = this.option(\"nodes.autoLayout\") || \"off\";\n    var layoutType = layoutParametersOption.type || layoutParametersOption;\n    var parameters = {};\n\n    if (\"off\" !== layoutType && (\"auto\" !== layoutType || !this._hasNodePositionExprs())) {\n      switch (layoutType) {\n        case \"tree\":\n          parameters.type = DataLayoutType.Tree;\n          break;\n\n        default:\n          parameters.type = DataLayoutType.Sugiyama;\n      }\n\n      switch (layoutParametersOption.orientation) {\n        case \"vertical\":\n          parameters.orientation = DataLayoutOrientation.Vertical;\n          break;\n\n        case \"horizontal\":\n          parameters.orientation = DataLayoutOrientation.Horizontal;\n      }\n\n      if (this.option(\"edges.fromPointIndexExpr\") || this.option(\"edges.toPointIndexExpr\")) {\n        parameters.skipPointIndices = true;\n      }\n    }\n\n    parameters.autoSizeEnabled = !!this.option(\"nodes.autoSizeEnabled\");\n    return parameters;\n  }\n\n  _hasNodePositionExprs() {\n    return this.option(\"nodes.topExpr\") && this.option(\"nodes.leftExpr\");\n  }\n\n  _getAutoZoomValue(option) {\n    var {\n      AutoZoomMode: AutoZoomMode\n    } = getDiagram();\n\n    switch (option) {\n      case \"fitContent\":\n        return AutoZoomMode.FitContent;\n\n      case \"fitWidth\":\n        return AutoZoomMode.FitToWidth;\n\n      default:\n        return AutoZoomMode.Disabled;\n    }\n  }\n\n  _isBindingMode() {\n    return this._nodesOption && this._nodesOption.hasItems() || this._edgesOption && this._edgesOption.hasItems();\n  }\n\n  _beginUpdateDiagram() {\n    this._updateDiagramLockCount++;\n  }\n\n  _endUpdateDiagram() {\n    this._updateDiagramLockCount = Math.max(this._updateDiagramLockCount - 1, 0);\n\n    if (!this._updateDiagramLockCount) {\n      this._bindDiagramData();\n    }\n  }\n\n  _getCustomShapes() {\n    return this.option(\"customShapes\") || [];\n  }\n\n  _getToolboxGroups() {\n    return DiagramToolboxManager.getGroups(this.option(\"toolbox.groups\"));\n  }\n\n  _updateAllCustomShapes() {\n    this._diagramInstance.removeAllCustomShapes();\n\n    this._updateCustomShapes(this._getCustomShapes());\n  }\n\n  _updateCustomShapes(customShapes, prevCustomShapes) {\n    if (Array.isArray(prevCustomShapes)) {\n      this._diagramInstance.removeCustomShapes(prevCustomShapes.map(s => s.type));\n    }\n\n    if (Array.isArray(customShapes)) {\n      this._diagramInstance.addCustomShapes(customShapes.map(s => {\n        var templateOption = s.template || this.option(\"customShapeTemplate\");\n\n        var template = templateOption && this._getTemplate(templateOption);\n\n        var toolboxTemplateOption = s.toolboxTemplate || this.option(\"customShapeToolboxTemplate\");\n\n        var toolboxTemplate = toolboxTemplateOption && this._getTemplate(toolboxTemplateOption);\n\n        return {\n          category: s.category,\n          type: s.type,\n          baseType: s.baseType,\n          title: s.title,\n          svgUrl: s.backgroundImageUrl,\n          svgToolboxUrl: s.backgroundImageToolboxUrl,\n          svgLeft: s.backgroundImageLeft,\n          svgTop: s.backgroundImageTop,\n          svgWidth: s.backgroundImageWidth,\n          svgHeight: s.backgroundImageHeight,\n          defaultWidth: s.defaultWidth,\n          defaultHeight: s.defaultHeight,\n          toolboxWidthToHeightRatio: s.toolboxWidthToHeightRatio,\n          minWidth: s.minWidth,\n          minHeight: s.minHeight,\n          maxWidth: s.maxWidth,\n          maxHeight: s.maxHeight,\n          allowResize: s.allowResize,\n          defaultText: s.defaultText,\n          allowEditText: s.allowEditText,\n          textLeft: s.textLeft,\n          textTop: s.textTop,\n          textWidth: s.textWidth,\n          textHeight: s.textHeight,\n          defaultImageUrl: s.defaultImageUrl,\n          allowEditImage: s.allowEditImage,\n          imageLeft: s.imageLeft,\n          imageTop: s.imageTop,\n          imageWidth: s.imageWidth,\n          imageHeight: s.imageHeight,\n          connectionPoints: s.connectionPoints && s.connectionPoints.map(pt => ({\n            x: pt.x,\n            y: pt.y\n          })),\n          createTemplate: template && ((container, item) => {\n            template.render({\n              model: this._nativeItemToDiagramItem(item),\n              container: getPublicElement($(container))\n            });\n          }),\n          createToolboxTemplate: toolboxTemplate && ((container, item) => {\n            toolboxTemplate.render({\n              model: this._nativeItemToDiagramItem(item),\n              container: getPublicElement($(container))\n            });\n          }),\n          destroyTemplate: template && (container => {\n            $(container).empty();\n          }),\n          templateLeft: s.templateLeft,\n          templateTop: s.templateTop,\n          templateWidth: s.templateWidth,\n          templateHeight: s.templateHeight,\n          keepRatioOnAutoSize: s.keepRatioOnAutoSize\n        };\n      }));\n    }\n  }\n\n  _getViewport() {\n    var $viewPort = this.$element().closest(\".dx-viewport\");\n    return $viewPort.length ? $viewPort : $(\"body\");\n  }\n\n  _onToggleFullScreen(fullScreen) {\n    if (this.toggleFullscreenLock > 0) {\n      return;\n    }\n\n    this._changeNativeFullscreen(fullScreen);\n\n    if (fullScreen) {\n      this._prevParent = this.$element().parent();\n      this._prevFullScreenZIndex = this.$element().css(\"zIndex\");\n      this._fullScreenZIndex = zIndexPool.create(Overlay.baseZIndex());\n      this.$element().css(\"zIndex\", this._fullScreenZIndex);\n      this.$element().appendTo(this._getViewport());\n    } else {\n      this.$element().appendTo(this._prevParent);\n\n      if (this._fullScreenZIndex) {\n        zIndexPool.remove(this._fullScreenZIndex);\n        this.$element().css(\"zIndex\", this._prevFullScreenZIndex);\n      }\n    }\n\n    this.$element().toggleClass(DIAGRAM_FULLSCREEN_CLASS, fullScreen);\n\n    this._processDiagramResize();\n\n    if (this._toolbox) {\n      this._toolbox.repaint();\n\n      this._toolbox._popup.option(\"propagateOutsideClick\", !fullScreen);\n    }\n\n    if (this._propertiesPanel) {\n      this._propertiesPanel.repaint();\n    }\n\n    if (this._historyToolbar) {\n      this._updateHistoryToolbarPosition();\n    }\n  }\n\n  _changeNativeFullscreen(setModeOn) {\n    var window = getWindow();\n\n    if (window.self === window.top || setModeOn === this._inNativeFullscreen()) {\n      return;\n    }\n\n    if (setModeOn) {\n      this._subscribeFullscreenNativeChanged();\n    } else {\n      this._unsubscribeFullscreenNativeChanged();\n    }\n\n    this._setNativeFullscreen(setModeOn);\n  }\n\n  _setNativeFullscreen(on) {\n    var window = getWindow();\n    var document = window.self.document;\n    var body = window.self.document.body;\n\n    if (on) {\n      if (body.requestFullscreen) {\n        body.requestFullscreen();\n      } else if (body.mozRequestFullscreen) {\n        body.mozRequestFullscreen();\n      } else if (body.webkitRequestFullscreen) {\n        body.webkitRequestFullscreen();\n      } else if (body.msRequestFullscreen) {\n        body.msRequestFullscreen();\n      }\n    } else if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.mozCancelFullscreen) {\n      document.mozCancelFullscreen();\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen();\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen();\n    }\n  }\n\n  _inNativeFullscreen() {\n    var document = getWindow().document;\n    var fullscreenElement = document.fullscreenElement || document.msFullscreenElement || document.webkitFullscreenElement;\n    var isInFullscreen = fullscreenElement === document.body || document.webkitIsFullscreen;\n    return !!isInFullscreen;\n  }\n\n  _subscribeFullscreenNativeChanged() {\n    var document = getWindow().document;\n\n    var handler = this._onNativeFullscreenChangeHandler.bind(this);\n\n    eventsEngine.on(document, FULLSCREEN_CHANGE_EVENT_NAME, handler);\n    eventsEngine.on(document, IE_FULLSCREEN_CHANGE_EVENT_NAME, handler);\n    eventsEngine.on(document, WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME, handler);\n    eventsEngine.on(document, MOZ_FULLSCREEN_CHANGE_EVENT_NAME, handler);\n  }\n\n  _unsubscribeFullscreenNativeChanged() {\n    var document = getWindow().document;\n    eventsEngine.off(document, FULLSCREEN_CHANGE_EVENT_NAME);\n    eventsEngine.off(document, IE_FULLSCREEN_CHANGE_EVENT_NAME);\n    eventsEngine.off(document, WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME);\n    eventsEngine.off(document, MOZ_FULLSCREEN_CHANGE_EVENT_NAME);\n  }\n\n  _onNativeFullscreenChangeHandler() {\n    if (!this._inNativeFullscreen()) {\n      this._unsubscribeFullscreenNativeChanged();\n\n      this.option(\"fullScreen\", false);\n    }\n  }\n\n  _executeDiagramFullscreenCommand(fullscreen) {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n    this.toggleFullscreenLock++;\n\n    this._executeDiagramCommand(DiagramCommand.Fullscreen, fullscreen);\n\n    this.toggleFullscreenLock--;\n  }\n\n  _onShowContextMenu(x, y, selection) {\n    if (this._contextMenu) {\n      this._contextMenu._show(x, y, selection);\n    }\n  }\n\n  _onHideContextMenu() {\n    if (this._contextMenu) {\n      this._contextMenu._hide();\n    }\n  }\n\n  _onShowContextToolbox(x, y, side, category, callback) {\n    if (this._contextToolbox) {\n      this._contextToolbox._show(x, y, side, category, callback);\n    }\n  }\n\n  _onHideContextToolbox() {\n    if (this._contextToolbox) {\n      this._contextToolbox._hide();\n    }\n  }\n\n  _getDiagramUnitValue(value) {\n    var {\n      DiagramUnit: DiagramUnit\n    } = getDiagram();\n\n    switch (value) {\n      case \"in\":\n        return DiagramUnit.In;\n\n      case \"cm\":\n        return DiagramUnit.Cm;\n\n      case \"px\":\n        return DiagramUnit.Px;\n\n      default:\n        return DiagramUnit.In;\n    }\n  }\n\n  _updateReadOnlyState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n    var readOnly = this.isReadOnlyMode();\n\n    this._executeDiagramCommand(DiagramCommand.ToggleReadOnly, readOnly);\n  }\n\n  _updateZoomLevelState() {\n    if (this.option(\"zoomLevel.items\")) {\n      this._updateZoomLevelItemsState();\n\n      var zoomLevel = this.option(\"zoomLevel.value\");\n\n      if (!zoomLevel) {\n        return;\n      }\n\n      var {\n        DiagramCommand: DiagramCommand\n      } = getDiagram();\n\n      this._executeDiagramCommand(DiagramCommand.ZoomLevel, zoomLevel);\n    } else {\n      var _zoomLevel = this.option(\"zoomLevel.value\") || this.option(\"zoomLevel\");\n\n      if (!_zoomLevel) {\n        return;\n      }\n\n      var {\n        DiagramCommand: _DiagramCommand\n      } = getDiagram();\n\n      this._executeDiagramCommand(_DiagramCommand.ZoomLevel, _zoomLevel);\n    }\n  }\n\n  _updateZoomLevelItemsState() {\n    var zoomLevelItems = this.option(\"zoomLevel.items\");\n\n    if (!Array.isArray(zoomLevelItems)) {\n      return;\n    }\n\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.ZoomLevelItems, zoomLevelItems);\n  }\n\n  _updateAutoZoomState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.SwitchAutoZoom, this._getAutoZoomValue(this.option(\"autoZoomMode\")));\n  }\n\n  _updateSimpleViewState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.ToggleSimpleView, this.option(\"simpleView\"));\n  }\n\n  _updateFullscreenState() {\n    var fullscreen = this.option(\"fullScreen\");\n\n    this._executeDiagramFullscreenCommand(fullscreen);\n\n    this._onToggleFullScreen(fullscreen);\n  }\n\n  _updateShowGridState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.ShowGrid, this.option(\"showGrid\"));\n  }\n\n  _updateSnapToGridState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.SnapToGrid, this.option(\"snapToGrid\"));\n  }\n\n  _updateGridSizeState() {\n    if (this.option(\"gridSize.items\")) {\n      this._updateGridSizeItemsState();\n\n      var gridSize = this.option(\"gridSize.value\");\n\n      if (!gridSize) {\n        return;\n      }\n\n      var {\n        DiagramCommand: DiagramCommand\n      } = getDiagram();\n\n      this._executeDiagramCommand(DiagramCommand.GridSize, gridSize);\n    } else {\n      var _gridSize = this.option(\"gridSize.value\") || this.option(\"gridSize\");\n\n      if (!_gridSize) {\n        return;\n      }\n\n      var {\n        DiagramCommand: _DiagramCommand2\n      } = getDiagram();\n\n      this._executeDiagramCommand(_DiagramCommand2.GridSize, _gridSize);\n    }\n  }\n\n  _updateGridSizeItemsState() {\n    var gridSizeItems = this.option(\"gridSize.items\");\n\n    if (!Array.isArray(gridSizeItems)) {\n      return;\n    }\n\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.GridSizeItems, gridSizeItems);\n  }\n\n  _updateUnitItems() {\n    var {\n      DiagramLocalizationService: DiagramLocalizationService\n    } = getDiagram();\n\n    var items = this._getUnitItems();\n\n    if (this._unitItems !== items) {\n      this._unitItems = items;\n      DiagramLocalizationService.unitItems = items;\n    }\n  }\n\n  _getUnitItems() {\n    var {\n      DiagramUnit: DiagramUnit\n    } = getDiagram();\n    var items = {};\n    items[DiagramUnit.In] = messageLocalization.format(\"dxDiagram-unitIn\");\n    items[DiagramUnit.Cm] = messageLocalization.format(\"dxDiagram-unitCm\");\n    items[DiagramUnit.Px] = messageLocalization.format(\"dxDiagram-unitPx\");\n    return items;\n  }\n\n  _updateFormatUnitsMethod() {\n    var {\n      DiagramLocalizationService: DiagramLocalizationService\n    } = getDiagram();\n\n    DiagramLocalizationService.formatUnit = function (value) {\n      return numberLocalization.format(value);\n    };\n  }\n\n  _updateViewUnitsState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.ViewUnits, this._getDiagramUnitValue(this.option(\"viewUnits\")));\n  }\n\n  _updateUnitsState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.Units, this._getDiagramUnitValue(this.option(\"units\")));\n  }\n\n  _updatePageSizeState() {\n    var pageSize = this.option(\"pageSize\");\n\n    if (!pageSize || !pageSize.width || !pageSize.height) {\n      return;\n    }\n\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.PageSize, pageSize);\n  }\n\n  _updatePageSizeItemsState() {\n    var pageSizeItems = this.option(\"pageSize.items\");\n\n    if (!Array.isArray(pageSizeItems)) {\n      return;\n    }\n\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.PageSizeItems, pageSizeItems);\n  }\n\n  _updatePageOrientationState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.PageLandscape, \"landscape\" === this.option(\"pageOrientation\"));\n  }\n\n  _updatePageColorState() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.PageColor, this.option(\"pageColor\"));\n  }\n\n  _updateShapeTexts() {\n    var {\n      DiagramLocalizationService: DiagramLocalizationService\n    } = getDiagram();\n\n    var texts = this._getShapeTexts();\n\n    if (this._shapeTexts !== texts) {\n      this._shapeTexts = texts;\n      DiagramLocalizationService.shapeTexts = texts;\n    }\n  }\n\n  _getShapeTexts() {\n    var {\n      ShapeTypes: ShapeTypes\n    } = getDiagram();\n    var texts = {};\n    texts[ShapeTypes.Text] = messageLocalization.format(\"dxDiagram-shapeText\");\n    texts[ShapeTypes.Rectangle] = messageLocalization.format(\"dxDiagram-shapeRectangle\");\n    texts[ShapeTypes.Ellipse] = messageLocalization.format(\"dxDiagram-shapeEllipse\");\n    texts[ShapeTypes.Cross] = messageLocalization.format(\"dxDiagram-shapeCross\");\n    texts[ShapeTypes.Triangle] = messageLocalization.format(\"dxDiagram-shapeTriangle\");\n    texts[ShapeTypes.Diamond] = messageLocalization.format(\"dxDiagram-shapeDiamond\");\n    texts[ShapeTypes.Heart] = messageLocalization.format(\"dxDiagram-shapeHeart\");\n    texts[ShapeTypes.Pentagon] = messageLocalization.format(\"dxDiagram-shapePentagon\");\n    texts[ShapeTypes.Hexagon] = messageLocalization.format(\"dxDiagram-shapeHexagon\");\n    texts[ShapeTypes.Octagon] = messageLocalization.format(\"dxDiagram-shapeOctagon\");\n    texts[ShapeTypes.Star] = messageLocalization.format(\"dxDiagram-shapeStar\");\n    texts[ShapeTypes.ArrowLeft] = messageLocalization.format(\"dxDiagram-shapeArrowLeft\");\n    texts[ShapeTypes.ArrowUp] = messageLocalization.format(\"dxDiagram-shapeArrowUp\");\n    texts[ShapeTypes.ArrowRight] = messageLocalization.format(\"dxDiagram-shapeArrowRight\");\n    texts[ShapeTypes.ArrowDown] = messageLocalization.format(\"dxDiagram-shapeArrowDown\");\n    texts[ShapeTypes.ArrowUpDown] = messageLocalization.format(\"dxDiagram-shapeArrowUpDown\");\n    texts[ShapeTypes.ArrowLeftRight] = messageLocalization.format(\"dxDiagram-shapeArrowLeftRight\");\n    texts[ShapeTypes.Process] = messageLocalization.format(\"dxDiagram-shapeProcess\");\n    texts[ShapeTypes.Decision] = messageLocalization.format(\"dxDiagram-shapeDecision\");\n    texts[ShapeTypes.Terminator] = messageLocalization.format(\"dxDiagram-shapeTerminator\");\n    texts[ShapeTypes.PredefinedProcess] = messageLocalization.format(\"dxDiagram-shapePredefinedProcess\");\n    texts[ShapeTypes.Document] = messageLocalization.format(\"dxDiagram-shapeDocument\");\n    texts[ShapeTypes.MultipleDocuments] = messageLocalization.format(\"dxDiagram-shapeMultipleDocuments\");\n    texts[ShapeTypes.ManualInput] = messageLocalization.format(\"dxDiagram-shapeManualInput\");\n    texts[ShapeTypes.Preparation] = messageLocalization.format(\"dxDiagram-shapePreparation\");\n    texts[ShapeTypes.Data] = messageLocalization.format(\"dxDiagram-shapeData\");\n    texts[ShapeTypes.Database] = messageLocalization.format(\"dxDiagram-shapeDatabase\");\n    texts[ShapeTypes.HardDisk] = messageLocalization.format(\"dxDiagram-shapeHardDisk\");\n    texts[ShapeTypes.InternalStorage] = messageLocalization.format(\"dxDiagram-shapeInternalStorage\");\n    texts[ShapeTypes.PaperTape] = messageLocalization.format(\"dxDiagram-shapePaperTape\");\n    texts[ShapeTypes.ManualOperation] = messageLocalization.format(\"dxDiagram-shapeManualOperation\");\n    texts[ShapeTypes.Delay] = messageLocalization.format(\"dxDiagram-shapeDelay\");\n    texts[ShapeTypes.StoredData] = messageLocalization.format(\"dxDiagram-shapeStoredData\");\n    texts[ShapeTypes.Display] = messageLocalization.format(\"dxDiagram-shapeDisplay\");\n    texts[ShapeTypes.Merge] = messageLocalization.format(\"dxDiagram-shapeMerge\");\n    texts[ShapeTypes.Connector] = messageLocalization.format(\"dxDiagram-shapeConnector\");\n    texts[ShapeTypes.Or] = messageLocalization.format(\"dxDiagram-shapeOr\");\n    texts[ShapeTypes.SummingJunction] = messageLocalization.format(\"dxDiagram-shapeSummingJunction\");\n    texts[ShapeTypes.Container] = messageLocalization.format(\"dxDiagram-shapeContainerDefaultText\");\n    texts[ShapeTypes.VerticalContainer] = messageLocalization.format(\"dxDiagram-shapeVerticalContainer\");\n    texts[ShapeTypes.HorizontalContainer] = messageLocalization.format(\"dxDiagram-shapeHorizontalContainer\");\n    texts[ShapeTypes.Card] = messageLocalization.format(\"dxDiagram-shapeCardDefaultText\");\n    texts[ShapeTypes.CardWithImageOnLeft] = messageLocalization.format(\"dxDiagram-shapeCardWithImageOnLeft\");\n    texts[ShapeTypes.CardWithImageOnTop] = messageLocalization.format(\"dxDiagram-shapeCardWithImageOnTop\");\n    texts[ShapeTypes.CardWithImageOnRight] = messageLocalization.format(\"dxDiagram-shapeCardWithImageOnRight\");\n    return texts;\n  }\n\n  _updateEventSubscriptionMethods() {\n    var {\n      RenderHelper: RenderHelper\n    } = getDiagram();\n\n    RenderHelper.addEventListener = (element, eventName, handler) => {\n      eventsEngine.on(element, eventName, handler);\n    };\n\n    RenderHelper.removeEventListener = (element, eventName, handler) => {\n      eventsEngine.off(element, eventName, handler);\n    };\n  }\n\n  _updateDefaultItemProperties() {\n    if (this.option(\"defaultItemProperties.style\")) {\n      this._diagramInstance.setInitialStyleProperties(this.option(\"defaultItemProperties.style\"));\n    }\n\n    if (this.option(\"defaultItemProperties.textStyle\")) {\n      this._diagramInstance.setInitialTextStyleProperties(this.option(\"defaultItemProperties.textStyle\"));\n    }\n\n    this._diagramInstance.setInitialConnectorProperties({\n      lineOption: this._getConnectorLineOption(this.option(\"defaultItemProperties.connectorLineType\")),\n      startLineEnding: this._getConnectorLineEnding(this.option(\"defaultItemProperties.connectorLineStart\")),\n      endLineEnding: this._getConnectorLineEnding(this.option(\"defaultItemProperties.connectorLineEnd\"))\n    });\n\n    this._diagramInstance.applyShapeSizeSettings({\n      shapeMinWidth: this.option(\"defaultItemProperties.shapeMinWidth\"),\n      shapeMaxWidth: this.option(\"defaultItemProperties.shapeMaxWidth\"),\n      shapeMinHeight: this.option(\"defaultItemProperties.shapeMinHeight\"),\n      shapeMaxHeight: this.option(\"defaultItemProperties.shapeMaxHeight\")\n    });\n  }\n\n  _updateEditingSettings() {\n    this._diagramInstance.applyOperationSettings({\n      addShape: this.option(\"editing.allowAddShape\"),\n      addShapeFromToolbox: this.option(\"editing.allowAddShape\"),\n      deleteShape: this.option(\"editing.allowDeleteShape\"),\n      deleteConnector: this.option(\"editing.allowDeleteConnector\"),\n      changeConnection: this.option(\"editing.allowChangeConnection\"),\n      changeConnectorPoints: this.option(\"editing.allowChangeConnectorPoints\"),\n      changeShapeText: this.option(\"editing.allowChangeShapeText\"),\n      changeConnectorText: this.option(\"editing.allowChangeConnectorText\"),\n      resizeShape: this.option(\"editing.allowResizeShape\"),\n      moveShape: this.option(\"editing.allowMoveShape\")\n    });\n  }\n\n  fitToContent() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.FitToScreen);\n  }\n\n  fitToWidth() {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    this._executeDiagramCommand(DiagramCommand.FitToWidth);\n  }\n\n  focus() {\n    this._captureFocus();\n  }\n\n  export() {\n    return this._getDiagramData();\n  }\n\n  exportTo(format, callback) {\n    var command = this._getDiagramExportToCommand(format);\n\n    this._executeDiagramCommand(command, callback);\n  }\n\n  _getDiagramExportToCommand(format) {\n    var {\n      DiagramCommand: DiagramCommand\n    } = getDiagram();\n\n    switch (format) {\n      case \"png\":\n        return DiagramCommand.ExportPng;\n\n      case \"jpg\":\n        return DiagramCommand.ExportJpg;\n\n      default:\n        return DiagramCommand.ExportSvg;\n    }\n  }\n\n  import(data, updateExistingItemsOnly) {\n    this._setDiagramData(data, updateExistingItemsOnly);\n\n    this._raiseDataChangeAction();\n  }\n\n  updateToolbox() {\n    this._diagramInstance && this._diagramInstance.refreshToolbox();\n\n    if (this._toolbox) {\n      this._toolbox.updateTooltips();\n\n      this._toolbox.updateFilter();\n\n      this._toolbox.updateMaxHeight();\n    }\n  }\n\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      readOnly: false,\n      zoomLevel: DIAGRAM_DEFAULT_ZOOMLEVEL,\n      simpleView: false,\n      autoZoomMode: DIAGRAM_DEFAULT_AUTOZOOM_MODE,\n      fullScreen: false,\n      showGrid: true,\n      snapToGrid: true,\n      units: DIAGRAM_DEFAULT_UNIT,\n      viewUnits: DIAGRAM_DEFAULT_UNIT,\n      pageOrientation: DIAGRAM_DEFAULT_PAGE_ORIENTATION,\n      pageColor: DIAGRAM_DEFAULT_PAGE_COLOR,\n      hasChanges: false,\n      nodes: {\n        dataSource: null,\n        keyExpr: \"id\",\n        customDataExpr: void 0,\n        lockedExpr: void 0,\n        styleExpr: void 0,\n        textStyleExpr: void 0,\n        zIndexExpr: void 0,\n        typeExpr: \"type\",\n        textExpr: \"text\",\n        imageUrlExpr: void 0,\n        parentKeyExpr: void 0,\n        itemsExpr: void 0,\n        leftExpr: void 0,\n        topExpr: void 0,\n        widthExpr: void 0,\n        heightExpr: void 0,\n        containerKeyExpr: \"containerKey\",\n        containerChildrenExpr: void 0,\n        autoLayout: \"auto\",\n        autoSizeEnabled: true\n      },\n      edges: {\n        dataSource: null,\n        keyExpr: \"id\",\n        customDataExpr: void 0,\n        lockedExpr: void 0,\n        styleExpr: void 0,\n        textStyleExpr: void 0,\n        zIndexExpr: void 0,\n        fromExpr: \"from\",\n        fromPointIndexExpr: void 0,\n        toExpr: \"to\",\n        toPointIndexExpr: void 0,\n        pointsExpr: void 0,\n        textExpr: void 0,\n        lineTypeExpr: void 0,\n        fromLineEndExpr: void 0,\n        toLineEndExpr: void 0\n      },\n      customShapes: [],\n      toolbox: {\n        visibility: \"auto\",\n        shapeIconsPerRow: DIAGRAM_TOOLBOX_SHAPES_PER_ROW,\n        showSearch: true\n      },\n      mainToolbar: {\n        visible: false\n      },\n      historyToolbar: {\n        visible: true\n      },\n      viewToolbar: {\n        visible: true\n      },\n      contextMenu: {\n        enabled: true\n      },\n      contextToolbox: {\n        enabled: true,\n        shapeIconsPerRow: DIAGRAM_CONTEXT_TOOLBOX_SHAPES_PER_ROW,\n        width: DIAGRAM_CONTEXT_TOOLBOX_DEFAULT_WIDTH\n      },\n      propertiesPanel: {\n        visibility: \"auto\"\n      },\n      defaultItemProperties: {\n        connectorLineType: \"orthogonal\",\n        connectorLineStart: \"none\",\n        connectorLineEnd: \"arrow\"\n      },\n      editing: {\n        allowAddShape: true,\n        allowDeleteShape: true,\n        allowDeleteConnector: true,\n        allowChangeConnection: true,\n        allowChangeConnectorPoints: true,\n        allowChangeShapeText: true,\n        allowChangeConnectorText: true,\n        allowResizeShape: true,\n        allowMoveShape: true\n      },\n      export: {\n        fileName: \"Diagram\",\n        proxyUrl: void 0\n      },\n      onItemClick: null,\n      onItemDblClick: null,\n      onSelectionChanged: null,\n      onRequestEditOperation: null,\n      onRequestLayoutUpdate: null\n    });\n  }\n\n  _raiseDataChangeAction() {\n    if (this._initialized) {\n      this.option(\"hasChanges\", true);\n    }\n  }\n\n  _raiseEdgeInsertedAction(data, callback, errorCallback) {\n    if (this._edgesOption) {\n      this._edgesOption.insert(data, callback, errorCallback);\n    }\n  }\n\n  _raiseEdgeUpdatedAction(key, data, callback, errorCallback) {\n    if (this._edgesOption) {\n      this._edgesOption.update(key, data, callback, errorCallback);\n    }\n  }\n\n  _raiseEdgeRemovedAction(key, data, callback, errorCallback) {\n    if (this._edgesOption) {\n      this._edgesOption.remove(key, data, callback, errorCallback);\n    }\n  }\n\n  _raiseNodeInsertedAction(data, callback, errorCallback) {\n    if (this._nodesOption) {\n      this._nodesOption.insert(data, callback, errorCallback);\n    }\n  }\n\n  _raiseNodeUpdatedAction(key, data, callback, errorCallback) {\n    if (this._nodesOption) {\n      this._nodesOption.update(key, data, callback, errorCallback);\n    }\n  }\n\n  _raiseNodeRemovedAction(key, data, callback, errorCallback) {\n    if (this._nodesOption) {\n      this._nodesOption.remove(key, data, callback, errorCallback);\n    }\n  }\n\n  _raiseToolboxDragStart() {\n    if (this._toolbox && this.isMobileScreenSize()) {\n      this._toolbox.hide();\n\n      this._toolboxDragHidden = true;\n    }\n  }\n\n  _raiseToolboxDragEnd() {\n    if (this._toolbox && this._toolboxDragHidden) {\n      this._toolbox.show();\n\n      delete this._toolboxDragHidden;\n    }\n  }\n\n  _raiseTextInputStart() {\n    this._textInputStarted = true;\n\n    if (this._propertiesPanel) {\n      if (this.isMobileScreenSize() && this._propertiesPanel.isVisible()) {\n        this._propertiesPanel.hide();\n\n        this._propertiesPanelTextInputHidden = true;\n      }\n    }\n\n    if (this._toolbox) {\n      if (this.isMobileScreenSize() && this._toolbox.isVisible()) {\n        this._toolbox.hide();\n\n        this._toolboxTextInputHidden = true;\n      }\n    }\n  }\n\n  _raiseTextInputEnd() {\n    if (this._propertiesPanel) {\n      if (this._propertiesPanelTextInputHidden) {\n        this._propertiesPanel.show();\n\n        delete this._propertiesPanelTextInputHidden;\n      }\n    }\n\n    if (this._toolbox) {\n      if (this._toolboxTextInputHidden) {\n        this._toolbox.show();\n\n        delete this._toolboxTextInputHidden;\n      }\n    }\n\n    this._textInputStarted = false;\n  }\n\n  _createItemClickAction() {\n    this._itemClickAction = this._createActionByOption(\"onItemClick\");\n  }\n\n  _createItemDblClickAction() {\n    this._itemDblClickAction = this._createActionByOption(\"onItemDblClick\");\n  }\n\n  _createSelectionChangedAction() {\n    this._selectionChangedAction = this._createActionByOption(\"onSelectionChanged\");\n  }\n\n  _createRequestEditOperationAction() {\n    this._requestEditOperationAction = this._createActionByOption(\"onRequestEditOperation\");\n  }\n\n  _createRequestLayoutUpdateAction() {\n    this._requestLayoutUpdateAction = this._createActionByOption(\"onRequestLayoutUpdate\");\n  }\n\n  _createCustomCommand() {\n    this._customCommandAction = this._createActionByOption(\"onCustomCommand\");\n  }\n\n  _raiseItemClickAction(nativeItem) {\n    if (!this._itemClickAction) {\n      this._createItemClickAction();\n    }\n\n    this._itemClickAction({\n      item: this._nativeItemToDiagramItem(nativeItem)\n    });\n  }\n\n  _raiseItemDblClickAction(nativeItem) {\n    if (!this._itemDblClickAction) {\n      this._createItemDblClickAction();\n    }\n\n    this._itemDblClickAction({\n      item: this._nativeItemToDiagramItem(nativeItem)\n    });\n  }\n\n  _raiseSelectionChanged(nativeItems) {\n    if (!this._selectionChangedAction) {\n      this._createSelectionChangedAction();\n    }\n\n    this._selectionChangedAction({\n      items: nativeItems.map(this._nativeItemToDiagramItem.bind(this))\n    });\n  }\n\n  _raiseRequestEditOperation(operation, args) {\n    if (!this._requestEditOperationAction) {\n      this._createRequestEditOperationAction();\n    }\n\n    var eventArgs = this._getRequestEditOperationEventArgs(operation, args);\n\n    this._requestEditOperationAction(eventArgs);\n\n    args.allowed = eventArgs.allowed;\n  }\n\n  _getModelOperation(operation) {\n    var {\n      DiagramModelOperation: DiagramModelOperation\n    } = getDiagram();\n\n    switch (operation) {\n      case DiagramModelOperation.AddShape:\n        return \"addShape\";\n\n      case DiagramModelOperation.AddShapeFromToolbox:\n        return \"addShapeFromToolbox\";\n\n      case DiagramModelOperation.DeleteShape:\n        return \"deleteShape\";\n\n      case DiagramModelOperation.DeleteConnector:\n        return \"deleteConnector\";\n\n      case DiagramModelOperation.ChangeConnection:\n        return \"changeConnection\";\n\n      case DiagramModelOperation.ChangeConnectorPoints:\n        return \"changeConnectorPoints\";\n\n      case DiagramModelOperation.BeforeChangeShapeText:\n        return \"beforeChangeShapeText\";\n\n      case DiagramModelOperation.ChangeShapeText:\n        return \"changeShapeText\";\n\n      case DiagramModelOperation.BeforeChangeConnectorText:\n        return \"beforeChangeConnectorText\";\n\n      case DiagramModelOperation.ChangeConnectorText:\n        return \"changeConnectorText\";\n\n      case DiagramModelOperation.ResizeShape:\n        return \"resizeShape\";\n\n      case DiagramModelOperation.MoveShape:\n        return \"moveShape\";\n    }\n  }\n\n  _getRequestEditOperationEventArgs(operation, args) {\n    var {\n      DiagramModelOperation: DiagramModelOperation,\n      ConnectorPosition: ConnectorPosition\n    } = getDiagram();\n    var eventArgs = {\n      operation: this._getModelOperation(operation),\n      allowed: args.allowed,\n      updateUI: args.updateUI,\n      reason: args.updateUI ? \"checkUIElementAvailability\" : \"modelModification\"\n    };\n\n    switch (operation) {\n      case DiagramModelOperation.AddShape:\n        eventArgs.args = {\n          shape: args.shape && this._nativeItemToDiagramItem(args.shape),\n          position: args.position && {\n            x: args.position.x,\n            y: args.position.y\n          }\n        };\n        break;\n\n      case DiagramModelOperation.AddShapeFromToolbox:\n        eventArgs.args = {\n          shapeType: args.shapeType\n        };\n        break;\n\n      case DiagramModelOperation.DeleteShape:\n        eventArgs.args = {\n          shape: args.shape && this._nativeItemToDiagramItem(args.shape)\n        };\n        break;\n\n      case DiagramModelOperation.DeleteConnector:\n        eventArgs.args = {\n          connector: args.connector && this._nativeItemToDiagramItem(args.connector)\n        };\n        break;\n\n      case DiagramModelOperation.ChangeConnection:\n        eventArgs.args = {\n          newShape: args.shape && this._nativeItemToDiagramItem(args.shape),\n          oldShape: args.oldShape && this._nativeItemToDiagramItem(args.oldShape),\n          connector: args.connector && this._nativeItemToDiagramItem(args.connector),\n          connectionPointIndex: args.connectionPointIndex,\n          connectorPosition: args.position === ConnectorPosition.Begin ? \"start\" : \"end\"\n        };\n        break;\n\n      case DiagramModelOperation.ChangeConnectorPoints:\n        eventArgs.args = {\n          connector: args.connector && this._nativeItemToDiagramItem(args.connector),\n          newPoints: args.points && args.points.map(pt => ({\n            x: pt.x,\n            y: pt.y\n          })),\n          oldPoints: args.oldPoints && args.oldPoints.map(pt => ({\n            x: pt.x,\n            y: pt.y\n          }))\n        };\n        break;\n\n      case DiagramModelOperation.BeforeChangeShapeText:\n        eventArgs.args = {\n          shape: args.shape && this._nativeItemToDiagramItem(args.shape)\n        };\n        break;\n\n      case DiagramModelOperation.ChangeShapeText:\n        eventArgs.args = {\n          shape: args.shape && this._nativeItemToDiagramItem(args.shape),\n          text: args.text\n        };\n        break;\n\n      case DiagramModelOperation.BeforeChangeConnectorText:\n        eventArgs.args = {\n          connector: args.connector && this._nativeItemToDiagramItem(args.connector),\n          index: args.index\n        };\n        break;\n\n      case DiagramModelOperation.ChangeConnectorText:\n        eventArgs.args = {\n          connector: args.connector && this._nativeItemToDiagramItem(args.connector),\n          index: args.index,\n          text: args.text\n        };\n        break;\n\n      case DiagramModelOperation.ResizeShape:\n        eventArgs.args = {\n          shape: args.shape && this._nativeItemToDiagramItem(args.shape),\n          newSize: args.size && {\n            width: args.size.width,\n            height: args.size.height\n          },\n          oldSize: args.oldSize && {\n            width: args.oldSize.width,\n            height: args.oldSize.height\n          }\n        };\n        break;\n\n      case DiagramModelOperation.MoveShape:\n        eventArgs.args = {\n          shape: args.shape && this._nativeItemToDiagramItem(args.shape),\n          newPosition: args.position && {\n            x: args.position.x,\n            y: args.position.y\n          },\n          oldPosition: args.oldPosition && {\n            x: args.oldPosition.x,\n            y: args.oldPosition.y\n          }\n        };\n    }\n\n    return eventArgs;\n  }\n\n  _nativeItemToDiagramItem(nativeItem) {\n    var {\n      NativeShape: NativeShape\n    } = getDiagram();\n    var createMethod = nativeItem instanceof NativeShape ? this._nativeShapeToDiagramShape.bind(this) : this._nativeConnectorToDiagramConnector.bind(this);\n    return extend({\n      id: nativeItem.id,\n      key: nativeItem.key,\n      dataItem: void 0\n    }, createMethod(nativeItem));\n  }\n\n  _nativeShapeToDiagramShape(nativeShape) {\n    return {\n      dataItem: this._nodesOption && this._nodesOption.findItem(nativeShape.key),\n      itemType: \"shape\",\n      text: nativeShape.text,\n      type: nativeShape.type,\n      position: {\n        x: nativeShape.position.x,\n        y: nativeShape.position.y\n      },\n      size: {\n        width: nativeShape.size.width,\n        height: nativeShape.size.height\n      },\n      attachedConnectorIds: nativeShape.attachedConnectorIds,\n      containerId: nativeShape.containerId,\n      containerChildItemIds: nativeShape.containerChildItemIds,\n      containerExpanded: nativeShape.containerExpanded\n    };\n  }\n\n  _nativeConnectorToDiagramConnector(nativeConnector) {\n    return {\n      dataItem: this._edgesOption && this._edgesOption.findItem(nativeConnector.key),\n      itemType: \"connector\",\n      texts: nativeConnector.texts,\n      fromKey: nativeConnector.fromKey,\n      toKey: nativeConnector.toKey,\n      fromId: nativeConnector.fromId,\n      fromPointIndex: nativeConnector.fromPointIndex,\n      toId: nativeConnector.toId,\n      toPointIndex: nativeConnector.toPointIndex,\n      points: nativeConnector.points.map(pt => ({\n        x: pt.x,\n        y: pt.y\n      }))\n    };\n  }\n\n  getItemByKey(key) {\n    var nativeItem = this._diagramInstance && this._diagramInstance.getNativeItemByDataKey(key);\n\n    return nativeItem && this._nativeItemToDiagramItem(nativeItem);\n  }\n\n  getItemById(id) {\n    var nativeItem = this._diagramInstance && this._diagramInstance.getNativeItemByKey(id);\n\n    return nativeItem && this._nativeItemToDiagramItem(nativeItem);\n  }\n\n  getItems() {\n    return this._diagramInstance.getNativeItems().map(nativeItem => nativeItem && this._nativeItemToDiagramItem(nativeItem));\n  }\n\n  getSelectedItems() {\n    return this._diagramInstance.getNativeSelectedItems().map(nativeItem => nativeItem && this._nativeItemToDiagramItem(nativeItem));\n  }\n\n  setSelectedItems(items) {\n    return this._diagramInstance.setSelectedItems(items.map(item => item.id));\n  }\n\n  scrollToItem(item) {\n    return this._diagramInstance.scrollToItems([item.id]);\n  }\n\n  _invalidateContextMenuCommands() {\n    if (this._contextMenu) {\n      this._contextMenu.option({\n        commands: this.option(\"contextMenu.commands\")\n      });\n    }\n  }\n\n  _invalidateMainToolbarCommands() {\n    if (this._mainToolbar) {\n      this._mainToolbar.option({\n        commands: this.option(\"mainToolbar.commands\")\n      });\n    }\n  }\n\n  _invalidateHistoryToolbarCommands() {\n    if (this._historyToolbar) {\n      this._historyToolbar.option({\n        commands: this.option(\"historyToolbar.commands\")\n      });\n    }\n  }\n\n  _invalidateViewToolbarCommands() {\n    if (this._viewToolbar) {\n      this._viewToolbar.option({\n        commands: this.option(\"viewToolbar.commands\")\n      });\n    }\n  }\n\n  _invalidateToolboxGroups() {\n    if (this._toolbox) {\n      this._toolbox.option({\n        toolboxGroups: this._getToolboxGroups()\n      });\n    }\n  }\n\n  _optionChanged(args) {\n    if (!this.optionsUpdateBar || this.optionsUpdateBar.isUpdateLocked()) {\n      return;\n    }\n\n    this.optionsUpdateBar.beginUpdate();\n\n    try {\n      this._optionChangedCore(args);\n    } finally {\n      this.optionsUpdateBar.endUpdate();\n    }\n  }\n\n  _optionChangedCore(args) {\n    switch (args.name) {\n      case \"readOnly\":\n      case \"disabled\":\n        this._updateReadOnlyState();\n\n        this._invalidate();\n\n        break;\n\n      case \"zoomLevel\":\n        if (\"zoomLevel\" === args.fullName || \"zoomLevel.items\" === args.fullName || \"zoomLevel.value\" === args.fullName) {\n          this._updateZoomLevelState();\n        }\n\n        break;\n\n      case \"autoZoomMode\":\n        this._updateAutoZoomState();\n\n        break;\n\n      case \"simpleView\":\n        this._updateSimpleViewState();\n\n        break;\n\n      case \"useNativeScrolling\":\n        this._invalidate();\n\n        break;\n\n      case \"fullScreen\":\n        this._updateFullscreenState();\n\n        break;\n\n      case \"showGrid\":\n        this._updateShowGridState();\n\n        break;\n\n      case \"snapToGrid\":\n        this._updateSnapToGridState();\n\n        break;\n\n      case \"gridSize\":\n        if (\"gridSize\" === args.fullName || \"gridSize.items\" === args.fullName || \"gridSize.value\" === args.fullName) {\n          this._updateGridSizeState();\n        }\n\n        break;\n\n      case \"viewUnits\":\n        this._updateViewUnitsState();\n\n        break;\n\n      case \"units\":\n        this._updateUnitsState();\n\n        break;\n\n      case \"pageSize\":\n        if (\"pageSize\" === args.fullName || \"pageSize.items\" === args.fullName) {\n          this._updatePageSizeItemsState();\n        }\n\n        if (\"pageSize\" === args.fullName || \"pageSize.width\" === args.fullName || \"pageSize.height\" === args.fullName) {\n          this._updatePageSizeState();\n        }\n\n        break;\n\n      case \"pageOrientation\":\n        this._updatePageOrientationState();\n\n        break;\n\n      case \"pageColor\":\n        this._updatePageColorState();\n\n        break;\n\n      case \"nodes\":\n        if (0 === args.fullName.indexOf(\"nodes.autoLayout\")) {\n          this._refreshDataSources();\n        } else {\n          this._refreshNodesDataSource();\n        }\n\n        break;\n\n      case \"edges\":\n        this._refreshEdgesDataSource();\n\n        break;\n\n      case \"customShapes\":\n        if (args.fullName !== args.name) {\n          this._updateAllCustomShapes();\n        } else {\n          this._updateCustomShapes(args.value, args.previousValue);\n        }\n\n        this._invalidate();\n\n        break;\n\n      case \"contextMenu\":\n        if (\"contextMenu.commands\" === args.fullName) {\n          this._invalidateContextMenuCommands();\n        } else {\n          this._invalidate();\n        }\n\n        break;\n\n      case \"contextToolbox\":\n      case \"propertiesPanel\":\n        this._invalidate();\n\n        break;\n\n      case \"toolbox\":\n        if (\"toolbox.groups\" === args.fullName) {\n          this._invalidateToolboxGroups();\n        } else {\n          this._invalidate();\n        }\n\n        break;\n\n      case \"mainToolbar\":\n        if (\"mainToolbar.commands\" === args.fullName) {\n          this._invalidateMainToolbarCommands();\n        } else {\n          this._invalidate();\n        }\n\n        break;\n\n      case \"historyToolbar\":\n        if (\"historyToolbar.commands\" === args.fullName) {\n          this._invalidateHistoryToolbarCommands();\n        } else {\n          this._invalidate();\n        }\n\n        break;\n\n      case \"viewToolbar\":\n        if (\"viewToolbar.commands\" === args.fullName) {\n          this._invalidateViewToolbarCommands();\n        } else {\n          this._invalidate();\n        }\n\n        break;\n\n      case \"onItemClick\":\n        this._createItemClickAction();\n\n        break;\n\n      case \"onItemDblClick\":\n        this._createItemDblClickAction();\n\n        break;\n\n      case \"onSelectionChanged\":\n        this._createSelectionChangedAction();\n\n        break;\n\n      case \"onRequestEditOperation\":\n        this._createRequestEditOperationAction();\n\n        break;\n\n      case \"onRequestLayoutUpdate\":\n        this._createRequestLayoutUpdateAction();\n\n        break;\n\n      case \"onCustomCommand\":\n        this._createCustomCommand();\n\n        break;\n\n      case \"defaultItemProperties\":\n        this._updateDefaultItemProperties();\n\n        break;\n\n      case \"editing\":\n        this._updateEditingSettings();\n\n        break;\n\n      case \"export\":\n        this._toolbars.forEach(toolbar => {\n          toolbar.option(\"export\", this.option(\"export\"));\n        });\n\n        if (this._contextMenu) {\n          this._contextMenu.option(\"export\", this.option(\"export\"));\n        }\n\n        break;\n\n      case \"hasChanges\":\n        break;\n\n      default:\n        super._optionChanged(args);\n\n    }\n  }\n\n}\n\nregisterComponent(\"dxDiagram\", Diagram);\nexport default Diagram;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devextreme/esm/ui/diagram/ui.diagram.js"],"names":["getOuterWidth","getHeight","getOuterHeight","$","Widget","LoadIndicator","registerComponent","extend","isFunction","isDefined","compileSetter","compileGetter","positionUtils","getDiagram","getWindow","hasWindow","getPublicElement","eventsEngine","addNamespace","messageLocalization","numberLocalization","zIndexPool","Overlay","DiagramToolbar","DiagramMainToolbar","DiagramHistoryToolbar","DiagramViewToolbar","DiagramPropertiesToolbar","diagramContextMenuModule","DiagramContextToolbox","DiagramDialog","DiagramScrollView","DiagramToolboxManager","DiagramToolbox","DiagramPropertiesPanel","DiagramOptionsUpdateBar","DiagramDialogManager","DiagramCommandsManager","NodesOption","EdgesOption","DIAGRAM_CLASS","DIAGRAM_FULLSCREEN_CLASS","DIAGRAM_TOOLBAR_WRAPPER_CLASS","DIAGRAM_CONTENT_WRAPPER_CLASS","DIAGRAM_CONTENT_CLASS","DIAGRAM_SCROLL_VIEW_CLASS","DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS","DIAGRAM_PROPERTIES_PANEL_TOOLBAR_CONTAINER_CLASS","DIAGRAM_LOADING_INDICATOR_CLASS","DIAGRAM_FLOATING_PANEL_OFFSET","DIAGRAM_DEFAULT_UNIT","DIAGRAM_DEFAULT_ZOOMLEVEL","DIAGRAM_DEFAULT_AUTOZOOM_MODE","DIAGRAM_DEFAULT_PAGE_ORIENTATION","DIAGRAM_DEFAULT_PAGE_COLOR","DIAGRAM_MAX_MOBILE_WINDOW_WIDTH","DIAGRAM_TOOLBOX_SHAPE_SPACING","DIAGRAM_TOOLBOX_SHAPES_PER_ROW","DIAGRAM_CONTEXT_TOOLBOX_SHAPE_SPACING","DIAGRAM_CONTEXT_TOOLBOX_SHAPES_PER_ROW","DIAGRAM_CONTEXT_TOOLBOX_DEFAULT_WIDTH","DIAGRAM_NAMESPACE","FULLSCREEN_CHANGE_EVENT_NAME","IE_FULLSCREEN_CHANGE_EVENT_NAME","WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME","MOZ_FULLSCREEN_CHANGE_EVENT_NAME","Diagram","_init","_updateDiagramLockCount","toggleFullscreenLock","_toolbars","_initDiagram","_createCustomCommand","_initMarkup","_isMobileScreenSize","isServerSide","$element","addClass","_mainToolbar","option","_renderMainToolbar","$contentWrapper","appendTo","_historyToolbar","_historyToolbarResizeCallback","_isHistoryToolbarVisible","_renderHistoryToolbar","_propertiesToolbar","_propertiesToolbarResizeCallback","_isPropertiesPanelEnabled","_renderPropertiesToolbar","_viewToolbar","_viewToolbarResizeCallback","_renderViewToolbar","_toolbox","_toolboxResizeCallback","_isToolboxEnabled","_renderToolbox","_propertiesPanel","_propertiesPanelResizeCallback","_renderPropertiesPanel","_$content","_contextMenu","_diagramInstance","settings","contextMenuEnabled","_renderContextMenu","_contextToolbox","_renderContextToolbox","_renderDialog","$scrollViewWrapper","_createComponent","useNativeScrolling","onCreateDiagram","e","createDocument","$parent","scrollView","_setCustomCommandChecked","SHOW_PROPERTIES_PANEL_COMMAND_NAME","_isPropertiesPanelVisible","SHOW_TOOLBOX_COMMAND_NAME","_isToolboxVisible","_createOptionsUpdateBar","_dimensionChanged","_processDiagramResize","_visibilityChanged","visible","_bindDiagramData","repaint","onDimensionChanged","call","isMobileScreenSize","_captureFocus","captureFocus","_captureFocusOnTimeout","_captureFocusTimeout","setTimeout","_killCaptureFocusTimeout","clearTimeout","notifyBarCommandExecuted","_registerToolbar","component","_registerBar","push","bar","onChanged","add","registerBar","_getExcludeCommands","excludeCommands","_getToolbarBaseOptions","onContentReady","_ref","onSubMenuVisibilityChanging","_ref2","updateBarItemsState","onPointerUp","_onPanelPointerUp","bind","export","onInternalCommand","_onInternalCommand","onCustomCommand","_onCustomCommand","isMobileView","command","toggle","_customCommandAction","name","$toolbarWrapper","commands","skipAdjustSize","isReadOnlyMode","$container","locateInMenu","_updateHistoryToolbarPosition","setup","my","at","of","parent","offset","$toolBox","bounds","_getToolboxBounds","isVisible","container","height","offsetParent","offsetX","offsetY","showSearch","toolboxGroups","_getToolboxGroups","toolboxWidth","onShapeCategoryRendered","createToolbox","displayMode","shapes","category","shapeIconSpacing","shapeIconCountInRow","shapeIconAttributes","dataToggle","onFilterChanged","applyToolboxFilter","text","filteringToolboxes","onVisibilityChanging","hide","_historyToolbarZIndex","create","baseZIndex","css","onVisibilityChanged","_textInputStarted","remove","_popup","prevIsMobileView","updateMaxHeight","result","_getViewToolbarYOffset","_updateViewToolbarPosition","buttonStylingMode","buttonType","_updatePropertiesToolbarPosition","$propertiesPanel","propertyTabs","onCreateToolbar","toolbar","editorStylingMode","_updatePropertiesPanelGroupBars","onSelectedGroupChanged","_ref3","getActiveToolbars","forEach","$contextMenu","DiagramContextMenuWrapper","_ref4","_ref5","onItemClick","itemData","_onBeforeCommandExecuted","$contextToolbox","onShown","$toolboxContainer","isTextGroup","group","filter","g","createContextToolbox","shapeType","callback","checked","tb","setCommandChecked","dialogParameters","getDialogParameters","_showDialog","$dialogElement","_dialogInstance","onGetContent","getCommand","title","_show","_showLoadingIndicator","_loadingIndicator","append","_hideLoadingIndicator","DiagramControl","_raiseDataChangeAction","onEdgeInserted","_raiseEdgeInsertedAction","onEdgeUpdated","_raiseEdgeUpdatedAction","onEdgeRemoved","_raiseEdgeRemovedAction","onNodeInserted","_raiseNodeInsertedAction","onNodeUpdated","_raiseNodeUpdatedAction","onNodeRemoved","_raiseNodeRemovedAction","onToolboxDragStart","_raiseToolboxDragStart","onToolboxDragEnd","_raiseToolboxDragEnd","onTextInputStart","_raiseTextInputStart","onTextInputEnd","_raiseTextInputEnd","onToggleFullscreen","_onToggleFullScreen","onShowContextMenu","_onShowContextMenu","onHideContextMenu","_onHideContextMenu","onShowContextToolbox","_onShowContextToolbox","onHideContextToolbox","_onHideContextToolbox","onNativeAction","notifyItemClick","_raiseItemClickAction","notifyItemDblClick","_raiseItemDblClickAction","notifySelectionChanged","_raiseSelectionChanged","onRequestOperation","_raiseRequestEditOperation","_updateEventSubscriptionMethods","_updateDefaultItemProperties","_updateEditingSettings","_updateShapeTexts","_updateUnitItems","_updateFormatUnitsMethod","_updateUnitsState","_updateReadOnlyState","_updatePageSizeItemsState","_updatePageSizeState","_updatePageOrientationState","_updatePageColorState","_updateViewUnitsState","_updateShowGridState","_updateSnapToGridState","_updateGridSizeState","_updateZoomLevelState","_updateSimpleViewState","_updateAutoZoomState","window","self","top","_updateFullscreenState","initMeasurer","_updateCustomShapes","_getCustomShapes","_refreshDataSources","optionsUpdateBar","_deleteOptionsUpdateBar","_clean","cleanMarkup","element","empty","_dispose","_executeDiagramCommand","parameter","execute","getNodeDataSource","_nodesOption","getDataSource","getEdgeDataSource","_edgesOption","_beginUpdateDiagram","_refreshNodesDataSource","_refreshEdgesDataSource","_endUpdateDiagram","_disposeDataSource","_refreshDataSource","_getDiagramData","value","DiagramCommand","Export","data","_setDiagramData","keepExistingItems","Import","_onDataSourceChanged","_getChangesKeys","changes","map","change","internalKey","key","_createOptionGetter","optionName","expr","_onRequestUpdateLayout","_requestLayoutUpdateAction","_createRequestLayoutUpdateAction","eventArgs","allowed","_createOptionSetter","_isBindingMode","ConnectorLineOption","ConnectorLineEnding","lineOptionGetter","lineOptionSetter","startLineEndingGetter","startLineEndingSetter","endLineEndingGetter","endLineEndingSetter","containerChildrenGetter","containerChildrenSetter","nodeDataSource","getItems","edgeDataSource","nodeDataImporter","getKey","setKey","getCustomData","setCustomData","getLocked","setLocked","getStyle","setStyle","getStyleText","setStyleText","getZIndex","setZIndex","getType","setType","getText","setText","getImage","setImage","getLeft","setLeft","getTop","setTop","getWidth","setWidth","setHeight","getParentKey","setParentKey","setItems","getChildren","setChildren","getContainerKey","setContainerKey","edgeDataImporter","getFrom","setFrom","getFromPointIndex","setFromPointIndex","getTo","setTo","getToPointIndex","setToPointIndex","getPoints","setPoints","getLineOption","obj","lineType","_getConnectorLineOption","setLineOption","Straight","Orthogonal","getStartLineEnding","lineEnd","_getConnectorLineEnding","setStartLineEnding","Arrow","OutlinedTriangle","FilledTriangle","None","getEndLineEnding","setEndLineEnding","layoutParameters","_getDataBindingLayoutParameters","BindDocument","_reloadContentByChanges","isExternalChanges","keys","applyLayout","_reloadContent","itemKeys","reloadContent","DataLayoutType","DataLayoutOrientation","layoutParametersOption","layoutType","type","parameters","_hasNodePositionExprs","Tree","Sugiyama","orientation","Vertical","Horizontal","skipPointIndices","autoSizeEnabled","_getAutoZoomValue","AutoZoomMode","FitContent","FitToWidth","Disabled","hasItems","Math","max","getGroups","_updateAllCustomShapes","removeAllCustomShapes","customShapes","prevCustomShapes","Array","isArray","removeCustomShapes","s","addCustomShapes","templateOption","template","_getTemplate","toolboxTemplateOption","toolboxTemplate","baseType","svgUrl","backgroundImageUrl","svgToolboxUrl","backgroundImageToolboxUrl","svgLeft","backgroundImageLeft","svgTop","backgroundImageTop","svgWidth","backgroundImageWidth","svgHeight","backgroundImageHeight","defaultWidth","defaultHeight","toolboxWidthToHeightRatio","minWidth","minHeight","maxWidth","maxHeight","allowResize","defaultText","allowEditText","textLeft","textTop","textWidth","textHeight","defaultImageUrl","allowEditImage","imageLeft","imageTop","imageWidth","imageHeight","connectionPoints","pt","x","y","createTemplate","item","render","model","_nativeItemToDiagramItem","createToolboxTemplate","destroyTemplate","templateLeft","templateTop","templateWidth","templateHeight","keepRatioOnAutoSize","_getViewport","$viewPort","closest","length","fullScreen","_changeNativeFullscreen","_prevParent","_prevFullScreenZIndex","_fullScreenZIndex","toggleClass","setModeOn","_inNativeFullscreen","_subscribeFullscreenNativeChanged","_unsubscribeFullscreenNativeChanged","_setNativeFullscreen","on","document","body","requestFullscreen","mozRequestFullscreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullscreen","webkitExitFullscreen","msExitFullscreen","fullscreenElement","msFullscreenElement","webkitFullscreenElement","isInFullscreen","webkitIsFullscreen","handler","_onNativeFullscreenChangeHandler","off","_executeDiagramFullscreenCommand","fullscreen","Fullscreen","selection","_hide","side","_getDiagramUnitValue","DiagramUnit","In","Cm","Px","readOnly","ToggleReadOnly","_updateZoomLevelItemsState","zoomLevel","ZoomLevel","_zoomLevel","_DiagramCommand","zoomLevelItems","ZoomLevelItems","SwitchAutoZoom","ToggleSimpleView","ShowGrid","SnapToGrid","_updateGridSizeItemsState","gridSize","GridSize","_gridSize","_DiagramCommand2","gridSizeItems","GridSizeItems","DiagramLocalizationService","items","_getUnitItems","_unitItems","unitItems","format","formatUnit","ViewUnits","Units","pageSize","width","PageSize","pageSizeItems","PageSizeItems","PageLandscape","PageColor","texts","_getShapeTexts","_shapeTexts","shapeTexts","ShapeTypes","Text","Rectangle","Ellipse","Cross","Triangle","Diamond","Heart","Pentagon","Hexagon","Octagon","Star","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","ArrowUpDown","ArrowLeftRight","Process","Decision","Terminator","PredefinedProcess","Document","MultipleDocuments","ManualInput","Preparation","Data","Database","HardDisk","InternalStorage","PaperTape","ManualOperation","Delay","StoredData","Display","Merge","Connector","Or","SummingJunction","Container","VerticalContainer","HorizontalContainer","Card","CardWithImageOnLeft","CardWithImageOnTop","CardWithImageOnRight","RenderHelper","addEventListener","eventName","removeEventListener","setInitialStyleProperties","setInitialTextStyleProperties","setInitialConnectorProperties","lineOption","startLineEnding","endLineEnding","applyShapeSizeSettings","shapeMinWidth","shapeMaxWidth","shapeMinHeight","shapeMaxHeight","applyOperationSettings","addShape","addShapeFromToolbox","deleteShape","deleteConnector","changeConnection","changeConnectorPoints","changeShapeText","changeConnectorText","resizeShape","moveShape","fitToContent","FitToScreen","fitToWidth","focus","exportTo","_getDiagramExportToCommand","ExportPng","ExportJpg","ExportSvg","import","updateExistingItemsOnly","updateToolbox","refreshToolbox","updateTooltips","updateFilter","_getDefaultOptions","simpleView","autoZoomMode","showGrid","snapToGrid","units","viewUnits","pageOrientation","pageColor","hasChanges","nodes","dataSource","keyExpr","customDataExpr","lockedExpr","styleExpr","textStyleExpr","zIndexExpr","typeExpr","textExpr","imageUrlExpr","parentKeyExpr","itemsExpr","leftExpr","topExpr","widthExpr","heightExpr","containerKeyExpr","containerChildrenExpr","autoLayout","edges","fromExpr","fromPointIndexExpr","toExpr","toPointIndexExpr","pointsExpr","lineTypeExpr","fromLineEndExpr","toLineEndExpr","toolbox","visibility","shapeIconsPerRow","mainToolbar","historyToolbar","viewToolbar","contextMenu","enabled","contextToolbox","propertiesPanel","defaultItemProperties","connectorLineType","connectorLineStart","connectorLineEnd","editing","allowAddShape","allowDeleteShape","allowDeleteConnector","allowChangeConnection","allowChangeConnectorPoints","allowChangeShapeText","allowChangeConnectorText","allowResizeShape","allowMoveShape","fileName","proxyUrl","onItemDblClick","onSelectionChanged","onRequestEditOperation","onRequestLayoutUpdate","_initialized","errorCallback","insert","update","_toolboxDragHidden","show","_propertiesPanelTextInputHidden","_toolboxTextInputHidden","_createItemClickAction","_itemClickAction","_createActionByOption","_createItemDblClickAction","_itemDblClickAction","_createSelectionChangedAction","_selectionChangedAction","_createRequestEditOperationAction","_requestEditOperationAction","nativeItem","nativeItems","operation","args","_getRequestEditOperationEventArgs","_getModelOperation","DiagramModelOperation","AddShape","AddShapeFromToolbox","DeleteShape","DeleteConnector","ChangeConnection","ChangeConnectorPoints","BeforeChangeShapeText","ChangeShapeText","BeforeChangeConnectorText","ChangeConnectorText","ResizeShape","MoveShape","ConnectorPosition","updateUI","reason","shape","position","connector","newShape","oldShape","connectionPointIndex","connectorPosition","Begin","newPoints","points","oldPoints","index","newSize","size","oldSize","newPosition","oldPosition","NativeShape","createMethod","_nativeShapeToDiagramShape","_nativeConnectorToDiagramConnector","id","dataItem","nativeShape","findItem","itemType","attachedConnectorIds","containerId","containerChildItemIds","containerExpanded","nativeConnector","fromKey","toKey","fromId","fromPointIndex","toId","toPointIndex","getItemByKey","getNativeItemByDataKey","getItemById","getNativeItemByKey","getNativeItems","getSelectedItems","getNativeSelectedItems","setSelectedItems","scrollToItem","scrollToItems","_invalidateContextMenuCommands","_invalidateMainToolbarCommands","_invalidateHistoryToolbarCommands","_invalidateViewToolbarCommands","_invalidateToolboxGroups","_optionChanged","isUpdateLocked","beginUpdate","_optionChangedCore","endUpdate","_invalidate","fullName","indexOf","previousValue"],"mappings":"AAAA;;;;;;;;AAQA,SACIA,aADJ,EAEIC,SAFJ,EAGIC,cAHJ,QAIO,uBAJP;AAKA,OAAOC,CAAP,MAAc,qBAAd;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,aAAP,MAA0B,mBAA1B;AACA,OAAOC,iBAAP,MAA8B,kCAA9B;AACA,SACIC,MADJ,QAEO,yBAFP;AAGA,SACIC,UADJ,EAEIC,SAFJ,QAGO,uBAHP;AAIA,SACIC,aADJ,EAEIC,aAFJ,QAGO,uBAHP;AAIA,OAAOC,aAAP,MAA0B,0BAA1B;AACA,SACIC,UADJ,QAEO,oBAFP;AAGA,SACIC,SADJ,EAEIC,SAFJ,QAGO,yBAHP;AAIA,SACIC,gBADJ,QAEO,oBAFP;AAGA,OAAOC,YAAP,MAAyB,iCAAzB;AACA,SACIC,YADJ,QAEO,0BAFP;AAGA,OAAOC,mBAAP,MAAgC,4BAAhC;AACA,OAAOC,kBAAP,MAA+B,2BAA/B;AACA,OAAO,KAAKC,UAAZ,MAA4B,oBAA5B;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,cAAP,MAA2B,sBAA3B;AACA,OAAOC,kBAAP,MAA+B,2BAA/B;AACA,OAAOC,qBAAP,MAAkC,8BAAlC;AACA,OAAOC,kBAAP,MAA+B,2BAA/B;AACA,OAAOC,wBAAP,MAAqC,iCAArC;AACA,OAAOC,wBAAP,MAAqC,2BAArC;AACA,OAAOC,qBAAP,MAAkC,8BAAlC;AACA,OAAOC,aAAP,MAA0B,sBAA1B;AACA,OAAOC,iBAAP,MAA8B,0BAA9B;AACA,OAAOC,qBAAP,MAAkC,2BAAlC;AACA,OAAOC,cAAP,MAA2B,sBAA3B;AACA,OAAOC,sBAAP,MAAmC,+BAAnC;AACA,OAAOC,uBAAP,MAAoC,0BAApC;AACA,OAAOC,oBAAP,MAAiC,6BAAjC;AACA,OAAOC,sBAAP,MAAmC,4BAAnC;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,IAAIC,aAAa,GAAG,YAApB;AACA,IAAIC,wBAAwB,GAAG,uBAA/B;AACA,IAAIC,6BAA6B,GAAGF,aAAa,GAAG,kBAApD;AACA,IAAIG,6BAA6B,GAAGH,aAAa,GAAG,kBAApD;AACA,IAAII,qBAAqB,GAAGJ,aAAa,GAAG,UAA5C;AACA,IAAIK,yBAAyB,GAAGL,aAAa,GAAG,cAAhD;AACA,IAAIM,wCAAwC,GAAGN,aAAa,GAAG,6BAA/D;AACA,IAAIO,gDAAgD,GAAGP,aAAa,GAAG,qCAAvE;AACA,IAAIQ,+BAA+B,GAAGR,aAAa,GAAG,oBAAtD;AACA,IAAIS,6BAA6B,GAAG,EAApC;AACA,IAAIC,oBAAoB,GAAG,IAA3B;AACA,IAAIC,yBAAyB,GAAG,CAAhC;AACA,IAAIC,6BAA6B,GAAG,UAApC;AACA,IAAIC,gCAAgC,GAAG,UAAvC;AACA,IAAIC,0BAA0B,GAAG,SAAjC;AACA,IAAIC,+BAA+B,GAAG,GAAtC;AACA,IAAIC,6BAA6B,GAAG,EAApC;AACA,IAAIC,8BAA8B,GAAG,CAArC;AACA,IAAIC,qCAAqC,GAAG,EAA5C;AACA,IAAIC,sCAAsC,GAAG,CAA7C;AACA,IAAIC,qCAAqC,GAAG,GAA5C;AACA,IAAIC,iBAAiB,GAAG,gBAAxB;AACA,IAAIC,4BAA4B,GAAG5C,YAAY,CAAC,kBAAD,EAAqB2C,iBAArB,CAA/C;AACA,IAAIE,+BAA+B,GAAG7C,YAAY,CAAC,oBAAD,EAAuB2C,iBAAvB,CAAlD;AACA,IAAIG,mCAAmC,GAAG9C,YAAY,CAAC,wBAAD,EAA2B2C,iBAA3B,CAAtD;AACA,IAAII,gCAAgC,GAAG/C,YAAY,CAAC,qBAAD,EAAwB2C,iBAAxB,CAAnD;;AACA,MAAMK,OAAN,SAAsB9D,MAAtB,CAA6B;AACzB+D,EAAAA,KAAK,GAAG;AACJ,SAAKC,uBAAL,GAA+B,CAA/B;AACA,SAAKC,oBAAL,GAA4B,CAA5B;AACA,SAAKC,SAAL,GAAiB,EAAjB;;AACA,UAAMH,KAAN;;AACA,SAAKI,YAAL;;AACA,SAAKC,oBAAL;AACH;;AACDC,EAAAA,WAAW,GAAG;AACV,UAAMA,WAAN;;AACA,SAAKH,SAAL,GAAiB,EAAjB;AACA,WAAO,KAAKI,mBAAZ;AACA,QAAIC,YAAY,GAAG,CAAC5D,SAAS,EAA7B;AACA,SAAK6D,QAAL,GAAgBC,QAAhB,CAAyBrC,aAAzB;AACA,WAAO,KAAKsC,YAAZ;;AACA,QAAI,KAAKC,MAAL,CAAY,qBAAZ,CAAJ,EAAwC;AACpC,WAAKC,kBAAL;AACH;;AACD,QAAIC,eAAe,GAAG9E,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoBlC,6BAApB,EAAmDuC,QAAnD,CAA4D,KAAKN,QAAL,EAA5D,CAAtB;AACA,WAAO,KAAKO,eAAZ;AACA,WAAO,KAAKC,6BAAZ;;AACA,QAAI,KAAKC,wBAAL,EAAJ,EAAqC;AACjC,WAAKC,qBAAL,CAA2BL,eAA3B;AACH;;AACD,WAAO,KAAKM,kBAAZ;AACA,WAAO,KAAKC,gCAAZ;;AACA,QAAI,KAAKC,yBAAL,EAAJ,EAAsC;AAClC,WAAKC,wBAAL,CAA8BT,eAA9B;AACH;;AACD,WAAO,KAAKU,YAAZ;AACA,WAAO,KAAKC,0BAAZ;;AACA,QAAI,KAAKb,MAAL,CAAY,qBAAZ,CAAJ,EAAwC;AACpC,WAAKc,kBAAL,CAAwBZ,eAAxB;AACH;;AACD,WAAO,KAAKa,QAAZ;AACA,WAAO,KAAKC,sBAAZ;;AACA,QAAI,KAAKC,iBAAL,EAAJ,EAA8B;AAC1B,WAAKC,cAAL,CAAoBhB,eAApB;AACH;;AACD,WAAO,KAAKiB,gBAAZ;AACA,WAAO,KAAKC,8BAAZ;;AACA,QAAI,KAAKV,yBAAL,EAAJ,EAAsC;AAClC,WAAKW,sBAAL,CAA4BnB,eAA5B;AACH;;AACD,SAAKoB,SAAL,GAAiBlG,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoBjC,qBAApB,EAA2CsC,QAA3C,CAAoDD,eAApD,CAAjB;AACA,WAAO,KAAKqB,YAAZ;AACA,SAAKC,gBAAL,CAAsBC,QAAtB,CAA+BC,kBAA/B,GAAoD,KAAK1B,MAAL,CAAY,qBAAZ,CAApD;;AACA,QAAI,KAAKwB,gBAAL,CAAsBC,QAAtB,CAA+BC,kBAAnC,EAAuD;AACnD,WAAKC,kBAAL,CAAwBzB,eAAxB;AACH;;AACD,WAAO,KAAK0B,eAAZ;;AACA,QAAI,KAAK5B,MAAL,CAAY,wBAAZ,CAAJ,EAA2C;AACvC,WAAK6B,qBAAL,CAA2B3B,eAA3B;AACH;;AACD,SAAK4B,aAAL,CAAmB5B,eAAnB;;AACA,QAAI,CAACN,YAAL,EAAmB;AACf,UAAImC,kBAAkB,GAAG3G,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoBhC,yBAApB,EAA+CqC,QAA/C,CAAwD,KAAKmB,SAA7D,CAAzB;;AACA,WAAKU,gBAAL,CAAsBD,kBAAtB,EAA0C/E,iBAA1C,EAA6D;AACzDiF,QAAAA,kBAAkB,EAAE,KAAKjC,MAAL,CAAY,oBAAZ,CADqC;AAEzDkC,QAAAA,eAAe,EAAEC,CAAC,IAAI;AAClB,eAAKX,gBAAL,CAAsBY,cAAtB,CAAqCD,CAAC,CAACE,OAAF,CAAU,CAAV,CAArC,EAAmDF,CAAC,CAACG,UAArD,EAAiEpC,eAAe,CAAC,CAAD,CAAhF;AACH;AAJwD,OAA7D;AAMH;;AACD,SAAKqC,wBAAL,CAA8BjF,sBAAsB,CAACkF,kCAArD,EAAyF,KAAKC,yBAAL,EAAzF;;AACA,SAAKF,wBAAL,CAA8BjF,sBAAsB,CAACoF,yBAArD,EAAgF,KAAKC,iBAAL,EAAhF;;AACA,SAAKC,uBAAL;AACH;;AACDC,EAAAA,iBAAiB,GAAG;AAChB,SAAKlD,mBAAL,GAA2B,KAAK,CAAhC;;AACA,SAAKmD,qBAAL;AACH;;AACDC,EAAAA,kBAAkB,CAACC,OAAD,EAAU;AACxB,QAAIA,OAAJ,EAAa;AACT,WAAKC,gBAAL;;AACA,WAAKC,OAAL;AACH;AACJ;;AACDJ,EAAAA,qBAAqB,GAAG;AACpB,SAAKtB,gBAAL,CAAsB2B,kBAAtB;;AACA,QAAI,KAAK9C,6BAAT,EAAwC;AACpC,WAAKA,6BAAL,CAAmC+C,IAAnC,CAAwC,IAAxC;AACH;;AACD,QAAI,KAAK3C,gCAAT,EAA2C;AACvC,WAAKA,gCAAL,CAAsC2C,IAAtC,CAA2C,IAA3C;AACH;;AACD,QAAI,KAAKhC,8BAAT,EAAyC;AACrC,WAAKA,8BAAL,CAAoCgC,IAApC,CAAyC,IAAzC;AACH;;AACD,QAAI,KAAKvC,0BAAT,EAAqC;AACjC,WAAKA,0BAAL,CAAgCuC,IAAhC,CAAqC,IAArC;AACH;;AACD,QAAI,KAAKpC,sBAAT,EAAiC;AAC7B,WAAKA,sBAAL,CAA4BoC,IAA5B,CAAiC,IAAjC;AACH;AACJ;;AACDC,EAAAA,kBAAkB,GAAG;AACjB,QAAI,KAAK,CAAL,KAAW,KAAK1D,mBAApB,EAAyC;AACrC,WAAKA,mBAAL,GAA2B3D,SAAS,MAAMf,aAAa,CAAC,KAAK4E,QAAL,EAAD,CAAb,GAAiCrB,+BAA3E;AACH;;AACD,WAAO,KAAKmB,mBAAZ;AACH;;AACD2D,EAAAA,aAAa,GAAG;AACZ,QAAI,KAAK9B,gBAAT,EAA2B;AACvB,WAAKA,gBAAL,CAAsB+B,YAAtB;AACH;AACJ;;AACDC,EAAAA,sBAAsB,GAAG;AACrB,SAAKC,oBAAL,GAA4BC,UAAU,CAAC,MAAM;AACzC,WAAKJ,aAAL;;AACA,aAAO,KAAKG,oBAAZ;AACH,KAHqC,EAGnC,GAHmC,CAAtC;AAIH;;AACDE,EAAAA,wBAAwB,GAAG;AACvB,QAAI,KAAKF,oBAAT,EAA+B;AAC3BG,MAAAA,YAAY,CAAC,KAAKH,oBAAN,CAAZ;AACA,aAAO,KAAKA,oBAAZ;AACH;AACJ;;AACDI,EAAAA,wBAAwB,GAAG;AACvB,SAAKL,sBAAL;AACH;;AACDM,EAAAA,gBAAgB,CAACC,SAAD,EAAY;AACxB,SAAKC,YAAL,CAAkBD,SAAlB;;AACA,SAAKxE,SAAL,CAAe0E,IAAf,CAAoBF,SAApB;AACH;;AACDC,EAAAA,YAAY,CAACD,SAAD,EAAY;AACpBA,IAAAA,SAAS,CAACG,GAAV,CAAcC,SAAd,CAAwBC,GAAxB,CAA4B,IAA5B;;AACA,SAAK5C,gBAAL,CAAsB6C,WAAtB,CAAkCN,SAAS,CAACG,GAA5C;AACH;;AACDI,EAAAA,mBAAmB,GAAG;AAClB,QAAIC,eAAe,GAAG,EAAtB;;AACA,QAAI,CAAC,KAAKtD,iBAAL,EAAL,EAA+B;AAC3BsD,MAAAA,eAAe,CAACN,IAAhB,CAAqB3G,sBAAsB,CAACoF,yBAA5C;AACH;;AACD,QAAI,CAAC,KAAKhC,yBAAL,EAAL,EAAuC;AACnC6D,MAAAA,eAAe,CAACN,IAAhB,CAAqB3G,sBAAsB,CAACkF,kCAA5C;AACH;;AACD,WAAO+B,eAAP;AACH;;AACDC,EAAAA,sBAAsB,GAAG;AACrB,WAAO;AACHC,MAAAA,cAAc,EAAEC,IAAI,IAAI;AACpB,YAAI;AACAX,UAAAA,SAAS,EAAEA;AADX,YAEAW,IAFJ;AAGA,eAAO,KAAKZ,gBAAL,CAAsBC,SAAtB,CAAP;AACH,OANE;AAOHY,MAAAA,2BAA2B,EAAEC,KAAK,IAAI;AAClC,YAAI;AACAb,UAAAA,SAAS,EAAEA;AADX,YAEAa,KAFJ;AAGA,eAAO,KAAKpD,gBAAL,CAAsBqD,mBAAtB,CAA0Cd,SAAS,CAACG,GAApD,CAAP;AACH,OAZE;AAaHY,MAAAA,WAAW,EAAE,KAAKC,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAbV;AAcHC,MAAAA,MAAM,EAAE,KAAKjF,MAAL,CAAY,QAAZ,CAdL;AAeHuE,MAAAA,eAAe,EAAE,KAAKD,mBAAL,EAfd;AAgBHY,MAAAA,iBAAiB,EAAE,KAAKC,kBAAL,CAAwBH,IAAxB,CAA6B,IAA7B,CAhBhB;AAiBHI,MAAAA,eAAe,EAAE,KAAKC,gBAAL,CAAsBL,IAAtB,CAA2B,IAA3B,CAjBd;AAkBHM,MAAAA,YAAY,EAAE,KAAKjC,kBAAL;AAlBX,KAAP;AAoBH;;AACD8B,EAAAA,kBAAkB,CAAChD,CAAD,EAAI;AAClB,YAAQA,CAAC,CAACoD,OAAV;AACI,WAAKjI,sBAAsB,CAACoF,yBAA5B;AACI,YAAI,KAAK3B,QAAT,EAAmB;AACf,eAAKA,QAAL,CAAcyE,MAAd;AACH;;AACD;;AACJ,WAAKlI,sBAAsB,CAACkF,kCAA5B;AACI,YAAI,KAAKrB,gBAAT,EAA2B;AACvB,eAAKA,gBAAL,CAAsBqE,MAAtB;AACH;;AATT;AAWH;;AACDH,EAAAA,gBAAgB,CAAClD,CAAD,EAAI;AAChB,SAAKsD,oBAAL,CAA0B;AACtBC,MAAAA,IAAI,EAAEvD,CAAC,CAACuD;AADc,KAA1B;AAGH;;AACDzF,EAAAA,kBAAkB,GAAG;AACjB,QAAI0F,eAAe,GAAGvK,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoBnC,6BAApB,EAAmDwC,QAAnD,CAA4D,KAAKN,QAAL,EAA5D,CAAtB;AACA,SAAKE,YAAL,GAAoB,KAAKiC,gBAAL,CAAsB2D,eAAtB,EAAuClJ,kBAAvC,EAA2DjB,MAAM,CAAC,KAAKgJ,sBAAL,EAAD,EAAgC;AACjHoB,MAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,sBAAZ,CADuG;AAEjH6F,MAAAA,cAAc,EAAE;AAFiG,KAAhC,CAAjE,CAApB;AAIH;;AACDvF,EAAAA,wBAAwB,GAAG;AACvB,WAAO,KAAKN,MAAL,CAAY,wBAAZ,KAAyC,CAAC,KAAK8F,cAAL,EAAjD;AACH;;AACDvF,EAAAA,qBAAqB,CAAC8B,OAAD,EAAU;AAC3B,QAAI0D,UAAU,GAAG3K,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoB/B,wCAApB,EAA8DoC,QAA9D,CAAuEkC,OAAvE,CAAjB;AACA,SAAKjC,eAAL,GAAuB,KAAK4B,gBAAL,CAAsB+D,UAAtB,EAAkCrJ,qBAAlC,EAAyDlB,MAAM,CAAC,KAAKgJ,sBAAL,EAAD,EAAgC;AAClHoB,MAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,yBAAZ,CADwG;AAElHgG,MAAAA,YAAY,EAAE;AAFoG,KAAhC,CAA/D,CAAvB;;AAIA,SAAKC,6BAAL;;AACA,SAAK5F,6BAAL,GAAqC,MAAM;AACvC,WAAKD,eAAL,CAAqBJ,MAArB,CAA4B,cAA5B,EAA4C,KAAKqD,kBAAL,EAA5C;AACH,KAFD;AAGH;;AACD4C,EAAAA,6BAA6B,GAAG;AAC5B,QAAI,CAACjK,SAAS,EAAd,EAAkB;AACd;AACH;;AACDH,IAAAA,aAAa,CAACqK,KAAd,CAAoB,KAAK9F,eAAL,CAAqBP,QAArB,EAApB,EAAqD;AACjDsG,MAAAA,EAAE,EAAE,UAD6C;AAEjDC,MAAAA,EAAE,EAAE,UAF6C;AAGjDC,MAAAA,EAAE,EAAE,KAAKjG,eAAL,CAAqBP,QAArB,GAAgCyG,MAAhC,EAH6C;AAIjDC,MAAAA,MAAM,EAAErI,6BAA6B,GAAG,GAAhC,GAAsCA;AAJG,KAArD;AAMH;;AACD+C,EAAAA,iBAAiB,GAAG;AAChB,WAAO,eAAe,KAAKjB,MAAL,CAAY,oBAAZ,CAAf,IAAoD,CAAC,KAAK8F,cAAL,EAA5D;AACH;;AACDnD,EAAAA,iBAAiB,GAAG;AAChB,WAAO,cAAc,KAAK3C,MAAL,CAAY,oBAAZ,CAAd,IAAmD,WAAW,KAAKA,MAAL,CAAY,oBAAZ,CAAX,IAAgD,CAAC,KAAKqD,kBAAL,EAA3G;AACH;;AACDnC,EAAAA,cAAc,CAACmB,OAAD,EAAU;AACpB,QAAIzC,YAAY,GAAG,CAAC5D,SAAS,EAA7B;AACA,QAAIwK,QAAQ,GAAGpL,CAAC,CAAC,OAAD,CAAD,CAAW+E,QAAX,CAAoBkC,OAApB,CAAf;;AACA,QAAIoE,MAAM,GAAG,KAAKC,iBAAL,CAAuBrE,OAAvB,EAAgCzC,YAAhC,CAAb;;AACA,SAAKmB,QAAL,GAAgB,KAAKiB,gBAAL,CAAsBwE,QAAtB,EAAgCtJ,cAAhC,EAAgD;AAC5DoI,MAAAA,YAAY,EAAE,KAAKjC,kBAAL,EAD8C;AAE5DsD,MAAAA,SAAS,EAAE,KAAKhE,iBAAL,EAFiD;AAG5DiE,MAAAA,SAAS,EAAE,KAAK/G,QAAL,EAHiD;AAI5DgH,MAAAA,MAAM,EAAEJ,MAAM,CAACI,MAJ6C;AAK5DC,MAAAA,YAAY,EAAEzE,OAL8C;AAM5D0E,MAAAA,OAAO,EAAEN,MAAM,CAACM,OAN4C;AAO5DC,MAAAA,OAAO,EAAEP,MAAM,CAACO,OAP4C;AAQ5DC,MAAAA,UAAU,EAAE,KAAKjH,MAAL,CAAY,oBAAZ,CARgD;AAS5DkH,MAAAA,aAAa,EAAE,KAAKC,iBAAL,EAT6C;AAU5DC,MAAAA,YAAY,EAAE,KAAKpH,MAAL,CAAY,eAAZ,CAV8C;AAW5DqH,MAAAA,uBAAuB,EAAElF,CAAC,IAAI;AAC1B,YAAIvC,YAAJ,EAAkB;AACd;AACH;;AACD,aAAK4B,gBAAL,CAAsB8F,aAAtB,CAAoCnF,CAAC,CAACtC,QAAF,CAAW,CAAX,CAApC,EAAmD,YAAYsC,CAAC,CAACoF,WAAjE,EAA8EpF,CAAC,CAACqF,MAAF,IAAYrF,CAAC,CAACsF,QAA5F,EAAsG;AAClGC,UAAAA,gBAAgB,EAAEjJ,6BADgF;AAElGkJ,UAAAA,mBAAmB,EAAE,KAAK3H,MAAL,CAAY,0BAAZ,CAF6E;AAGlG4H,UAAAA,mBAAmB,EAAE;AACjB,2BAAezF,CAAC,CAAC0F;AADA;AAH6E,SAAtG;AAOH,OAtB2D;AAuB5DC,MAAAA,eAAe,EAAE3F,CAAC,IAAI;AAClB,YAAIvC,YAAJ,EAAkB;AACd;AACH;;AACD,aAAK4B,gBAAL,CAAsBuG,kBAAtB,CAAyC5F,CAAC,CAAC6F,IAA3C,EAAiD7F,CAAC,CAAC8F,kBAAnD;AACH,OA5B2D;AA6B5DC,MAAAA,oBAAoB,EAAE/F,CAAC,IAAI;AACvB,YAAIvC,YAAJ,EAAkB;AACd;AACH;;AACD,aAAK2C,wBAAL,CAA8BjF,sBAAsB,CAACoF,yBAArD,EAAgFP,CAAC,CAACa,OAAlF;;AACA,YAAI,KAAK7B,gBAAT,EAA2B;AACvB,cAAIgB,CAAC,CAACa,OAAF,IAAa,KAAKK,kBAAL,EAAjB,EAA4C;AACxC,iBAAKlC,gBAAL,CAAsBgH,IAAtB;AACH;AACJ;;AACD,YAAI,KAAK/H,eAAT,EAA0B;AACtB,cAAI+B,CAAC,CAACa,OAAF,IAAa,KAAKK,kBAAL,EAAjB,EAA4C;AACxC,iBAAK+E,qBAAL,GAA6B9L,UAAU,CAAC+L,MAAX,CAAkB9L,OAAO,CAAC+L,UAAR,EAAlB,CAA7B;;AACA,iBAAKlI,eAAL,CAAqBP,QAArB,GAAgC0I,GAAhC,CAAoC,QAApC,EAA8C,KAAKH,qBAAnD;;AACA,iBAAKhI,eAAL,CAAqBP,QAArB,GAAgC0I,GAAhC,CAAoC,WAApC,EAAiD,MAAjD;AACH;AACJ;;AACD,YAAI,KAAK3H,YAAT,EAAuB;AACnB,eAAKA,YAAL,CAAkBf,QAAlB,GAA6B0I,GAA7B,CAAiC,SAAjC,EAA4CpG,CAAC,CAACa,OAAF,IAAa,KAAKK,kBAAL,EAAb,GAAyC,GAAzC,GAA+C,GAA3F;;AACA,eAAKzC,YAAL,CAAkBf,QAAlB,GAA6B0I,GAA7B,CAAiC,eAAjC,EAAkDpG,CAAC,CAACa,OAAF,IAAa,KAAKK,kBAAL,EAAb,GAAyC,MAAzC,GAAkD,EAApG;AACH;AACJ,OAlD2D;AAmD5DmF,MAAAA,mBAAmB,EAAErG,CAAC,IAAI;AACtB,YAAI,CAACA,CAAC,CAACa,OAAH,IAAc,CAAC,KAAKyF,iBAAxB,EAA2C;AACvC,eAAKnF,aAAL;AACH;;AACD,YAAI,CAAC1D,YAAL,EAAmB;AACf,cAAI,KAAKQ,eAAT,EAA0B;AACtB,gBAAI,CAAC+B,CAAC,CAACa,OAAH,IAAc,KAAKK,kBAAL,EAAd,IAA2C,KAAK+E,qBAApD,EAA2E;AACvE9L,cAAAA,UAAU,CAACoM,MAAX,CAAkB,KAAKN,qBAAvB;;AACA,mBAAKhI,eAAL,CAAqBP,QAArB,GAAgC0I,GAAhC,CAAoC,QAApC,EAA8C,EAA9C;;AACA,mBAAKnI,eAAL,CAAqBP,QAArB,GAAgC0I,GAAhC,CAAoC,WAApC,EAAiD,EAAjD;;AACA,mBAAKH,qBAAL,GAA6B,KAAK,CAAlC;AACH;AACJ;AACJ;AACJ,OAjE2D;AAkE5DtD,MAAAA,WAAW,EAAE,KAAKC,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B;AAlE+C,KAAhD,CAAhB;;AAoEA,SAAKjE,QAAL,CAAc4H,MAAd,CAAqB3I,MAArB,CAA4B,uBAA5B,EAAqD,CAAC,KAAKA,MAAL,CAAY,YAAZ,CAAtD;;AACA,SAAKgB,sBAAL,GAA8B,MAAM;AAChC,UAAIyF,MAAM,GAAG,KAAKC,iBAAL,CAAuBrE,OAAvB,EAAgCzC,YAAhC,CAAb;;AACA,WAAKmB,QAAL,CAAcf,MAAd,CAAqB,QAArB,EAA+ByG,MAAM,CAACI,MAAtC;;AACA,UAAI+B,gBAAgB,GAAG,KAAK7H,QAAL,CAAcf,MAAd,CAAqB,cAArB,CAAvB;;AACA,UAAI4I,gBAAgB,KAAK,KAAKvF,kBAAL,EAAzB,EAAoD;AAChD,aAAKtC,QAAL,CAAcf,MAAd,CAAqB;AACjBsF,UAAAA,YAAY,EAAE,KAAKjC,kBAAL,EADG;AAEjBsD,UAAAA,SAAS,EAAE,KAAKhE,iBAAL;AAFM,SAArB;;AAIA,aAAKJ,wBAAL,CAA8BjF,sBAAsB,CAACoF,yBAArD,EAAgF,KAAKC,iBAAL,EAAhF;AACH;;AACD,WAAK5B,QAAL,CAAc8H,eAAd;AACH,KAZD;AAaH;;AACDnC,EAAAA,iBAAiB,CAACrE,OAAD,EAAUzC,YAAV,EAAwB;AACrC,QAAIkJ,MAAM,GAAG;AACT/B,MAAAA,OAAO,EAAE7I,6BADA;AAET8I,MAAAA,OAAO,EAAE9I,6BAFA;AAGT2I,MAAAA,MAAM,EAAE,CAACjH,YAAD,GAAgB1E,SAAS,CAACmH,OAAD,CAAT,GAAqB,IAAInE,6BAAzC,GAAyE;AAHxE,KAAb;;AAKA,QAAI,KAAKkC,eAAL,IAAwB,CAACR,YAA7B,EAA2C;AACvCkJ,MAAAA,MAAM,CAAC9B,OAAP,IAAkB7L,cAAc,CAAC,KAAKiF,eAAL,CAAqBP,QAArB,EAAD,CAAd,GAAkD3B,6BAApE;AACA4K,MAAAA,MAAM,CAACjC,MAAP,IAAiB1L,cAAc,CAAC,KAAKiF,eAAL,CAAqBP,QAArB,EAAD,CAAd,GAAkD3B,6BAAnE;AACH;;AACD,QAAI,KAAK0C,YAAL,IAAqB,CAAChB,YAA1B,EAAwC;AACpCkJ,MAAAA,MAAM,CAACjC,MAAP,IAAiB1L,cAAc,CAAC,KAAKyF,YAAL,CAAkBf,QAAlB,EAAD,CAAd,GAA+C,KAAKkJ,sBAAL,CAA4BnJ,YAA5B,CAAhE;AACH;;AACD,WAAOkJ,MAAP;AACH;;AACDhI,EAAAA,kBAAkB,CAACuB,OAAD,EAAU;AACxB,QAAIzC,YAAY,GAAG,CAAC5D,SAAS,EAA7B;AACA,QAAI+J,UAAU,GAAG3K,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoB/B,wCAApB,EAA8DoC,QAA9D,CAAuEkC,OAAvE,CAAjB;AACA,SAAKzB,YAAL,GAAoB,KAAKoB,gBAAL,CAAsB+D,UAAtB,EAAkCpJ,kBAAlC,EAAsDnB,MAAM,CAAC,KAAKgJ,sBAAL,EAAD,EAAgC;AAC5GoB,MAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,sBAAZ,CADkG;AAE5GgG,MAAAA,YAAY,EAAE;AAF8F,KAAhC,CAA5D,CAApB;;AAIA,SAAKgD,0BAAL,CAAgCjD,UAAhC,EAA4C1D,OAA5C,EAAqDzC,YAArD;;AACA,SAAKiB,0BAAL,GAAkC,MAAM;AACpC,WAAKmI,0BAAL,CAAgCjD,UAAhC,EAA4C1D,OAA5C,EAAqDzC,YAArD;AACH,KAFD;AAGH;;AACDmJ,EAAAA,sBAAsB,CAACnJ,YAAD,EAAe;AACjC,QAAIA,YAAJ,EAAkB;AACd;AACH;;AACD,QAAIkJ,MAAM,GAAG5K,6BAAb;;AACA,QAAI,KAAK0C,YAAL,IAAqB,KAAKJ,kBAA9B,EAAkD;AAC9CsI,MAAAA,MAAM,IAAI,CAAC3N,cAAc,CAAC,KAAKqF,kBAAL,CAAwBX,QAAxB,EAAD,CAAd,GAAqD1E,cAAc,CAAC,KAAKyF,YAAL,CAAkBf,QAAlB,EAAD,CAApE,IAAsG,CAAhH;AACH;;AACD,WAAOiJ,MAAP;AACH;;AACDE,EAAAA,0BAA0B,CAACjD,UAAD,EAAa1D,OAAb,EAAsBzC,YAAtB,EAAoC;AAC1D,QAAIA,YAAJ,EAAkB;AACd;AACH;;AACD/D,IAAAA,aAAa,CAACqK,KAAd,CAAoBH,UAApB,EAAgC;AAC5BI,MAAAA,EAAE,EAAE,aADwB;AAE5BC,MAAAA,EAAE,EAAE,aAFwB;AAG5BC,MAAAA,EAAE,EAAEhE,OAHwB;AAI5BkE,MAAAA,MAAM,EAAErI,6BAA6B,GAAG,IAAhC,GAAuC,KAAK6K,sBAAL,CAA4BnJ,YAA5B;AAJnB,KAAhC;AAMH;;AACDc,EAAAA,yBAAyB,GAAG;AACxB,WAAO,eAAe,KAAKV,MAAL,CAAY,4BAAZ,CAAf,IAA4D,CAAC,KAAK8F,cAAL,EAApE;AACH;;AACDrD,EAAAA,yBAAyB,GAAG;AACxB,WAAO,cAAc,KAAKzC,MAAL,CAAY,4BAAZ,CAArB;AACH;;AACDW,EAAAA,wBAAwB,CAAC0B,OAAD,EAAU;AAC9B,QAAIzC,YAAY,GAAG,CAAC5D,SAAS,EAA7B;AACA,QAAI+J,UAAU,GAAG3K,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoB/B,wCAApB,EAA8D+B,QAA9D,CAAuE9B,gDAAvE,EAAyHmC,QAAzH,CAAkIkC,OAAlI,CAAjB;AACA,SAAK7B,kBAAL,GAA0B,KAAKwB,gBAAL,CAAsB+D,UAAtB,EAAkCnJ,wBAAlC,EAA4DpB,MAAM,CAAC,KAAKgJ,sBAAL,EAAD,EAAgC;AACxHyE,MAAAA,iBAAiB,EAAE,WADqG;AAExHC,MAAAA,UAAU,EAAE,SAF4G;AAGxHlD,MAAAA,YAAY,EAAE;AAH0G,KAAhC,CAAlE,CAA1B;;AAKA,SAAKmD,gCAAL,CAAsCpD,UAAtC,EAAkD1D,OAAlD,EAA2DzC,YAA3D;;AACA,SAAKa,gCAAL,GAAwC,MAAM;AAC1C,WAAK0I,gCAAL,CAAsCpD,UAAtC,EAAkD1D,OAAlD,EAA2DzC,YAA3D;AACH,KAFD;AAGH;;AACDuJ,EAAAA,gCAAgC,CAACpD,UAAD,EAAa1D,OAAb,EAAsBzC,YAAtB,EAAoC;AAChE,QAAIA,YAAJ,EAAkB;AACd;AACH;;AACD/D,IAAAA,aAAa,CAACqK,KAAd,CAAoBH,UAApB,EAAgC;AAC5BI,MAAAA,EAAE,EAAE,cADwB;AAE5BC,MAAAA,EAAE,EAAE,cAFwB;AAG5BC,MAAAA,EAAE,EAAEhE,OAHwB;AAI5BkE,MAAAA,MAAM,EAAE,MAAMrI,6BAAN,GAAsC,IAAtC,GAA6CA;AAJzB,KAAhC;AAMH;;AACDmD,EAAAA,sBAAsB,CAACgB,OAAD,EAAU;AAC5B,QAAIzC,YAAY,GAAG,CAAC5D,SAAS,EAA7B;AACA,QAAIoN,gBAAgB,GAAGhO,CAAC,CAAC,OAAD,CAAD,CAAW+E,QAAX,CAAoBkC,OAApB,CAAvB;AACA,QAAI0E,OAAO,GAAG7I,6BAAd;AACA,QAAI8I,OAAO,GAAG,IAAI9I,6BAAJ,IAAqC,CAAC0B,YAAD,GAAgBzE,cAAc,CAAC,KAAKqF,kBAAL,CAAwBX,QAAxB,EAAD,CAA9B,GAAqE,CAA1G,CAAd;AACA,SAAKsB,gBAAL,GAAwB,KAAKa,gBAAL,CAAsBoH,gBAAtB,EAAwCjM,sBAAxC,EAAgE;AACpFmI,MAAAA,YAAY,EAAE,KAAKjC,kBAAL,EADsE;AAEpFsD,MAAAA,SAAS,EAAE,KAAKlE,yBAAL,EAFyE;AAGpFmE,MAAAA,SAAS,EAAE,KAAK/G,QAAL,EAHyE;AAIpFiH,MAAAA,YAAY,EAAEzE,OAJsE;AAKpF0E,MAAAA,OAAO,EAAEA,OAL2E;AAMpFC,MAAAA,OAAO,EAAEA,OAN2E;AAOpFqC,MAAAA,YAAY,EAAE,KAAKrJ,MAAL,CAAY,sBAAZ,CAPsE;AAQpFsJ,MAAAA,eAAe,EAAEnH,CAAC,IAAI;AAClBA,QAAAA,CAAC,CAACoH,OAAF,GAAY,KAAKvH,gBAAL,CAAsBG,CAAC,CAACE,OAAxB,EAAiC7F,cAAjC,EAAiDhB,MAAM,CAAC,KAAKgJ,sBAAL,EAAD,EAAgC;AAC/FoB,UAAAA,QAAQ,EAAEzD,CAAC,CAACyD,QADmF;AAE/FI,UAAAA,YAAY,EAAE,OAFiF;AAG/FwD,UAAAA,iBAAiB,EAAE;AAH4E,SAAhC,CAAvD,CAAZ;AAKH,OAdmF;AAepFtB,MAAAA,oBAAoB,EAAE/F,CAAC,IAAI;AACvB,YAAIvC,YAAJ,EAAkB;AACd;AACH;;AACD,aAAK6J,+BAAL,CAAqCtH,CAAC,CAAC4B,SAAvC;;AACA,aAAKxB,wBAAL,CAA8BjF,sBAAsB,CAACkF,kCAArD,EAAyFL,CAAC,CAACa,OAA3F;;AACA,YAAI,KAAKjC,QAAT,EAAmB;AACf,cAAIoB,CAAC,CAACa,OAAF,IAAa,KAAKK,kBAAL,EAAjB,EAA4C;AACxC,iBAAKtC,QAAL,CAAcoH,IAAd;AACH;AACJ;AACJ,OA1BmF;AA2BpFK,MAAAA,mBAAmB,EAAErG,CAAC,IAAI;AACtB,YAAI,CAACA,CAAC,CAACa,OAAH,IAAc,CAAC,KAAKyF,iBAAxB,EAA2C;AACvC,eAAKnF,aAAL;AACH;AACJ,OA/BmF;AAgCpFoG,MAAAA,sBAAsB,EAAEC,KAAK,IAAI;AAC7B,YAAI;AACA5F,UAAAA,SAAS,EAAEA;AADX,YAEA4F,KAFJ;AAGA,eAAO,KAAKF,+BAAL,CAAqC1F,SAArC,CAAP;AACH,OArCmF;AAsCpFe,MAAAA,WAAW,EAAE,KAAKC,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B;AAtCuE,KAAhE,CAAxB;;AAwCA,SAAK5D,8BAAL,GAAsC,MAAM;AACxC,UAAIwH,gBAAgB,GAAG,KAAKzH,gBAAL,CAAsBnB,MAAtB,CAA6B,cAA7B,CAAvB;;AACA,UAAI4I,gBAAgB,KAAK,KAAKvF,kBAAL,EAAzB,EAAoD;AAChD,aAAKlC,gBAAL,CAAsBnB,MAAtB,CAA6B;AACzBsF,UAAAA,YAAY,EAAE,KAAKjC,kBAAL,EADW;AAEzBsD,UAAAA,SAAS,EAAE,KAAKlE,yBAAL;AAFc,SAA7B;;AAIA,aAAKF,wBAAL,CAA8BjF,sBAAsB,CAACkF,kCAArD,EAAyF,KAAKC,yBAAL,EAAzF;AACH;AACJ,KATD;AAUH;;AACDgH,EAAAA,+BAA+B,CAAC1F,SAAD,EAAY;AACvCA,IAAAA,SAAS,CAAC6F,iBAAV,GAA8BC,OAA9B,CAAsCN,OAAO,IAAI;AAC7C,WAAK/H,gBAAL,CAAsBqD,mBAAtB,CAA0C0E,OAAO,CAACrF,GAAlD;AACH,KAFD;AAGH;;AACDa,EAAAA,iBAAiB,GAAG;AAChB,SAAKvB,sBAAL;AACH;;AACD7B,EAAAA,kBAAkB,CAACU,OAAD,EAAU;AACxB,QAAIyH,YAAY,GAAG1O,CAAC,CAAC,OAAD,CAAD,CAAW+E,QAAX,CAAoBkC,OAApB,CAAnB;AACA,SAAKd,YAAL,GAAoB,KAAKS,gBAAL,CAAsB8H,YAAtB,EAAoCjN,wBAAwB,CAACkN,yBAA7D,EAAwF;AACxGnE,MAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,sBAAZ,CAD8F;AAExGyE,MAAAA,cAAc,EAAEuF,KAAK,IAAI;AACrB,YAAI;AACAjG,UAAAA,SAAS,EAAEA;AADX,YAEAiG,KAFJ;AAGA,eAAO,KAAKhG,YAAL,CAAkBD,SAAlB,CAAP;AACH,OAPuG;AAQxGmE,MAAAA,oBAAoB,EAAE+B,KAAK,IAAI;AAC3B,YAAI;AACAlG,UAAAA,SAAS,EAAEA;AADX,YAEAkG,KAFJ;AAGA,eAAO,KAAKzI,gBAAL,CAAsBqD,mBAAtB,CAA0Cd,SAAS,CAACG,GAApD,CAAP;AACH,OAbuG;AAcxGgG,MAAAA,WAAW,EAAEC,QAAQ,IAAI,KAAKC,wBAAL,CAA8BD,QAAQ,CAAC5E,OAAvC,CAd+E;AAexGN,MAAAA,MAAM,EAAE,KAAKjF,MAAL,CAAY,QAAZ,CAfgG;AAgBxGuE,MAAAA,eAAe,EAAE,KAAKD,mBAAL,EAhBuF;AAiBxGY,MAAAA,iBAAiB,EAAE,KAAKC,kBAAL,CAAwBH,IAAxB,CAA6B,IAA7B,CAjBqF;AAkBxGI,MAAAA,eAAe,EAAE,KAAKC,gBAAL,CAAsBL,IAAtB,CAA2B,IAA3B;AAlBuF,KAAxF,CAApB;AAoBH;;AACDnD,EAAAA,qBAAqB,CAACQ,OAAD,EAAU;AAC3B,QAAIzC,YAAY,GAAG,CAAC5D,SAAS,EAA7B;AACA,QAAIyL,QAAQ,GAAG,KAAKzH,MAAL,CAAY,yBAAZ,CAAf;AACA,QAAIuH,WAAW,GAAG,KAAKvH,MAAL,CAAY,4BAAZ,CAAlB;AACA,QAAIwH,MAAM,GAAG,KAAKxH,MAAL,CAAY,uBAAZ,CAAb;AACA,QAAIqK,eAAe,GAAGjP,CAAC,CAAC,OAAD,CAAD,CAAW+E,QAAX,CAAoBkC,OAApB,CAAtB;AACA,SAAKT,eAAL,GAAuB,KAAKI,gBAAL,CAAsBqI,eAAtB,EAAuCvN,qBAAvC,EAA8D;AACjFsK,MAAAA,YAAY,EAAE,KAAKpH,MAAL,CAAY,sBAAZ,CADmE;AAEjFsK,MAAAA,OAAO,EAAEnI,CAAC,IAAI;AACV,YAAIvC,YAAJ,EAAkB;AACd;AACH;;AACD,YAAI2K,iBAAiB,GAAGnP,CAAC,CAAC+G,CAAC,CAACtC,QAAH,CAAzB;AACA,YAAI2K,WAAW,GAAG,YAAYjD,WAA9B;;AACA,YAAI,CAACC,MAAD,IAAW,CAACC,QAAZ,IAAwB,CAAC+C,WAA7B,EAA0C;AACtC,cAAIC,KAAK,GAAG,KAAKtD,iBAAL,GAAyBuD,MAAzB,CAAiC,UAASC,CAAT,EAAY;AACrD,mBAAOA,CAAC,CAAClD,QAAF,KAAetF,CAAC,CAACsF,QAAxB;AACH,WAFW,EAER,CAFQ,CAAZ;;AAGA,cAAIgD,KAAJ,EAAW;AACPD,YAAAA,WAAW,GAAG,YAAYC,KAAK,CAAClD,WAAhC;AACH;AACJ;;AACD,aAAK/F,gBAAL,CAAsBoJ,oBAAtB,CAA2CL,iBAAiB,CAAC,CAAD,CAA5D,EAAiEC,WAAjE,EAA8EhD,MAAM,IAAIC,QAAV,IAAsBtF,CAAC,CAACsF,QAAtG,EAAgH;AAC5GC,UAAAA,gBAAgB,EAAE/I,qCAD0F;AAE5GgJ,UAAAA,mBAAmB,EAAE,KAAK3H,MAAL,CAAY,iCAAZ;AAFuF,SAAhH,EAGG6K,SAAS,IAAI;AACZ1I,UAAAA,CAAC,CAAC2I,QAAF,CAAWD,SAAX;;AACA,eAAKvH,aAAL;;AACAnB,UAAAA,CAAC,CAACgG,IAAF;AACH,SAPD;AAQH;AAxBgF,KAA9D,CAAvB;AA0BH;;AACD5F,EAAAA,wBAAwB,CAACgD,OAAD,EAAUwF,OAAV,EAAmB;AACvC,SAAKxL,SAAL,CAAesK,OAAf,CAAuBmB,EAAE,IAAI;AACzBA,MAAAA,EAAE,CAACC,iBAAH,CAAqB1F,OAArB,EAA8BwF,OAA9B;AACH,KAFD;AAGH;;AACDX,EAAAA,wBAAwB,CAAC7E,OAAD,EAAU;AAC9B,QAAI2F,gBAAgB,GAAG7N,oBAAoB,CAAC8N,mBAArB,CAAyC5F,OAAzC,CAAvB;;AACA,QAAI2F,gBAAJ,EAAsB;AAClB,WAAKE,WAAL,CAAiBF,gBAAjB;AACH;;AACD,WAAO,CAAC,CAACA,gBAAT;AACH;;AACDpJ,EAAAA,aAAa,CAACO,OAAD,EAAU;AACnB,QAAIgJ,cAAc,GAAGjQ,CAAC,CAAC,OAAD,CAAD,CAAW+E,QAAX,CAAoBkC,OAApB,CAArB;AACA,SAAKiJ,eAAL,GAAuB,KAAKtJ,gBAAL,CAAsBqJ,cAAtB,EAAsCtO,aAAtC,EAAqD,EAArD,CAAvB;AACH;;AACDqO,EAAAA,WAAW,CAACF,gBAAD,EAAmB;AAC1B,QAAI,KAAKI,eAAT,EAA0B;AACtB,WAAKA,eAAL,CAAqBtL,MAArB,CAA4B,cAA5B,EAA4CkL,gBAAgB,CAACK,YAA7D;;AACA,WAAKD,eAAL,CAAqBtL,MAArB,CAA4B,UAA5B,EAAwC,YAAW;AAC/C,aAAKsD,aAAL;AACH,OAFuC,CAEtC0B,IAFsC,CAEjC,IAFiC,CAAxC;;AAGA,WAAKsG,eAAL,CAAqBtL,MAArB,CAA4B,SAA5B,EAAuC,KAAKwB,gBAAL,CAAsBgK,UAAtB,CAAiCN,gBAAgB,CAAC3F,OAAlD,CAAvC;;AACA,WAAK+F,eAAL,CAAqBtL,MAArB,CAA4B,OAA5B,EAAqCkL,gBAAgB,CAACO,KAAtD;;AACA,WAAKH,eAAL,CAAqBI,KAArB;AACH;AACJ;;AACDC,EAAAA,qBAAqB,GAAG;AACpB,SAAKC,iBAAL,GAAyBxQ,CAAC,CAAC,OAAD,CAAD,CAAW0E,QAAX,CAAoB7B,+BAApB,CAAzB;;AACA,SAAK+D,gBAAL,CAAsB,KAAK4J,iBAA3B,EAA8CtQ,aAA9C,EAA6D,EAA7D;;AACA,QAAI+G,OAAO,GAAG,KAAKf,SAAL,IAAkB,KAAKzB,QAAL,EAAhC;AACAwC,IAAAA,OAAO,CAACwJ,MAAR,CAAe,KAAKD,iBAApB;AACH;;AACDE,EAAAA,qBAAqB,GAAG;AACpB,QAAI,CAAC,KAAKF,iBAAV,EAA6B;AACzB;AACH;;AACD,SAAKA,iBAAL,CAAuBlD,MAAvB;;AACA,SAAKkD,iBAAL,GAAyB,IAAzB;AACH;;AACDpM,EAAAA,YAAY,GAAG;AACX,QAAI;AACAuM,MAAAA,cAAc,EAAEA;AADhB,QAEAjQ,UAAU,EAFd;AAGA,SAAK0F,gBAAL,GAAwB,IAAIuK,cAAJ,EAAxB;AACA,SAAKvK,gBAAL,CAAsB2C,SAAtB,GAAkC,KAAK6H,sBAAL,CAA4BhH,IAA5B,CAAiC,IAAjC,CAAlC;AACA,SAAKxD,gBAAL,CAAsByK,cAAtB,GAAuC,KAAKC,wBAAL,CAA8BlH,IAA9B,CAAmC,IAAnC,CAAvC;AACA,SAAKxD,gBAAL,CAAsB2K,aAAtB,GAAsC,KAAKC,uBAAL,CAA6BpH,IAA7B,CAAkC,IAAlC,CAAtC;AACA,SAAKxD,gBAAL,CAAsB6K,aAAtB,GAAsC,KAAKC,uBAAL,CAA6BtH,IAA7B,CAAkC,IAAlC,CAAtC;AACA,SAAKxD,gBAAL,CAAsB+K,cAAtB,GAAuC,KAAKC,wBAAL,CAA8BxH,IAA9B,CAAmC,IAAnC,CAAvC;AACA,SAAKxD,gBAAL,CAAsBiL,aAAtB,GAAsC,KAAKC,uBAAL,CAA6B1H,IAA7B,CAAkC,IAAlC,CAAtC;AACA,SAAKxD,gBAAL,CAAsBmL,aAAtB,GAAsC,KAAKC,uBAAL,CAA6B5H,IAA7B,CAAkC,IAAlC,CAAtC;AACA,SAAKxD,gBAAL,CAAsBqL,kBAAtB,GAA2C,KAAKC,sBAAL,CAA4B9H,IAA5B,CAAiC,IAAjC,CAA3C;AACA,SAAKxD,gBAAL,CAAsBuL,gBAAtB,GAAyC,KAAKC,oBAAL,CAA0BhI,IAA1B,CAA+B,IAA/B,CAAzC;AACA,SAAKxD,gBAAL,CAAsByL,gBAAtB,GAAyC,KAAKC,oBAAL,CAA0BlI,IAA1B,CAA+B,IAA/B,CAAzC;AACA,SAAKxD,gBAAL,CAAsB2L,cAAtB,GAAuC,KAAKC,kBAAL,CAAwBpI,IAAxB,CAA6B,IAA7B,CAAvC;AACA,SAAKxD,gBAAL,CAAsB6L,kBAAtB,GAA2C,KAAKC,mBAAL,CAAyBtI,IAAzB,CAA8B,IAA9B,CAA3C;AACA,SAAKxD,gBAAL,CAAsB+L,iBAAtB,GAA0C,KAAKC,kBAAL,CAAwBxI,IAAxB,CAA6B,IAA7B,CAA1C;AACA,SAAKxD,gBAAL,CAAsBiM,iBAAtB,GAA0C,KAAKC,kBAAL,CAAwB1I,IAAxB,CAA6B,IAA7B,CAA1C;AACA,SAAKxD,gBAAL,CAAsBmM,oBAAtB,GAA6C,KAAKC,qBAAL,CAA2B5I,IAA3B,CAAgC,IAAhC,CAA7C;AACA,SAAKxD,gBAAL,CAAsBqM,oBAAtB,GAA6C,KAAKC,qBAAL,CAA2B9I,IAA3B,CAAgC,IAAhC,CAA7C;;AACA,SAAKxD,gBAAL,CAAsBuM,cAAtB,CAAqC3J,GAArC,CAAyC;AACrC4J,MAAAA,eAAe,EAAE,KAAKC,qBAAL,CAA2BjJ,IAA3B,CAAgC,IAAhC,CADoB;AAErCkJ,MAAAA,kBAAkB,EAAE,KAAKC,wBAAL,CAA8BnJ,IAA9B,CAAmC,IAAnC,CAFiB;AAGrCoJ,MAAAA,sBAAsB,EAAE,KAAKC,sBAAL,CAA4BrJ,IAA5B,CAAiC,IAAjC;AAHa,KAAzC;;AAKA,SAAKxD,gBAAL,CAAsB8M,kBAAtB,GAA2C,KAAKC,0BAAL,CAAgCvJ,IAAhC,CAAqC,IAArC,CAA3C;;AACA,SAAKwJ,+BAAL;;AACA,SAAKC,4BAAL;;AACA,SAAKC,sBAAL;;AACA,SAAKC,iBAAL;;AACA,SAAKC,gBAAL;;AACA,SAAKC,wBAAL;;AACA,QAAI,KAAK7O,MAAL,CAAY,OAAZ,MAAyB7B,oBAA7B,EAAmD;AAC/C,WAAK2Q,iBAAL;AACH;;AACD,QAAI,KAAKhJ,cAAL,EAAJ,EAA2B;AACvB,WAAKiJ,oBAAL;AACH;;AACD,QAAI,KAAK/O,MAAL,CAAY,UAAZ,CAAJ,EAA6B;AACzB,UAAI,KAAKA,MAAL,CAAY,gBAAZ,CAAJ,EAAmC;AAC/B,aAAKgP,yBAAL;AACH;;AACD,UAAI,KAAKhP,MAAL,CAAY,gBAAZ,KAAiC,KAAKA,MAAL,CAAY,iBAAZ,CAArC,EAAqE;AACjE,aAAKiP,oBAAL;AACH;AACJ;;AACD,QAAI,KAAKjP,MAAL,CAAY,iBAAZ,MAAmC1B,gCAAvC,EAAyE;AACrE,WAAK4Q,2BAAL;AACH;;AACD,QAAI,KAAKlP,MAAL,CAAY,WAAZ,MAA6BzB,0BAAjC,EAA6D;AACzD,WAAK4Q,qBAAL;AACH;;AACD,QAAI,KAAKnP,MAAL,CAAY,WAAZ,MAA6B7B,oBAAjC,EAAuD;AACnD,WAAKiR,qBAAL;AACH;;AACD,QAAI,CAAC,KAAKpP,MAAL,CAAY,UAAZ,CAAL,EAA8B;AAC1B,WAAKqP,oBAAL;AACH;;AACD,QAAI,CAAC,KAAKrP,MAAL,CAAY,YAAZ,CAAL,EAAgC;AAC5B,WAAKsP,sBAAL;AACH;;AACD,QAAI,KAAKtP,MAAL,CAAY,UAAZ,CAAJ,EAA6B;AACzB,WAAKuP,oBAAL;AACH;;AACD,QAAI,KAAKvP,MAAL,CAAY,WAAZ,MAA6B5B,yBAAjC,EAA4D;AACxD,WAAKoR,qBAAL;AACH;;AACD,QAAI,KAAKxP,MAAL,CAAY,YAAZ,CAAJ,EAA+B;AAC3B,WAAKyP,sBAAL;AACH;;AACD,QAAI,KAAKzP,MAAL,CAAY,cAAZ,MAAgC3B,6BAApC,EAAmE;AAC/D,WAAKqR,oBAAL;AACH;;AACD,QAAI,KAAK1P,MAAL,CAAY,YAAZ,CAAJ,EAA+B;AAC3B,UAAI2P,MAAM,GAAG5T,SAAS,EAAtB;;AACA,UAAI4T,MAAM,IAAIA,MAAM,CAACC,IAAP,KAAgBD,MAAM,CAACE,GAArC,EAA0C;AACtC,aAAK7P,MAAL,CAAY,YAAZ,EAA0B,KAA1B;AACH,OAFD,MAEO;AACH,aAAK8P,sBAAL;AACH;AACJ;;AACD,SAAKlN,uBAAL;;AACA,QAAI5G,SAAS,EAAb,EAAiB;AACb,WAAKwF,gBAAL,CAAsBuO,YAAtB,CAAmC,KAAKlQ,QAAL,GAAgB,CAAhB,CAAnC;AACH;;AACD,SAAKmQ,mBAAL,CAAyB,KAAKC,gBAAL,EAAzB;;AACA,SAAKC,mBAAL;AACH;;AACDtN,EAAAA,uBAAuB,GAAG;AACtB,QAAI,CAAC,KAAKuN,gBAAV,EAA4B;AACxB,WAAKA,gBAAL,GAAwB,IAAI/S,uBAAJ,CAA4B,IAA5B,CAAxB;;AACA,WAAKoE,gBAAL,CAAsB6C,WAAtB,CAAkC,KAAK8L,gBAAvC;AACH;AACJ;;AACDC,EAAAA,uBAAuB,GAAG;AACtB,WAAO,KAAKD,gBAAZ;AACH;;AACDE,EAAAA,MAAM,GAAG;AACL,QAAI,KAAK7O,gBAAT,EAA2B;AACvB,WAAKA,gBAAL,CAAsB8O,WAAtB,CAAkCC,OAAO,IAAI;AACzCnV,QAAAA,CAAC,CAACmV,OAAD,CAAD,CAAWC,KAAX;AACH,OAFD;;AAGA,WAAKJ,uBAAL;AACH;;AACD,UAAMC,MAAN;AACH;;AACDI,EAAAA,QAAQ,GAAG;AACP,SAAK9M,wBAAL;;AACA,UAAM8M,QAAN;;AACA,SAAKjP,gBAAL,GAAwB,KAAK,CAA7B;AACH;;AACDkP,EAAAA,sBAAsB,CAACnL,OAAD,EAAUoL,SAAV,EAAqB;AACvC,SAAKnP,gBAAL,CAAsBgK,UAAtB,CAAiCjG,OAAjC,EAA0CqL,OAA1C,CAAkDD,SAAlD;AACH;;AACDE,EAAAA,iBAAiB,GAAG;AAChB,WAAO,KAAKC,YAAL,IAAqB,KAAKA,YAAL,CAAkBC,aAAlB,EAA5B;AACH;;AACDC,EAAAA,iBAAiB,GAAG;AAChB,WAAO,KAAKC,YAAL,IAAqB,KAAKA,YAAL,CAAkBF,aAAlB,EAA5B;AACH;;AACDb,EAAAA,mBAAmB,GAAG;AAClB,SAAKgB,mBAAL;;AACA,SAAKC,uBAAL;;AACA,SAAKC,uBAAL;;AACA,SAAKC,iBAAL;AACH;;AACDF,EAAAA,uBAAuB,GAAG;AACtB,QAAI,KAAKL,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBQ,kBAAlB;;AACA,aAAO,KAAKR,YAAZ;AACH;;AACD,QAAI,KAAK9Q,MAAL,CAAY,kBAAZ,CAAJ,EAAqC;AACjC,WAAK8Q,YAAL,GAAoB,IAAIvT,WAAJ,CAAgB,IAAhB,CAApB;;AACA,WAAKuT,YAAL,CAAkB9Q,MAAlB,CAAyB,YAAzB,EAAuC,KAAKA,MAAL,CAAY,kBAAZ,CAAvC;;AACA,WAAK8Q,YAAL,CAAkBS,kBAAlB;AACH;AACJ;;AACDH,EAAAA,uBAAuB,GAAG;AACtB,QAAI,KAAKH,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBK,kBAAlB;;AACA,aAAO,KAAKL,YAAZ;AACH;;AACD,QAAI,KAAKjR,MAAL,CAAY,kBAAZ,CAAJ,EAAqC;AACjC,WAAKiR,YAAL,GAAoB,IAAIzT,WAAJ,CAAgB,IAAhB,CAApB;;AACA,WAAKyT,YAAL,CAAkBjR,MAAlB,CAAyB,YAAzB,EAAuC,KAAKA,MAAL,CAAY,kBAAZ,CAAvC;;AACA,WAAKiR,YAAL,CAAkBM,kBAAlB;AACH;AACJ;;AACDC,EAAAA,eAAe,GAAG;AACd,QAAIC,KAAJ;AACA,QAAI;AACAC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACC,MAA3C,EAAoD,UAASC,IAAT,EAAe;AAC/DH,MAAAA,KAAK,GAAGG,IAAR;AACH,KAFD;;AAGA,WAAOH,KAAP;AACH;;AACDI,EAAAA,eAAe,CAACD,IAAD,EAAOE,iBAAP,EAA0B;AACrC,QAAI;AACAJ,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACK,MAA3C,EAAmD;AAC/CH,MAAAA,IAAI,EAAEA,IADyC;AAE/CE,MAAAA,iBAAiB,EAAEA;AAF4B,KAAnD;AAIH;;AACDhM,EAAAA,cAAc,GAAG;AACb,WAAO,KAAK9F,MAAL,CAAY,UAAZ,KAA2B,KAAKA,MAAL,CAAY,UAAZ,CAAlC;AACH;;AACDgS,EAAAA,oBAAoB,GAAG;AACnB,SAAK/O,gBAAL;AACH;;AACDgP,EAAAA,eAAe,CAACC,OAAD,EAAU;AACrB,WAAOA,OAAO,CAACC,GAAR,CAAYC,MAAM,IAAI;AACzB,UAAI1W,SAAS,CAAC0W,MAAM,CAACC,WAAR,CAAb,EAAmC;AAC/B,eAAOD,MAAM,CAACC,WAAd;AACH,OAFD,MAEO,IAAI3W,SAAS,CAAC0W,MAAM,CAACE,GAAR,CAAb,EAA2B;AAC9B,eAAOF,MAAM,CAACE,GAAd;AACH,OAFM,MAEA;AACH,eAAO,IAAP;AACH;AACJ,KARM,EAQJ5H,MARI,CAQG4H,GAAG,IAAI5W,SAAS,CAAC4W,GAAD,CARnB,CAAP;AASH;;AACDC,EAAAA,mBAAmB,CAACC,UAAD,EAAa;AAC5B,QAAIC,IAAI,GAAG,KAAKzS,MAAL,CAAYwS,UAAZ,CAAX;AACA,WAAOC,IAAI,IAAI7W,aAAa,CAAC6W,IAAD,CAA5B;AACH;;AACDC,EAAAA,sBAAsB,CAACR,OAAD,EAAU;AAC5B,QAAI,CAAC,KAAKS,0BAAV,EAAsC;AAClC,WAAKC,gCAAL;AACH;;AACD,QAAIC,SAAS,GAAG;AACZX,MAAAA,OAAO,EAAEA,OADG;AAEZY,MAAAA,OAAO,EAAE;AAFG,KAAhB;;AAIA,SAAKH,0BAAL,CAAgCE,SAAhC;;AACA,WAAOA,SAAS,CAACC,OAAjB;AACH;;AACDC,EAAAA,mBAAmB,CAACP,UAAD,EAAa;AAC5B,QAAIC,IAAI,GAAG,KAAKzS,MAAL,CAAYwS,UAAZ,CAAX;;AACA,QAAI/W,UAAU,CAACgX,IAAD,CAAd,EAAsB;AAClB,aAAOA,IAAP;AACH;;AACD,WAAOA,IAAI,IAAI9W,aAAa,CAAC8W,IAAD,CAA5B;AACH;;AACDxP,EAAAA,gBAAgB,GAAG;AACf,QAAI,KAAK5D,uBAAL,IAAgC,CAAC,KAAK2T,cAAL,EAArC,EAA4D;AACxD;AACH;;AACD,QAAI;AACAtB,MAAAA,cAAc,EAAEA,cADhB;AAEAuB,MAAAA,mBAAmB,EAAEA,mBAFrB;AAGAC,MAAAA,mBAAmB,EAAEA;AAHrB,QAIApX,UAAU,EAJd;AAKA,QAAIqX,gBAAJ;AACA,QAAIC,gBAAJ;AACA,QAAIC,qBAAJ;AACA,QAAIC,qBAAJ;AACA,QAAIC,mBAAJ;AACA,QAAIC,mBAAJ;AACA,QAAIC,uBAAJ;AACA,QAAIC,uBAAJ;AACA,QAAI9B,IAAI,GAAG;AACP+B,MAAAA,cAAc,EAAE,KAAK7C,YAAL,IAAqB,KAAKA,YAAL,CAAkB8C,QAAlB,EAD9B;AAEPC,MAAAA,cAAc,EAAE,KAAK5C,YAAL,IAAqB,KAAKA,YAAL,CAAkB2C,QAAlB,EAF9B;AAGPE,MAAAA,gBAAgB,EAAE;AACdC,QAAAA,MAAM,EAAE,KAAKxB,mBAAL,CAAyB,eAAzB,CADM;AAEdyB,QAAAA,MAAM,EAAE,KAAKjB,mBAAL,CAAyB,eAAzB,CAFM;AAGdkB,QAAAA,aAAa,EAAE,KAAK1B,mBAAL,CAAyB,sBAAzB,CAHD;AAId2B,QAAAA,aAAa,EAAE,KAAKnB,mBAAL,CAAyB,sBAAzB,CAJD;AAKdoB,QAAAA,SAAS,EAAE,KAAK5B,mBAAL,CAAyB,kBAAzB,CALG;AAMd6B,QAAAA,SAAS,EAAE,KAAKrB,mBAAL,CAAyB,kBAAzB,CANG;AAOdsB,QAAAA,QAAQ,EAAE,KAAK9B,mBAAL,CAAyB,iBAAzB,CAPI;AAQd+B,QAAAA,QAAQ,EAAE,KAAKvB,mBAAL,CAAyB,iBAAzB,CARI;AASdwB,QAAAA,YAAY,EAAE,KAAKhC,mBAAL,CAAyB,qBAAzB,CATA;AAUdiC,QAAAA,YAAY,EAAE,KAAKzB,mBAAL,CAAyB,qBAAzB,CAVA;AAWd0B,QAAAA,SAAS,EAAE,KAAKlC,mBAAL,CAAyB,kBAAzB,CAXG;AAYdmC,QAAAA,SAAS,EAAE,KAAK3B,mBAAL,CAAyB,kBAAzB,CAZG;AAad4B,QAAAA,OAAO,EAAE,KAAKpC,mBAAL,CAAyB,gBAAzB,CAbK;AAcdqC,QAAAA,OAAO,EAAE,KAAK7B,mBAAL,CAAyB,gBAAzB,CAdK;AAed8B,QAAAA,OAAO,EAAE,KAAKtC,mBAAL,CAAyB,gBAAzB,CAfK;AAgBduC,QAAAA,OAAO,EAAE,KAAK/B,mBAAL,CAAyB,gBAAzB,CAhBK;AAiBdgC,QAAAA,QAAQ,EAAE,KAAKxC,mBAAL,CAAyB,oBAAzB,CAjBI;AAkBdyC,QAAAA,QAAQ,EAAE,KAAKjC,mBAAL,CAAyB,oBAAzB,CAlBI;AAmBdkC,QAAAA,OAAO,EAAE,KAAK1C,mBAAL,CAAyB,gBAAzB,CAnBK;AAoBd2C,QAAAA,OAAO,EAAE,KAAKnC,mBAAL,CAAyB,gBAAzB,CApBK;AAqBdoC,QAAAA,MAAM,EAAE,KAAK5C,mBAAL,CAAyB,eAAzB,CArBM;AAsBd6C,QAAAA,MAAM,EAAE,KAAKrC,mBAAL,CAAyB,eAAzB,CAtBM;AAuBdsC,QAAAA,QAAQ,EAAE,KAAK9C,mBAAL,CAAyB,iBAAzB,CAvBI;AAwBd+C,QAAAA,QAAQ,EAAE,KAAKvC,mBAAL,CAAyB,iBAAzB,CAxBI;AAyBd7X,QAAAA,SAAS,EAAE,KAAKqX,mBAAL,CAAyB,kBAAzB,CAzBG;AA0BdgD,QAAAA,SAAS,EAAE,KAAKxC,mBAAL,CAAyB,kBAAzB,CA1BG;AA2BdyC,QAAAA,YAAY,EAAE,KAAKjD,mBAAL,CAAyB,qBAAzB,CA3BA;AA4BdkD,QAAAA,YAAY,EAAE,KAAK1C,mBAAL,CAAyB,qBAAzB,CA5BA;AA6Bda,QAAAA,QAAQ,EAAE,KAAKrB,mBAAL,CAAyB,iBAAzB,CA7BI;AA8BdmD,QAAAA,QAAQ,EAAE,KAAK3C,mBAAL,CAAyB,iBAAzB,CA9BI;AA+Bd4C,QAAAA,WAAW,EAAElC,uBAAuB,GAAG,KAAKlB,mBAAL,CAAyB,6BAAzB,CA/BzB;AAgCdqD,QAAAA,WAAW,EAAElC,uBAAuB,GAAG,KAAKX,mBAAL,CAAyB,6BAAzB,CAhCzB;AAiCd8C,QAAAA,eAAe,EAAE,CAACpC,uBAAD,IAA4B,CAACC,uBAA7B,IAAwD,KAAKnB,mBAAL,CAAyB,wBAAzB,CAjC3D;AAkCduD,QAAAA,eAAe,EAAE,CAACrC,uBAAD,IAA4B,CAACC,uBAA7B,IAAwD,KAAKX,mBAAL,CAAyB,wBAAzB;AAlC3D,OAHX;AAuCPgD,MAAAA,gBAAgB,EAAE;AACdhC,QAAAA,MAAM,EAAE,KAAKxB,mBAAL,CAAyB,eAAzB,CADM;AAEdyB,QAAAA,MAAM,EAAE,KAAKjB,mBAAL,CAAyB,eAAzB,CAFM;AAGdkB,QAAAA,aAAa,EAAE,KAAK1B,mBAAL,CAAyB,sBAAzB,CAHD;AAId2B,QAAAA,aAAa,EAAE,KAAKnB,mBAAL,CAAyB,sBAAzB,CAJD;AAKdoB,QAAAA,SAAS,EAAE,KAAK5B,mBAAL,CAAyB,kBAAzB,CALG;AAMd6B,QAAAA,SAAS,EAAE,KAAKrB,mBAAL,CAAyB,kBAAzB,CANG;AAOdsB,QAAAA,QAAQ,EAAE,KAAK9B,mBAAL,CAAyB,iBAAzB,CAPI;AAQd+B,QAAAA,QAAQ,EAAE,KAAKvB,mBAAL,CAAyB,iBAAzB,CARI;AASdwB,QAAAA,YAAY,EAAE,KAAKhC,mBAAL,CAAyB,qBAAzB,CATA;AAUdiC,QAAAA,YAAY,EAAE,KAAKzB,mBAAL,CAAyB,qBAAzB,CAVA;AAWd0B,QAAAA,SAAS,EAAE,KAAKlC,mBAAL,CAAyB,kBAAzB,CAXG;AAYdmC,QAAAA,SAAS,EAAE,KAAK3B,mBAAL,CAAyB,kBAAzB,CAZG;AAadiD,QAAAA,OAAO,EAAE,KAAKzD,mBAAL,CAAyB,gBAAzB,CAbK;AAcd0D,QAAAA,OAAO,EAAE,KAAKlD,mBAAL,CAAyB,gBAAzB,CAdK;AAedmD,QAAAA,iBAAiB,EAAE,KAAK3D,mBAAL,CAAyB,0BAAzB,CAfL;AAgBd4D,QAAAA,iBAAiB,EAAE,KAAKpD,mBAAL,CAAyB,0BAAzB,CAhBL;AAiBdqD,QAAAA,KAAK,EAAE,KAAK7D,mBAAL,CAAyB,cAAzB,CAjBO;AAkBd8D,QAAAA,KAAK,EAAE,KAAKtD,mBAAL,CAAyB,cAAzB,CAlBO;AAmBduD,QAAAA,eAAe,EAAE,KAAK/D,mBAAL,CAAyB,wBAAzB,CAnBH;AAoBdgE,QAAAA,eAAe,EAAE,KAAKxD,mBAAL,CAAyB,wBAAzB,CApBH;AAqBdyD,QAAAA,SAAS,EAAE,KAAKjE,mBAAL,CAAyB,kBAAzB,CArBG;AAsBdkE,QAAAA,SAAS,EAAE,KAAK1D,mBAAL,CAAyB,kBAAzB,CAtBG;AAuBd8B,QAAAA,OAAO,EAAE,KAAKtC,mBAAL,CAAyB,gBAAzB,CAvBK;AAwBduC,QAAAA,OAAO,EAAE,KAAK/B,mBAAL,CAAyB,gBAAzB,CAxBK;AAyBd2D,QAAAA,aAAa,EAAE,CAACvD,gBAAgB,GAAG,KAAKZ,mBAAL,CAAyB,oBAAzB,CAApB,KAAuE,UAASoE,GAAT,EAAc;AAChG,cAAIC,QAAQ,GAAGzD,gBAAgB,CAACwD,GAAD,CAA/B;AACA,iBAAO,KAAKE,uBAAL,CAA6BD,QAA7B,CAAP;AACH,SAHqF,CAGpF5R,IAHoF,CAG/E,IAH+E,CAzBxE;AA6Bd8R,QAAAA,aAAa,EAAE,CAAC1D,gBAAgB,GAAG,KAAKL,mBAAL,CAAyB,oBAAzB,CAApB,KAAuE,UAAS4D,GAAT,EAAclF,KAAd,EAAqB;AACvG,kBAAQA,KAAR;AACI,iBAAKwB,mBAAmB,CAAC8D,QAAzB;AACItF,cAAAA,KAAK,GAAG,UAAR;AACA;;AACJ,iBAAKwB,mBAAmB,CAAC+D,UAAzB;AACIvF,cAAAA,KAAK,GAAG,YAAR;AALR;;AAOA2B,UAAAA,gBAAgB,CAACuD,GAAD,EAAMlF,KAAN,CAAhB;AACH,SATqF,CASpFzM,IAToF,CAS/E,IAT+E,CA7BxE;AAuCdiS,QAAAA,kBAAkB,EAAE,CAAC5D,qBAAqB,GAAG,KAAKd,mBAAL,CAAyB,uBAAzB,CAAzB,KAA+E,UAASoE,GAAT,EAAc;AAC7G,cAAIO,OAAO,GAAG7D,qBAAqB,CAACsD,GAAD,CAAnC;AACA,iBAAO,KAAKQ,uBAAL,CAA6BD,OAA7B,CAAP;AACH,SAHkG,CAGjGlS,IAHiG,CAG5F,IAH4F,CAvCrF;AA2CdoS,QAAAA,kBAAkB,EAAE,CAAC9D,qBAAqB,GAAG,KAAKP,mBAAL,CAAyB,uBAAzB,CAAzB,KAA+E,UAAS4D,GAAT,EAAclF,KAAd,EAAqB;AACpH,kBAAQA,KAAR;AACI,iBAAKyB,mBAAmB,CAACmE,KAAzB;AACI5F,cAAAA,KAAK,GAAG,OAAR;AACA;;AACJ,iBAAKyB,mBAAmB,CAACoE,gBAAzB;AACI7F,cAAAA,KAAK,GAAG,kBAAR;AACA;;AACJ,iBAAKyB,mBAAmB,CAACqE,cAAzB;AACI9F,cAAAA,KAAK,GAAG,gBAAR;AACA;;AACJ,iBAAKyB,mBAAmB,CAACsE,IAAzB;AACI/F,cAAAA,KAAK,GAAG,MAAR;AAXR;;AAaA6B,UAAAA,qBAAqB,CAACqD,GAAD,EAAMlF,KAAN,CAArB;AACH,SAfkG,CAejGzM,IAfiG,CAe5F,IAf4F,CA3CrF;AA2DdyS,QAAAA,gBAAgB,EAAE,CAAClE,mBAAmB,GAAG,KAAKhB,mBAAL,CAAyB,qBAAzB,CAAvB,KAA2E,UAASoE,GAAT,EAAc;AACvG,cAAIO,OAAO,GAAG3D,mBAAmB,CAACoD,GAAD,CAAjC;AACA,iBAAO,KAAKQ,uBAAL,CAA6BD,OAA7B,CAAP;AACH,SAH4F,CAG3FlS,IAH2F,CAGtF,IAHsF,CA3D/E;AA+Dd0S,QAAAA,gBAAgB,EAAE,CAAClE,mBAAmB,GAAG,KAAKT,mBAAL,CAAyB,qBAAzB,CAAvB,KAA2E,UAAS4D,GAAT,EAAclF,KAAd,EAAqB;AAC9G,kBAAQA,KAAR;AACI,iBAAKyB,mBAAmB,CAACmE,KAAzB;AACI5F,cAAAA,KAAK,GAAG,OAAR;AACA;;AACJ,iBAAKyB,mBAAmB,CAACoE,gBAAzB;AACI7F,cAAAA,KAAK,GAAG,kBAAR;AACA;;AACJ,iBAAKyB,mBAAmB,CAACqE,cAAzB;AACI9F,cAAAA,KAAK,GAAG,gBAAR;AACA;;AACJ,iBAAKyB,mBAAmB,CAACsE,IAAzB;AACI/F,cAAAA,KAAK,GAAG,MAAR;AAXR;;AAaA+B,UAAAA,mBAAmB,CAACmD,GAAD,EAAMlF,KAAN,CAAnB;AACH,SAf4F,CAe3FzM,IAf2F,CAetF,IAfsF;AA/D/E,OAvCX;AAuHP2S,MAAAA,gBAAgB,EAAE,KAAKC,+BAAL;AAvHX,KAAX;;AAyHA,SAAKlH,sBAAL,CAA4BgB,cAAc,CAACmG,YAA3C,EAAyDjG,IAAzD;AACH;;AACDkG,EAAAA,uBAAuB,CAAC5F,OAAD,EAAU6F,iBAAV,EAA6B;AAChD,QAAIC,IAAI,GAAG,KAAK/F,eAAL,CAAqBC,OAArB,CAAX;;AACA,QAAI+F,WAAW,GAAG,KAAKvF,sBAAL,CAA4BR,OAA5B,CAAlB;;AACA,SAAKgG,cAAL,CAAoBF,IAApB,EAA0BC,WAA1B,EAAuCF,iBAAvC;AACH;;AACDG,EAAAA,cAAc,CAACC,QAAD,EAAWF,WAAX,EAAwBF,iBAAxB,EAA2C;AACrD,SAAKvW,gBAAL,CAAsB4W,aAAtB,CAAoCD,QAApC,EAA8C,MAAM;AAChD,UAAIxE,cAAJ;AACA,UAAIE,cAAJ;;AACA,UAAI,KAAK/C,YAAL,IAAqBiH,iBAAzB,EAA4C;AACxCpE,QAAAA,cAAc,GAAG,KAAK7C,YAAL,CAAkB8C,QAAlB,EAAjB;AACH;;AACD,UAAI,KAAK3C,YAAL,IAAqB8G,iBAAzB,EAA4C;AACxClE,QAAAA,cAAc,GAAG,KAAK5C,YAAL,CAAkB2C,QAAlB,EAAjB;AACH;;AACD,aAAO;AACHD,QAAAA,cAAc,EAAEA,cADb;AAEHE,QAAAA,cAAc,EAAEA;AAFb,OAAP;AAIH,KAbD,EAaGoE,WAAW,IAAI,KAAKL,+BAAL,EAblB,EAa0DG,iBAb1D;AAcH;;AACDlB,EAAAA,uBAAuB,CAACD,QAAD,EAAW;AAC9B,QAAI;AACA3D,MAAAA,mBAAmB,EAAEA;AADrB,QAEAnX,UAAU,EAFd;;AAGA,YAAQ8a,QAAR;AACI,WAAK,UAAL;AACI,eAAO3D,mBAAmB,CAAC8D,QAA3B;;AACJ;AACI,eAAO9D,mBAAmB,CAAC+D,UAA3B;AAJR;AAMH;;AACDG,EAAAA,uBAAuB,CAACD,OAAD,EAAU;AAC7B,QAAI;AACAhE,MAAAA,mBAAmB,EAAEA;AADrB,QAEApX,UAAU,EAFd;;AAGA,YAAQob,OAAR;AACI,WAAK,OAAL;AACI,eAAOhE,mBAAmB,CAACmE,KAA3B;;AACJ,WAAK,kBAAL;AACI,eAAOnE,mBAAmB,CAACoE,gBAA3B;;AACJ,WAAK,gBAAL;AACI,eAAOpE,mBAAmB,CAACqE,cAA3B;;AACJ;AACI,eAAOrE,mBAAmB,CAACsE,IAA3B;AARR;AAUH;;AACDI,EAAAA,+BAA+B,GAAG;AAC9B,QAAI;AACAS,MAAAA,cAAc,EAAEA,cADhB;AAEAC,MAAAA,qBAAqB,EAAEA;AAFvB,QAGAxc,UAAU,EAHd;AAIA,QAAIyc,sBAAsB,GAAG,KAAKvY,MAAL,CAAY,kBAAZ,KAAmC,KAAhE;AACA,QAAIwY,UAAU,GAAGD,sBAAsB,CAACE,IAAvB,IAA+BF,sBAAhD;AACA,QAAIG,UAAU,GAAG,EAAjB;;AACA,QAAI,UAAUF,UAAV,KAAyB,WAAWA,UAAX,IAAyB,CAAC,KAAKG,qBAAL,EAAnD,CAAJ,EAAsF;AAClF,cAAQH,UAAR;AACI,aAAK,MAAL;AACIE,UAAAA,UAAU,CAACD,IAAX,GAAkBJ,cAAc,CAACO,IAAjC;AACA;;AACJ;AACIF,UAAAA,UAAU,CAACD,IAAX,GAAkBJ,cAAc,CAACQ,QAAjC;AALR;;AAOA,cAAQN,sBAAsB,CAACO,WAA/B;AACI,aAAK,UAAL;AACIJ,UAAAA,UAAU,CAACI,WAAX,GAAyBR,qBAAqB,CAACS,QAA/C;AACA;;AACJ,aAAK,YAAL;AACIL,UAAAA,UAAU,CAACI,WAAX,GAAyBR,qBAAqB,CAACU,UAA/C;AALR;;AAOA,UAAI,KAAKhZ,MAAL,CAAY,0BAAZ,KAA2C,KAAKA,MAAL,CAAY,wBAAZ,CAA/C,EAAsF;AAClF0Y,QAAAA,UAAU,CAACO,gBAAX,GAA8B,IAA9B;AACH;AACJ;;AACDP,IAAAA,UAAU,CAACQ,eAAX,GAA6B,CAAC,CAAC,KAAKlZ,MAAL,CAAY,uBAAZ,CAA/B;AACA,WAAO0Y,UAAP;AACH;;AACDC,EAAAA,qBAAqB,GAAG;AACpB,WAAO,KAAK3Y,MAAL,CAAY,eAAZ,KAAgC,KAAKA,MAAL,CAAY,gBAAZ,CAAvC;AACH;;AACDmZ,EAAAA,iBAAiB,CAACnZ,MAAD,EAAS;AACtB,QAAI;AACAoZ,MAAAA,YAAY,EAAEA;AADd,QAEAtd,UAAU,EAFd;;AAGA,YAAQkE,MAAR;AACI,WAAK,YAAL;AACI,eAAOoZ,YAAY,CAACC,UAApB;;AACJ,WAAK,UAAL;AACI,eAAOD,YAAY,CAACE,UAApB;;AACJ;AACI,eAAOF,YAAY,CAACG,QAApB;AANR;AAQH;;AACDvG,EAAAA,cAAc,GAAG;AACb,WAAO,KAAKlC,YAAL,IAAqB,KAAKA,YAAL,CAAkB0I,QAAlB,EAArB,IAAqD,KAAKvI,YAAL,IAAqB,KAAKA,YAAL,CAAkBuI,QAAlB,EAAjF;AACH;;AACDtI,EAAAA,mBAAmB,GAAG;AAClB,SAAK7R,uBAAL;AACH;;AACDgS,EAAAA,iBAAiB,GAAG;AAChB,SAAKhS,uBAAL,GAA+Boa,IAAI,CAACC,GAAL,CAAS,KAAKra,uBAAL,GAA+B,CAAxC,EAA2C,CAA3C,CAA/B;;AACA,QAAI,CAAC,KAAKA,uBAAV,EAAmC;AAC/B,WAAK4D,gBAAL;AACH;AACJ;;AACDgN,EAAAA,gBAAgB,GAAG;AACf,WAAO,KAAKjQ,MAAL,CAAY,cAAZ,KAA+B,EAAtC;AACH;;AACDmH,EAAAA,iBAAiB,GAAG;AAChB,WAAOlK,qBAAqB,CAAC0c,SAAtB,CAAgC,KAAK3Z,MAAL,CAAY,gBAAZ,CAAhC,CAAP;AACH;;AACD4Z,EAAAA,sBAAsB,GAAG;AACrB,SAAKpY,gBAAL,CAAsBqY,qBAAtB;;AACA,SAAK7J,mBAAL,CAAyB,KAAKC,gBAAL,EAAzB;AACH;;AACDD,EAAAA,mBAAmB,CAAC8J,YAAD,EAAeC,gBAAf,EAAiC;AAChD,QAAIC,KAAK,CAACC,OAAN,CAAcF,gBAAd,CAAJ,EAAqC;AACjC,WAAKvY,gBAAL,CAAsB0Y,kBAAtB,CAAyCH,gBAAgB,CAAC5H,GAAjB,CAAqBgI,CAAC,IAAIA,CAAC,CAAC1B,IAA5B,CAAzC;AACH;;AACD,QAAIuB,KAAK,CAACC,OAAN,CAAcH,YAAd,CAAJ,EAAiC;AAC7B,WAAKtY,gBAAL,CAAsB4Y,eAAtB,CAAsCN,YAAY,CAAC3H,GAAb,CAAiBgI,CAAC,IAAI;AACxD,YAAIE,cAAc,GAAGF,CAAC,CAACG,QAAF,IAAc,KAAKta,MAAL,CAAY,qBAAZ,CAAnC;;AACA,YAAIsa,QAAQ,GAAGD,cAAc,IAAI,KAAKE,YAAL,CAAkBF,cAAlB,CAAjC;;AACA,YAAIG,qBAAqB,GAAGL,CAAC,CAACM,eAAF,IAAqB,KAAKza,MAAL,CAAY,4BAAZ,CAAjD;;AACA,YAAIya,eAAe,GAAGD,qBAAqB,IAAI,KAAKD,YAAL,CAAkBC,qBAAlB,CAA/C;;AACA,eAAO;AACH/S,UAAAA,QAAQ,EAAE0S,CAAC,CAAC1S,QADT;AAEHgR,UAAAA,IAAI,EAAE0B,CAAC,CAAC1B,IAFL;AAGHiC,UAAAA,QAAQ,EAAEP,CAAC,CAACO,QAHT;AAIHjP,UAAAA,KAAK,EAAE0O,CAAC,CAAC1O,KAJN;AAKHkP,UAAAA,MAAM,EAAER,CAAC,CAACS,kBALP;AAMHC,UAAAA,aAAa,EAAEV,CAAC,CAACW,yBANd;AAOHC,UAAAA,OAAO,EAAEZ,CAAC,CAACa,mBAPR;AAQHC,UAAAA,MAAM,EAAEd,CAAC,CAACe,kBARP;AASHC,UAAAA,QAAQ,EAAEhB,CAAC,CAACiB,oBATT;AAUHC,UAAAA,SAAS,EAAElB,CAAC,CAACmB,qBAVV;AAWHC,UAAAA,YAAY,EAAEpB,CAAC,CAACoB,YAXb;AAYHC,UAAAA,aAAa,EAAErB,CAAC,CAACqB,aAZd;AAaHC,UAAAA,yBAAyB,EAAEtB,CAAC,CAACsB,yBAb1B;AAcHC,UAAAA,QAAQ,EAAEvB,CAAC,CAACuB,QAdT;AAeHC,UAAAA,SAAS,EAAExB,CAAC,CAACwB,SAfV;AAgBHC,UAAAA,QAAQ,EAAEzB,CAAC,CAACyB,QAhBT;AAiBHC,UAAAA,SAAS,EAAE1B,CAAC,CAAC0B,SAjBV;AAkBHC,UAAAA,WAAW,EAAE3B,CAAC,CAAC2B,WAlBZ;AAmBHC,UAAAA,WAAW,EAAE5B,CAAC,CAAC4B,WAnBZ;AAoBHC,UAAAA,aAAa,EAAE7B,CAAC,CAAC6B,aApBd;AAqBHC,UAAAA,QAAQ,EAAE9B,CAAC,CAAC8B,QArBT;AAsBHC,UAAAA,OAAO,EAAE/B,CAAC,CAAC+B,OAtBR;AAuBHC,UAAAA,SAAS,EAAEhC,CAAC,CAACgC,SAvBV;AAwBHC,UAAAA,UAAU,EAAEjC,CAAC,CAACiC,UAxBX;AAyBHC,UAAAA,eAAe,EAAElC,CAAC,CAACkC,eAzBhB;AA0BHC,UAAAA,cAAc,EAAEnC,CAAC,CAACmC,cA1Bf;AA2BHC,UAAAA,SAAS,EAAEpC,CAAC,CAACoC,SA3BV;AA4BHC,UAAAA,QAAQ,EAAErC,CAAC,CAACqC,QA5BT;AA6BHC,UAAAA,UAAU,EAAEtC,CAAC,CAACsC,UA7BX;AA8BHC,UAAAA,WAAW,EAAEvC,CAAC,CAACuC,WA9BZ;AA+BHC,UAAAA,gBAAgB,EAAExC,CAAC,CAACwC,gBAAF,IAAsBxC,CAAC,CAACwC,gBAAF,CAAmBxK,GAAnB,CAAuByK,EAAE,KAAK;AAClEC,YAAAA,CAAC,EAAED,EAAE,CAACC,CAD4D;AAElEC,YAAAA,CAAC,EAAEF,EAAE,CAACE;AAF4D,WAAL,CAAzB,CA/BrC;AAmCHC,UAAAA,cAAc,EAAEzC,QAAQ,KAAK,CAAC1T,SAAD,EAAYoW,IAAZ,KAAqB;AAC9C1C,YAAAA,QAAQ,CAAC2C,MAAT,CAAgB;AACZC,cAAAA,KAAK,EAAE,KAAKC,wBAAL,CAA8BH,IAA9B,CADK;AAEZpW,cAAAA,SAAS,EAAE3K,gBAAgB,CAACb,CAAC,CAACwL,SAAD,CAAF;AAFf,aAAhB;AAIH,WALuB,CAnCrB;AAyCHwW,UAAAA,qBAAqB,EAAE3C,eAAe,KAAK,CAAC7T,SAAD,EAAYoW,IAAZ,KAAqB;AAC5DvC,YAAAA,eAAe,CAACwC,MAAhB,CAAuB;AACnBC,cAAAA,KAAK,EAAE,KAAKC,wBAAL,CAA8BH,IAA9B,CADY;AAEnBpW,cAAAA,SAAS,EAAE3K,gBAAgB,CAACb,CAAC,CAACwL,SAAD,CAAF;AAFR,aAAvB;AAIH,WALqC,CAzCnC;AA+CHyW,UAAAA,eAAe,EAAE/C,QAAQ,KAAK1T,SAAS,IAAI;AACvCxL,YAAAA,CAAC,CAACwL,SAAD,CAAD,CAAa4J,KAAb;AACH,WAFwB,CA/CtB;AAkDH8M,UAAAA,YAAY,EAAEnD,CAAC,CAACmD,YAlDb;AAmDHC,UAAAA,WAAW,EAAEpD,CAAC,CAACoD,WAnDZ;AAoDHC,UAAAA,aAAa,EAAErD,CAAC,CAACqD,aApDd;AAqDHC,UAAAA,cAAc,EAAEtD,CAAC,CAACsD,cArDf;AAsDHC,UAAAA,mBAAmB,EAAEvD,CAAC,CAACuD;AAtDpB,SAAP;AAwDH,OA7DqC,CAAtC;AA8DH;AACJ;;AACDC,EAAAA,YAAY,GAAG;AACX,QAAIC,SAAS,GAAG,KAAK/d,QAAL,GAAgBge,OAAhB,CAAwB,cAAxB,CAAhB;AACA,WAAOD,SAAS,CAACE,MAAV,GAAmBF,SAAnB,GAA+BxiB,CAAC,CAAC,MAAD,CAAvC;AACH;;AACDkS,EAAAA,mBAAmB,CAACyQ,UAAD,EAAa;AAC5B,QAAI,KAAKze,oBAAL,GAA4B,CAAhC,EAAmC;AAC/B;AACH;;AACD,SAAK0e,uBAAL,CAA6BD,UAA7B;;AACA,QAAIA,UAAJ,EAAgB;AACZ,WAAKE,WAAL,GAAmB,KAAKpe,QAAL,GAAgByG,MAAhB,EAAnB;AACA,WAAK4X,qBAAL,GAA6B,KAAKre,QAAL,GAAgB0I,GAAhB,CAAoB,QAApB,CAA7B;AACA,WAAK4V,iBAAL,GAAyB7hB,UAAU,CAAC+L,MAAX,CAAkB9L,OAAO,CAAC+L,UAAR,EAAlB,CAAzB;AACA,WAAKzI,QAAL,GAAgB0I,GAAhB,CAAoB,QAApB,EAA8B,KAAK4V,iBAAnC;AACA,WAAKte,QAAL,GAAgBM,QAAhB,CAAyB,KAAKwd,YAAL,EAAzB;AACH,KAND,MAMO;AACH,WAAK9d,QAAL,GAAgBM,QAAhB,CAAyB,KAAK8d,WAA9B;;AACA,UAAI,KAAKE,iBAAT,EAA4B;AACxB7hB,QAAAA,UAAU,CAACoM,MAAX,CAAkB,KAAKyV,iBAAvB;AACA,aAAKte,QAAL,GAAgB0I,GAAhB,CAAoB,QAApB,EAA8B,KAAK2V,qBAAnC;AACH;AACJ;;AACD,SAAKre,QAAL,GAAgBue,WAAhB,CAA4B1gB,wBAA5B,EAAsDqgB,UAAtD;;AACA,SAAKjb,qBAAL;;AACA,QAAI,KAAK/B,QAAT,EAAmB;AACf,WAAKA,QAAL,CAAcmC,OAAd;;AACA,WAAKnC,QAAL,CAAc4H,MAAd,CAAqB3I,MAArB,CAA4B,uBAA5B,EAAqD,CAAC+d,UAAtD;AACH;;AACD,QAAI,KAAK5c,gBAAT,EAA2B;AACvB,WAAKA,gBAAL,CAAsB+B,OAAtB;AACH;;AACD,QAAI,KAAK9C,eAAT,EAA0B;AACtB,WAAK6F,6BAAL;AACH;AACJ;;AACD+X,EAAAA,uBAAuB,CAACK,SAAD,EAAY;AAC/B,QAAI1O,MAAM,GAAG5T,SAAS,EAAtB;;AACA,QAAI4T,MAAM,CAACC,IAAP,KAAgBD,MAAM,CAACE,GAAvB,IAA8BwO,SAAS,KAAK,KAAKC,mBAAL,EAAhD,EAA4E;AACxE;AACH;;AACD,QAAID,SAAJ,EAAe;AACX,WAAKE,iCAAL;AACH,KAFD,MAEO;AACH,WAAKC,mCAAL;AACH;;AACD,SAAKC,oBAAL,CAA0BJ,SAA1B;AACH;;AACDI,EAAAA,oBAAoB,CAACC,EAAD,EAAK;AACrB,QAAI/O,MAAM,GAAG5T,SAAS,EAAtB;AACA,QAAI4iB,QAAQ,GAAGhP,MAAM,CAACC,IAAP,CAAY+O,QAA3B;AACA,QAAIC,IAAI,GAAGjP,MAAM,CAACC,IAAP,CAAY+O,QAAZ,CAAqBC,IAAhC;;AACA,QAAIF,EAAJ,EAAQ;AACJ,UAAIE,IAAI,CAACC,iBAAT,EAA4B;AACxBD,QAAAA,IAAI,CAACC,iBAAL;AACH,OAFD,MAEO,IAAID,IAAI,CAACE,oBAAT,EAA+B;AAClCF,QAAAA,IAAI,CAACE,oBAAL;AACH,OAFM,MAEA,IAAIF,IAAI,CAACG,uBAAT,EAAkC;AACrCH,QAAAA,IAAI,CAACG,uBAAL;AACH,OAFM,MAEA,IAAIH,IAAI,CAACI,mBAAT,EAA8B;AACjCJ,QAAAA,IAAI,CAACI,mBAAL;AACH;AACJ,KAVD,MAUO,IAAIL,QAAQ,CAACM,cAAb,EAA6B;AAChCN,MAAAA,QAAQ,CAACM,cAAT;AACH,KAFM,MAEA,IAAIN,QAAQ,CAACO,mBAAb,EAAkC;AACrCP,MAAAA,QAAQ,CAACO,mBAAT;AACH,KAFM,MAEA,IAAIP,QAAQ,CAACQ,oBAAb,EAAmC;AACtCR,MAAAA,QAAQ,CAACQ,oBAAT;AACH,KAFM,MAEA,IAAIR,QAAQ,CAACS,gBAAb,EAA+B;AAClCT,MAAAA,QAAQ,CAACS,gBAAT;AACH;AACJ;;AACDd,EAAAA,mBAAmB,GAAG;AAClB,QAAIK,QAAQ,GAAG5iB,SAAS,GAAG4iB,QAA3B;AACA,QAAIU,iBAAiB,GAAGV,QAAQ,CAACU,iBAAT,IAA8BV,QAAQ,CAACW,mBAAvC,IAA8DX,QAAQ,CAACY,uBAA/F;AACA,QAAIC,cAAc,GAAGH,iBAAiB,KAAKV,QAAQ,CAACC,IAA/B,IAAuCD,QAAQ,CAACc,kBAArE;AACA,WAAO,CAAC,CAACD,cAAT;AACH;;AACDjB,EAAAA,iCAAiC,GAAG;AAChC,QAAII,QAAQ,GAAG5iB,SAAS,GAAG4iB,QAA3B;;AACA,QAAIe,OAAO,GAAG,KAAKC,gCAAL,CAAsC3a,IAAtC,CAA2C,IAA3C,CAAd;;AACA9I,IAAAA,YAAY,CAACwiB,EAAb,CAAgBC,QAAhB,EAA0B5f,4BAA1B,EAAwD2gB,OAAxD;AACAxjB,IAAAA,YAAY,CAACwiB,EAAb,CAAgBC,QAAhB,EAA0B3f,+BAA1B,EAA2D0gB,OAA3D;AACAxjB,IAAAA,YAAY,CAACwiB,EAAb,CAAgBC,QAAhB,EAA0B1f,mCAA1B,EAA+DygB,OAA/D;AACAxjB,IAAAA,YAAY,CAACwiB,EAAb,CAAgBC,QAAhB,EAA0Bzf,gCAA1B,EAA4DwgB,OAA5D;AACH;;AACDlB,EAAAA,mCAAmC,GAAG;AAClC,QAAIG,QAAQ,GAAG5iB,SAAS,GAAG4iB,QAA3B;AACAziB,IAAAA,YAAY,CAAC0jB,GAAb,CAAiBjB,QAAjB,EAA2B5f,4BAA3B;AACA7C,IAAAA,YAAY,CAAC0jB,GAAb,CAAiBjB,QAAjB,EAA2B3f,+BAA3B;AACA9C,IAAAA,YAAY,CAAC0jB,GAAb,CAAiBjB,QAAjB,EAA2B1f,mCAA3B;AACA/C,IAAAA,YAAY,CAAC0jB,GAAb,CAAiBjB,QAAjB,EAA2Bzf,gCAA3B;AACH;;AACDygB,EAAAA,gCAAgC,GAAG;AAC/B,QAAI,CAAC,KAAKrB,mBAAL,EAAL,EAAiC;AAC7B,WAAKE,mCAAL;;AACA,WAAKxe,MAAL,CAAY,YAAZ,EAA0B,KAA1B;AACH;AACJ;;AACD6f,EAAAA,gCAAgC,CAACC,UAAD,EAAa;AACzC,QAAI;AACApO,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;AAGA,SAAKwD,oBAAL;;AACA,SAAKoR,sBAAL,CAA4BgB,cAAc,CAACqO,UAA3C,EAAuDD,UAAvD;;AACA,SAAKxgB,oBAAL;AACH;;AACDkO,EAAAA,kBAAkB,CAACqP,CAAD,EAAIC,CAAJ,EAAOkD,SAAP,EAAkB;AAChC,QAAI,KAAKze,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBmK,KAAlB,CAAwBmR,CAAxB,EAA2BC,CAA3B,EAA8BkD,SAA9B;AACH;AACJ;;AACDtS,EAAAA,kBAAkB,GAAG;AACjB,QAAI,KAAKnM,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkB0e,KAAlB;AACH;AACJ;;AACDrS,EAAAA,qBAAqB,CAACiP,CAAD,EAAIC,CAAJ,EAAOoD,IAAP,EAAazY,QAAb,EAAuBqD,QAAvB,EAAiC;AAClD,QAAI,KAAKlJ,eAAT,EAA0B;AACtB,WAAKA,eAAL,CAAqB8J,KAArB,CAA2BmR,CAA3B,EAA8BC,CAA9B,EAAiCoD,IAAjC,EAAuCzY,QAAvC,EAAiDqD,QAAjD;AACH;AACJ;;AACDgD,EAAAA,qBAAqB,GAAG;AACpB,QAAI,KAAKlM,eAAT,EAA0B;AACtB,WAAKA,eAAL,CAAqBqe,KAArB;AACH;AACJ;;AACDE,EAAAA,oBAAoB,CAAC1O,KAAD,EAAQ;AACxB,QAAI;AACA2O,MAAAA,WAAW,EAAEA;AADb,QAEAtkB,UAAU,EAFd;;AAGA,YAAQ2V,KAAR;AACI,WAAK,IAAL;AACI,eAAO2O,WAAW,CAACC,EAAnB;;AACJ,WAAK,IAAL;AACI,eAAOD,WAAW,CAACE,EAAnB;;AACJ,WAAK,IAAL;AACI,eAAOF,WAAW,CAACG,EAAnB;;AACJ;AACI,eAAOH,WAAW,CAACC,EAAnB;AARR;AAUH;;AACDtR,EAAAA,oBAAoB,GAAG;AACnB,QAAI;AACA2C,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;AAGA,QAAI0kB,QAAQ,GAAG,KAAK1a,cAAL,EAAf;;AACA,SAAK4K,sBAAL,CAA4BgB,cAAc,CAAC+O,cAA3C,EAA2DD,QAA3D;AACH;;AACDhR,EAAAA,qBAAqB,GAAG;AACpB,QAAI,KAAKxP,MAAL,CAAY,iBAAZ,CAAJ,EAAoC;AAChC,WAAK0gB,0BAAL;;AACA,UAAIC,SAAS,GAAG,KAAK3gB,MAAL,CAAY,iBAAZ,CAAhB;;AACA,UAAI,CAAC2gB,SAAL,EAAgB;AACZ;AACH;;AACD,UAAI;AACAjP,QAAAA,cAAc,EAAEA;AADhB,UAEA5V,UAAU,EAFd;;AAGA,WAAK4U,sBAAL,CAA4BgB,cAAc,CAACkP,SAA3C,EAAsDD,SAAtD;AACH,KAVD,MAUO;AACH,UAAIE,UAAU,GAAG,KAAK7gB,MAAL,CAAY,iBAAZ,KAAkC,KAAKA,MAAL,CAAY,WAAZ,CAAnD;;AACA,UAAI,CAAC6gB,UAAL,EAAiB;AACb;AACH;;AACD,UAAI;AACAnP,QAAAA,cAAc,EAAEoP;AADhB,UAEAhlB,UAAU,EAFd;;AAGA,WAAK4U,sBAAL,CAA4BoQ,eAAe,CAACF,SAA5C,EAAuDC,UAAvD;AACH;AACJ;;AACDH,EAAAA,0BAA0B,GAAG;AACzB,QAAIK,cAAc,GAAG,KAAK/gB,MAAL,CAAY,iBAAZ,CAArB;;AACA,QAAI,CAACga,KAAK,CAACC,OAAN,CAAc8G,cAAd,CAAL,EAAoC;AAChC;AACH;;AACD,QAAI;AACArP,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACsP,cAA3C,EAA2DD,cAA3D;AACH;;AACDrR,EAAAA,oBAAoB,GAAG;AACnB,QAAI;AACAgC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACuP,cAA3C,EAA2D,KAAK9H,iBAAL,CAAuB,KAAKnZ,MAAL,CAAY,cAAZ,CAAvB,CAA3D;AACH;;AACDyP,EAAAA,sBAAsB,GAAG;AACrB,QAAI;AACAiC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACwP,gBAA3C,EAA6D,KAAKlhB,MAAL,CAAY,YAAZ,CAA7D;AACH;;AACD8P,EAAAA,sBAAsB,GAAG;AACrB,QAAIgQ,UAAU,GAAG,KAAK9f,MAAL,CAAY,YAAZ,CAAjB;;AACA,SAAK6f,gCAAL,CAAsCC,UAAtC;;AACA,SAAKxS,mBAAL,CAAyBwS,UAAzB;AACH;;AACDzQ,EAAAA,oBAAoB,GAAG;AACnB,QAAI;AACAqC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACyP,QAA3C,EAAqD,KAAKnhB,MAAL,CAAY,UAAZ,CAArD;AACH;;AACDsP,EAAAA,sBAAsB,GAAG;AACrB,QAAI;AACAoC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAAC0P,UAA3C,EAAuD,KAAKphB,MAAL,CAAY,YAAZ,CAAvD;AACH;;AACDuP,EAAAA,oBAAoB,GAAG;AACnB,QAAI,KAAKvP,MAAL,CAAY,gBAAZ,CAAJ,EAAmC;AAC/B,WAAKqhB,yBAAL;;AACA,UAAIC,QAAQ,GAAG,KAAKthB,MAAL,CAAY,gBAAZ,CAAf;;AACA,UAAI,CAACshB,QAAL,EAAe;AACX;AACH;;AACD,UAAI;AACA5P,QAAAA,cAAc,EAAEA;AADhB,UAEA5V,UAAU,EAFd;;AAGA,WAAK4U,sBAAL,CAA4BgB,cAAc,CAAC6P,QAA3C,EAAqDD,QAArD;AACH,KAVD,MAUO;AACH,UAAIE,SAAS,GAAG,KAAKxhB,MAAL,CAAY,gBAAZ,KAAiC,KAAKA,MAAL,CAAY,UAAZ,CAAjD;;AACA,UAAI,CAACwhB,SAAL,EAAgB;AACZ;AACH;;AACD,UAAI;AACA9P,QAAAA,cAAc,EAAE+P;AADhB,UAEA3lB,UAAU,EAFd;;AAGA,WAAK4U,sBAAL,CAA4B+Q,gBAAgB,CAACF,QAA7C,EAAuDC,SAAvD;AACH;AACJ;;AACDH,EAAAA,yBAAyB,GAAG;AACxB,QAAIK,aAAa,GAAG,KAAK1hB,MAAL,CAAY,gBAAZ,CAApB;;AACA,QAAI,CAACga,KAAK,CAACC,OAAN,CAAcyH,aAAd,CAAL,EAAmC;AAC/B;AACH;;AACD,QAAI;AACAhQ,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACiQ,aAA3C,EAA0DD,aAA1D;AACH;;AACD9S,EAAAA,gBAAgB,GAAG;AACf,QAAI;AACAgT,MAAAA,0BAA0B,EAAEA;AAD5B,QAEA9lB,UAAU,EAFd;;AAGA,QAAI+lB,KAAK,GAAG,KAAKC,aAAL,EAAZ;;AACA,QAAI,KAAKC,UAAL,KAAoBF,KAAxB,EAA+B;AAC3B,WAAKE,UAAL,GAAkBF,KAAlB;AACAD,MAAAA,0BAA0B,CAACI,SAA3B,GAAuCH,KAAvC;AACH;AACJ;;AACDC,EAAAA,aAAa,GAAG;AACZ,QAAI;AACA1B,MAAAA,WAAW,EAAEA;AADb,QAEAtkB,UAAU,EAFd;AAGA,QAAI+lB,KAAK,GAAG,EAAZ;AACAA,IAAAA,KAAK,CAACzB,WAAW,CAACC,EAAb,CAAL,GAAwBjkB,mBAAmB,CAAC6lB,MAApB,CAA2B,kBAA3B,CAAxB;AACAJ,IAAAA,KAAK,CAACzB,WAAW,CAACE,EAAb,CAAL,GAAwBlkB,mBAAmB,CAAC6lB,MAApB,CAA2B,kBAA3B,CAAxB;AACAJ,IAAAA,KAAK,CAACzB,WAAW,CAACG,EAAb,CAAL,GAAwBnkB,mBAAmB,CAAC6lB,MAApB,CAA2B,kBAA3B,CAAxB;AACA,WAAOJ,KAAP;AACH;;AACDhT,EAAAA,wBAAwB,GAAG;AACvB,QAAI;AACA+S,MAAAA,0BAA0B,EAAEA;AAD5B,QAEA9lB,UAAU,EAFd;;AAGA8lB,IAAAA,0BAA0B,CAACM,UAA3B,GAAwC,UAASzQ,KAAT,EAAgB;AACpD,aAAOpV,kBAAkB,CAAC4lB,MAAnB,CAA0BxQ,KAA1B,CAAP;AACH,KAFD;AAGH;;AACDrC,EAAAA,qBAAqB,GAAG;AACpB,QAAI;AACAsC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACyQ,SAA3C,EAAsD,KAAKhC,oBAAL,CAA0B,KAAKngB,MAAL,CAAY,WAAZ,CAA1B,CAAtD;AACH;;AACD8O,EAAAA,iBAAiB,GAAG;AAChB,QAAI;AACA4C,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAAC0Q,KAA3C,EAAkD,KAAKjC,oBAAL,CAA0B,KAAKngB,MAAL,CAAY,OAAZ,CAA1B,CAAlD;AACH;;AACDiP,EAAAA,oBAAoB,GAAG;AACnB,QAAIoT,QAAQ,GAAG,KAAKriB,MAAL,CAAY,UAAZ,CAAf;;AACA,QAAI,CAACqiB,QAAD,IAAa,CAACA,QAAQ,CAACC,KAAvB,IAAgC,CAACD,QAAQ,CAACxb,MAA9C,EAAsD;AAClD;AACH;;AACD,QAAI;AACA6K,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAAC6Q,QAA3C,EAAqDF,QAArD;AACH;;AACDrT,EAAAA,yBAAyB,GAAG;AACxB,QAAIwT,aAAa,GAAG,KAAKxiB,MAAL,CAAY,gBAAZ,CAApB;;AACA,QAAI,CAACga,KAAK,CAACC,OAAN,CAAcuI,aAAd,CAAL,EAAmC;AAC/B;AACH;;AACD,QAAI;AACA9Q,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAAC+Q,aAA3C,EAA0DD,aAA1D;AACH;;AACDtT,EAAAA,2BAA2B,GAAG;AAC1B,QAAI;AACAwC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACgR,aAA3C,EAA0D,gBAAgB,KAAK1iB,MAAL,CAAY,iBAAZ,CAA1E;AACH;;AACDmP,EAAAA,qBAAqB,GAAG;AACpB,QAAI;AACAuC,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAACiR,SAA3C,EAAsD,KAAK3iB,MAAL,CAAY,WAAZ,CAAtD;AACH;;AACD2O,EAAAA,iBAAiB,GAAG;AAChB,QAAI;AACAiT,MAAAA,0BAA0B,EAAEA;AAD5B,QAEA9lB,UAAU,EAFd;;AAGA,QAAI8mB,KAAK,GAAG,KAAKC,cAAL,EAAZ;;AACA,QAAI,KAAKC,WAAL,KAAqBF,KAAzB,EAAgC;AAC5B,WAAKE,WAAL,GAAmBF,KAAnB;AACAhB,MAAAA,0BAA0B,CAACmB,UAA3B,GAAwCH,KAAxC;AACH;AACJ;;AACDC,EAAAA,cAAc,GAAG;AACb,QAAI;AACAG,MAAAA,UAAU,EAAEA;AADZ,QAEAlnB,UAAU,EAFd;AAGA,QAAI8mB,KAAK,GAAG,EAAZ;AACAA,IAAAA,KAAK,CAACI,UAAU,CAACC,IAAZ,CAAL,GAAyB7mB,mBAAmB,CAAC6lB,MAApB,CAA2B,qBAA3B,CAAzB;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACE,SAAZ,CAAL,GAA8B9mB,mBAAmB,CAAC6lB,MAApB,CAA2B,0BAA3B,CAA9B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACG,OAAZ,CAAL,GAA4B/mB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACI,KAAZ,CAAL,GAA0BhnB,mBAAmB,CAAC6lB,MAApB,CAA2B,sBAA3B,CAA1B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACK,QAAZ,CAAL,GAA6BjnB,mBAAmB,CAAC6lB,MAApB,CAA2B,yBAA3B,CAA7B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACM,OAAZ,CAAL,GAA4BlnB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACO,KAAZ,CAAL,GAA0BnnB,mBAAmB,CAAC6lB,MAApB,CAA2B,sBAA3B,CAA1B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACQ,QAAZ,CAAL,GAA6BpnB,mBAAmB,CAAC6lB,MAApB,CAA2B,yBAA3B,CAA7B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACS,OAAZ,CAAL,GAA4BrnB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACU,OAAZ,CAAL,GAA4BtnB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACW,IAAZ,CAAL,GAAyBvnB,mBAAmB,CAAC6lB,MAApB,CAA2B,qBAA3B,CAAzB;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACY,SAAZ,CAAL,GAA8BxnB,mBAAmB,CAAC6lB,MAApB,CAA2B,0BAA3B,CAA9B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACa,OAAZ,CAAL,GAA4BznB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACc,UAAZ,CAAL,GAA+B1nB,mBAAmB,CAAC6lB,MAApB,CAA2B,2BAA3B,CAA/B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACe,SAAZ,CAAL,GAA8B3nB,mBAAmB,CAAC6lB,MAApB,CAA2B,0BAA3B,CAA9B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACgB,WAAZ,CAAL,GAAgC5nB,mBAAmB,CAAC6lB,MAApB,CAA2B,4BAA3B,CAAhC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACiB,cAAZ,CAAL,GAAmC7nB,mBAAmB,CAAC6lB,MAApB,CAA2B,+BAA3B,CAAnC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACkB,OAAZ,CAAL,GAA4B9nB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACmB,QAAZ,CAAL,GAA6B/nB,mBAAmB,CAAC6lB,MAApB,CAA2B,yBAA3B,CAA7B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACoB,UAAZ,CAAL,GAA+BhoB,mBAAmB,CAAC6lB,MAApB,CAA2B,2BAA3B,CAA/B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACqB,iBAAZ,CAAL,GAAsCjoB,mBAAmB,CAAC6lB,MAApB,CAA2B,kCAA3B,CAAtC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACsB,QAAZ,CAAL,GAA6BloB,mBAAmB,CAAC6lB,MAApB,CAA2B,yBAA3B,CAA7B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACuB,iBAAZ,CAAL,GAAsCnoB,mBAAmB,CAAC6lB,MAApB,CAA2B,kCAA3B,CAAtC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACwB,WAAZ,CAAL,GAAgCpoB,mBAAmB,CAAC6lB,MAApB,CAA2B,4BAA3B,CAAhC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACyB,WAAZ,CAAL,GAAgCroB,mBAAmB,CAAC6lB,MAApB,CAA2B,4BAA3B,CAAhC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC0B,IAAZ,CAAL,GAAyBtoB,mBAAmB,CAAC6lB,MAApB,CAA2B,qBAA3B,CAAzB;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC2B,QAAZ,CAAL,GAA6BvoB,mBAAmB,CAAC6lB,MAApB,CAA2B,yBAA3B,CAA7B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC4B,QAAZ,CAAL,GAA6BxoB,mBAAmB,CAAC6lB,MAApB,CAA2B,yBAA3B,CAA7B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC6B,eAAZ,CAAL,GAAoCzoB,mBAAmB,CAAC6lB,MAApB,CAA2B,gCAA3B,CAApC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC8B,SAAZ,CAAL,GAA8B1oB,mBAAmB,CAAC6lB,MAApB,CAA2B,0BAA3B,CAA9B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC+B,eAAZ,CAAL,GAAoC3oB,mBAAmB,CAAC6lB,MAApB,CAA2B,gCAA3B,CAApC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACgC,KAAZ,CAAL,GAA0B5oB,mBAAmB,CAAC6lB,MAApB,CAA2B,sBAA3B,CAA1B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACiC,UAAZ,CAAL,GAA+B7oB,mBAAmB,CAAC6lB,MAApB,CAA2B,2BAA3B,CAA/B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACkC,OAAZ,CAAL,GAA4B9oB,mBAAmB,CAAC6lB,MAApB,CAA2B,wBAA3B,CAA5B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACmC,KAAZ,CAAL,GAA0B/oB,mBAAmB,CAAC6lB,MAApB,CAA2B,sBAA3B,CAA1B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACoC,SAAZ,CAAL,GAA8BhpB,mBAAmB,CAAC6lB,MAApB,CAA2B,0BAA3B,CAA9B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACqC,EAAZ,CAAL,GAAuBjpB,mBAAmB,CAAC6lB,MAApB,CAA2B,mBAA3B,CAAvB;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACsC,eAAZ,CAAL,GAAoClpB,mBAAmB,CAAC6lB,MAApB,CAA2B,gCAA3B,CAApC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACuC,SAAZ,CAAL,GAA8BnpB,mBAAmB,CAAC6lB,MAApB,CAA2B,qCAA3B,CAA9B;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACwC,iBAAZ,CAAL,GAAsCppB,mBAAmB,CAAC6lB,MAApB,CAA2B,kCAA3B,CAAtC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAACyC,mBAAZ,CAAL,GAAwCrpB,mBAAmB,CAAC6lB,MAApB,CAA2B,oCAA3B,CAAxC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC0C,IAAZ,CAAL,GAAyBtpB,mBAAmB,CAAC6lB,MAApB,CAA2B,gCAA3B,CAAzB;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC2C,mBAAZ,CAAL,GAAwCvpB,mBAAmB,CAAC6lB,MAApB,CAA2B,oCAA3B,CAAxC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC4C,kBAAZ,CAAL,GAAuCxpB,mBAAmB,CAAC6lB,MAApB,CAA2B,mCAA3B,CAAvC;AACAW,IAAAA,KAAK,CAACI,UAAU,CAAC6C,oBAAZ,CAAL,GAAyCzpB,mBAAmB,CAAC6lB,MAApB,CAA2B,qCAA3B,CAAzC;AACA,WAAOW,KAAP;AACH;;AACDpU,EAAAA,+BAA+B,GAAG;AAC9B,QAAI;AACAsX,MAAAA,YAAY,EAAEA;AADd,QAEAhqB,UAAU,EAFd;;AAGAgqB,IAAAA,YAAY,CAACC,gBAAb,GAAgC,CAACxV,OAAD,EAAUyV,SAAV,EAAqBtG,OAArB,KAAiC;AAC7DxjB,MAAAA,YAAY,CAACwiB,EAAb,CAAgBnO,OAAhB,EAAyByV,SAAzB,EAAoCtG,OAApC;AACH,KAFD;;AAGAoG,IAAAA,YAAY,CAACG,mBAAb,GAAmC,CAAC1V,OAAD,EAAUyV,SAAV,EAAqBtG,OAArB,KAAiC;AAChExjB,MAAAA,YAAY,CAAC0jB,GAAb,CAAiBrP,OAAjB,EAA0ByV,SAA1B,EAAqCtG,OAArC;AACH,KAFD;AAGH;;AACDjR,EAAAA,4BAA4B,GAAG;AAC3B,QAAI,KAAKzO,MAAL,CAAY,6BAAZ,CAAJ,EAAgD;AAC5C,WAAKwB,gBAAL,CAAsB0kB,yBAAtB,CAAgD,KAAKlmB,MAAL,CAAY,6BAAZ,CAAhD;AACH;;AACD,QAAI,KAAKA,MAAL,CAAY,iCAAZ,CAAJ,EAAoD;AAChD,WAAKwB,gBAAL,CAAsB2kB,6BAAtB,CAAoD,KAAKnmB,MAAL,CAAY,iCAAZ,CAApD;AACH;;AACD,SAAKwB,gBAAL,CAAsB4kB,6BAAtB,CAAoD;AAChDC,MAAAA,UAAU,EAAE,KAAKxP,uBAAL,CAA6B,KAAK7W,MAAL,CAAY,yCAAZ,CAA7B,CADoC;AAEhDsmB,MAAAA,eAAe,EAAE,KAAKnP,uBAAL,CAA6B,KAAKnX,MAAL,CAAY,0CAAZ,CAA7B,CAF+B;AAGhDumB,MAAAA,aAAa,EAAE,KAAKpP,uBAAL,CAA6B,KAAKnX,MAAL,CAAY,wCAAZ,CAA7B;AAHiC,KAApD;;AAKA,SAAKwB,gBAAL,CAAsBglB,sBAAtB,CAA6C;AACzCC,MAAAA,aAAa,EAAE,KAAKzmB,MAAL,CAAY,qCAAZ,CAD0B;AAEzC0mB,MAAAA,aAAa,EAAE,KAAK1mB,MAAL,CAAY,qCAAZ,CAF0B;AAGzC2mB,MAAAA,cAAc,EAAE,KAAK3mB,MAAL,CAAY,sCAAZ,CAHyB;AAIzC4mB,MAAAA,cAAc,EAAE,KAAK5mB,MAAL,CAAY,sCAAZ;AAJyB,KAA7C;AAMH;;AACD0O,EAAAA,sBAAsB,GAAG;AACrB,SAAKlN,gBAAL,CAAsBqlB,sBAAtB,CAA6C;AACzCC,MAAAA,QAAQ,EAAE,KAAK9mB,MAAL,CAAY,uBAAZ,CAD+B;AAEzC+mB,MAAAA,mBAAmB,EAAE,KAAK/mB,MAAL,CAAY,uBAAZ,CAFoB;AAGzCgnB,MAAAA,WAAW,EAAE,KAAKhnB,MAAL,CAAY,0BAAZ,CAH4B;AAIzCinB,MAAAA,eAAe,EAAE,KAAKjnB,MAAL,CAAY,8BAAZ,CAJwB;AAKzCknB,MAAAA,gBAAgB,EAAE,KAAKlnB,MAAL,CAAY,+BAAZ,CALuB;AAMzCmnB,MAAAA,qBAAqB,EAAE,KAAKnnB,MAAL,CAAY,oCAAZ,CANkB;AAOzConB,MAAAA,eAAe,EAAE,KAAKpnB,MAAL,CAAY,8BAAZ,CAPwB;AAQzCqnB,MAAAA,mBAAmB,EAAE,KAAKrnB,MAAL,CAAY,kCAAZ,CARoB;AASzCsnB,MAAAA,WAAW,EAAE,KAAKtnB,MAAL,CAAY,0BAAZ,CAT4B;AAUzCunB,MAAAA,SAAS,EAAE,KAAKvnB,MAAL,CAAY,wBAAZ;AAV8B,KAA7C;AAYH;;AACDwnB,EAAAA,YAAY,GAAG;AACX,QAAI;AACA9V,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAAC+V,WAA3C;AACH;;AACDC,EAAAA,UAAU,GAAG;AACT,QAAI;AACAhW,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,SAAK4U,sBAAL,CAA4BgB,cAAc,CAAC4H,UAA3C;AACH;;AACDqO,EAAAA,KAAK,GAAG;AACJ,SAAKrkB,aAAL;AACH;;AACD2B,EAAAA,MAAM,GAAI;AACN,WAAO,KAAKuM,eAAL,EAAP;AACH;;AACDoW,EAAAA,QAAQ,CAAC3F,MAAD,EAASnX,QAAT,EAAmB;AACvB,QAAIvF,OAAO,GAAG,KAAKsiB,0BAAL,CAAgC5F,MAAhC,CAAd;;AACA,SAAKvR,sBAAL,CAA4BnL,OAA5B,EAAqCuF,QAArC;AACH;;AACD+c,EAAAA,0BAA0B,CAAC5F,MAAD,EAAS;AAC/B,QAAI;AACAvQ,MAAAA,cAAc,EAAEA;AADhB,QAEA5V,UAAU,EAFd;;AAGA,YAAQmmB,MAAR;AACI,WAAK,KAAL;AACI,eAAOvQ,cAAc,CAACoW,SAAtB;;AACJ,WAAK,KAAL;AACI,eAAOpW,cAAc,CAACqW,SAAtB;;AACJ;AACI,eAAOrW,cAAc,CAACsW,SAAtB;AANR;AAQH;;AACDC,EAAAA,MAAM,CAACrW,IAAD,EAAOsW,uBAAP,EAAgC;AAClC,SAAKrW,eAAL,CAAqBD,IAArB,EAA2BsW,uBAA3B;;AACA,SAAKlc,sBAAL;AACH;;AACDmc,EAAAA,aAAa,GAAG;AACZ,SAAK3mB,gBAAL,IAAyB,KAAKA,gBAAL,CAAsB4mB,cAAtB,EAAzB;;AACA,QAAI,KAAKrnB,QAAT,EAAmB;AACf,WAAKA,QAAL,CAAcsnB,cAAd;;AACA,WAAKtnB,QAAL,CAAcunB,YAAd;;AACA,WAAKvnB,QAAL,CAAc8H,eAAd;AACH;AACJ;;AACD0f,EAAAA,kBAAkB,GAAG;AACjB,WAAO/sB,MAAM,CAAC,MAAM+sB,kBAAN,EAAD,EAA6B;AACtC/H,MAAAA,QAAQ,EAAE,KAD4B;AAEtCG,MAAAA,SAAS,EAAEviB,yBAF2B;AAGtCoqB,MAAAA,UAAU,EAAE,KAH0B;AAItCC,MAAAA,YAAY,EAAEpqB,6BAJwB;AAKtC0f,MAAAA,UAAU,EAAE,KAL0B;AAMtC2K,MAAAA,QAAQ,EAAE,IAN4B;AAOtCC,MAAAA,UAAU,EAAE,IAP0B;AAQtCC,MAAAA,KAAK,EAAEzqB,oBAR+B;AAStC0qB,MAAAA,SAAS,EAAE1qB,oBAT2B;AAUtC2qB,MAAAA,eAAe,EAAExqB,gCAVqB;AAWtCyqB,MAAAA,SAAS,EAAExqB,0BAX2B;AAYtCyqB,MAAAA,UAAU,EAAE,KAZ0B;AAatCC,MAAAA,KAAK,EAAE;AACHC,QAAAA,UAAU,EAAE,IADT;AAEHC,QAAAA,OAAO,EAAE,IAFN;AAGHC,QAAAA,cAAc,EAAE,KAAK,CAHlB;AAIHC,QAAAA,UAAU,EAAE,KAAK,CAJd;AAKHC,QAAAA,SAAS,EAAE,KAAK,CALb;AAMHC,QAAAA,aAAa,EAAE,KAAK,CANjB;AAOHC,QAAAA,UAAU,EAAE,KAAK,CAPd;AAQHC,QAAAA,QAAQ,EAAE,MARP;AASHC,QAAAA,QAAQ,EAAE,MATP;AAUHC,QAAAA,YAAY,EAAE,KAAK,CAVhB;AAWHC,QAAAA,aAAa,EAAE,KAAK,CAXjB;AAYHC,QAAAA,SAAS,EAAE,KAAK,CAZb;AAaHC,QAAAA,QAAQ,EAAE,KAAK,CAbZ;AAcHC,QAAAA,OAAO,EAAE,KAAK,CAdX;AAeHC,QAAAA,SAAS,EAAE,KAAK,CAfb;AAgBHC,QAAAA,UAAU,EAAE,KAAK,CAhBd;AAiBHC,QAAAA,gBAAgB,EAAE,cAjBf;AAkBHC,QAAAA,qBAAqB,EAAE,KAAK,CAlBzB;AAmBHC,QAAAA,UAAU,EAAE,MAnBT;AAoBHlR,QAAAA,eAAe,EAAE;AApBd,OAb+B;AAmCtCmR,MAAAA,KAAK,EAAE;AACHnB,QAAAA,UAAU,EAAE,IADT;AAEHC,QAAAA,OAAO,EAAE,IAFN;AAGHC,QAAAA,cAAc,EAAE,KAAK,CAHlB;AAIHC,QAAAA,UAAU,EAAE,KAAK,CAJd;AAKHC,QAAAA,SAAS,EAAE,KAAK,CALb;AAMHC,QAAAA,aAAa,EAAE,KAAK,CANjB;AAOHC,QAAAA,UAAU,EAAE,KAAK,CAPd;AAQHc,QAAAA,QAAQ,EAAE,MARP;AASHC,QAAAA,kBAAkB,EAAE,KAAK,CATtB;AAUHC,QAAAA,MAAM,EAAE,IAVL;AAWHC,QAAAA,gBAAgB,EAAE,KAAK,CAXpB;AAYHC,QAAAA,UAAU,EAAE,KAAK,CAZd;AAaHhB,QAAAA,QAAQ,EAAE,KAAK,CAbZ;AAcHiB,QAAAA,YAAY,EAAE,KAAK,CAdhB;AAeHC,QAAAA,eAAe,EAAE,KAAK,CAfnB;AAgBHC,QAAAA,aAAa,EAAE,KAAK;AAhBjB,OAnC+B;AAqDtC/Q,MAAAA,YAAY,EAAE,EArDwB;AAsDtCgR,MAAAA,OAAO,EAAE;AACLC,QAAAA,UAAU,EAAE,MADP;AAELC,QAAAA,gBAAgB,EAAEtsB,8BAFb;AAGLuI,QAAAA,UAAU,EAAE;AAHP,OAtD6B;AA2DtCgkB,MAAAA,WAAW,EAAE;AACTjoB,QAAAA,OAAO,EAAE;AADA,OA3DyB;AA8DtCkoB,MAAAA,cAAc,EAAE;AACZloB,QAAAA,OAAO,EAAE;AADG,OA9DsB;AAiEtCmoB,MAAAA,WAAW,EAAE;AACTnoB,QAAAA,OAAO,EAAE;AADA,OAjEyB;AAoEtCooB,MAAAA,WAAW,EAAE;AACTC,QAAAA,OAAO,EAAE;AADA,OApEyB;AAuEtCC,MAAAA,cAAc,EAAE;AACZD,QAAAA,OAAO,EAAE,IADG;AAEZL,QAAAA,gBAAgB,EAAEpsB,sCAFN;AAGZ0jB,QAAAA,KAAK,EAAEzjB;AAHK,OAvEsB;AA4EtC0sB,MAAAA,eAAe,EAAE;AACbR,QAAAA,UAAU,EAAE;AADC,OA5EqB;AA+EtCS,MAAAA,qBAAqB,EAAE;AACnBC,QAAAA,iBAAiB,EAAE,YADA;AAEnBC,QAAAA,kBAAkB,EAAE,MAFD;AAGnBC,QAAAA,gBAAgB,EAAE;AAHC,OA/Ee;AAoFtCC,MAAAA,OAAO,EAAE;AACLC,QAAAA,aAAa,EAAE,IADV;AAELC,QAAAA,gBAAgB,EAAE,IAFb;AAGLC,QAAAA,oBAAoB,EAAE,IAHjB;AAILC,QAAAA,qBAAqB,EAAE,IAJlB;AAKLC,QAAAA,0BAA0B,EAAE,IALvB;AAMLC,QAAAA,oBAAoB,EAAE,IANjB;AAOLC,QAAAA,wBAAwB,EAAE,IAPrB;AAQLC,QAAAA,gBAAgB,EAAE,IARb;AASLC,QAAAA,cAAc,EAAE;AATX,OApF6B;AA+FtCpnB,MAAAA,MAAM,EAAE;AACJqnB,QAAAA,QAAQ,EAAE,SADN;AAEJC,QAAAA,QAAQ,EAAE,KAAK;AAFX,OA/F8B;AAmGtCriB,MAAAA,WAAW,EAAE,IAnGyB;AAoGtCsiB,MAAAA,cAAc,EAAE,IApGsB;AAqGtCC,MAAAA,kBAAkB,EAAE,IArGkB;AAsGtCC,MAAAA,sBAAsB,EAAE,IAtGc;AAuGtCC,MAAAA,qBAAqB,EAAE;AAvGe,KAA7B,CAAb;AAyGH;;AACD3gB,EAAAA,sBAAsB,GAAG;AACrB,QAAI,KAAK4gB,YAAT,EAAuB;AACnB,WAAK5sB,MAAL,CAAY,YAAZ,EAA0B,IAA1B;AACH;AACJ;;AACDkM,EAAAA,wBAAwB,CAAC0F,IAAD,EAAO9G,QAAP,EAAiB+hB,aAAjB,EAAgC;AACpD,QAAI,KAAK5b,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkB6b,MAAlB,CAAyBlb,IAAzB,EAA+B9G,QAA/B,EAAyC+hB,aAAzC;AACH;AACJ;;AACDzgB,EAAAA,uBAAuB,CAACkG,GAAD,EAAMV,IAAN,EAAY9G,QAAZ,EAAsB+hB,aAAtB,EAAqC;AACxD,QAAI,KAAK5b,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkB8b,MAAlB,CAAyBza,GAAzB,EAA8BV,IAA9B,EAAoC9G,QAApC,EAA8C+hB,aAA9C;AACH;AACJ;;AACDvgB,EAAAA,uBAAuB,CAACgG,GAAD,EAAMV,IAAN,EAAY9G,QAAZ,EAAsB+hB,aAAtB,EAAqC;AACxD,QAAI,KAAK5b,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBvI,MAAlB,CAAyB4J,GAAzB,EAA8BV,IAA9B,EAAoC9G,QAApC,EAA8C+hB,aAA9C;AACH;AACJ;;AACDrgB,EAAAA,wBAAwB,CAACoF,IAAD,EAAO9G,QAAP,EAAiB+hB,aAAjB,EAAgC;AACpD,QAAI,KAAK/b,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBgc,MAAlB,CAAyBlb,IAAzB,EAA+B9G,QAA/B,EAAyC+hB,aAAzC;AACH;AACJ;;AACDngB,EAAAA,uBAAuB,CAAC4F,GAAD,EAAMV,IAAN,EAAY9G,QAAZ,EAAsB+hB,aAAtB,EAAqC;AACxD,QAAI,KAAK/b,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBic,MAAlB,CAAyBza,GAAzB,EAA8BV,IAA9B,EAAoC9G,QAApC,EAA8C+hB,aAA9C;AACH;AACJ;;AACDjgB,EAAAA,uBAAuB,CAAC0F,GAAD,EAAMV,IAAN,EAAY9G,QAAZ,EAAsB+hB,aAAtB,EAAqC;AACxD,QAAI,KAAK/b,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBpI,MAAlB,CAAyB4J,GAAzB,EAA8BV,IAA9B,EAAoC9G,QAApC,EAA8C+hB,aAA9C;AACH;AACJ;;AACD/f,EAAAA,sBAAsB,GAAG;AACrB,QAAI,KAAK/L,QAAL,IAAiB,KAAKsC,kBAAL,EAArB,EAAgD;AAC5C,WAAKtC,QAAL,CAAcoH,IAAd;;AACA,WAAK6kB,kBAAL,GAA0B,IAA1B;AACH;AACJ;;AACDhgB,EAAAA,oBAAoB,GAAG;AACnB,QAAI,KAAKjM,QAAL,IAAiB,KAAKisB,kBAA1B,EAA8C;AAC1C,WAAKjsB,QAAL,CAAcksB,IAAd;;AACA,aAAO,KAAKD,kBAAZ;AACH;AACJ;;AACD9f,EAAAA,oBAAoB,GAAG;AACnB,SAAKzE,iBAAL,GAAyB,IAAzB;;AACA,QAAI,KAAKtH,gBAAT,EAA2B;AACvB,UAAI,KAAKkC,kBAAL,MAA6B,KAAKlC,gBAAL,CAAsBwF,SAAtB,EAAjC,EAAoE;AAChE,aAAKxF,gBAAL,CAAsBgH,IAAtB;;AACA,aAAK+kB,+BAAL,GAAuC,IAAvC;AACH;AACJ;;AACD,QAAI,KAAKnsB,QAAT,EAAmB;AACf,UAAI,KAAKsC,kBAAL,MAA6B,KAAKtC,QAAL,CAAc4F,SAAd,EAAjC,EAA4D;AACxD,aAAK5F,QAAL,CAAcoH,IAAd;;AACA,aAAKglB,uBAAL,GAA+B,IAA/B;AACH;AACJ;AACJ;;AACD/f,EAAAA,kBAAkB,GAAG;AACjB,QAAI,KAAKjM,gBAAT,EAA2B;AACvB,UAAI,KAAK+rB,+BAAT,EAA0C;AACtC,aAAK/rB,gBAAL,CAAsB8rB,IAAtB;;AACA,eAAO,KAAKC,+BAAZ;AACH;AACJ;;AACD,QAAI,KAAKnsB,QAAT,EAAmB;AACf,UAAI,KAAKosB,uBAAT,EAAkC;AAC9B,aAAKpsB,QAAL,CAAcksB,IAAd;;AACA,eAAO,KAAKE,uBAAZ;AACH;AACJ;;AACD,SAAK1kB,iBAAL,GAAyB,KAAzB;AACH;;AACD2kB,EAAAA,sBAAsB,GAAG;AACrB,SAAKC,gBAAL,GAAwB,KAAKC,qBAAL,CAA2B,aAA3B,CAAxB;AACH;;AACDC,EAAAA,yBAAyB,GAAG;AACxB,SAAKC,mBAAL,GAA2B,KAAKF,qBAAL,CAA2B,gBAA3B,CAA3B;AACH;;AACDG,EAAAA,6BAA6B,GAAG;AAC5B,SAAKC,uBAAL,GAA+B,KAAKJ,qBAAL,CAA2B,oBAA3B,CAA/B;AACH;;AACDK,EAAAA,iCAAiC,GAAG;AAChC,SAAKC,2BAAL,GAAmC,KAAKN,qBAAL,CAA2B,wBAA3B,CAAnC;AACH;;AACD1a,EAAAA,gCAAgC,GAAG;AAC/B,SAAKD,0BAAL,GAAkC,KAAK2a,qBAAL,CAA2B,uBAA3B,CAAlC;AACH;;AACD7tB,EAAAA,oBAAoB,GAAG;AACnB,SAAKgG,oBAAL,GAA4B,KAAK6nB,qBAAL,CAA2B,iBAA3B,CAA5B;AACH;;AACDrf,EAAAA,qBAAqB,CAAC4f,UAAD,EAAa;AAC9B,QAAI,CAAC,KAAKR,gBAAV,EAA4B;AACxB,WAAKD,sBAAL;AACH;;AACD,SAAKC,gBAAL,CAAsB;AAClBrQ,MAAAA,IAAI,EAAE,KAAKG,wBAAL,CAA8B0Q,UAA9B;AADY,KAAtB;AAGH;;AACD1f,EAAAA,wBAAwB,CAAC0f,UAAD,EAAa;AACjC,QAAI,CAAC,KAAKL,mBAAV,EAA+B;AAC3B,WAAKD,yBAAL;AACH;;AACD,SAAKC,mBAAL,CAAyB;AACrBxQ,MAAAA,IAAI,EAAE,KAAKG,wBAAL,CAA8B0Q,UAA9B;AADe,KAAzB;AAGH;;AACDxf,EAAAA,sBAAsB,CAACyf,WAAD,EAAc;AAChC,QAAI,CAAC,KAAKJ,uBAAV,EAAmC;AAC/B,WAAKD,6BAAL;AACH;;AACD,SAAKC,uBAAL,CAA6B;AACzB7L,MAAAA,KAAK,EAAEiM,WAAW,CAAC3b,GAAZ,CAAgB,KAAKgL,wBAAL,CAA8BnY,IAA9B,CAAmC,IAAnC,CAAhB;AADkB,KAA7B;AAGH;;AACDuJ,EAAAA,0BAA0B,CAACwf,SAAD,EAAYC,IAAZ,EAAkB;AACxC,QAAI,CAAC,KAAKJ,2BAAV,EAAuC;AACnC,WAAKD,iCAAL;AACH;;AACD,QAAI9a,SAAS,GAAG,KAAKob,iCAAL,CAAuCF,SAAvC,EAAkDC,IAAlD,CAAhB;;AACA,SAAKJ,2BAAL,CAAiC/a,SAAjC;;AACAmb,IAAAA,IAAI,CAAClb,OAAL,GAAeD,SAAS,CAACC,OAAzB;AACH;;AACDob,EAAAA,kBAAkB,CAACH,SAAD,EAAY;AAC1B,QAAI;AACAI,MAAAA,qBAAqB,EAAEA;AADvB,QAEAryB,UAAU,EAFd;;AAGA,YAAQiyB,SAAR;AACI,WAAKI,qBAAqB,CAACC,QAA3B;AACI,eAAO,UAAP;;AACJ,WAAKD,qBAAqB,CAACE,mBAA3B;AACI,eAAO,qBAAP;;AACJ,WAAKF,qBAAqB,CAACG,WAA3B;AACI,eAAO,aAAP;;AACJ,WAAKH,qBAAqB,CAACI,eAA3B;AACI,eAAO,iBAAP;;AACJ,WAAKJ,qBAAqB,CAACK,gBAA3B;AACI,eAAO,kBAAP;;AACJ,WAAKL,qBAAqB,CAACM,qBAA3B;AACI,eAAO,uBAAP;;AACJ,WAAKN,qBAAqB,CAACO,qBAA3B;AACI,eAAO,uBAAP;;AACJ,WAAKP,qBAAqB,CAACQ,eAA3B;AACI,eAAO,iBAAP;;AACJ,WAAKR,qBAAqB,CAACS,yBAA3B;AACI,eAAO,2BAAP;;AACJ,WAAKT,qBAAqB,CAACU,mBAA3B;AACI,eAAO,qBAAP;;AACJ,WAAKV,qBAAqB,CAACW,WAA3B;AACI,eAAO,aAAP;;AACJ,WAAKX,qBAAqB,CAACY,SAA3B;AACI,eAAO,WAAP;AAxBR;AA0BH;;AACDd,EAAAA,iCAAiC,CAACF,SAAD,EAAYC,IAAZ,EAAkB;AAC/C,QAAI;AACAG,MAAAA,qBAAqB,EAAEA,qBADvB;AAEAa,MAAAA,iBAAiB,EAAEA;AAFnB,QAGAlzB,UAAU,EAHd;AAIA,QAAI+W,SAAS,GAAG;AACZkb,MAAAA,SAAS,EAAE,KAAKG,kBAAL,CAAwBH,SAAxB,CADC;AAEZjb,MAAAA,OAAO,EAAEkb,IAAI,CAAClb,OAFF;AAGZmc,MAAAA,QAAQ,EAAEjB,IAAI,CAACiB,QAHH;AAIZC,MAAAA,MAAM,EAAElB,IAAI,CAACiB,QAAL,GAAgB,4BAAhB,GAA+C;AAJ3C,KAAhB;;AAMA,YAAQlB,SAAR;AACI,WAAKI,qBAAqB,CAACC,QAA3B;AACIvb,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbmB,UAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC,CADR;AAEbC,UAAAA,QAAQ,EAAEpB,IAAI,CAACoB,QAAL,IAAiB;AACvBvS,YAAAA,CAAC,EAAEmR,IAAI,CAACoB,QAAL,CAAcvS,CADM;AAEvBC,YAAAA,CAAC,EAAEkR,IAAI,CAACoB,QAAL,CAActS;AAFM;AAFd,SAAjB;AAOA;;AACJ,WAAKqR,qBAAqB,CAACE,mBAA3B;AACIxb,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbnjB,UAAAA,SAAS,EAAEmjB,IAAI,CAACnjB;AADH,SAAjB;AAGA;;AACJ,WAAKsjB,qBAAqB,CAACG,WAA3B;AACIzb,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbmB,UAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC;AADR,SAAjB;AAGA;;AACJ,WAAKhB,qBAAqB,CAACI,eAA3B;AACI1b,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbqB,UAAAA,SAAS,EAAErB,IAAI,CAACqB,SAAL,IAAkB,KAAKlS,wBAAL,CAA8B6Q,IAAI,CAACqB,SAAnC;AADhB,SAAjB;AAGA;;AACJ,WAAKlB,qBAAqB,CAACK,gBAA3B;AACI3b,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbsB,UAAAA,QAAQ,EAAEtB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC,CADX;AAEbI,UAAAA,QAAQ,EAAEvB,IAAI,CAACuB,QAAL,IAAiB,KAAKpS,wBAAL,CAA8B6Q,IAAI,CAACuB,QAAnC,CAFd;AAGbF,UAAAA,SAAS,EAAErB,IAAI,CAACqB,SAAL,IAAkB,KAAKlS,wBAAL,CAA8B6Q,IAAI,CAACqB,SAAnC,CAHhB;AAIbG,UAAAA,oBAAoB,EAAExB,IAAI,CAACwB,oBAJd;AAKbC,UAAAA,iBAAiB,EAAEzB,IAAI,CAACoB,QAAL,KAAkBJ,iBAAiB,CAACU,KAApC,GAA4C,OAA5C,GAAsD;AAL5D,SAAjB;AAOA;;AACJ,WAAKvB,qBAAqB,CAACM,qBAA3B;AACI5b,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbqB,UAAAA,SAAS,EAAErB,IAAI,CAACqB,SAAL,IAAkB,KAAKlS,wBAAL,CAA8B6Q,IAAI,CAACqB,SAAnC,CADhB;AAEbM,UAAAA,SAAS,EAAE3B,IAAI,CAAC4B,MAAL,IAAe5B,IAAI,CAAC4B,MAAL,CAAYzd,GAAZ,CAAgByK,EAAE,KAAK;AAC7CC,YAAAA,CAAC,EAAED,EAAE,CAACC,CADuC;AAE7CC,YAAAA,CAAC,EAAEF,EAAE,CAACE;AAFuC,WAAL,CAAlB,CAFb;AAMb+S,UAAAA,SAAS,EAAE7B,IAAI,CAAC6B,SAAL,IAAkB7B,IAAI,CAAC6B,SAAL,CAAe1d,GAAf,CAAmByK,EAAE,KAAK;AACnDC,YAAAA,CAAC,EAAED,EAAE,CAACC,CAD6C;AAEnDC,YAAAA,CAAC,EAAEF,EAAE,CAACE;AAF6C,WAAL,CAArB;AANhB,SAAjB;AAWA;;AACJ,WAAKqR,qBAAqB,CAACO,qBAA3B;AACI7b,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbmB,UAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC;AADR,SAAjB;AAGA;;AACJ,WAAKhB,qBAAqB,CAACQ,eAA3B;AACI9b,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbmB,UAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC,CADR;AAEbnnB,UAAAA,IAAI,EAAEgmB,IAAI,CAAChmB;AAFE,SAAjB;AAIA;;AACJ,WAAKmmB,qBAAqB,CAACS,yBAA3B;AACI/b,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbqB,UAAAA,SAAS,EAAErB,IAAI,CAACqB,SAAL,IAAkB,KAAKlS,wBAAL,CAA8B6Q,IAAI,CAACqB,SAAnC,CADhB;AAEbS,UAAAA,KAAK,EAAE9B,IAAI,CAAC8B;AAFC,SAAjB;AAIA;;AACJ,WAAK3B,qBAAqB,CAACU,mBAA3B;AACIhc,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbqB,UAAAA,SAAS,EAAErB,IAAI,CAACqB,SAAL,IAAkB,KAAKlS,wBAAL,CAA8B6Q,IAAI,CAACqB,SAAnC,CADhB;AAEbS,UAAAA,KAAK,EAAE9B,IAAI,CAAC8B,KAFC;AAGb9nB,UAAAA,IAAI,EAAEgmB,IAAI,CAAChmB;AAHE,SAAjB;AAKA;;AACJ,WAAKmmB,qBAAqB,CAACW,WAA3B;AACIjc,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbmB,UAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC,CADR;AAEbY,UAAAA,OAAO,EAAE/B,IAAI,CAACgC,IAAL,IAAa;AAClB1N,YAAAA,KAAK,EAAE0L,IAAI,CAACgC,IAAL,CAAU1N,KADC;AAElBzb,YAAAA,MAAM,EAAEmnB,IAAI,CAACgC,IAAL,CAAUnpB;AAFA,WAFT;AAMbopB,UAAAA,OAAO,EAAEjC,IAAI,CAACiC,OAAL,IAAgB;AACrB3N,YAAAA,KAAK,EAAE0L,IAAI,CAACiC,OAAL,CAAa3N,KADC;AAErBzb,YAAAA,MAAM,EAAEmnB,IAAI,CAACiC,OAAL,CAAappB;AAFA;AANZ,SAAjB;AAWA;;AACJ,WAAKsnB,qBAAqB,CAACY,SAA3B;AACIlc,QAAAA,SAAS,CAACmb,IAAV,GAAiB;AACbmB,UAAAA,KAAK,EAAEnB,IAAI,CAACmB,KAAL,IAAc,KAAKhS,wBAAL,CAA8B6Q,IAAI,CAACmB,KAAnC,CADR;AAEbe,UAAAA,WAAW,EAAElC,IAAI,CAACoB,QAAL,IAAiB;AAC1BvS,YAAAA,CAAC,EAAEmR,IAAI,CAACoB,QAAL,CAAcvS,CADS;AAE1BC,YAAAA,CAAC,EAAEkR,IAAI,CAACoB,QAAL,CAActS;AAFS,WAFjB;AAMbqT,UAAAA,WAAW,EAAEnC,IAAI,CAACmC,WAAL,IAAoB;AAC7BtT,YAAAA,CAAC,EAAEmR,IAAI,CAACmC,WAAL,CAAiBtT,CADS;AAE7BC,YAAAA,CAAC,EAAEkR,IAAI,CAACmC,WAAL,CAAiBrT;AAFS;AANpB,SAAjB;AArFR;;AAiGA,WAAOjK,SAAP;AACH;;AACDsK,EAAAA,wBAAwB,CAAC0Q,UAAD,EAAa;AACjC,QAAI;AACAuC,MAAAA,WAAW,EAAEA;AADb,QAEAt0B,UAAU,EAFd;AAGA,QAAIu0B,YAAY,GAAGxC,UAAU,YAAYuC,WAAtB,GAAoC,KAAKE,0BAAL,CAAgCtrB,IAAhC,CAAqC,IAArC,CAApC,GAAiF,KAAKurB,kCAAL,CAAwCvrB,IAAxC,CAA6C,IAA7C,CAApG;AACA,WAAOxJ,MAAM,CAAC;AACVg1B,MAAAA,EAAE,EAAE3C,UAAU,CAAC2C,EADL;AAEVle,MAAAA,GAAG,EAAEub,UAAU,CAACvb,GAFN;AAGVme,MAAAA,QAAQ,EAAE,KAAK;AAHL,KAAD,EAIVJ,YAAY,CAACxC,UAAD,CAJF,CAAb;AAKH;;AACDyC,EAAAA,0BAA0B,CAACI,WAAD,EAAc;AACpC,WAAO;AACHD,MAAAA,QAAQ,EAAE,KAAK3f,YAAL,IAAqB,KAAKA,YAAL,CAAkB6f,QAAlB,CAA2BD,WAAW,CAACpe,GAAvC,CAD5B;AAEHse,MAAAA,QAAQ,EAAE,OAFP;AAGH5oB,MAAAA,IAAI,EAAE0oB,WAAW,CAAC1oB,IAHf;AAIHyQ,MAAAA,IAAI,EAAEiY,WAAW,CAACjY,IAJf;AAKH2W,MAAAA,QAAQ,EAAE;AACNvS,QAAAA,CAAC,EAAE6T,WAAW,CAACtB,QAAZ,CAAqBvS,CADlB;AAENC,QAAAA,CAAC,EAAE4T,WAAW,CAACtB,QAAZ,CAAqBtS;AAFlB,OALP;AASHkT,MAAAA,IAAI,EAAE;AACF1N,QAAAA,KAAK,EAAEoO,WAAW,CAACV,IAAZ,CAAiB1N,KADtB;AAEFzb,QAAAA,MAAM,EAAE6pB,WAAW,CAACV,IAAZ,CAAiBnpB;AAFvB,OATH;AAaHgqB,MAAAA,oBAAoB,EAAEH,WAAW,CAACG,oBAb/B;AAcHC,MAAAA,WAAW,EAAEJ,WAAW,CAACI,WAdtB;AAeHC,MAAAA,qBAAqB,EAAEL,WAAW,CAACK,qBAfhC;AAgBHC,MAAAA,iBAAiB,EAAEN,WAAW,CAACM;AAhB5B,KAAP;AAkBH;;AACDT,EAAAA,kCAAkC,CAACU,eAAD,EAAkB;AAChD,WAAO;AACHR,MAAAA,QAAQ,EAAE,KAAKxf,YAAL,IAAqB,KAAKA,YAAL,CAAkB0f,QAAlB,CAA2BM,eAAe,CAAC3e,GAA3C,CAD5B;AAEHse,MAAAA,QAAQ,EAAE,WAFP;AAGHhO,MAAAA,KAAK,EAAEqO,eAAe,CAACrO,KAHpB;AAIHsO,MAAAA,OAAO,EAAED,eAAe,CAACC,OAJtB;AAKHC,MAAAA,KAAK,EAAEF,eAAe,CAACE,KALpB;AAMHC,MAAAA,MAAM,EAAEH,eAAe,CAACG,MANrB;AAOHC,MAAAA,cAAc,EAAEJ,eAAe,CAACI,cAP7B;AAQHC,MAAAA,IAAI,EAAEL,eAAe,CAACK,IARnB;AASHC,MAAAA,YAAY,EAAEN,eAAe,CAACM,YAT3B;AAUH3B,MAAAA,MAAM,EAAEqB,eAAe,CAACrB,MAAhB,CAAuBzd,GAAvB,CAA2ByK,EAAE,KAAK;AACtCC,QAAAA,CAAC,EAAED,EAAE,CAACC,CADgC;AAEtCC,QAAAA,CAAC,EAAEF,EAAE,CAACE;AAFgC,OAAL,CAA7B;AAVL,KAAP;AAeH;;AACD0U,EAAAA,YAAY,CAAClf,GAAD,EAAM;AACd,QAAIub,UAAU,GAAG,KAAKrsB,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBiwB,sBAAtB,CAA6Cnf,GAA7C,CAA1C;;AACA,WAAOub,UAAU,IAAI,KAAK1Q,wBAAL,CAA8B0Q,UAA9B,CAArB;AACH;;AACD6D,EAAAA,WAAW,CAAClB,EAAD,EAAK;AACZ,QAAI3C,UAAU,GAAG,KAAKrsB,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBmwB,kBAAtB,CAAyCnB,EAAzC,CAA1C;;AACA,WAAO3C,UAAU,IAAI,KAAK1Q,wBAAL,CAA8B0Q,UAA9B,CAArB;AACH;;AACDja,EAAAA,QAAQ,GAAG;AACP,WAAO,KAAKpS,gBAAL,CAAsBowB,cAAtB,GAAuCzf,GAAvC,CAA2C0b,UAAU,IAAIA,UAAU,IAAI,KAAK1Q,wBAAL,CAA8B0Q,UAA9B,CAAvE,CAAP;AACH;;AACDgE,EAAAA,gBAAgB,GAAG;AACf,WAAO,KAAKrwB,gBAAL,CAAsBswB,sBAAtB,GAA+C3f,GAA/C,CAAmD0b,UAAU,IAAIA,UAAU,IAAI,KAAK1Q,wBAAL,CAA8B0Q,UAA9B,CAA/E,CAAP;AACH;;AACDkE,EAAAA,gBAAgB,CAAClQ,KAAD,EAAQ;AACpB,WAAO,KAAKrgB,gBAAL,CAAsBuwB,gBAAtB,CAAuClQ,KAAK,CAAC1P,GAAN,CAAU6K,IAAI,IAAIA,IAAI,CAACwT,EAAvB,CAAvC,CAAP;AACH;;AACDwB,EAAAA,YAAY,CAAChV,IAAD,EAAO;AACf,WAAO,KAAKxb,gBAAL,CAAsBywB,aAAtB,CAAoC,CAACjV,IAAI,CAACwT,EAAN,CAApC,CAAP;AACH;;AACD0B,EAAAA,8BAA8B,GAAG;AAC7B,QAAI,KAAK3wB,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBvB,MAAlB,CAAyB;AACrB4F,QAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,sBAAZ;AADW,OAAzB;AAGH;AACJ;;AACDmyB,EAAAA,8BAA8B,GAAG;AAC7B,QAAI,KAAKpyB,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBC,MAAlB,CAAyB;AACrB4F,QAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,sBAAZ;AADW,OAAzB;AAGH;AACJ;;AACDoyB,EAAAA,iCAAiC,GAAG;AAChC,QAAI,KAAKhyB,eAAT,EAA0B;AACtB,WAAKA,eAAL,CAAqBJ,MAArB,CAA4B;AACxB4F,QAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,yBAAZ;AADc,OAA5B;AAGH;AACJ;;AACDqyB,EAAAA,8BAA8B,GAAG;AAC7B,QAAI,KAAKzxB,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBZ,MAAlB,CAAyB;AACrB4F,QAAAA,QAAQ,EAAE,KAAK5F,MAAL,CAAY,sBAAZ;AADW,OAAzB;AAGH;AACJ;;AACDsyB,EAAAA,wBAAwB,GAAG;AACvB,QAAI,KAAKvxB,QAAT,EAAmB;AACf,WAAKA,QAAL,CAAcf,MAAd,CAAqB;AACjBkH,QAAAA,aAAa,EAAE,KAAKC,iBAAL;AADE,OAArB;AAGH;AACJ;;AACDorB,EAAAA,cAAc,CAACvE,IAAD,EAAO;AACjB,QAAI,CAAC,KAAK7d,gBAAN,IAA0B,KAAKA,gBAAL,CAAsBqiB,cAAtB,EAA9B,EAAsE;AAClE;AACH;;AACD,SAAKriB,gBAAL,CAAsBsiB,WAAtB;;AACA,QAAI;AACA,WAAKC,kBAAL,CAAwB1E,IAAxB;AACH,KAFD,SAEU;AACN,WAAK7d,gBAAL,CAAsBwiB,SAAtB;AACH;AACJ;;AACDD,EAAAA,kBAAkB,CAAC1E,IAAD,EAAO;AACrB,YAAQA,IAAI,CAACtoB,IAAb;AACI,WAAK,UAAL;AACA,WAAK,UAAL;AACI,aAAKqJ,oBAAL;;AACA,aAAK6jB,WAAL;;AACA;;AACJ,WAAK,WAAL;AACI,YAAI,gBAAgB5E,IAAI,CAAC6E,QAArB,IAAiC,sBAAsB7E,IAAI,CAAC6E,QAA5D,IAAwE,sBAAsB7E,IAAI,CAAC6E,QAAvG,EAAiH;AAC7G,eAAKrjB,qBAAL;AACH;;AACD;;AACJ,WAAK,cAAL;AACI,aAAKE,oBAAL;;AACA;;AACJ,WAAK,YAAL;AACI,aAAKD,sBAAL;;AACA;;AACJ,WAAK,oBAAL;AACI,aAAKmjB,WAAL;;AACA;;AACJ,WAAK,YAAL;AACI,aAAK9iB,sBAAL;;AACA;;AACJ,WAAK,UAAL;AACI,aAAKT,oBAAL;;AACA;;AACJ,WAAK,YAAL;AACI,aAAKC,sBAAL;;AACA;;AACJ,WAAK,UAAL;AACI,YAAI,eAAe0e,IAAI,CAAC6E,QAApB,IAAgC,qBAAqB7E,IAAI,CAAC6E,QAA1D,IAAsE,qBAAqB7E,IAAI,CAAC6E,QAApG,EAA8G;AAC1G,eAAKtjB,oBAAL;AACH;;AACD;;AACJ,WAAK,WAAL;AACI,aAAKH,qBAAL;;AACA;;AACJ,WAAK,OAAL;AACI,aAAKN,iBAAL;;AACA;;AACJ,WAAK,UAAL;AACI,YAAI,eAAekf,IAAI,CAAC6E,QAApB,IAAgC,qBAAqB7E,IAAI,CAAC6E,QAA9D,EAAwE;AACpE,eAAK7jB,yBAAL;AACH;;AACD,YAAI,eAAegf,IAAI,CAAC6E,QAApB,IAAgC,qBAAqB7E,IAAI,CAAC6E,QAA1D,IAAsE,sBAAsB7E,IAAI,CAAC6E,QAArG,EAA+G;AAC3G,eAAK5jB,oBAAL;AACH;;AACD;;AACJ,WAAK,iBAAL;AACI,aAAKC,2BAAL;;AACA;;AACJ,WAAK,WAAL;AACI,aAAKC,qBAAL;;AACA;;AACJ,WAAK,OAAL;AACI,YAAI,MAAM6e,IAAI,CAAC6E,QAAL,CAAcC,OAAd,CAAsB,kBAAtB,CAAV,EAAqD;AACjD,eAAK5iB,mBAAL;AACH,SAFD,MAEO;AACH,eAAKiB,uBAAL;AACH;;AACD;;AACJ,WAAK,OAAL;AACI,aAAKC,uBAAL;;AACA;;AACJ,WAAK,cAAL;AACI,YAAI4c,IAAI,CAAC6E,QAAL,KAAkB7E,IAAI,CAACtoB,IAA3B,EAAiC;AAC7B,eAAKkU,sBAAL;AACH,SAFD,MAEO;AACH,eAAK5J,mBAAL,CAAyBge,IAAI,CAACvc,KAA9B,EAAqCuc,IAAI,CAAC+E,aAA1C;AACH;;AACD,aAAKH,WAAL;;AACA;;AACJ,WAAK,aAAL;AACI,YAAI,2BAA2B5E,IAAI,CAAC6E,QAApC,EAA8C;AAC1C,eAAKX,8BAAL;AACH,SAFD,MAEO;AACH,eAAKU,WAAL;AACH;;AACD;;AACJ,WAAK,gBAAL;AACA,WAAK,iBAAL;AACI,aAAKA,WAAL;;AACA;;AACJ,WAAK,SAAL;AACI,YAAI,qBAAqB5E,IAAI,CAAC6E,QAA9B,EAAwC;AACpC,eAAKP,wBAAL;AACH,SAFD,MAEO;AACH,eAAKM,WAAL;AACH;;AACD;;AACJ,WAAK,aAAL;AACI,YAAI,2BAA2B5E,IAAI,CAAC6E,QAApC,EAA8C;AAC1C,eAAKV,8BAAL;AACH,SAFD,MAEO;AACH,eAAKS,WAAL;AACH;;AACD;;AACJ,WAAK,gBAAL;AACI,YAAI,8BAA8B5E,IAAI,CAAC6E,QAAvC,EAAiD;AAC7C,eAAKT,iCAAL;AACH,SAFD,MAEO;AACH,eAAKQ,WAAL;AACH;;AACD;;AACJ,WAAK,aAAL;AACI,YAAI,2BAA2B5E,IAAI,CAAC6E,QAApC,EAA8C;AAC1C,eAAKR,8BAAL;AACH,SAFD,MAEO;AACH,eAAKO,WAAL;AACH;;AACD;;AACJ,WAAK,aAAL;AACI,aAAKxF,sBAAL;;AACA;;AACJ,WAAK,gBAAL;AACI,aAAKG,yBAAL;;AACA;;AACJ,WAAK,oBAAL;AACI,aAAKE,6BAAL;;AACA;;AACJ,WAAK,wBAAL;AACI,aAAKE,iCAAL;;AACA;;AACJ,WAAK,uBAAL;AACI,aAAK/a,gCAAL;;AACA;;AACJ,WAAK,iBAAL;AACI,aAAKnT,oBAAL;;AACA;;AACJ,WAAK,uBAAL;AACI,aAAKgP,4BAAL;;AACA;;AACJ,WAAK,SAAL;AACI,aAAKC,sBAAL;;AACA;;AACJ,WAAK,QAAL;AACI,aAAKnP,SAAL,CAAesK,OAAf,CAAuBN,OAAO,IAAI;AAC9BA,UAAAA,OAAO,CAACvJ,MAAR,CAAe,QAAf,EAAyB,KAAKA,MAAL,CAAY,QAAZ,CAAzB;AACH,SAFD;;AAGA,YAAI,KAAKuB,YAAT,EAAuB;AACnB,eAAKA,YAAL,CAAkBvB,MAAlB,CAAyB,QAAzB,EAAmC,KAAKA,MAAL,CAAY,QAAZ,CAAnC;AACH;;AACD;;AACJ,WAAK,YAAL;AACI;;AACJ;AACI,cAAMuyB,cAAN,CAAqBvE,IAArB;;AAlJR;AAoJH;;AAnoEwB;;AAqoE7BzyB,iBAAiB,CAAC,WAAD,EAAc4D,OAAd,CAAjB;AACA,eAAeA,OAAf","sourcesContent":["/**\r\n * DevExtreme (esm/ui/diagram/ui.diagram.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getOuterWidth,\r\n    getHeight,\r\n    getOuterHeight\r\n} from \"../../core/utils/size\";\r\nimport $ from \"../../core/renderer\";\r\nimport Widget from \"../widget/ui.widget\";\r\nimport LoadIndicator from \"../load_indicator\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    isFunction,\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    compileSetter,\r\n    compileGetter\r\n} from \"../../core/utils/data\";\r\nimport positionUtils from \"../../animation/position\";\r\nimport {\r\n    getDiagram\r\n} from \"./diagram.importer\";\r\nimport {\r\n    getWindow,\r\n    hasWindow\r\n} from \"../../core/utils/window\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    addNamespace\r\n} from \"../../events/utils/index\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport numberLocalization from \"../../localization/number\";\r\nimport * as zIndexPool from \"../overlay/z_index\";\r\nimport Overlay from \"../overlay/ui.overlay\";\r\nimport DiagramToolbar from \"./ui.diagram.toolbar\";\r\nimport DiagramMainToolbar from \"./ui.diagram.main_toolbar\";\r\nimport DiagramHistoryToolbar from \"./ui.diagram.history_toolbar\";\r\nimport DiagramViewToolbar from \"./ui.diagram.view_toolbar\";\r\nimport DiagramPropertiesToolbar from \"./ui.diagram.properties_toolbar\";\r\nimport diagramContextMenuModule from \"./ui.diagram.context_menu\";\r\nimport DiagramContextToolbox from \"./ui.diagram.context_toolbox\";\r\nimport DiagramDialog from \"./ui.diagram.dialogs\";\r\nimport DiagramScrollView from \"./ui.diagram.scroll_view\";\r\nimport DiagramToolboxManager from \"./diagram.toolbox_manager\";\r\nimport DiagramToolbox from \"./ui.diagram.toolbox\";\r\nimport DiagramPropertiesPanel from \"./ui.diagram.properties_panel\";\r\nimport DiagramOptionsUpdateBar from \"./diagram.options_update\";\r\nimport DiagramDialogManager from \"./ui.diagram.dialog_manager\";\r\nimport DiagramCommandsManager from \"./diagram.commands_manager\";\r\nimport NodesOption from \"./diagram.nodes_option\";\r\nimport EdgesOption from \"./diagram.edges_option\";\r\nvar DIAGRAM_CLASS = \"dx-diagram\";\r\nvar DIAGRAM_FULLSCREEN_CLASS = \"dx-diagram-fullscreen\";\r\nvar DIAGRAM_TOOLBAR_WRAPPER_CLASS = DIAGRAM_CLASS + \"-toolbar-wrapper\";\r\nvar DIAGRAM_CONTENT_WRAPPER_CLASS = DIAGRAM_CLASS + \"-content-wrapper\";\r\nvar DIAGRAM_CONTENT_CLASS = DIAGRAM_CLASS + \"-content\";\r\nvar DIAGRAM_SCROLL_VIEW_CLASS = DIAGRAM_CLASS + \"-scroll-view\";\r\nvar DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS = DIAGRAM_CLASS + \"-floating-toolbar-container\";\r\nvar DIAGRAM_PROPERTIES_PANEL_TOOLBAR_CONTAINER_CLASS = DIAGRAM_CLASS + \"-properties-panel-toolbar-container\";\r\nvar DIAGRAM_LOADING_INDICATOR_CLASS = DIAGRAM_CLASS + \"-loading-indicator\";\r\nvar DIAGRAM_FLOATING_PANEL_OFFSET = 12;\r\nvar DIAGRAM_DEFAULT_UNIT = \"in\";\r\nvar DIAGRAM_DEFAULT_ZOOMLEVEL = 1;\r\nvar DIAGRAM_DEFAULT_AUTOZOOM_MODE = \"disabled\";\r\nvar DIAGRAM_DEFAULT_PAGE_ORIENTATION = \"portrait\";\r\nvar DIAGRAM_DEFAULT_PAGE_COLOR = \"#ffffff\";\r\nvar DIAGRAM_MAX_MOBILE_WINDOW_WIDTH = 576;\r\nvar DIAGRAM_TOOLBOX_SHAPE_SPACING = 12;\r\nvar DIAGRAM_TOOLBOX_SHAPES_PER_ROW = 3;\r\nvar DIAGRAM_CONTEXT_TOOLBOX_SHAPE_SPACING = 12;\r\nvar DIAGRAM_CONTEXT_TOOLBOX_SHAPES_PER_ROW = 4;\r\nvar DIAGRAM_CONTEXT_TOOLBOX_DEFAULT_WIDTH = 152;\r\nvar DIAGRAM_NAMESPACE = \"dxDiagramEvent\";\r\nvar FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"fullscreenchange\", DIAGRAM_NAMESPACE);\r\nvar IE_FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"msfullscreenchange\", DIAGRAM_NAMESPACE);\r\nvar WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"webkitfullscreenchange\", DIAGRAM_NAMESPACE);\r\nvar MOZ_FULLSCREEN_CHANGE_EVENT_NAME = addNamespace(\"mozfullscreenchange\", DIAGRAM_NAMESPACE);\r\nclass Diagram extends Widget {\r\n    _init() {\r\n        this._updateDiagramLockCount = 0;\r\n        this.toggleFullscreenLock = 0;\r\n        this._toolbars = [];\r\n        super._init();\r\n        this._initDiagram();\r\n        this._createCustomCommand()\r\n    }\r\n    _initMarkup() {\r\n        super._initMarkup();\r\n        this._toolbars = [];\r\n        delete this._isMobileScreenSize;\r\n        var isServerSide = !hasWindow();\r\n        this.$element().addClass(DIAGRAM_CLASS);\r\n        delete this._mainToolbar;\r\n        if (this.option(\"mainToolbar.visible\")) {\r\n            this._renderMainToolbar()\r\n        }\r\n        var $contentWrapper = $(\"<div>\").addClass(DIAGRAM_CONTENT_WRAPPER_CLASS).appendTo(this.$element());\r\n        delete this._historyToolbar;\r\n        delete this._historyToolbarResizeCallback;\r\n        if (this._isHistoryToolbarVisible()) {\r\n            this._renderHistoryToolbar($contentWrapper)\r\n        }\r\n        delete this._propertiesToolbar;\r\n        delete this._propertiesToolbarResizeCallback;\r\n        if (this._isPropertiesPanelEnabled()) {\r\n            this._renderPropertiesToolbar($contentWrapper)\r\n        }\r\n        delete this._viewToolbar;\r\n        delete this._viewToolbarResizeCallback;\r\n        if (this.option(\"viewToolbar.visible\")) {\r\n            this._renderViewToolbar($contentWrapper)\r\n        }\r\n        delete this._toolbox;\r\n        delete this._toolboxResizeCallback;\r\n        if (this._isToolboxEnabled()) {\r\n            this._renderToolbox($contentWrapper)\r\n        }\r\n        delete this._propertiesPanel;\r\n        delete this._propertiesPanelResizeCallback;\r\n        if (this._isPropertiesPanelEnabled()) {\r\n            this._renderPropertiesPanel($contentWrapper)\r\n        }\r\n        this._$content = $(\"<div>\").addClass(DIAGRAM_CONTENT_CLASS).appendTo($contentWrapper);\r\n        delete this._contextMenu;\r\n        this._diagramInstance.settings.contextMenuEnabled = this.option(\"contextMenu.enabled\");\r\n        if (this._diagramInstance.settings.contextMenuEnabled) {\r\n            this._renderContextMenu($contentWrapper)\r\n        }\r\n        delete this._contextToolbox;\r\n        if (this.option(\"contextToolbox.enabled\")) {\r\n            this._renderContextToolbox($contentWrapper)\r\n        }\r\n        this._renderDialog($contentWrapper);\r\n        if (!isServerSide) {\r\n            var $scrollViewWrapper = $(\"<div>\").addClass(DIAGRAM_SCROLL_VIEW_CLASS).appendTo(this._$content);\r\n            this._createComponent($scrollViewWrapper, DiagramScrollView, {\r\n                useNativeScrolling: this.option(\"useNativeScrolling\"),\r\n                onCreateDiagram: e => {\r\n                    this._diagramInstance.createDocument(e.$parent[0], e.scrollView, $contentWrapper[0])\r\n                }\r\n            })\r\n        }\r\n        this._setCustomCommandChecked(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME, this._isPropertiesPanelVisible());\r\n        this._setCustomCommandChecked(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME, this._isToolboxVisible());\r\n        this._createOptionsUpdateBar()\r\n    }\r\n    _dimensionChanged() {\r\n        this._isMobileScreenSize = void 0;\r\n        this._processDiagramResize()\r\n    }\r\n    _visibilityChanged(visible) {\r\n        if (visible) {\r\n            this._bindDiagramData();\r\n            this.repaint()\r\n        }\r\n    }\r\n    _processDiagramResize() {\r\n        this._diagramInstance.onDimensionChanged();\r\n        if (this._historyToolbarResizeCallback) {\r\n            this._historyToolbarResizeCallback.call(this)\r\n        }\r\n        if (this._propertiesToolbarResizeCallback) {\r\n            this._propertiesToolbarResizeCallback.call(this)\r\n        }\r\n        if (this._propertiesPanelResizeCallback) {\r\n            this._propertiesPanelResizeCallback.call(this)\r\n        }\r\n        if (this._viewToolbarResizeCallback) {\r\n            this._viewToolbarResizeCallback.call(this)\r\n        }\r\n        if (this._toolboxResizeCallback) {\r\n            this._toolboxResizeCallback.call(this)\r\n        }\r\n    }\r\n    isMobileScreenSize() {\r\n        if (void 0 === this._isMobileScreenSize) {\r\n            this._isMobileScreenSize = hasWindow() && getOuterWidth(this.$element()) < DIAGRAM_MAX_MOBILE_WINDOW_WIDTH\r\n        }\r\n        return this._isMobileScreenSize\r\n    }\r\n    _captureFocus() {\r\n        if (this._diagramInstance) {\r\n            this._diagramInstance.captureFocus()\r\n        }\r\n    }\r\n    _captureFocusOnTimeout() {\r\n        this._captureFocusTimeout = setTimeout(() => {\r\n            this._captureFocus();\r\n            delete this._captureFocusTimeout\r\n        }, 100)\r\n    }\r\n    _killCaptureFocusTimeout() {\r\n        if (this._captureFocusTimeout) {\r\n            clearTimeout(this._captureFocusTimeout);\r\n            delete this._captureFocusTimeout\r\n        }\r\n    }\r\n    notifyBarCommandExecuted() {\r\n        this._captureFocusOnTimeout()\r\n    }\r\n    _registerToolbar(component) {\r\n        this._registerBar(component);\r\n        this._toolbars.push(component)\r\n    }\r\n    _registerBar(component) {\r\n        component.bar.onChanged.add(this);\r\n        this._diagramInstance.registerBar(component.bar)\r\n    }\r\n    _getExcludeCommands() {\r\n        var excludeCommands = [];\r\n        if (!this._isToolboxEnabled()) {\r\n            excludeCommands.push(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME)\r\n        }\r\n        if (!this._isPropertiesPanelEnabled()) {\r\n            excludeCommands.push(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME)\r\n        }\r\n        return excludeCommands\r\n    }\r\n    _getToolbarBaseOptions() {\r\n        return {\r\n            onContentReady: _ref => {\r\n                var {\r\n                    component: component\r\n                } = _ref;\r\n                return this._registerToolbar(component)\r\n            },\r\n            onSubMenuVisibilityChanging: _ref2 => {\r\n                var {\r\n                    component: component\r\n                } = _ref2;\r\n                return this._diagramInstance.updateBarItemsState(component.bar)\r\n            },\r\n            onPointerUp: this._onPanelPointerUp.bind(this),\r\n            export: this.option(\"export\"),\r\n            excludeCommands: this._getExcludeCommands(),\r\n            onInternalCommand: this._onInternalCommand.bind(this),\r\n            onCustomCommand: this._onCustomCommand.bind(this),\r\n            isMobileView: this.isMobileScreenSize()\r\n        }\r\n    }\r\n    _onInternalCommand(e) {\r\n        switch (e.command) {\r\n            case DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME:\r\n                if (this._toolbox) {\r\n                    this._toolbox.toggle()\r\n                }\r\n                break;\r\n            case DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME:\r\n                if (this._propertiesPanel) {\r\n                    this._propertiesPanel.toggle()\r\n                }\r\n        }\r\n    }\r\n    _onCustomCommand(e) {\r\n        this._customCommandAction({\r\n            name: e.name\r\n        })\r\n    }\r\n    _renderMainToolbar() {\r\n        var $toolbarWrapper = $(\"<div>\").addClass(DIAGRAM_TOOLBAR_WRAPPER_CLASS).appendTo(this.$element());\r\n        this._mainToolbar = this._createComponent($toolbarWrapper, DiagramMainToolbar, extend(this._getToolbarBaseOptions(), {\r\n            commands: this.option(\"mainToolbar.commands\"),\r\n            skipAdjustSize: true\r\n        }))\r\n    }\r\n    _isHistoryToolbarVisible() {\r\n        return this.option(\"historyToolbar.visible\") && !this.isReadOnlyMode()\r\n    }\r\n    _renderHistoryToolbar($parent) {\r\n        var $container = $(\"<div>\").addClass(DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS).appendTo($parent);\r\n        this._historyToolbar = this._createComponent($container, DiagramHistoryToolbar, extend(this._getToolbarBaseOptions(), {\r\n            commands: this.option(\"historyToolbar.commands\"),\r\n            locateInMenu: \"never\"\r\n        }));\r\n        this._updateHistoryToolbarPosition();\r\n        this._historyToolbarResizeCallback = () => {\r\n            this._historyToolbar.option(\"isMobileView\", this.isMobileScreenSize())\r\n        }\r\n    }\r\n    _updateHistoryToolbarPosition() {\r\n        if (!hasWindow()) {\r\n            return\r\n        }\r\n        positionUtils.setup(this._historyToolbar.$element(), {\r\n            my: \"left top\",\r\n            at: \"left top\",\r\n            of: this._historyToolbar.$element().parent(),\r\n            offset: DIAGRAM_FLOATING_PANEL_OFFSET + \" \" + DIAGRAM_FLOATING_PANEL_OFFSET\r\n        })\r\n    }\r\n    _isToolboxEnabled() {\r\n        return \"disabled\" !== this.option(\"toolbox.visibility\") && !this.isReadOnlyMode()\r\n    }\r\n    _isToolboxVisible() {\r\n        return \"visible\" === this.option(\"toolbox.visibility\") || \"auto\" === this.option(\"toolbox.visibility\") && !this.isMobileScreenSize()\r\n    }\r\n    _renderToolbox($parent) {\r\n        var isServerSide = !hasWindow();\r\n        var $toolBox = $(\"<div>\").appendTo($parent);\r\n        var bounds = this._getToolboxBounds($parent, isServerSide);\r\n        this._toolbox = this._createComponent($toolBox, DiagramToolbox, {\r\n            isMobileView: this.isMobileScreenSize(),\r\n            isVisible: this._isToolboxVisible(),\r\n            container: this.$element(),\r\n            height: bounds.height,\r\n            offsetParent: $parent,\r\n            offsetX: bounds.offsetX,\r\n            offsetY: bounds.offsetY,\r\n            showSearch: this.option(\"toolbox.showSearch\"),\r\n            toolboxGroups: this._getToolboxGroups(),\r\n            toolboxWidth: this.option(\"toolbox.width\"),\r\n            onShapeCategoryRendered: e => {\r\n                if (isServerSide) {\r\n                    return\r\n                }\r\n                this._diagramInstance.createToolbox(e.$element[0], \"texts\" === e.displayMode, e.shapes || e.category, {\r\n                    shapeIconSpacing: DIAGRAM_TOOLBOX_SHAPE_SPACING,\r\n                    shapeIconCountInRow: this.option(\"toolbox.shapeIconsPerRow\"),\r\n                    shapeIconAttributes: {\r\n                        \"data-toggle\": e.dataToggle\r\n                    }\r\n                })\r\n            },\r\n            onFilterChanged: e => {\r\n                if (isServerSide) {\r\n                    return\r\n                }\r\n                this._diagramInstance.applyToolboxFilter(e.text, e.filteringToolboxes)\r\n            },\r\n            onVisibilityChanging: e => {\r\n                if (isServerSide) {\r\n                    return\r\n                }\r\n                this._setCustomCommandChecked(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME, e.visible);\r\n                if (this._propertiesPanel) {\r\n                    if (e.visible && this.isMobileScreenSize()) {\r\n                        this._propertiesPanel.hide()\r\n                    }\r\n                }\r\n                if (this._historyToolbar) {\r\n                    if (e.visible && this.isMobileScreenSize()) {\r\n                        this._historyToolbarZIndex = zIndexPool.create(Overlay.baseZIndex());\r\n                        this._historyToolbar.$element().css(\"zIndex\", this._historyToolbarZIndex);\r\n                        this._historyToolbar.$element().css(\"boxShadow\", \"none\")\r\n                    }\r\n                }\r\n                if (this._viewToolbar) {\r\n                    this._viewToolbar.$element().css(\"opacity\", e.visible && this.isMobileScreenSize() ? \"0\" : \"1\");\r\n                    this._viewToolbar.$element().css(\"pointerEvents\", e.visible && this.isMobileScreenSize() ? \"none\" : \"\")\r\n                }\r\n            },\r\n            onVisibilityChanged: e => {\r\n                if (!e.visible && !this._textInputStarted) {\r\n                    this._captureFocus()\r\n                }\r\n                if (!isServerSide) {\r\n                    if (this._historyToolbar) {\r\n                        if (!e.visible && this.isMobileScreenSize() && this._historyToolbarZIndex) {\r\n                            zIndexPool.remove(this._historyToolbarZIndex);\r\n                            this._historyToolbar.$element().css(\"zIndex\", \"\");\r\n                            this._historyToolbar.$element().css(\"boxShadow\", \"\");\r\n                            this._historyToolbarZIndex = void 0\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            onPointerUp: this._onPanelPointerUp.bind(this)\r\n        });\r\n        this._toolbox._popup.option(\"propagateOutsideClick\", !this.option(\"fullScreen\"));\r\n        this._toolboxResizeCallback = () => {\r\n            var bounds = this._getToolboxBounds($parent, isServerSide);\r\n            this._toolbox.option(\"height\", bounds.height);\r\n            var prevIsMobileView = this._toolbox.option(\"isMobileView\");\r\n            if (prevIsMobileView !== this.isMobileScreenSize()) {\r\n                this._toolbox.option({\r\n                    isMobileView: this.isMobileScreenSize(),\r\n                    isVisible: this._isToolboxVisible()\r\n                });\r\n                this._setCustomCommandChecked(DiagramCommandsManager.SHOW_TOOLBOX_COMMAND_NAME, this._isToolboxVisible())\r\n            }\r\n            this._toolbox.updateMaxHeight()\r\n        }\r\n    }\r\n    _getToolboxBounds($parent, isServerSide) {\r\n        var result = {\r\n            offsetX: DIAGRAM_FLOATING_PANEL_OFFSET,\r\n            offsetY: DIAGRAM_FLOATING_PANEL_OFFSET,\r\n            height: !isServerSide ? getHeight($parent) - 2 * DIAGRAM_FLOATING_PANEL_OFFSET : 0\r\n        };\r\n        if (this._historyToolbar && !isServerSide) {\r\n            result.offsetY += getOuterHeight(this._historyToolbar.$element()) + DIAGRAM_FLOATING_PANEL_OFFSET;\r\n            result.height -= getOuterHeight(this._historyToolbar.$element()) + DIAGRAM_FLOATING_PANEL_OFFSET\r\n        }\r\n        if (this._viewToolbar && !isServerSide) {\r\n            result.height -= getOuterHeight(this._viewToolbar.$element()) + this._getViewToolbarYOffset(isServerSide)\r\n        }\r\n        return result\r\n    }\r\n    _renderViewToolbar($parent) {\r\n        var isServerSide = !hasWindow();\r\n        var $container = $(\"<div>\").addClass(DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS).appendTo($parent);\r\n        this._viewToolbar = this._createComponent($container, DiagramViewToolbar, extend(this._getToolbarBaseOptions(), {\r\n            commands: this.option(\"viewToolbar.commands\"),\r\n            locateInMenu: \"never\"\r\n        }));\r\n        this._updateViewToolbarPosition($container, $parent, isServerSide);\r\n        this._viewToolbarResizeCallback = () => {\r\n            this._updateViewToolbarPosition($container, $parent, isServerSide)\r\n        }\r\n    }\r\n    _getViewToolbarYOffset(isServerSide) {\r\n        if (isServerSide) {\r\n            return\r\n        }\r\n        var result = DIAGRAM_FLOATING_PANEL_OFFSET;\r\n        if (this._viewToolbar && this._propertiesToolbar) {\r\n            result += (getOuterHeight(this._propertiesToolbar.$element()) - getOuterHeight(this._viewToolbar.$element())) / 2\r\n        }\r\n        return result\r\n    }\r\n    _updateViewToolbarPosition($container, $parent, isServerSide) {\r\n        if (isServerSide) {\r\n            return\r\n        }\r\n        positionUtils.setup($container, {\r\n            my: \"left bottom\",\r\n            at: \"left bottom\",\r\n            of: $parent,\r\n            offset: DIAGRAM_FLOATING_PANEL_OFFSET + \" -\" + this._getViewToolbarYOffset(isServerSide)\r\n        })\r\n    }\r\n    _isPropertiesPanelEnabled() {\r\n        return \"disabled\" !== this.option(\"propertiesPanel.visibility\") && !this.isReadOnlyMode()\r\n    }\r\n    _isPropertiesPanelVisible() {\r\n        return \"visible\" === this.option(\"propertiesPanel.visibility\")\r\n    }\r\n    _renderPropertiesToolbar($parent) {\r\n        var isServerSide = !hasWindow();\r\n        var $container = $(\"<div>\").addClass(DIAGRAM_FLOATING_TOOLBAR_CONTAINER_CLASS).addClass(DIAGRAM_PROPERTIES_PANEL_TOOLBAR_CONTAINER_CLASS).appendTo($parent);\r\n        this._propertiesToolbar = this._createComponent($container, DiagramPropertiesToolbar, extend(this._getToolbarBaseOptions(), {\r\n            buttonStylingMode: \"contained\",\r\n            buttonType: \"default\",\r\n            locateInMenu: \"never\"\r\n        }));\r\n        this._updatePropertiesToolbarPosition($container, $parent, isServerSide);\r\n        this._propertiesToolbarResizeCallback = () => {\r\n            this._updatePropertiesToolbarPosition($container, $parent, isServerSide)\r\n        }\r\n    }\r\n    _updatePropertiesToolbarPosition($container, $parent, isServerSide) {\r\n        if (isServerSide) {\r\n            return\r\n        }\r\n        positionUtils.setup($container, {\r\n            my: \"right bottom\",\r\n            at: \"right bottom\",\r\n            of: $parent,\r\n            offset: \"-\" + DIAGRAM_FLOATING_PANEL_OFFSET + \" -\" + DIAGRAM_FLOATING_PANEL_OFFSET\r\n        })\r\n    }\r\n    _renderPropertiesPanel($parent) {\r\n        var isServerSide = !hasWindow();\r\n        var $propertiesPanel = $(\"<div>\").appendTo($parent);\r\n        var offsetX = DIAGRAM_FLOATING_PANEL_OFFSET;\r\n        var offsetY = 2 * DIAGRAM_FLOATING_PANEL_OFFSET + (!isServerSide ? getOuterHeight(this._propertiesToolbar.$element()) : 0);\r\n        this._propertiesPanel = this._createComponent($propertiesPanel, DiagramPropertiesPanel, {\r\n            isMobileView: this.isMobileScreenSize(),\r\n            isVisible: this._isPropertiesPanelVisible(),\r\n            container: this.$element(),\r\n            offsetParent: $parent,\r\n            offsetX: offsetX,\r\n            offsetY: offsetY,\r\n            propertyTabs: this.option(\"propertiesPanel.tabs\"),\r\n            onCreateToolbar: e => {\r\n                e.toolbar = this._createComponent(e.$parent, DiagramToolbar, extend(this._getToolbarBaseOptions(), {\r\n                    commands: e.commands,\r\n                    locateInMenu: \"never\",\r\n                    editorStylingMode: \"outlined\"\r\n                }))\r\n            },\r\n            onVisibilityChanging: e => {\r\n                if (isServerSide) {\r\n                    return\r\n                }\r\n                this._updatePropertiesPanelGroupBars(e.component);\r\n                this._setCustomCommandChecked(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME, e.visible);\r\n                if (this._toolbox) {\r\n                    if (e.visible && this.isMobileScreenSize()) {\r\n                        this._toolbox.hide()\r\n                    }\r\n                }\r\n            },\r\n            onVisibilityChanged: e => {\r\n                if (!e.visible && !this._textInputStarted) {\r\n                    this._captureFocus()\r\n                }\r\n            },\r\n            onSelectedGroupChanged: _ref3 => {\r\n                var {\r\n                    component: component\r\n                } = _ref3;\r\n                return this._updatePropertiesPanelGroupBars(component)\r\n            },\r\n            onPointerUp: this._onPanelPointerUp.bind(this)\r\n        });\r\n        this._propertiesPanelResizeCallback = () => {\r\n            var prevIsMobileView = this._propertiesPanel.option(\"isMobileView\");\r\n            if (prevIsMobileView !== this.isMobileScreenSize()) {\r\n                this._propertiesPanel.option({\r\n                    isMobileView: this.isMobileScreenSize(),\r\n                    isVisible: this._isPropertiesPanelVisible()\r\n                });\r\n                this._setCustomCommandChecked(DiagramCommandsManager.SHOW_PROPERTIES_PANEL_COMMAND_NAME, this._isPropertiesPanelVisible())\r\n            }\r\n        }\r\n    }\r\n    _updatePropertiesPanelGroupBars(component) {\r\n        component.getActiveToolbars().forEach(toolbar => {\r\n            this._diagramInstance.updateBarItemsState(toolbar.bar)\r\n        })\r\n    }\r\n    _onPanelPointerUp() {\r\n        this._captureFocusOnTimeout()\r\n    }\r\n    _renderContextMenu($parent) {\r\n        var $contextMenu = $(\"<div>\").appendTo($parent);\r\n        this._contextMenu = this._createComponent($contextMenu, diagramContextMenuModule.DiagramContextMenuWrapper, {\r\n            commands: this.option(\"contextMenu.commands\"),\r\n            onContentReady: _ref4 => {\r\n                var {\r\n                    component: component\r\n                } = _ref4;\r\n                return this._registerBar(component)\r\n            },\r\n            onVisibilityChanging: _ref5 => {\r\n                var {\r\n                    component: component\r\n                } = _ref5;\r\n                return this._diagramInstance.updateBarItemsState(component.bar)\r\n            },\r\n            onItemClick: itemData => this._onBeforeCommandExecuted(itemData.command),\r\n            export: this.option(\"export\"),\r\n            excludeCommands: this._getExcludeCommands(),\r\n            onInternalCommand: this._onInternalCommand.bind(this),\r\n            onCustomCommand: this._onCustomCommand.bind(this)\r\n        })\r\n    }\r\n    _renderContextToolbox($parent) {\r\n        var isServerSide = !hasWindow();\r\n        var category = this.option(\"contextToolbox.category\");\r\n        var displayMode = this.option(\"contextToolbox.displayMode\");\r\n        var shapes = this.option(\"contextToolbox.shapes\");\r\n        var $contextToolbox = $(\"<div>\").appendTo($parent);\r\n        this._contextToolbox = this._createComponent($contextToolbox, DiagramContextToolbox, {\r\n            toolboxWidth: this.option(\"contextToolbox.width\"),\r\n            onShown: e => {\r\n                if (isServerSide) {\r\n                    return\r\n                }\r\n                var $toolboxContainer = $(e.$element);\r\n                var isTextGroup = \"texts\" === displayMode;\r\n                if (!shapes && !category && !isTextGroup) {\r\n                    var group = this._getToolboxGroups().filter((function(g) {\r\n                        return g.category === e.category\r\n                    }))[0];\r\n                    if (group) {\r\n                        isTextGroup = \"texts\" === group.displayMode\r\n                    }\r\n                }\r\n                this._diagramInstance.createContextToolbox($toolboxContainer[0], isTextGroup, shapes || category || e.category, {\r\n                    shapeIconSpacing: DIAGRAM_CONTEXT_TOOLBOX_SHAPE_SPACING,\r\n                    shapeIconCountInRow: this.option(\"contextToolbox.shapeIconsPerRow\")\r\n                }, shapeType => {\r\n                    e.callback(shapeType);\r\n                    this._captureFocus();\r\n                    e.hide()\r\n                })\r\n            }\r\n        })\r\n    }\r\n    _setCustomCommandChecked(command, checked) {\r\n        this._toolbars.forEach(tb => {\r\n            tb.setCommandChecked(command, checked)\r\n        })\r\n    }\r\n    _onBeforeCommandExecuted(command) {\r\n        var dialogParameters = DiagramDialogManager.getDialogParameters(command);\r\n        if (dialogParameters) {\r\n            this._showDialog(dialogParameters)\r\n        }\r\n        return !!dialogParameters\r\n    }\r\n    _renderDialog($parent) {\r\n        var $dialogElement = $(\"<div>\").appendTo($parent);\r\n        this._dialogInstance = this._createComponent($dialogElement, DiagramDialog, {})\r\n    }\r\n    _showDialog(dialogParameters) {\r\n        if (this._dialogInstance) {\r\n            this._dialogInstance.option(\"onGetContent\", dialogParameters.onGetContent);\r\n            this._dialogInstance.option(\"onHidden\", function() {\r\n                this._captureFocus()\r\n            }.bind(this));\r\n            this._dialogInstance.option(\"command\", this._diagramInstance.getCommand(dialogParameters.command));\r\n            this._dialogInstance.option(\"title\", dialogParameters.title);\r\n            this._dialogInstance._show()\r\n        }\r\n    }\r\n    _showLoadingIndicator() {\r\n        this._loadingIndicator = $(\"<div>\").addClass(DIAGRAM_LOADING_INDICATOR_CLASS);\r\n        this._createComponent(this._loadingIndicator, LoadIndicator, {});\r\n        var $parent = this._$content || this.$element();\r\n        $parent.append(this._loadingIndicator)\r\n    }\r\n    _hideLoadingIndicator() {\r\n        if (!this._loadingIndicator) {\r\n            return\r\n        }\r\n        this._loadingIndicator.remove();\r\n        this._loadingIndicator = null\r\n    }\r\n    _initDiagram() {\r\n        var {\r\n            DiagramControl: DiagramControl\r\n        } = getDiagram();\r\n        this._diagramInstance = new DiagramControl;\r\n        this._diagramInstance.onChanged = this._raiseDataChangeAction.bind(this);\r\n        this._diagramInstance.onEdgeInserted = this._raiseEdgeInsertedAction.bind(this);\r\n        this._diagramInstance.onEdgeUpdated = this._raiseEdgeUpdatedAction.bind(this);\r\n        this._diagramInstance.onEdgeRemoved = this._raiseEdgeRemovedAction.bind(this);\r\n        this._diagramInstance.onNodeInserted = this._raiseNodeInsertedAction.bind(this);\r\n        this._diagramInstance.onNodeUpdated = this._raiseNodeUpdatedAction.bind(this);\r\n        this._diagramInstance.onNodeRemoved = this._raiseNodeRemovedAction.bind(this);\r\n        this._diagramInstance.onToolboxDragStart = this._raiseToolboxDragStart.bind(this);\r\n        this._diagramInstance.onToolboxDragEnd = this._raiseToolboxDragEnd.bind(this);\r\n        this._diagramInstance.onTextInputStart = this._raiseTextInputStart.bind(this);\r\n        this._diagramInstance.onTextInputEnd = this._raiseTextInputEnd.bind(this);\r\n        this._diagramInstance.onToggleFullscreen = this._onToggleFullScreen.bind(this);\r\n        this._diagramInstance.onShowContextMenu = this._onShowContextMenu.bind(this);\r\n        this._diagramInstance.onHideContextMenu = this._onHideContextMenu.bind(this);\r\n        this._diagramInstance.onShowContextToolbox = this._onShowContextToolbox.bind(this);\r\n        this._diagramInstance.onHideContextToolbox = this._onHideContextToolbox.bind(this);\r\n        this._diagramInstance.onNativeAction.add({\r\n            notifyItemClick: this._raiseItemClickAction.bind(this),\r\n            notifyItemDblClick: this._raiseItemDblClickAction.bind(this),\r\n            notifySelectionChanged: this._raiseSelectionChanged.bind(this)\r\n        });\r\n        this._diagramInstance.onRequestOperation = this._raiseRequestEditOperation.bind(this);\r\n        this._updateEventSubscriptionMethods();\r\n        this._updateDefaultItemProperties();\r\n        this._updateEditingSettings();\r\n        this._updateShapeTexts();\r\n        this._updateUnitItems();\r\n        this._updateFormatUnitsMethod();\r\n        if (this.option(\"units\") !== DIAGRAM_DEFAULT_UNIT) {\r\n            this._updateUnitsState()\r\n        }\r\n        if (this.isReadOnlyMode()) {\r\n            this._updateReadOnlyState()\r\n        }\r\n        if (this.option(\"pageSize\")) {\r\n            if (this.option(\"pageSize.items\")) {\r\n                this._updatePageSizeItemsState()\r\n            }\r\n            if (this.option(\"pageSize.width\") && this.option(\"pageSize.height\")) {\r\n                this._updatePageSizeState()\r\n            }\r\n        }\r\n        if (this.option(\"pageOrientation\") !== DIAGRAM_DEFAULT_PAGE_ORIENTATION) {\r\n            this._updatePageOrientationState()\r\n        }\r\n        if (this.option(\"pageColor\") !== DIAGRAM_DEFAULT_PAGE_COLOR) {\r\n            this._updatePageColorState()\r\n        }\r\n        if (this.option(\"viewUnits\") !== DIAGRAM_DEFAULT_UNIT) {\r\n            this._updateViewUnitsState()\r\n        }\r\n        if (!this.option(\"showGrid\")) {\r\n            this._updateShowGridState()\r\n        }\r\n        if (!this.option(\"snapToGrid\")) {\r\n            this._updateSnapToGridState()\r\n        }\r\n        if (this.option(\"gridSize\")) {\r\n            this._updateGridSizeState()\r\n        }\r\n        if (this.option(\"zoomLevel\") !== DIAGRAM_DEFAULT_ZOOMLEVEL) {\r\n            this._updateZoomLevelState()\r\n        }\r\n        if (this.option(\"simpleView\")) {\r\n            this._updateSimpleViewState()\r\n        }\r\n        if (this.option(\"autoZoomMode\") !== DIAGRAM_DEFAULT_AUTOZOOM_MODE) {\r\n            this._updateAutoZoomState()\r\n        }\r\n        if (this.option(\"fullScreen\")) {\r\n            var window = getWindow();\r\n            if (window && window.self !== window.top) {\r\n                this.option(\"fullScreen\", false)\r\n            } else {\r\n                this._updateFullscreenState()\r\n            }\r\n        }\r\n        this._createOptionsUpdateBar();\r\n        if (hasWindow()) {\r\n            this._diagramInstance.initMeasurer(this.$element()[0])\r\n        }\r\n        this._updateCustomShapes(this._getCustomShapes());\r\n        this._refreshDataSources()\r\n    }\r\n    _createOptionsUpdateBar() {\r\n        if (!this.optionsUpdateBar) {\r\n            this.optionsUpdateBar = new DiagramOptionsUpdateBar(this);\r\n            this._diagramInstance.registerBar(this.optionsUpdateBar)\r\n        }\r\n    }\r\n    _deleteOptionsUpdateBar() {\r\n        delete this.optionsUpdateBar\r\n    }\r\n    _clean() {\r\n        if (this._diagramInstance) {\r\n            this._diagramInstance.cleanMarkup(element => {\r\n                $(element).empty()\r\n            });\r\n            this._deleteOptionsUpdateBar()\r\n        }\r\n        super._clean()\r\n    }\r\n    _dispose() {\r\n        this._killCaptureFocusTimeout();\r\n        super._dispose();\r\n        this._diagramInstance = void 0\r\n    }\r\n    _executeDiagramCommand(command, parameter) {\r\n        this._diagramInstance.getCommand(command).execute(parameter)\r\n    }\r\n    getNodeDataSource() {\r\n        return this._nodesOption && this._nodesOption.getDataSource()\r\n    }\r\n    getEdgeDataSource() {\r\n        return this._edgesOption && this._edgesOption.getDataSource()\r\n    }\r\n    _refreshDataSources() {\r\n        this._beginUpdateDiagram();\r\n        this._refreshNodesDataSource();\r\n        this._refreshEdgesDataSource();\r\n        this._endUpdateDiagram()\r\n    }\r\n    _refreshNodesDataSource() {\r\n        if (this._nodesOption) {\r\n            this._nodesOption._disposeDataSource();\r\n            delete this._nodesOption\r\n        }\r\n        if (this.option(\"nodes.dataSource\")) {\r\n            this._nodesOption = new NodesOption(this);\r\n            this._nodesOption.option(\"dataSource\", this.option(\"nodes.dataSource\"));\r\n            this._nodesOption._refreshDataSource()\r\n        }\r\n    }\r\n    _refreshEdgesDataSource() {\r\n        if (this._edgesOption) {\r\n            this._edgesOption._disposeDataSource();\r\n            delete this._edgesOption\r\n        }\r\n        if (this.option(\"edges.dataSource\")) {\r\n            this._edgesOption = new EdgesOption(this);\r\n            this._edgesOption.option(\"dataSource\", this.option(\"edges.dataSource\"));\r\n            this._edgesOption._refreshDataSource()\r\n        }\r\n    }\r\n    _getDiagramData() {\r\n        var value;\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.Export, (function(data) {\r\n            value = data\r\n        }));\r\n        return value\r\n    }\r\n    _setDiagramData(data, keepExistingItems) {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.Import, {\r\n            data: data,\r\n            keepExistingItems: keepExistingItems\r\n        })\r\n    }\r\n    isReadOnlyMode() {\r\n        return this.option(\"readOnly\") || this.option(\"disabled\")\r\n    }\r\n    _onDataSourceChanged() {\r\n        this._bindDiagramData()\r\n    }\r\n    _getChangesKeys(changes) {\r\n        return changes.map(change => {\r\n            if (isDefined(change.internalKey)) {\r\n                return change.internalKey\r\n            } else if (isDefined(change.key)) {\r\n                return change.key\r\n            } else {\r\n                return null\r\n            }\r\n        }).filter(key => isDefined(key))\r\n    }\r\n    _createOptionGetter(optionName) {\r\n        var expr = this.option(optionName);\r\n        return expr && compileGetter(expr)\r\n    }\r\n    _onRequestUpdateLayout(changes) {\r\n        if (!this._requestLayoutUpdateAction) {\r\n            this._createRequestLayoutUpdateAction()\r\n        }\r\n        var eventArgs = {\r\n            changes: changes,\r\n            allowed: false\r\n        };\r\n        this._requestLayoutUpdateAction(eventArgs);\r\n        return eventArgs.allowed\r\n    }\r\n    _createOptionSetter(optionName) {\r\n        var expr = this.option(optionName);\r\n        if (isFunction(expr)) {\r\n            return expr\r\n        }\r\n        return expr && compileSetter(expr)\r\n    }\r\n    _bindDiagramData() {\r\n        if (this._updateDiagramLockCount || !this._isBindingMode()) {\r\n            return\r\n        }\r\n        var {\r\n            DiagramCommand: DiagramCommand,\r\n            ConnectorLineOption: ConnectorLineOption,\r\n            ConnectorLineEnding: ConnectorLineEnding\r\n        } = getDiagram();\r\n        var lineOptionGetter;\r\n        var lineOptionSetter;\r\n        var startLineEndingGetter;\r\n        var startLineEndingSetter;\r\n        var endLineEndingGetter;\r\n        var endLineEndingSetter;\r\n        var containerChildrenGetter;\r\n        var containerChildrenSetter;\r\n        var data = {\r\n            nodeDataSource: this._nodesOption && this._nodesOption.getItems(),\r\n            edgeDataSource: this._edgesOption && this._edgesOption.getItems(),\r\n            nodeDataImporter: {\r\n                getKey: this._createOptionGetter(\"nodes.keyExpr\"),\r\n                setKey: this._createOptionSetter(\"nodes.keyExpr\"),\r\n                getCustomData: this._createOptionGetter(\"nodes.customDataExpr\"),\r\n                setCustomData: this._createOptionSetter(\"nodes.customDataExpr\"),\r\n                getLocked: this._createOptionGetter(\"nodes.lockedExpr\"),\r\n                setLocked: this._createOptionSetter(\"nodes.lockedExpr\"),\r\n                getStyle: this._createOptionGetter(\"nodes.styleExpr\"),\r\n                setStyle: this._createOptionSetter(\"nodes.styleExpr\"),\r\n                getStyleText: this._createOptionGetter(\"nodes.textStyleExpr\"),\r\n                setStyleText: this._createOptionSetter(\"nodes.textStyleExpr\"),\r\n                getZIndex: this._createOptionGetter(\"nodes.zIndexExpr\"),\r\n                setZIndex: this._createOptionSetter(\"nodes.zIndexExpr\"),\r\n                getType: this._createOptionGetter(\"nodes.typeExpr\"),\r\n                setType: this._createOptionSetter(\"nodes.typeExpr\"),\r\n                getText: this._createOptionGetter(\"nodes.textExpr\"),\r\n                setText: this._createOptionSetter(\"nodes.textExpr\"),\r\n                getImage: this._createOptionGetter(\"nodes.imageUrlExpr\"),\r\n                setImage: this._createOptionSetter(\"nodes.imageUrlExpr\"),\r\n                getLeft: this._createOptionGetter(\"nodes.leftExpr\"),\r\n                setLeft: this._createOptionSetter(\"nodes.leftExpr\"),\r\n                getTop: this._createOptionGetter(\"nodes.topExpr\"),\r\n                setTop: this._createOptionSetter(\"nodes.topExpr\"),\r\n                getWidth: this._createOptionGetter(\"nodes.widthExpr\"),\r\n                setWidth: this._createOptionSetter(\"nodes.widthExpr\"),\r\n                getHeight: this._createOptionGetter(\"nodes.heightExpr\"),\r\n                setHeight: this._createOptionSetter(\"nodes.heightExpr\"),\r\n                getParentKey: this._createOptionGetter(\"nodes.parentKeyExpr\"),\r\n                setParentKey: this._createOptionSetter(\"nodes.parentKeyExpr\"),\r\n                getItems: this._createOptionGetter(\"nodes.itemsExpr\"),\r\n                setItems: this._createOptionSetter(\"nodes.itemsExpr\"),\r\n                getChildren: containerChildrenGetter = this._createOptionGetter(\"nodes.containerChildrenExpr\"),\r\n                setChildren: containerChildrenSetter = this._createOptionSetter(\"nodes.containerChildrenExpr\"),\r\n                getContainerKey: !containerChildrenGetter && !containerChildrenSetter && this._createOptionGetter(\"nodes.containerKeyExpr\"),\r\n                setContainerKey: !containerChildrenGetter && !containerChildrenSetter && this._createOptionSetter(\"nodes.containerKeyExpr\")\r\n            },\r\n            edgeDataImporter: {\r\n                getKey: this._createOptionGetter(\"edges.keyExpr\"),\r\n                setKey: this._createOptionSetter(\"edges.keyExpr\"),\r\n                getCustomData: this._createOptionGetter(\"edges.customDataExpr\"),\r\n                setCustomData: this._createOptionSetter(\"edges.customDataExpr\"),\r\n                getLocked: this._createOptionGetter(\"edges.lockedExpr\"),\r\n                setLocked: this._createOptionSetter(\"edges.lockedExpr\"),\r\n                getStyle: this._createOptionGetter(\"edges.styleExpr\"),\r\n                setStyle: this._createOptionSetter(\"edges.styleExpr\"),\r\n                getStyleText: this._createOptionGetter(\"edges.textStyleExpr\"),\r\n                setStyleText: this._createOptionSetter(\"edges.textStyleExpr\"),\r\n                getZIndex: this._createOptionGetter(\"edges.zIndexExpr\"),\r\n                setZIndex: this._createOptionSetter(\"edges.zIndexExpr\"),\r\n                getFrom: this._createOptionGetter(\"edges.fromExpr\"),\r\n                setFrom: this._createOptionSetter(\"edges.fromExpr\"),\r\n                getFromPointIndex: this._createOptionGetter(\"edges.fromPointIndexExpr\"),\r\n                setFromPointIndex: this._createOptionSetter(\"edges.fromPointIndexExpr\"),\r\n                getTo: this._createOptionGetter(\"edges.toExpr\"),\r\n                setTo: this._createOptionSetter(\"edges.toExpr\"),\r\n                getToPointIndex: this._createOptionGetter(\"edges.toPointIndexExpr\"),\r\n                setToPointIndex: this._createOptionSetter(\"edges.toPointIndexExpr\"),\r\n                getPoints: this._createOptionGetter(\"edges.pointsExpr\"),\r\n                setPoints: this._createOptionSetter(\"edges.pointsExpr\"),\r\n                getText: this._createOptionGetter(\"edges.textExpr\"),\r\n                setText: this._createOptionSetter(\"edges.textExpr\"),\r\n                getLineOption: (lineOptionGetter = this._createOptionGetter(\"edges.lineTypeExpr\")) && function(obj) {\r\n                    var lineType = lineOptionGetter(obj);\r\n                    return this._getConnectorLineOption(lineType)\r\n                }.bind(this),\r\n                setLineOption: (lineOptionSetter = this._createOptionSetter(\"edges.lineTypeExpr\")) && function(obj, value) {\r\n                    switch (value) {\r\n                        case ConnectorLineOption.Straight:\r\n                            value = \"straight\";\r\n                            break;\r\n                        case ConnectorLineOption.Orthogonal:\r\n                            value = \"orthogonal\"\r\n                    }\r\n                    lineOptionSetter(obj, value)\r\n                }.bind(this),\r\n                getStartLineEnding: (startLineEndingGetter = this._createOptionGetter(\"edges.fromLineEndExpr\")) && function(obj) {\r\n                    var lineEnd = startLineEndingGetter(obj);\r\n                    return this._getConnectorLineEnding(lineEnd)\r\n                }.bind(this),\r\n                setStartLineEnding: (startLineEndingSetter = this._createOptionSetter(\"edges.fromLineEndExpr\")) && function(obj, value) {\r\n                    switch (value) {\r\n                        case ConnectorLineEnding.Arrow:\r\n                            value = \"arrow\";\r\n                            break;\r\n                        case ConnectorLineEnding.OutlinedTriangle:\r\n                            value = \"outlinedTriangle\";\r\n                            break;\r\n                        case ConnectorLineEnding.FilledTriangle:\r\n                            value = \"filledTriangle\";\r\n                            break;\r\n                        case ConnectorLineEnding.None:\r\n                            value = \"none\"\r\n                    }\r\n                    startLineEndingSetter(obj, value)\r\n                }.bind(this),\r\n                getEndLineEnding: (endLineEndingGetter = this._createOptionGetter(\"edges.toLineEndExpr\")) && function(obj) {\r\n                    var lineEnd = endLineEndingGetter(obj);\r\n                    return this._getConnectorLineEnding(lineEnd)\r\n                }.bind(this),\r\n                setEndLineEnding: (endLineEndingSetter = this._createOptionSetter(\"edges.toLineEndExpr\")) && function(obj, value) {\r\n                    switch (value) {\r\n                        case ConnectorLineEnding.Arrow:\r\n                            value = \"arrow\";\r\n                            break;\r\n                        case ConnectorLineEnding.OutlinedTriangle:\r\n                            value = \"outlinedTriangle\";\r\n                            break;\r\n                        case ConnectorLineEnding.FilledTriangle:\r\n                            value = \"filledTriangle\";\r\n                            break;\r\n                        case ConnectorLineEnding.None:\r\n                            value = \"none\"\r\n                    }\r\n                    endLineEndingSetter(obj, value)\r\n                }.bind(this)\r\n            },\r\n            layoutParameters: this._getDataBindingLayoutParameters()\r\n        };\r\n        this._executeDiagramCommand(DiagramCommand.BindDocument, data)\r\n    }\r\n    _reloadContentByChanges(changes, isExternalChanges) {\r\n        var keys = this._getChangesKeys(changes);\r\n        var applyLayout = this._onRequestUpdateLayout(changes);\r\n        this._reloadContent(keys, applyLayout, isExternalChanges)\r\n    }\r\n    _reloadContent(itemKeys, applyLayout, isExternalChanges) {\r\n        this._diagramInstance.reloadContent(itemKeys, () => {\r\n            var nodeDataSource;\r\n            var edgeDataSource;\r\n            if (this._nodesOption && isExternalChanges) {\r\n                nodeDataSource = this._nodesOption.getItems()\r\n            }\r\n            if (this._edgesOption && isExternalChanges) {\r\n                edgeDataSource = this._edgesOption.getItems()\r\n            }\r\n            return {\r\n                nodeDataSource: nodeDataSource,\r\n                edgeDataSource: edgeDataSource\r\n            }\r\n        }, applyLayout && this._getDataBindingLayoutParameters(), isExternalChanges)\r\n    }\r\n    _getConnectorLineOption(lineType) {\r\n        var {\r\n            ConnectorLineOption: ConnectorLineOption\r\n        } = getDiagram();\r\n        switch (lineType) {\r\n            case \"straight\":\r\n                return ConnectorLineOption.Straight;\r\n            default:\r\n                return ConnectorLineOption.Orthogonal\r\n        }\r\n    }\r\n    _getConnectorLineEnding(lineEnd) {\r\n        var {\r\n            ConnectorLineEnding: ConnectorLineEnding\r\n        } = getDiagram();\r\n        switch (lineEnd) {\r\n            case \"arrow\":\r\n                return ConnectorLineEnding.Arrow;\r\n            case \"outlinedTriangle\":\r\n                return ConnectorLineEnding.OutlinedTriangle;\r\n            case \"filledTriangle\":\r\n                return ConnectorLineEnding.FilledTriangle;\r\n            default:\r\n                return ConnectorLineEnding.None\r\n        }\r\n    }\r\n    _getDataBindingLayoutParameters() {\r\n        var {\r\n            DataLayoutType: DataLayoutType,\r\n            DataLayoutOrientation: DataLayoutOrientation\r\n        } = getDiagram();\r\n        var layoutParametersOption = this.option(\"nodes.autoLayout\") || \"off\";\r\n        var layoutType = layoutParametersOption.type || layoutParametersOption;\r\n        var parameters = {};\r\n        if (\"off\" !== layoutType && (\"auto\" !== layoutType || !this._hasNodePositionExprs())) {\r\n            switch (layoutType) {\r\n                case \"tree\":\r\n                    parameters.type = DataLayoutType.Tree;\r\n                    break;\r\n                default:\r\n                    parameters.type = DataLayoutType.Sugiyama\r\n            }\r\n            switch (layoutParametersOption.orientation) {\r\n                case \"vertical\":\r\n                    parameters.orientation = DataLayoutOrientation.Vertical;\r\n                    break;\r\n                case \"horizontal\":\r\n                    parameters.orientation = DataLayoutOrientation.Horizontal\r\n            }\r\n            if (this.option(\"edges.fromPointIndexExpr\") || this.option(\"edges.toPointIndexExpr\")) {\r\n                parameters.skipPointIndices = true\r\n            }\r\n        }\r\n        parameters.autoSizeEnabled = !!this.option(\"nodes.autoSizeEnabled\");\r\n        return parameters\r\n    }\r\n    _hasNodePositionExprs() {\r\n        return this.option(\"nodes.topExpr\") && this.option(\"nodes.leftExpr\")\r\n    }\r\n    _getAutoZoomValue(option) {\r\n        var {\r\n            AutoZoomMode: AutoZoomMode\r\n        } = getDiagram();\r\n        switch (option) {\r\n            case \"fitContent\":\r\n                return AutoZoomMode.FitContent;\r\n            case \"fitWidth\":\r\n                return AutoZoomMode.FitToWidth;\r\n            default:\r\n                return AutoZoomMode.Disabled\r\n        }\r\n    }\r\n    _isBindingMode() {\r\n        return this._nodesOption && this._nodesOption.hasItems() || this._edgesOption && this._edgesOption.hasItems()\r\n    }\r\n    _beginUpdateDiagram() {\r\n        this._updateDiagramLockCount++\r\n    }\r\n    _endUpdateDiagram() {\r\n        this._updateDiagramLockCount = Math.max(this._updateDiagramLockCount - 1, 0);\r\n        if (!this._updateDiagramLockCount) {\r\n            this._bindDiagramData()\r\n        }\r\n    }\r\n    _getCustomShapes() {\r\n        return this.option(\"customShapes\") || []\r\n    }\r\n    _getToolboxGroups() {\r\n        return DiagramToolboxManager.getGroups(this.option(\"toolbox.groups\"))\r\n    }\r\n    _updateAllCustomShapes() {\r\n        this._diagramInstance.removeAllCustomShapes();\r\n        this._updateCustomShapes(this._getCustomShapes())\r\n    }\r\n    _updateCustomShapes(customShapes, prevCustomShapes) {\r\n        if (Array.isArray(prevCustomShapes)) {\r\n            this._diagramInstance.removeCustomShapes(prevCustomShapes.map(s => s.type))\r\n        }\r\n        if (Array.isArray(customShapes)) {\r\n            this._diagramInstance.addCustomShapes(customShapes.map(s => {\r\n                var templateOption = s.template || this.option(\"customShapeTemplate\");\r\n                var template = templateOption && this._getTemplate(templateOption);\r\n                var toolboxTemplateOption = s.toolboxTemplate || this.option(\"customShapeToolboxTemplate\");\r\n                var toolboxTemplate = toolboxTemplateOption && this._getTemplate(toolboxTemplateOption);\r\n                return {\r\n                    category: s.category,\r\n                    type: s.type,\r\n                    baseType: s.baseType,\r\n                    title: s.title,\r\n                    svgUrl: s.backgroundImageUrl,\r\n                    svgToolboxUrl: s.backgroundImageToolboxUrl,\r\n                    svgLeft: s.backgroundImageLeft,\r\n                    svgTop: s.backgroundImageTop,\r\n                    svgWidth: s.backgroundImageWidth,\r\n                    svgHeight: s.backgroundImageHeight,\r\n                    defaultWidth: s.defaultWidth,\r\n                    defaultHeight: s.defaultHeight,\r\n                    toolboxWidthToHeightRatio: s.toolboxWidthToHeightRatio,\r\n                    minWidth: s.minWidth,\r\n                    minHeight: s.minHeight,\r\n                    maxWidth: s.maxWidth,\r\n                    maxHeight: s.maxHeight,\r\n                    allowResize: s.allowResize,\r\n                    defaultText: s.defaultText,\r\n                    allowEditText: s.allowEditText,\r\n                    textLeft: s.textLeft,\r\n                    textTop: s.textTop,\r\n                    textWidth: s.textWidth,\r\n                    textHeight: s.textHeight,\r\n                    defaultImageUrl: s.defaultImageUrl,\r\n                    allowEditImage: s.allowEditImage,\r\n                    imageLeft: s.imageLeft,\r\n                    imageTop: s.imageTop,\r\n                    imageWidth: s.imageWidth,\r\n                    imageHeight: s.imageHeight,\r\n                    connectionPoints: s.connectionPoints && s.connectionPoints.map(pt => ({\r\n                        x: pt.x,\r\n                        y: pt.y\r\n                    })),\r\n                    createTemplate: template && ((container, item) => {\r\n                        template.render({\r\n                            model: this._nativeItemToDiagramItem(item),\r\n                            container: getPublicElement($(container))\r\n                        })\r\n                    }),\r\n                    createToolboxTemplate: toolboxTemplate && ((container, item) => {\r\n                        toolboxTemplate.render({\r\n                            model: this._nativeItemToDiagramItem(item),\r\n                            container: getPublicElement($(container))\r\n                        })\r\n                    }),\r\n                    destroyTemplate: template && (container => {\r\n                        $(container).empty()\r\n                    }),\r\n                    templateLeft: s.templateLeft,\r\n                    templateTop: s.templateTop,\r\n                    templateWidth: s.templateWidth,\r\n                    templateHeight: s.templateHeight,\r\n                    keepRatioOnAutoSize: s.keepRatioOnAutoSize\r\n                }\r\n            }))\r\n        }\r\n    }\r\n    _getViewport() {\r\n        var $viewPort = this.$element().closest(\".dx-viewport\");\r\n        return $viewPort.length ? $viewPort : $(\"body\")\r\n    }\r\n    _onToggleFullScreen(fullScreen) {\r\n        if (this.toggleFullscreenLock > 0) {\r\n            return\r\n        }\r\n        this._changeNativeFullscreen(fullScreen);\r\n        if (fullScreen) {\r\n            this._prevParent = this.$element().parent();\r\n            this._prevFullScreenZIndex = this.$element().css(\"zIndex\");\r\n            this._fullScreenZIndex = zIndexPool.create(Overlay.baseZIndex());\r\n            this.$element().css(\"zIndex\", this._fullScreenZIndex);\r\n            this.$element().appendTo(this._getViewport())\r\n        } else {\r\n            this.$element().appendTo(this._prevParent);\r\n            if (this._fullScreenZIndex) {\r\n                zIndexPool.remove(this._fullScreenZIndex);\r\n                this.$element().css(\"zIndex\", this._prevFullScreenZIndex)\r\n            }\r\n        }\r\n        this.$element().toggleClass(DIAGRAM_FULLSCREEN_CLASS, fullScreen);\r\n        this._processDiagramResize();\r\n        if (this._toolbox) {\r\n            this._toolbox.repaint();\r\n            this._toolbox._popup.option(\"propagateOutsideClick\", !fullScreen)\r\n        }\r\n        if (this._propertiesPanel) {\r\n            this._propertiesPanel.repaint()\r\n        }\r\n        if (this._historyToolbar) {\r\n            this._updateHistoryToolbarPosition()\r\n        }\r\n    }\r\n    _changeNativeFullscreen(setModeOn) {\r\n        var window = getWindow();\r\n        if (window.self === window.top || setModeOn === this._inNativeFullscreen()) {\r\n            return\r\n        }\r\n        if (setModeOn) {\r\n            this._subscribeFullscreenNativeChanged()\r\n        } else {\r\n            this._unsubscribeFullscreenNativeChanged()\r\n        }\r\n        this._setNativeFullscreen(setModeOn)\r\n    }\r\n    _setNativeFullscreen(on) {\r\n        var window = getWindow();\r\n        var document = window.self.document;\r\n        var body = window.self.document.body;\r\n        if (on) {\r\n            if (body.requestFullscreen) {\r\n                body.requestFullscreen()\r\n            } else if (body.mozRequestFullscreen) {\r\n                body.mozRequestFullscreen()\r\n            } else if (body.webkitRequestFullscreen) {\r\n                body.webkitRequestFullscreen()\r\n            } else if (body.msRequestFullscreen) {\r\n                body.msRequestFullscreen()\r\n            }\r\n        } else if (document.exitFullscreen) {\r\n            document.exitFullscreen()\r\n        } else if (document.mozCancelFullscreen) {\r\n            document.mozCancelFullscreen()\r\n        } else if (document.webkitExitFullscreen) {\r\n            document.webkitExitFullscreen()\r\n        } else if (document.msExitFullscreen) {\r\n            document.msExitFullscreen()\r\n        }\r\n    }\r\n    _inNativeFullscreen() {\r\n        var document = getWindow().document;\r\n        var fullscreenElement = document.fullscreenElement || document.msFullscreenElement || document.webkitFullscreenElement;\r\n        var isInFullscreen = fullscreenElement === document.body || document.webkitIsFullscreen;\r\n        return !!isInFullscreen\r\n    }\r\n    _subscribeFullscreenNativeChanged() {\r\n        var document = getWindow().document;\r\n        var handler = this._onNativeFullscreenChangeHandler.bind(this);\r\n        eventsEngine.on(document, FULLSCREEN_CHANGE_EVENT_NAME, handler);\r\n        eventsEngine.on(document, IE_FULLSCREEN_CHANGE_EVENT_NAME, handler);\r\n        eventsEngine.on(document, WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME, handler);\r\n        eventsEngine.on(document, MOZ_FULLSCREEN_CHANGE_EVENT_NAME, handler)\r\n    }\r\n    _unsubscribeFullscreenNativeChanged() {\r\n        var document = getWindow().document;\r\n        eventsEngine.off(document, FULLSCREEN_CHANGE_EVENT_NAME);\r\n        eventsEngine.off(document, IE_FULLSCREEN_CHANGE_EVENT_NAME);\r\n        eventsEngine.off(document, WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME);\r\n        eventsEngine.off(document, MOZ_FULLSCREEN_CHANGE_EVENT_NAME)\r\n    }\r\n    _onNativeFullscreenChangeHandler() {\r\n        if (!this._inNativeFullscreen()) {\r\n            this._unsubscribeFullscreenNativeChanged();\r\n            this.option(\"fullScreen\", false)\r\n        }\r\n    }\r\n    _executeDiagramFullscreenCommand(fullscreen) {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this.toggleFullscreenLock++;\r\n        this._executeDiagramCommand(DiagramCommand.Fullscreen, fullscreen);\r\n        this.toggleFullscreenLock--\r\n    }\r\n    _onShowContextMenu(x, y, selection) {\r\n        if (this._contextMenu) {\r\n            this._contextMenu._show(x, y, selection)\r\n        }\r\n    }\r\n    _onHideContextMenu() {\r\n        if (this._contextMenu) {\r\n            this._contextMenu._hide()\r\n        }\r\n    }\r\n    _onShowContextToolbox(x, y, side, category, callback) {\r\n        if (this._contextToolbox) {\r\n            this._contextToolbox._show(x, y, side, category, callback)\r\n        }\r\n    }\r\n    _onHideContextToolbox() {\r\n        if (this._contextToolbox) {\r\n            this._contextToolbox._hide()\r\n        }\r\n    }\r\n    _getDiagramUnitValue(value) {\r\n        var {\r\n            DiagramUnit: DiagramUnit\r\n        } = getDiagram();\r\n        switch (value) {\r\n            case \"in\":\r\n                return DiagramUnit.In;\r\n            case \"cm\":\r\n                return DiagramUnit.Cm;\r\n            case \"px\":\r\n                return DiagramUnit.Px;\r\n            default:\r\n                return DiagramUnit.In\r\n        }\r\n    }\r\n    _updateReadOnlyState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        var readOnly = this.isReadOnlyMode();\r\n        this._executeDiagramCommand(DiagramCommand.ToggleReadOnly, readOnly)\r\n    }\r\n    _updateZoomLevelState() {\r\n        if (this.option(\"zoomLevel.items\")) {\r\n            this._updateZoomLevelItemsState();\r\n            var zoomLevel = this.option(\"zoomLevel.value\");\r\n            if (!zoomLevel) {\r\n                return\r\n            }\r\n            var {\r\n                DiagramCommand: DiagramCommand\r\n            } = getDiagram();\r\n            this._executeDiagramCommand(DiagramCommand.ZoomLevel, zoomLevel)\r\n        } else {\r\n            var _zoomLevel = this.option(\"zoomLevel.value\") || this.option(\"zoomLevel\");\r\n            if (!_zoomLevel) {\r\n                return\r\n            }\r\n            var {\r\n                DiagramCommand: _DiagramCommand\r\n            } = getDiagram();\r\n            this._executeDiagramCommand(_DiagramCommand.ZoomLevel, _zoomLevel)\r\n        }\r\n    }\r\n    _updateZoomLevelItemsState() {\r\n        var zoomLevelItems = this.option(\"zoomLevel.items\");\r\n        if (!Array.isArray(zoomLevelItems)) {\r\n            return\r\n        }\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.ZoomLevelItems, zoomLevelItems)\r\n    }\r\n    _updateAutoZoomState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.SwitchAutoZoom, this._getAutoZoomValue(this.option(\"autoZoomMode\")))\r\n    }\r\n    _updateSimpleViewState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.ToggleSimpleView, this.option(\"simpleView\"))\r\n    }\r\n    _updateFullscreenState() {\r\n        var fullscreen = this.option(\"fullScreen\");\r\n        this._executeDiagramFullscreenCommand(fullscreen);\r\n        this._onToggleFullScreen(fullscreen)\r\n    }\r\n    _updateShowGridState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.ShowGrid, this.option(\"showGrid\"))\r\n    }\r\n    _updateSnapToGridState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.SnapToGrid, this.option(\"snapToGrid\"))\r\n    }\r\n    _updateGridSizeState() {\r\n        if (this.option(\"gridSize.items\")) {\r\n            this._updateGridSizeItemsState();\r\n            var gridSize = this.option(\"gridSize.value\");\r\n            if (!gridSize) {\r\n                return\r\n            }\r\n            var {\r\n                DiagramCommand: DiagramCommand\r\n            } = getDiagram();\r\n            this._executeDiagramCommand(DiagramCommand.GridSize, gridSize)\r\n        } else {\r\n            var _gridSize = this.option(\"gridSize.value\") || this.option(\"gridSize\");\r\n            if (!_gridSize) {\r\n                return\r\n            }\r\n            var {\r\n                DiagramCommand: _DiagramCommand2\r\n            } = getDiagram();\r\n            this._executeDiagramCommand(_DiagramCommand2.GridSize, _gridSize)\r\n        }\r\n    }\r\n    _updateGridSizeItemsState() {\r\n        var gridSizeItems = this.option(\"gridSize.items\");\r\n        if (!Array.isArray(gridSizeItems)) {\r\n            return\r\n        }\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.GridSizeItems, gridSizeItems)\r\n    }\r\n    _updateUnitItems() {\r\n        var {\r\n            DiagramLocalizationService: DiagramLocalizationService\r\n        } = getDiagram();\r\n        var items = this._getUnitItems();\r\n        if (this._unitItems !== items) {\r\n            this._unitItems = items;\r\n            DiagramLocalizationService.unitItems = items\r\n        }\r\n    }\r\n    _getUnitItems() {\r\n        var {\r\n            DiagramUnit: DiagramUnit\r\n        } = getDiagram();\r\n        var items = {};\r\n        items[DiagramUnit.In] = messageLocalization.format(\"dxDiagram-unitIn\");\r\n        items[DiagramUnit.Cm] = messageLocalization.format(\"dxDiagram-unitCm\");\r\n        items[DiagramUnit.Px] = messageLocalization.format(\"dxDiagram-unitPx\");\r\n        return items\r\n    }\r\n    _updateFormatUnitsMethod() {\r\n        var {\r\n            DiagramLocalizationService: DiagramLocalizationService\r\n        } = getDiagram();\r\n        DiagramLocalizationService.formatUnit = function(value) {\r\n            return numberLocalization.format(value)\r\n        }\r\n    }\r\n    _updateViewUnitsState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.ViewUnits, this._getDiagramUnitValue(this.option(\"viewUnits\")))\r\n    }\r\n    _updateUnitsState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.Units, this._getDiagramUnitValue(this.option(\"units\")))\r\n    }\r\n    _updatePageSizeState() {\r\n        var pageSize = this.option(\"pageSize\");\r\n        if (!pageSize || !pageSize.width || !pageSize.height) {\r\n            return\r\n        }\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.PageSize, pageSize)\r\n    }\r\n    _updatePageSizeItemsState() {\r\n        var pageSizeItems = this.option(\"pageSize.items\");\r\n        if (!Array.isArray(pageSizeItems)) {\r\n            return\r\n        }\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.PageSizeItems, pageSizeItems)\r\n    }\r\n    _updatePageOrientationState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.PageLandscape, \"landscape\" === this.option(\"pageOrientation\"))\r\n    }\r\n    _updatePageColorState() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.PageColor, this.option(\"pageColor\"))\r\n    }\r\n    _updateShapeTexts() {\r\n        var {\r\n            DiagramLocalizationService: DiagramLocalizationService\r\n        } = getDiagram();\r\n        var texts = this._getShapeTexts();\r\n        if (this._shapeTexts !== texts) {\r\n            this._shapeTexts = texts;\r\n            DiagramLocalizationService.shapeTexts = texts\r\n        }\r\n    }\r\n    _getShapeTexts() {\r\n        var {\r\n            ShapeTypes: ShapeTypes\r\n        } = getDiagram();\r\n        var texts = {};\r\n        texts[ShapeTypes.Text] = messageLocalization.format(\"dxDiagram-shapeText\");\r\n        texts[ShapeTypes.Rectangle] = messageLocalization.format(\"dxDiagram-shapeRectangle\");\r\n        texts[ShapeTypes.Ellipse] = messageLocalization.format(\"dxDiagram-shapeEllipse\");\r\n        texts[ShapeTypes.Cross] = messageLocalization.format(\"dxDiagram-shapeCross\");\r\n        texts[ShapeTypes.Triangle] = messageLocalization.format(\"dxDiagram-shapeTriangle\");\r\n        texts[ShapeTypes.Diamond] = messageLocalization.format(\"dxDiagram-shapeDiamond\");\r\n        texts[ShapeTypes.Heart] = messageLocalization.format(\"dxDiagram-shapeHeart\");\r\n        texts[ShapeTypes.Pentagon] = messageLocalization.format(\"dxDiagram-shapePentagon\");\r\n        texts[ShapeTypes.Hexagon] = messageLocalization.format(\"dxDiagram-shapeHexagon\");\r\n        texts[ShapeTypes.Octagon] = messageLocalization.format(\"dxDiagram-shapeOctagon\");\r\n        texts[ShapeTypes.Star] = messageLocalization.format(\"dxDiagram-shapeStar\");\r\n        texts[ShapeTypes.ArrowLeft] = messageLocalization.format(\"dxDiagram-shapeArrowLeft\");\r\n        texts[ShapeTypes.ArrowUp] = messageLocalization.format(\"dxDiagram-shapeArrowUp\");\r\n        texts[ShapeTypes.ArrowRight] = messageLocalization.format(\"dxDiagram-shapeArrowRight\");\r\n        texts[ShapeTypes.ArrowDown] = messageLocalization.format(\"dxDiagram-shapeArrowDown\");\r\n        texts[ShapeTypes.ArrowUpDown] = messageLocalization.format(\"dxDiagram-shapeArrowUpDown\");\r\n        texts[ShapeTypes.ArrowLeftRight] = messageLocalization.format(\"dxDiagram-shapeArrowLeftRight\");\r\n        texts[ShapeTypes.Process] = messageLocalization.format(\"dxDiagram-shapeProcess\");\r\n        texts[ShapeTypes.Decision] = messageLocalization.format(\"dxDiagram-shapeDecision\");\r\n        texts[ShapeTypes.Terminator] = messageLocalization.format(\"dxDiagram-shapeTerminator\");\r\n        texts[ShapeTypes.PredefinedProcess] = messageLocalization.format(\"dxDiagram-shapePredefinedProcess\");\r\n        texts[ShapeTypes.Document] = messageLocalization.format(\"dxDiagram-shapeDocument\");\r\n        texts[ShapeTypes.MultipleDocuments] = messageLocalization.format(\"dxDiagram-shapeMultipleDocuments\");\r\n        texts[ShapeTypes.ManualInput] = messageLocalization.format(\"dxDiagram-shapeManualInput\");\r\n        texts[ShapeTypes.Preparation] = messageLocalization.format(\"dxDiagram-shapePreparation\");\r\n        texts[ShapeTypes.Data] = messageLocalization.format(\"dxDiagram-shapeData\");\r\n        texts[ShapeTypes.Database] = messageLocalization.format(\"dxDiagram-shapeDatabase\");\r\n        texts[ShapeTypes.HardDisk] = messageLocalization.format(\"dxDiagram-shapeHardDisk\");\r\n        texts[ShapeTypes.InternalStorage] = messageLocalization.format(\"dxDiagram-shapeInternalStorage\");\r\n        texts[ShapeTypes.PaperTape] = messageLocalization.format(\"dxDiagram-shapePaperTape\");\r\n        texts[ShapeTypes.ManualOperation] = messageLocalization.format(\"dxDiagram-shapeManualOperation\");\r\n        texts[ShapeTypes.Delay] = messageLocalization.format(\"dxDiagram-shapeDelay\");\r\n        texts[ShapeTypes.StoredData] = messageLocalization.format(\"dxDiagram-shapeStoredData\");\r\n        texts[ShapeTypes.Display] = messageLocalization.format(\"dxDiagram-shapeDisplay\");\r\n        texts[ShapeTypes.Merge] = messageLocalization.format(\"dxDiagram-shapeMerge\");\r\n        texts[ShapeTypes.Connector] = messageLocalization.format(\"dxDiagram-shapeConnector\");\r\n        texts[ShapeTypes.Or] = messageLocalization.format(\"dxDiagram-shapeOr\");\r\n        texts[ShapeTypes.SummingJunction] = messageLocalization.format(\"dxDiagram-shapeSummingJunction\");\r\n        texts[ShapeTypes.Container] = messageLocalization.format(\"dxDiagram-shapeContainerDefaultText\");\r\n        texts[ShapeTypes.VerticalContainer] = messageLocalization.format(\"dxDiagram-shapeVerticalContainer\");\r\n        texts[ShapeTypes.HorizontalContainer] = messageLocalization.format(\"dxDiagram-shapeHorizontalContainer\");\r\n        texts[ShapeTypes.Card] = messageLocalization.format(\"dxDiagram-shapeCardDefaultText\");\r\n        texts[ShapeTypes.CardWithImageOnLeft] = messageLocalization.format(\"dxDiagram-shapeCardWithImageOnLeft\");\r\n        texts[ShapeTypes.CardWithImageOnTop] = messageLocalization.format(\"dxDiagram-shapeCardWithImageOnTop\");\r\n        texts[ShapeTypes.CardWithImageOnRight] = messageLocalization.format(\"dxDiagram-shapeCardWithImageOnRight\");\r\n        return texts\r\n    }\r\n    _updateEventSubscriptionMethods() {\r\n        var {\r\n            RenderHelper: RenderHelper\r\n        } = getDiagram();\r\n        RenderHelper.addEventListener = (element, eventName, handler) => {\r\n            eventsEngine.on(element, eventName, handler)\r\n        };\r\n        RenderHelper.removeEventListener = (element, eventName, handler) => {\r\n            eventsEngine.off(element, eventName, handler)\r\n        }\r\n    }\r\n    _updateDefaultItemProperties() {\r\n        if (this.option(\"defaultItemProperties.style\")) {\r\n            this._diagramInstance.setInitialStyleProperties(this.option(\"defaultItemProperties.style\"))\r\n        }\r\n        if (this.option(\"defaultItemProperties.textStyle\")) {\r\n            this._diagramInstance.setInitialTextStyleProperties(this.option(\"defaultItemProperties.textStyle\"))\r\n        }\r\n        this._diagramInstance.setInitialConnectorProperties({\r\n            lineOption: this._getConnectorLineOption(this.option(\"defaultItemProperties.connectorLineType\")),\r\n            startLineEnding: this._getConnectorLineEnding(this.option(\"defaultItemProperties.connectorLineStart\")),\r\n            endLineEnding: this._getConnectorLineEnding(this.option(\"defaultItemProperties.connectorLineEnd\"))\r\n        });\r\n        this._diagramInstance.applyShapeSizeSettings({\r\n            shapeMinWidth: this.option(\"defaultItemProperties.shapeMinWidth\"),\r\n            shapeMaxWidth: this.option(\"defaultItemProperties.shapeMaxWidth\"),\r\n            shapeMinHeight: this.option(\"defaultItemProperties.shapeMinHeight\"),\r\n            shapeMaxHeight: this.option(\"defaultItemProperties.shapeMaxHeight\")\r\n        })\r\n    }\r\n    _updateEditingSettings() {\r\n        this._diagramInstance.applyOperationSettings({\r\n            addShape: this.option(\"editing.allowAddShape\"),\r\n            addShapeFromToolbox: this.option(\"editing.allowAddShape\"),\r\n            deleteShape: this.option(\"editing.allowDeleteShape\"),\r\n            deleteConnector: this.option(\"editing.allowDeleteConnector\"),\r\n            changeConnection: this.option(\"editing.allowChangeConnection\"),\r\n            changeConnectorPoints: this.option(\"editing.allowChangeConnectorPoints\"),\r\n            changeShapeText: this.option(\"editing.allowChangeShapeText\"),\r\n            changeConnectorText: this.option(\"editing.allowChangeConnectorText\"),\r\n            resizeShape: this.option(\"editing.allowResizeShape\"),\r\n            moveShape: this.option(\"editing.allowMoveShape\")\r\n        })\r\n    }\r\n    fitToContent() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.FitToScreen)\r\n    }\r\n    fitToWidth() {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        this._executeDiagramCommand(DiagramCommand.FitToWidth)\r\n    }\r\n    focus() {\r\n        this._captureFocus()\r\n    }\r\n    export () {\r\n        return this._getDiagramData()\r\n    }\r\n    exportTo(format, callback) {\r\n        var command = this._getDiagramExportToCommand(format);\r\n        this._executeDiagramCommand(command, callback)\r\n    }\r\n    _getDiagramExportToCommand(format) {\r\n        var {\r\n            DiagramCommand: DiagramCommand\r\n        } = getDiagram();\r\n        switch (format) {\r\n            case \"png\":\r\n                return DiagramCommand.ExportPng;\r\n            case \"jpg\":\r\n                return DiagramCommand.ExportJpg;\r\n            default:\r\n                return DiagramCommand.ExportSvg\r\n        }\r\n    }\r\n    import(data, updateExistingItemsOnly) {\r\n        this._setDiagramData(data, updateExistingItemsOnly);\r\n        this._raiseDataChangeAction()\r\n    }\r\n    updateToolbox() {\r\n        this._diagramInstance && this._diagramInstance.refreshToolbox();\r\n        if (this._toolbox) {\r\n            this._toolbox.updateTooltips();\r\n            this._toolbox.updateFilter();\r\n            this._toolbox.updateMaxHeight()\r\n        }\r\n    }\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            readOnly: false,\r\n            zoomLevel: DIAGRAM_DEFAULT_ZOOMLEVEL,\r\n            simpleView: false,\r\n            autoZoomMode: DIAGRAM_DEFAULT_AUTOZOOM_MODE,\r\n            fullScreen: false,\r\n            showGrid: true,\r\n            snapToGrid: true,\r\n            units: DIAGRAM_DEFAULT_UNIT,\r\n            viewUnits: DIAGRAM_DEFAULT_UNIT,\r\n            pageOrientation: DIAGRAM_DEFAULT_PAGE_ORIENTATION,\r\n            pageColor: DIAGRAM_DEFAULT_PAGE_COLOR,\r\n            hasChanges: false,\r\n            nodes: {\r\n                dataSource: null,\r\n                keyExpr: \"id\",\r\n                customDataExpr: void 0,\r\n                lockedExpr: void 0,\r\n                styleExpr: void 0,\r\n                textStyleExpr: void 0,\r\n                zIndexExpr: void 0,\r\n                typeExpr: \"type\",\r\n                textExpr: \"text\",\r\n                imageUrlExpr: void 0,\r\n                parentKeyExpr: void 0,\r\n                itemsExpr: void 0,\r\n                leftExpr: void 0,\r\n                topExpr: void 0,\r\n                widthExpr: void 0,\r\n                heightExpr: void 0,\r\n                containerKeyExpr: \"containerKey\",\r\n                containerChildrenExpr: void 0,\r\n                autoLayout: \"auto\",\r\n                autoSizeEnabled: true\r\n            },\r\n            edges: {\r\n                dataSource: null,\r\n                keyExpr: \"id\",\r\n                customDataExpr: void 0,\r\n                lockedExpr: void 0,\r\n                styleExpr: void 0,\r\n                textStyleExpr: void 0,\r\n                zIndexExpr: void 0,\r\n                fromExpr: \"from\",\r\n                fromPointIndexExpr: void 0,\r\n                toExpr: \"to\",\r\n                toPointIndexExpr: void 0,\r\n                pointsExpr: void 0,\r\n                textExpr: void 0,\r\n                lineTypeExpr: void 0,\r\n                fromLineEndExpr: void 0,\r\n                toLineEndExpr: void 0\r\n            },\r\n            customShapes: [],\r\n            toolbox: {\r\n                visibility: \"auto\",\r\n                shapeIconsPerRow: DIAGRAM_TOOLBOX_SHAPES_PER_ROW,\r\n                showSearch: true\r\n            },\r\n            mainToolbar: {\r\n                visible: false\r\n            },\r\n            historyToolbar: {\r\n                visible: true\r\n            },\r\n            viewToolbar: {\r\n                visible: true\r\n            },\r\n            contextMenu: {\r\n                enabled: true\r\n            },\r\n            contextToolbox: {\r\n                enabled: true,\r\n                shapeIconsPerRow: DIAGRAM_CONTEXT_TOOLBOX_SHAPES_PER_ROW,\r\n                width: DIAGRAM_CONTEXT_TOOLBOX_DEFAULT_WIDTH\r\n            },\r\n            propertiesPanel: {\r\n                visibility: \"auto\"\r\n            },\r\n            defaultItemProperties: {\r\n                connectorLineType: \"orthogonal\",\r\n                connectorLineStart: \"none\",\r\n                connectorLineEnd: \"arrow\"\r\n            },\r\n            editing: {\r\n                allowAddShape: true,\r\n                allowDeleteShape: true,\r\n                allowDeleteConnector: true,\r\n                allowChangeConnection: true,\r\n                allowChangeConnectorPoints: true,\r\n                allowChangeShapeText: true,\r\n                allowChangeConnectorText: true,\r\n                allowResizeShape: true,\r\n                allowMoveShape: true\r\n            },\r\n            export: {\r\n                fileName: \"Diagram\",\r\n                proxyUrl: void 0\r\n            },\r\n            onItemClick: null,\r\n            onItemDblClick: null,\r\n            onSelectionChanged: null,\r\n            onRequestEditOperation: null,\r\n            onRequestLayoutUpdate: null\r\n        })\r\n    }\r\n    _raiseDataChangeAction() {\r\n        if (this._initialized) {\r\n            this.option(\"hasChanges\", true)\r\n        }\r\n    }\r\n    _raiseEdgeInsertedAction(data, callback, errorCallback) {\r\n        if (this._edgesOption) {\r\n            this._edgesOption.insert(data, callback, errorCallback)\r\n        }\r\n    }\r\n    _raiseEdgeUpdatedAction(key, data, callback, errorCallback) {\r\n        if (this._edgesOption) {\r\n            this._edgesOption.update(key, data, callback, errorCallback)\r\n        }\r\n    }\r\n    _raiseEdgeRemovedAction(key, data, callback, errorCallback) {\r\n        if (this._edgesOption) {\r\n            this._edgesOption.remove(key, data, callback, errorCallback)\r\n        }\r\n    }\r\n    _raiseNodeInsertedAction(data, callback, errorCallback) {\r\n        if (this._nodesOption) {\r\n            this._nodesOption.insert(data, callback, errorCallback)\r\n        }\r\n    }\r\n    _raiseNodeUpdatedAction(key, data, callback, errorCallback) {\r\n        if (this._nodesOption) {\r\n            this._nodesOption.update(key, data, callback, errorCallback)\r\n        }\r\n    }\r\n    _raiseNodeRemovedAction(key, data, callback, errorCallback) {\r\n        if (this._nodesOption) {\r\n            this._nodesOption.remove(key, data, callback, errorCallback)\r\n        }\r\n    }\r\n    _raiseToolboxDragStart() {\r\n        if (this._toolbox && this.isMobileScreenSize()) {\r\n            this._toolbox.hide();\r\n            this._toolboxDragHidden = true\r\n        }\r\n    }\r\n    _raiseToolboxDragEnd() {\r\n        if (this._toolbox && this._toolboxDragHidden) {\r\n            this._toolbox.show();\r\n            delete this._toolboxDragHidden\r\n        }\r\n    }\r\n    _raiseTextInputStart() {\r\n        this._textInputStarted = true;\r\n        if (this._propertiesPanel) {\r\n            if (this.isMobileScreenSize() && this._propertiesPanel.isVisible()) {\r\n                this._propertiesPanel.hide();\r\n                this._propertiesPanelTextInputHidden = true\r\n            }\r\n        }\r\n        if (this._toolbox) {\r\n            if (this.isMobileScreenSize() && this._toolbox.isVisible()) {\r\n                this._toolbox.hide();\r\n                this._toolboxTextInputHidden = true\r\n            }\r\n        }\r\n    }\r\n    _raiseTextInputEnd() {\r\n        if (this._propertiesPanel) {\r\n            if (this._propertiesPanelTextInputHidden) {\r\n                this._propertiesPanel.show();\r\n                delete this._propertiesPanelTextInputHidden\r\n            }\r\n        }\r\n        if (this._toolbox) {\r\n            if (this._toolboxTextInputHidden) {\r\n                this._toolbox.show();\r\n                delete this._toolboxTextInputHidden\r\n            }\r\n        }\r\n        this._textInputStarted = false\r\n    }\r\n    _createItemClickAction() {\r\n        this._itemClickAction = this._createActionByOption(\"onItemClick\")\r\n    }\r\n    _createItemDblClickAction() {\r\n        this._itemDblClickAction = this._createActionByOption(\"onItemDblClick\")\r\n    }\r\n    _createSelectionChangedAction() {\r\n        this._selectionChangedAction = this._createActionByOption(\"onSelectionChanged\")\r\n    }\r\n    _createRequestEditOperationAction() {\r\n        this._requestEditOperationAction = this._createActionByOption(\"onRequestEditOperation\")\r\n    }\r\n    _createRequestLayoutUpdateAction() {\r\n        this._requestLayoutUpdateAction = this._createActionByOption(\"onRequestLayoutUpdate\")\r\n    }\r\n    _createCustomCommand() {\r\n        this._customCommandAction = this._createActionByOption(\"onCustomCommand\")\r\n    }\r\n    _raiseItemClickAction(nativeItem) {\r\n        if (!this._itemClickAction) {\r\n            this._createItemClickAction()\r\n        }\r\n        this._itemClickAction({\r\n            item: this._nativeItemToDiagramItem(nativeItem)\r\n        })\r\n    }\r\n    _raiseItemDblClickAction(nativeItem) {\r\n        if (!this._itemDblClickAction) {\r\n            this._createItemDblClickAction()\r\n        }\r\n        this._itemDblClickAction({\r\n            item: this._nativeItemToDiagramItem(nativeItem)\r\n        })\r\n    }\r\n    _raiseSelectionChanged(nativeItems) {\r\n        if (!this._selectionChangedAction) {\r\n            this._createSelectionChangedAction()\r\n        }\r\n        this._selectionChangedAction({\r\n            items: nativeItems.map(this._nativeItemToDiagramItem.bind(this))\r\n        })\r\n    }\r\n    _raiseRequestEditOperation(operation, args) {\r\n        if (!this._requestEditOperationAction) {\r\n            this._createRequestEditOperationAction()\r\n        }\r\n        var eventArgs = this._getRequestEditOperationEventArgs(operation, args);\r\n        this._requestEditOperationAction(eventArgs);\r\n        args.allowed = eventArgs.allowed\r\n    }\r\n    _getModelOperation(operation) {\r\n        var {\r\n            DiagramModelOperation: DiagramModelOperation\r\n        } = getDiagram();\r\n        switch (operation) {\r\n            case DiagramModelOperation.AddShape:\r\n                return \"addShape\";\r\n            case DiagramModelOperation.AddShapeFromToolbox:\r\n                return \"addShapeFromToolbox\";\r\n            case DiagramModelOperation.DeleteShape:\r\n                return \"deleteShape\";\r\n            case DiagramModelOperation.DeleteConnector:\r\n                return \"deleteConnector\";\r\n            case DiagramModelOperation.ChangeConnection:\r\n                return \"changeConnection\";\r\n            case DiagramModelOperation.ChangeConnectorPoints:\r\n                return \"changeConnectorPoints\";\r\n            case DiagramModelOperation.BeforeChangeShapeText:\r\n                return \"beforeChangeShapeText\";\r\n            case DiagramModelOperation.ChangeShapeText:\r\n                return \"changeShapeText\";\r\n            case DiagramModelOperation.BeforeChangeConnectorText:\r\n                return \"beforeChangeConnectorText\";\r\n            case DiagramModelOperation.ChangeConnectorText:\r\n                return \"changeConnectorText\";\r\n            case DiagramModelOperation.ResizeShape:\r\n                return \"resizeShape\";\r\n            case DiagramModelOperation.MoveShape:\r\n                return \"moveShape\"\r\n        }\r\n    }\r\n    _getRequestEditOperationEventArgs(operation, args) {\r\n        var {\r\n            DiagramModelOperation: DiagramModelOperation,\r\n            ConnectorPosition: ConnectorPosition\r\n        } = getDiagram();\r\n        var eventArgs = {\r\n            operation: this._getModelOperation(operation),\r\n            allowed: args.allowed,\r\n            updateUI: args.updateUI,\r\n            reason: args.updateUI ? \"checkUIElementAvailability\" : \"modelModification\"\r\n        };\r\n        switch (operation) {\r\n            case DiagramModelOperation.AddShape:\r\n                eventArgs.args = {\r\n                    shape: args.shape && this._nativeItemToDiagramItem(args.shape),\r\n                    position: args.position && {\r\n                        x: args.position.x,\r\n                        y: args.position.y\r\n                    }\r\n                };\r\n                break;\r\n            case DiagramModelOperation.AddShapeFromToolbox:\r\n                eventArgs.args = {\r\n                    shapeType: args.shapeType\r\n                };\r\n                break;\r\n            case DiagramModelOperation.DeleteShape:\r\n                eventArgs.args = {\r\n                    shape: args.shape && this._nativeItemToDiagramItem(args.shape)\r\n                };\r\n                break;\r\n            case DiagramModelOperation.DeleteConnector:\r\n                eventArgs.args = {\r\n                    connector: args.connector && this._nativeItemToDiagramItem(args.connector)\r\n                };\r\n                break;\r\n            case DiagramModelOperation.ChangeConnection:\r\n                eventArgs.args = {\r\n                    newShape: args.shape && this._nativeItemToDiagramItem(args.shape),\r\n                    oldShape: args.oldShape && this._nativeItemToDiagramItem(args.oldShape),\r\n                    connector: args.connector && this._nativeItemToDiagramItem(args.connector),\r\n                    connectionPointIndex: args.connectionPointIndex,\r\n                    connectorPosition: args.position === ConnectorPosition.Begin ? \"start\" : \"end\"\r\n                };\r\n                break;\r\n            case DiagramModelOperation.ChangeConnectorPoints:\r\n                eventArgs.args = {\r\n                    connector: args.connector && this._nativeItemToDiagramItem(args.connector),\r\n                    newPoints: args.points && args.points.map(pt => ({\r\n                        x: pt.x,\r\n                        y: pt.y\r\n                    })),\r\n                    oldPoints: args.oldPoints && args.oldPoints.map(pt => ({\r\n                        x: pt.x,\r\n                        y: pt.y\r\n                    }))\r\n                };\r\n                break;\r\n            case DiagramModelOperation.BeforeChangeShapeText:\r\n                eventArgs.args = {\r\n                    shape: args.shape && this._nativeItemToDiagramItem(args.shape)\r\n                };\r\n                break;\r\n            case DiagramModelOperation.ChangeShapeText:\r\n                eventArgs.args = {\r\n                    shape: args.shape && this._nativeItemToDiagramItem(args.shape),\r\n                    text: args.text\r\n                };\r\n                break;\r\n            case DiagramModelOperation.BeforeChangeConnectorText:\r\n                eventArgs.args = {\r\n                    connector: args.connector && this._nativeItemToDiagramItem(args.connector),\r\n                    index: args.index\r\n                };\r\n                break;\r\n            case DiagramModelOperation.ChangeConnectorText:\r\n                eventArgs.args = {\r\n                    connector: args.connector && this._nativeItemToDiagramItem(args.connector),\r\n                    index: args.index,\r\n                    text: args.text\r\n                };\r\n                break;\r\n            case DiagramModelOperation.ResizeShape:\r\n                eventArgs.args = {\r\n                    shape: args.shape && this._nativeItemToDiagramItem(args.shape),\r\n                    newSize: args.size && {\r\n                        width: args.size.width,\r\n                        height: args.size.height\r\n                    },\r\n                    oldSize: args.oldSize && {\r\n                        width: args.oldSize.width,\r\n                        height: args.oldSize.height\r\n                    }\r\n                };\r\n                break;\r\n            case DiagramModelOperation.MoveShape:\r\n                eventArgs.args = {\r\n                    shape: args.shape && this._nativeItemToDiagramItem(args.shape),\r\n                    newPosition: args.position && {\r\n                        x: args.position.x,\r\n                        y: args.position.y\r\n                    },\r\n                    oldPosition: args.oldPosition && {\r\n                        x: args.oldPosition.x,\r\n                        y: args.oldPosition.y\r\n                    }\r\n                }\r\n        }\r\n        return eventArgs\r\n    }\r\n    _nativeItemToDiagramItem(nativeItem) {\r\n        var {\r\n            NativeShape: NativeShape\r\n        } = getDiagram();\r\n        var createMethod = nativeItem instanceof NativeShape ? this._nativeShapeToDiagramShape.bind(this) : this._nativeConnectorToDiagramConnector.bind(this);\r\n        return extend({\r\n            id: nativeItem.id,\r\n            key: nativeItem.key,\r\n            dataItem: void 0\r\n        }, createMethod(nativeItem))\r\n    }\r\n    _nativeShapeToDiagramShape(nativeShape) {\r\n        return {\r\n            dataItem: this._nodesOption && this._nodesOption.findItem(nativeShape.key),\r\n            itemType: \"shape\",\r\n            text: nativeShape.text,\r\n            type: nativeShape.type,\r\n            position: {\r\n                x: nativeShape.position.x,\r\n                y: nativeShape.position.y\r\n            },\r\n            size: {\r\n                width: nativeShape.size.width,\r\n                height: nativeShape.size.height\r\n            },\r\n            attachedConnectorIds: nativeShape.attachedConnectorIds,\r\n            containerId: nativeShape.containerId,\r\n            containerChildItemIds: nativeShape.containerChildItemIds,\r\n            containerExpanded: nativeShape.containerExpanded\r\n        }\r\n    }\r\n    _nativeConnectorToDiagramConnector(nativeConnector) {\r\n        return {\r\n            dataItem: this._edgesOption && this._edgesOption.findItem(nativeConnector.key),\r\n            itemType: \"connector\",\r\n            texts: nativeConnector.texts,\r\n            fromKey: nativeConnector.fromKey,\r\n            toKey: nativeConnector.toKey,\r\n            fromId: nativeConnector.fromId,\r\n            fromPointIndex: nativeConnector.fromPointIndex,\r\n            toId: nativeConnector.toId,\r\n            toPointIndex: nativeConnector.toPointIndex,\r\n            points: nativeConnector.points.map(pt => ({\r\n                x: pt.x,\r\n                y: pt.y\r\n            }))\r\n        }\r\n    }\r\n    getItemByKey(key) {\r\n        var nativeItem = this._diagramInstance && this._diagramInstance.getNativeItemByDataKey(key);\r\n        return nativeItem && this._nativeItemToDiagramItem(nativeItem)\r\n    }\r\n    getItemById(id) {\r\n        var nativeItem = this._diagramInstance && this._diagramInstance.getNativeItemByKey(id);\r\n        return nativeItem && this._nativeItemToDiagramItem(nativeItem)\r\n    }\r\n    getItems() {\r\n        return this._diagramInstance.getNativeItems().map(nativeItem => nativeItem && this._nativeItemToDiagramItem(nativeItem))\r\n    }\r\n    getSelectedItems() {\r\n        return this._diagramInstance.getNativeSelectedItems().map(nativeItem => nativeItem && this._nativeItemToDiagramItem(nativeItem))\r\n    }\r\n    setSelectedItems(items) {\r\n        return this._diagramInstance.setSelectedItems(items.map(item => item.id))\r\n    }\r\n    scrollToItem(item) {\r\n        return this._diagramInstance.scrollToItems([item.id])\r\n    }\r\n    _invalidateContextMenuCommands() {\r\n        if (this._contextMenu) {\r\n            this._contextMenu.option({\r\n                commands: this.option(\"contextMenu.commands\")\r\n            })\r\n        }\r\n    }\r\n    _invalidateMainToolbarCommands() {\r\n        if (this._mainToolbar) {\r\n            this._mainToolbar.option({\r\n                commands: this.option(\"mainToolbar.commands\")\r\n            })\r\n        }\r\n    }\r\n    _invalidateHistoryToolbarCommands() {\r\n        if (this._historyToolbar) {\r\n            this._historyToolbar.option({\r\n                commands: this.option(\"historyToolbar.commands\")\r\n            })\r\n        }\r\n    }\r\n    _invalidateViewToolbarCommands() {\r\n        if (this._viewToolbar) {\r\n            this._viewToolbar.option({\r\n                commands: this.option(\"viewToolbar.commands\")\r\n            })\r\n        }\r\n    }\r\n    _invalidateToolboxGroups() {\r\n        if (this._toolbox) {\r\n            this._toolbox.option({\r\n                toolboxGroups: this._getToolboxGroups()\r\n            })\r\n        }\r\n    }\r\n    _optionChanged(args) {\r\n        if (!this.optionsUpdateBar || this.optionsUpdateBar.isUpdateLocked()) {\r\n            return\r\n        }\r\n        this.optionsUpdateBar.beginUpdate();\r\n        try {\r\n            this._optionChangedCore(args)\r\n        } finally {\r\n            this.optionsUpdateBar.endUpdate()\r\n        }\r\n    }\r\n    _optionChangedCore(args) {\r\n        switch (args.name) {\r\n            case \"readOnly\":\r\n            case \"disabled\":\r\n                this._updateReadOnlyState();\r\n                this._invalidate();\r\n                break;\r\n            case \"zoomLevel\":\r\n                if (\"zoomLevel\" === args.fullName || \"zoomLevel.items\" === args.fullName || \"zoomLevel.value\" === args.fullName) {\r\n                    this._updateZoomLevelState()\r\n                }\r\n                break;\r\n            case \"autoZoomMode\":\r\n                this._updateAutoZoomState();\r\n                break;\r\n            case \"simpleView\":\r\n                this._updateSimpleViewState();\r\n                break;\r\n            case \"useNativeScrolling\":\r\n                this._invalidate();\r\n                break;\r\n            case \"fullScreen\":\r\n                this._updateFullscreenState();\r\n                break;\r\n            case \"showGrid\":\r\n                this._updateShowGridState();\r\n                break;\r\n            case \"snapToGrid\":\r\n                this._updateSnapToGridState();\r\n                break;\r\n            case \"gridSize\":\r\n                if (\"gridSize\" === args.fullName || \"gridSize.items\" === args.fullName || \"gridSize.value\" === args.fullName) {\r\n                    this._updateGridSizeState()\r\n                }\r\n                break;\r\n            case \"viewUnits\":\r\n                this._updateViewUnitsState();\r\n                break;\r\n            case \"units\":\r\n                this._updateUnitsState();\r\n                break;\r\n            case \"pageSize\":\r\n                if (\"pageSize\" === args.fullName || \"pageSize.items\" === args.fullName) {\r\n                    this._updatePageSizeItemsState()\r\n                }\r\n                if (\"pageSize\" === args.fullName || \"pageSize.width\" === args.fullName || \"pageSize.height\" === args.fullName) {\r\n                    this._updatePageSizeState()\r\n                }\r\n                break;\r\n            case \"pageOrientation\":\r\n                this._updatePageOrientationState();\r\n                break;\r\n            case \"pageColor\":\r\n                this._updatePageColorState();\r\n                break;\r\n            case \"nodes\":\r\n                if (0 === args.fullName.indexOf(\"nodes.autoLayout\")) {\r\n                    this._refreshDataSources()\r\n                } else {\r\n                    this._refreshNodesDataSource()\r\n                }\r\n                break;\r\n            case \"edges\":\r\n                this._refreshEdgesDataSource();\r\n                break;\r\n            case \"customShapes\":\r\n                if (args.fullName !== args.name) {\r\n                    this._updateAllCustomShapes()\r\n                } else {\r\n                    this._updateCustomShapes(args.value, args.previousValue)\r\n                }\r\n                this._invalidate();\r\n                break;\r\n            case \"contextMenu\":\r\n                if (\"contextMenu.commands\" === args.fullName) {\r\n                    this._invalidateContextMenuCommands()\r\n                } else {\r\n                    this._invalidate()\r\n                }\r\n                break;\r\n            case \"contextToolbox\":\r\n            case \"propertiesPanel\":\r\n                this._invalidate();\r\n                break;\r\n            case \"toolbox\":\r\n                if (\"toolbox.groups\" === args.fullName) {\r\n                    this._invalidateToolboxGroups()\r\n                } else {\r\n                    this._invalidate()\r\n                }\r\n                break;\r\n            case \"mainToolbar\":\r\n                if (\"mainToolbar.commands\" === args.fullName) {\r\n                    this._invalidateMainToolbarCommands()\r\n                } else {\r\n                    this._invalidate()\r\n                }\r\n                break;\r\n            case \"historyToolbar\":\r\n                if (\"historyToolbar.commands\" === args.fullName) {\r\n                    this._invalidateHistoryToolbarCommands()\r\n                } else {\r\n                    this._invalidate()\r\n                }\r\n                break;\r\n            case \"viewToolbar\":\r\n                if (\"viewToolbar.commands\" === args.fullName) {\r\n                    this._invalidateViewToolbarCommands()\r\n                } else {\r\n                    this._invalidate()\r\n                }\r\n                break;\r\n            case \"onItemClick\":\r\n                this._createItemClickAction();\r\n                break;\r\n            case \"onItemDblClick\":\r\n                this._createItemDblClickAction();\r\n                break;\r\n            case \"onSelectionChanged\":\r\n                this._createSelectionChangedAction();\r\n                break;\r\n            case \"onRequestEditOperation\":\r\n                this._createRequestEditOperationAction();\r\n                break;\r\n            case \"onRequestLayoutUpdate\":\r\n                this._createRequestLayoutUpdateAction();\r\n                break;\r\n            case \"onCustomCommand\":\r\n                this._createCustomCommand();\r\n                break;\r\n            case \"defaultItemProperties\":\r\n                this._updateDefaultItemProperties();\r\n                break;\r\n            case \"editing\":\r\n                this._updateEditingSettings();\r\n                break;\r\n            case \"export\":\r\n                this._toolbars.forEach(toolbar => {\r\n                    toolbar.option(\"export\", this.option(\"export\"))\r\n                });\r\n                if (this._contextMenu) {\r\n                    this._contextMenu.option(\"export\", this.option(\"export\"))\r\n                }\r\n                break;\r\n            case \"hasChanges\":\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n}\r\nregisterComponent(\"dxDiagram\", Diagram);\r\nexport default Diagram;\r\n"]},"metadata":{},"sourceType":"module"}