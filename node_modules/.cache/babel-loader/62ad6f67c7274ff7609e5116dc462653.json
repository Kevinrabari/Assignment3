{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/pivot_grid/ui.pivot_grid.export.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport Class from \"../../core/class\";\nimport { isDefined } from \"../../core/utils/type\";\nimport { extend } from \"../../core/utils/extend\";\nimport { each } from \"../../core/utils/iterator\";\nimport { hasWindow } from \"../../core/utils/window\";\nimport { getDefaultAlignment } from \"../../core/utils/position\";\nimport formatHelper from \"../../format_helper\";\nimport localizationNumber from \"../../localization/number\";\nimport { excel as excelExporter, export as exportMethod } from \"../../exporter\";\nimport { prepareItems } from \"../grid_core/ui.grid_core.export\";\nimport { when, Deferred } from \"../../core/utils/deferred\";\nvar DEFAULT_DATA_TYPE = \"string\";\nvar DEFAUL_COLUMN_WIDTH = 100;\nexport var ExportController = {\n  exportToExcel: function () {\n    exportMethod(this.getDataProvider(), {\n      fileName: this.option(\"export.fileName\"),\n      proxyUrl: this.option(\"export.proxyUrl\"),\n      format: \"EXCEL\",\n      rtlEnabled: this.option(\"rtlEnabled\"),\n      ignoreErrors: this.option(\"export.ignoreExcelErrors\"),\n      exportingAction: this._actions.onExporting,\n      exportedAction: this._actions.onExported,\n      fileSavingAction: this._actions.onFileSaving\n    }, excelExporter.getData);\n  },\n  _getLength: function (items) {\n    var i;\n    var itemCount = items[0].length;\n    var cellCount = 0;\n\n    for (i = 0; i < itemCount; i++) {\n      cellCount += items[0][i].colspan || 1;\n    }\n\n    return cellCount;\n  },\n  _correctCellsInfoItemLengths: function (cellsInfo, expectedLength) {\n    for (var i = 0; i < cellsInfo.length; i++) {\n      while (cellsInfo[i].length < expectedLength) {\n        cellsInfo[i].push({});\n      }\n    }\n\n    return cellsInfo;\n  },\n  _calculateCellInfoItemLength: function (columnsRow) {\n    var result = 0;\n\n    for (var columnIndex = 0; columnIndex < columnsRow.length; columnIndex++) {\n      result += isDefined(columnsRow[columnIndex].colspan) ? columnsRow[columnIndex].colspan : 1;\n    }\n\n    return result;\n  },\n  _getEmptyCell: function () {\n    return {\n      text: \"\",\n      value: void 0,\n      colspan: 1,\n      rowspan: 1\n    };\n  },\n  _getAllItems: function (columnsInfo, rowsInfoItems, cellsInfo) {\n    var cellIndex;\n    var rowIndex;\n    var correctedCellsInfo = cellsInfo;\n\n    var rowsLength = this._getLength(rowsInfoItems);\n\n    var headerRowsCount = columnsInfo.length;\n\n    if (columnsInfo.length > 0 && columnsInfo[0].length > 0 && cellsInfo.length > 0 && 0 === cellsInfo[0].length) {\n      var cellInfoItemLength = this._calculateCellInfoItemLength(columnsInfo[0]);\n\n      if (cellInfoItemLength > 0) {\n        correctedCellsInfo = this._correctCellsInfoItemLengths(cellsInfo, cellInfoItemLength);\n      }\n    }\n\n    var sourceItems = columnsInfo.concat(correctedCellsInfo);\n\n    for (rowIndex = 0; rowIndex < rowsInfoItems.length; rowIndex++) {\n      for (cellIndex = rowsInfoItems[rowIndex].length - 1; cellIndex >= 0; cellIndex--) {\n        if (!isDefined(sourceItems[rowIndex + headerRowsCount])) {\n          sourceItems[rowIndex + headerRowsCount] = [];\n        }\n\n        sourceItems[rowIndex + headerRowsCount].splice(0, 0, extend({}, rowsInfoItems[rowIndex][cellIndex]));\n      }\n    }\n\n    sourceItems[0].splice(0, 0, extend({}, this._getEmptyCell(), {\n      alignment: getDefaultAlignment(this._options.rtlEnabled),\n      colspan: rowsLength,\n      rowspan: headerRowsCount\n    }));\n    return prepareItems(sourceItems, this._getEmptyCell());\n  },\n  getDataProvider: function () {\n    return new DataProvider(this);\n  }\n};\nexport var DataProvider = Class.inherit({\n  ctor: function (exportController) {\n    this._exportController = exportController;\n  },\n  ready: function () {\n    this._initOptions();\n\n    var options = this._options;\n    return when(options.items).done(items => {\n      var headerSize = items[0][0].rowspan;\n      var columns = items[headerSize - 1];\n      each(columns, (columnIndex, column) => {\n        column.width = DEFAUL_COLUMN_WIDTH;\n      });\n      options.columns = columns;\n      options.items = items;\n    });\n  },\n  _initOptions: function () {\n    var exportController = this._exportController;\n    var dataController = exportController._dataController;\n    var items = new Deferred();\n    dataController.beginLoading();\n    setTimeout(function () {\n      var columnsInfo = extend(true, [], dataController.getColumnsInfo(true));\n      var rowsInfoItems = extend(true, [], dataController.getRowsInfo(true));\n      var cellsInfo = dataController.getCellsInfo(true);\n      items.resolve(exportController._getAllItems(columnsInfo, rowsInfoItems, cellsInfo));\n      dataController.endLoading();\n    });\n    this._options = {\n      items: items,\n      rtlEnabled: exportController.option(\"rtlEnabled\"),\n      dataFields: exportController.getDataSource().getAreaFields(\"data\"),\n      customizeExcelCell: exportController.option(\"export.customizeExcelCell\"),\n      rowsArea: exportController._rowsArea,\n      columnsArea: exportController._columnsArea\n    };\n  },\n  getColumns: function () {\n    return this._options.columns;\n  },\n  getColumnsWidths: function () {\n    var colsArea = this._options.columnsArea;\n    var rowsArea = this._options.rowsArea;\n    var columns = this._options.columns;\n    var useDefaultWidth = !hasWindow() || \"virtual\" === colsArea.option(\"scrolling.mode\") || colsArea.element().is(\":hidden\");\n    return useDefaultWidth ? columns.map(_ => DEFAUL_COLUMN_WIDTH) : rowsArea.getColumnsWidth().concat(colsArea.getColumnsWidth());\n  },\n  getRowsCount: function () {\n    return this._options.items.length;\n  },\n  getGroupLevel: function () {\n    return 0;\n  },\n  getCellMerging: function (rowIndex, cellIndex) {\n    var items = this._options.items;\n    var item = items[rowIndex] && items[rowIndex][cellIndex];\n    return item ? {\n      colspan: item.colspan - 1,\n      rowspan: item.rowspan - 1\n    } : {\n      colspan: 0,\n      rowspan: 0\n    };\n  },\n  getFrozenArea: function () {\n    return {\n      x: this.getRowAreaColCount(),\n      y: this.getColumnAreaRowCount()\n    };\n  },\n  getCellType: function (rowIndex, cellIndex) {\n    var style = this.getStyles()[this.getStyleId(rowIndex, cellIndex)];\n    return style && style.dataType || \"string\";\n  },\n  getCellData: function (rowIndex, cellIndex, isExcelJS) {\n    var result = {};\n    var items = this._options.items;\n    var item = items[rowIndex] && items[rowIndex][cellIndex] || {};\n\n    if (isExcelJS) {\n      result.cellSourceData = item;\n\n      var areaName = this._tryGetAreaName(item, rowIndex, cellIndex);\n\n      if (areaName) {\n        result.cellSourceData.area = areaName;\n      }\n\n      result.cellSourceData.rowIndex = rowIndex;\n      result.cellSourceData.columnIndex = cellIndex;\n    }\n\n    if (\"string\" === this.getCellType(rowIndex, cellIndex)) {\n      result.value = item.text;\n    } else {\n      result.value = item.value;\n    }\n\n    if (result.cellSourceData && result.cellSourceData.isWhiteSpace) {\n      result.value = \"\";\n    }\n\n    return result;\n  },\n\n  _tryGetAreaName(item, rowIndex, cellIndex) {\n    if (this.isColumnAreaCell(rowIndex, cellIndex)) {\n      return \"column\";\n    } else if (this.isRowAreaCell(rowIndex, cellIndex)) {\n      return \"row\";\n    } else if (isDefined(item.dataIndex)) {\n      return \"data\";\n    }\n  },\n\n  isRowAreaCell(rowIndex, cellIndex) {\n    return rowIndex >= this.getColumnAreaRowCount() && cellIndex < this.getRowAreaColCount();\n  },\n\n  isColumnAreaCell(rowIndex, cellIndex) {\n    return cellIndex >= this.getRowAreaColCount() && rowIndex < this.getColumnAreaRowCount();\n  },\n\n  getColumnAreaRowCount() {\n    return this._options.items[0][0].rowspan;\n  },\n\n  getRowAreaColCount() {\n    return this._options.items[0][0].colspan;\n  },\n\n  getHeaderStyles() {\n    return [{\n      alignment: \"center\",\n      dataType: \"string\"\n    }, {\n      alignment: getDefaultAlignment(this._options.rtlEnabled),\n      dataType: \"string\"\n    }];\n  },\n\n  getDataFieldStyles() {\n    var dataFields = this._options.dataFields;\n    var dataItemStyle = {\n      alignment: this._options.rtlEnabled ? \"left\" : \"right\"\n    };\n    var dataFieldStyles = [];\n\n    if (dataFields.length) {\n      dataFields.forEach(dataField => {\n        dataFieldStyles.push(_extends({}, dataItemStyle, {\n          format: dataField.format,\n          dataType: this.getCellDataType(dataField)\n        }));\n      });\n      return dataFieldStyles;\n    }\n\n    return [dataItemStyle];\n  },\n\n  getStyles: function () {\n    if (this._styles) {\n      return this._styles;\n    }\n\n    this._styles = [...this.getHeaderStyles(), ...this.getDataFieldStyles()];\n    return this._styles;\n  },\n  getCellDataType: function (field) {\n    if (field && field.customizeText) {\n      return \"string\";\n    }\n\n    if (field.dataType) {\n      return field.dataType;\n    }\n\n    if (field.format) {\n      if (1 === localizationNumber.parse(formatHelper.format(1, field.format))) {\n        return \"number\";\n      }\n\n      if (formatHelper.format(new Date(), field.format)) {\n        return \"date\";\n      }\n    }\n\n    return DEFAULT_DATA_TYPE;\n  },\n  getStyleId: function (rowIndex, cellIndex) {\n    var items = this._options.items;\n    var item = items[rowIndex] && items[rowIndex][cellIndex] || {};\n\n    if (0 === cellIndex && 0 === rowIndex || this.isColumnAreaCell(rowIndex, cellIndex)) {\n      return 0;\n    } else if (this.isRowAreaCell(rowIndex, cellIndex)) {\n      return 1;\n    }\n\n    return this.getHeaderStyles().length + (item.dataIndex || 0);\n  },\n  hasCustomizeExcelCell: function () {\n    return isDefined(this._options.customizeExcelCell);\n  },\n  customizeExcelCell: function (e) {\n    if (this._options.customizeExcelCell) {\n      this._options.customizeExcelCell(e);\n    }\n  }\n});","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devextreme/esm/ui/pivot_grid/ui.pivot_grid.export.js"],"names":["_extends","Class","isDefined","extend","each","hasWindow","getDefaultAlignment","formatHelper","localizationNumber","excel","excelExporter","export","exportMethod","prepareItems","when","Deferred","DEFAULT_DATA_TYPE","DEFAUL_COLUMN_WIDTH","ExportController","exportToExcel","getDataProvider","fileName","option","proxyUrl","format","rtlEnabled","ignoreErrors","exportingAction","_actions","onExporting","exportedAction","onExported","fileSavingAction","onFileSaving","getData","_getLength","items","i","itemCount","length","cellCount","colspan","_correctCellsInfoItemLengths","cellsInfo","expectedLength","push","_calculateCellInfoItemLength","columnsRow","result","columnIndex","_getEmptyCell","text","value","rowspan","_getAllItems","columnsInfo","rowsInfoItems","cellIndex","rowIndex","correctedCellsInfo","rowsLength","headerRowsCount","cellInfoItemLength","sourceItems","concat","splice","alignment","_options","DataProvider","inherit","ctor","exportController","_exportController","ready","_initOptions","options","done","headerSize","columns","column","width","dataController","_dataController","beginLoading","setTimeout","getColumnsInfo","getRowsInfo","getCellsInfo","resolve","endLoading","dataFields","getDataSource","getAreaFields","customizeExcelCell","rowsArea","_rowsArea","columnsArea","_columnsArea","getColumns","getColumnsWidths","colsArea","useDefaultWidth","element","is","map","_","getColumnsWidth","getRowsCount","getGroupLevel","getCellMerging","item","getFrozenArea","x","getRowAreaColCount","y","getColumnAreaRowCount","getCellType","style","getStyles","getStyleId","dataType","getCellData","isExcelJS","cellSourceData","areaName","_tryGetAreaName","area","isWhiteSpace","isColumnAreaCell","isRowAreaCell","dataIndex","getHeaderStyles","getDataFieldStyles","dataItemStyle","dataFieldStyles","forEach","dataField","getCellDataType","_styles","field","customizeText","parse","Date","hasCustomizeExcelCell","e"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/pivot_grid/ui.pivot_grid.export.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport Class from \"../../core/class\";\r\nimport {\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    hasWindow\r\n} from \"../../core/utils/window\";\r\nimport {\r\n    getDefaultAlignment\r\n} from \"../../core/utils/position\";\r\nimport formatHelper from \"../../format_helper\";\r\nimport localizationNumber from \"../../localization/number\";\r\nimport {\r\n    excel as excelExporter,\r\n    export as exportMethod\r\n} from \"../../exporter\";\r\nimport {\r\n    prepareItems\r\n} from \"../grid_core/ui.grid_core.export\";\r\nimport {\r\n    when,\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nvar DEFAULT_DATA_TYPE = \"string\";\r\nvar DEFAUL_COLUMN_WIDTH = 100;\r\nexport var ExportController = {\r\n    exportToExcel: function() {\r\n        exportMethod(this.getDataProvider(), {\r\n            fileName: this.option(\"export.fileName\"),\r\n            proxyUrl: this.option(\"export.proxyUrl\"),\r\n            format: \"EXCEL\",\r\n            rtlEnabled: this.option(\"rtlEnabled\"),\r\n            ignoreErrors: this.option(\"export.ignoreExcelErrors\"),\r\n            exportingAction: this._actions.onExporting,\r\n            exportedAction: this._actions.onExported,\r\n            fileSavingAction: this._actions.onFileSaving\r\n        }, excelExporter.getData)\r\n    },\r\n    _getLength: function(items) {\r\n        var i;\r\n        var itemCount = items[0].length;\r\n        var cellCount = 0;\r\n        for (i = 0; i < itemCount; i++) {\r\n            cellCount += items[0][i].colspan || 1\r\n        }\r\n        return cellCount\r\n    },\r\n    _correctCellsInfoItemLengths: function(cellsInfo, expectedLength) {\r\n        for (var i = 0; i < cellsInfo.length; i++) {\r\n            while (cellsInfo[i].length < expectedLength) {\r\n                cellsInfo[i].push({})\r\n            }\r\n        }\r\n        return cellsInfo\r\n    },\r\n    _calculateCellInfoItemLength: function(columnsRow) {\r\n        var result = 0;\r\n        for (var columnIndex = 0; columnIndex < columnsRow.length; columnIndex++) {\r\n            result += isDefined(columnsRow[columnIndex].colspan) ? columnsRow[columnIndex].colspan : 1\r\n        }\r\n        return result\r\n    },\r\n    _getEmptyCell: function() {\r\n        return {\r\n            text: \"\",\r\n            value: void 0,\r\n            colspan: 1,\r\n            rowspan: 1\r\n        }\r\n    },\r\n    _getAllItems: function(columnsInfo, rowsInfoItems, cellsInfo) {\r\n        var cellIndex;\r\n        var rowIndex;\r\n        var correctedCellsInfo = cellsInfo;\r\n        var rowsLength = this._getLength(rowsInfoItems);\r\n        var headerRowsCount = columnsInfo.length;\r\n        if (columnsInfo.length > 0 && columnsInfo[0].length > 0 && cellsInfo.length > 0 && 0 === cellsInfo[0].length) {\r\n            var cellInfoItemLength = this._calculateCellInfoItemLength(columnsInfo[0]);\r\n            if (cellInfoItemLength > 0) {\r\n                correctedCellsInfo = this._correctCellsInfoItemLengths(cellsInfo, cellInfoItemLength)\r\n            }\r\n        }\r\n        var sourceItems = columnsInfo.concat(correctedCellsInfo);\r\n        for (rowIndex = 0; rowIndex < rowsInfoItems.length; rowIndex++) {\r\n            for (cellIndex = rowsInfoItems[rowIndex].length - 1; cellIndex >= 0; cellIndex--) {\r\n                if (!isDefined(sourceItems[rowIndex + headerRowsCount])) {\r\n                    sourceItems[rowIndex + headerRowsCount] = []\r\n                }\r\n                sourceItems[rowIndex + headerRowsCount].splice(0, 0, extend({}, rowsInfoItems[rowIndex][cellIndex]))\r\n            }\r\n        }\r\n        sourceItems[0].splice(0, 0, extend({}, this._getEmptyCell(), {\r\n            alignment: getDefaultAlignment(this._options.rtlEnabled),\r\n            colspan: rowsLength,\r\n            rowspan: headerRowsCount\r\n        }));\r\n        return prepareItems(sourceItems, this._getEmptyCell())\r\n    },\r\n    getDataProvider: function() {\r\n        return new DataProvider(this)\r\n    }\r\n};\r\nexport var DataProvider = Class.inherit({\r\n    ctor: function(exportController) {\r\n        this._exportController = exportController\r\n    },\r\n    ready: function() {\r\n        this._initOptions();\r\n        var options = this._options;\r\n        return when(options.items).done(items => {\r\n            var headerSize = items[0][0].rowspan;\r\n            var columns = items[headerSize - 1];\r\n            each(columns, (columnIndex, column) => {\r\n                column.width = DEFAUL_COLUMN_WIDTH\r\n            });\r\n            options.columns = columns;\r\n            options.items = items\r\n        })\r\n    },\r\n    _initOptions: function() {\r\n        var exportController = this._exportController;\r\n        var dataController = exportController._dataController;\r\n        var items = new Deferred;\r\n        dataController.beginLoading();\r\n        setTimeout((function() {\r\n            var columnsInfo = extend(true, [], dataController.getColumnsInfo(true));\r\n            var rowsInfoItems = extend(true, [], dataController.getRowsInfo(true));\r\n            var cellsInfo = dataController.getCellsInfo(true);\r\n            items.resolve(exportController._getAllItems(columnsInfo, rowsInfoItems, cellsInfo));\r\n            dataController.endLoading()\r\n        }));\r\n        this._options = {\r\n            items: items,\r\n            rtlEnabled: exportController.option(\"rtlEnabled\"),\r\n            dataFields: exportController.getDataSource().getAreaFields(\"data\"),\r\n            customizeExcelCell: exportController.option(\"export.customizeExcelCell\"),\r\n            rowsArea: exportController._rowsArea,\r\n            columnsArea: exportController._columnsArea\r\n        }\r\n    },\r\n    getColumns: function() {\r\n        return this._options.columns\r\n    },\r\n    getColumnsWidths: function() {\r\n        var colsArea = this._options.columnsArea;\r\n        var rowsArea = this._options.rowsArea;\r\n        var columns = this._options.columns;\r\n        var useDefaultWidth = !hasWindow() || \"virtual\" === colsArea.option(\"scrolling.mode\") || colsArea.element().is(\":hidden\");\r\n        return useDefaultWidth ? columns.map(_ => DEFAUL_COLUMN_WIDTH) : rowsArea.getColumnsWidth().concat(colsArea.getColumnsWidth())\r\n    },\r\n    getRowsCount: function() {\r\n        return this._options.items.length\r\n    },\r\n    getGroupLevel: function() {\r\n        return 0\r\n    },\r\n    getCellMerging: function(rowIndex, cellIndex) {\r\n        var items = this._options.items;\r\n        var item = items[rowIndex] && items[rowIndex][cellIndex];\r\n        return item ? {\r\n            colspan: item.colspan - 1,\r\n            rowspan: item.rowspan - 1\r\n        } : {\r\n            colspan: 0,\r\n            rowspan: 0\r\n        }\r\n    },\r\n    getFrozenArea: function() {\r\n        return {\r\n            x: this.getRowAreaColCount(),\r\n            y: this.getColumnAreaRowCount()\r\n        }\r\n    },\r\n    getCellType: function(rowIndex, cellIndex) {\r\n        var style = this.getStyles()[this.getStyleId(rowIndex, cellIndex)];\r\n        return style && style.dataType || \"string\"\r\n    },\r\n    getCellData: function(rowIndex, cellIndex, isExcelJS) {\r\n        var result = {};\r\n        var items = this._options.items;\r\n        var item = items[rowIndex] && items[rowIndex][cellIndex] || {};\r\n        if (isExcelJS) {\r\n            result.cellSourceData = item;\r\n            var areaName = this._tryGetAreaName(item, rowIndex, cellIndex);\r\n            if (areaName) {\r\n                result.cellSourceData.area = areaName\r\n            }\r\n            result.cellSourceData.rowIndex = rowIndex;\r\n            result.cellSourceData.columnIndex = cellIndex\r\n        }\r\n        if (\"string\" === this.getCellType(rowIndex, cellIndex)) {\r\n            result.value = item.text\r\n        } else {\r\n            result.value = item.value\r\n        }\r\n        if (result.cellSourceData && result.cellSourceData.isWhiteSpace) {\r\n            result.value = \"\"\r\n        }\r\n        return result\r\n    },\r\n    _tryGetAreaName(item, rowIndex, cellIndex) {\r\n        if (this.isColumnAreaCell(rowIndex, cellIndex)) {\r\n            return \"column\"\r\n        } else if (this.isRowAreaCell(rowIndex, cellIndex)) {\r\n            return \"row\"\r\n        } else if (isDefined(item.dataIndex)) {\r\n            return \"data\"\r\n        }\r\n    },\r\n    isRowAreaCell(rowIndex, cellIndex) {\r\n        return rowIndex >= this.getColumnAreaRowCount() && cellIndex < this.getRowAreaColCount()\r\n    },\r\n    isColumnAreaCell(rowIndex, cellIndex) {\r\n        return cellIndex >= this.getRowAreaColCount() && rowIndex < this.getColumnAreaRowCount()\r\n    },\r\n    getColumnAreaRowCount() {\r\n        return this._options.items[0][0].rowspan\r\n    },\r\n    getRowAreaColCount() {\r\n        return this._options.items[0][0].colspan\r\n    },\r\n    getHeaderStyles() {\r\n        return [{\r\n            alignment: \"center\",\r\n            dataType: \"string\"\r\n        }, {\r\n            alignment: getDefaultAlignment(this._options.rtlEnabled),\r\n            dataType: \"string\"\r\n        }]\r\n    },\r\n    getDataFieldStyles() {\r\n        var dataFields = this._options.dataFields;\r\n        var dataItemStyle = {\r\n            alignment: this._options.rtlEnabled ? \"left\" : \"right\"\r\n        };\r\n        var dataFieldStyles = [];\r\n        if (dataFields.length) {\r\n            dataFields.forEach(dataField => {\r\n                dataFieldStyles.push(_extends({}, dataItemStyle, {\r\n                    format: dataField.format,\r\n                    dataType: this.getCellDataType(dataField)\r\n                }))\r\n            });\r\n            return dataFieldStyles\r\n        }\r\n        return [dataItemStyle]\r\n    },\r\n    getStyles: function() {\r\n        if (this._styles) {\r\n            return this._styles\r\n        }\r\n        this._styles = [...this.getHeaderStyles(), ...this.getDataFieldStyles()];\r\n        return this._styles\r\n    },\r\n    getCellDataType: function(field) {\r\n        if (field && field.customizeText) {\r\n            return \"string\"\r\n        }\r\n        if (field.dataType) {\r\n            return field.dataType\r\n        }\r\n        if (field.format) {\r\n            if (1 === localizationNumber.parse(formatHelper.format(1, field.format))) {\r\n                return \"number\"\r\n            }\r\n            if (formatHelper.format(new Date, field.format)) {\r\n                return \"date\"\r\n            }\r\n        }\r\n        return DEFAULT_DATA_TYPE\r\n    },\r\n    getStyleId: function(rowIndex, cellIndex) {\r\n        var items = this._options.items;\r\n        var item = items[rowIndex] && items[rowIndex][cellIndex] || {};\r\n        if (0 === cellIndex && 0 === rowIndex || this.isColumnAreaCell(rowIndex, cellIndex)) {\r\n            return 0\r\n        } else if (this.isRowAreaCell(rowIndex, cellIndex)) {\r\n            return 1\r\n        }\r\n        return this.getHeaderStyles().length + (item.dataIndex || 0)\r\n    },\r\n    hasCustomizeExcelCell: function() {\r\n        return isDefined(this._options.customizeExcelCell)\r\n    },\r\n    customizeExcelCell: function(e) {\r\n        if (this._options.customizeExcelCell) {\r\n            this._options.customizeExcelCell(e)\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}