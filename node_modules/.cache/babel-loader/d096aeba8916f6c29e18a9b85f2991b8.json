{"ast":null,"code":"/**\n* DevExpress Analytics (query-builder\\elements\\columnModel.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ColumnViewModel = void 0;\n\nvar ko = require(\"knockout\");\n\nvar queryElementModel_1 = require(\"./queryElementModel\");\n\nvar columnModelMeta_1 = require(\"./columnModelMeta\");\n\nvar dbColumn_1 = require(\"../dataSource/dbColumn\");\n\nvar utils_1 = require(\"../../diagram/utils\");\n\nvar _columnExpressionCollectionHelper_1 = require(\"../utils/_columnExpressionCollectionHelper\");\n\nvar _utils_1 = require(\"../../serializer/_utils\");\n\nvar ColumnViewModel = function (_super) {\n  __extends(ColumnViewModel, _super);\n\n  function ColumnViewModel(model, dbColumn, parent, serializer) {\n    var _this = _super.call(this, _utils_1.extend({\n      '@ControlType': 'Column'\n    }, model), parent, serializer) || this;\n\n    _this.isNotAvailable = ko.observable(false);\n    _this._type = ko.observable(dbColumn_1.DBColumnType.Unknown);\n    _this._size = ko.observable('');\n    if (dbColumn.size) _this._size(dbColumn.size);\n    if (dbColumn.type) _this._type(dbColumn.type);\n    _this.displayType = ko.pureComputed(function () {\n      return dbColumn_1.DBColumnType[_this._type()] + (_this._size() ? '(' + _this._size() + ')' : '');\n    });\n    _this.dataType = ko.pureComputed(function () {\n      return dbColumn_1.DBColumn.GetType(_this._type());\n    });\n    _this.actualName = ko.pureComputed(function () {\n      return _this.alias() || _this.name();\n    });\n    var points = parent.getColumnConnectionPoints(_this);\n    _this.rightConnectionPoint = {\n      side: ko.observable(utils_1.PointSide.East),\n      location: points.right\n    };\n    _this.leftConnectionPoint = {\n      side: ko.observable(utils_1.PointSide.West),\n      location: points.left\n    };\n    var query = parent.parentModel();\n    var targetColumn = ko.pureComputed(function () {\n      return _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.find(query.columns, parent.actualName(), _this.name());\n    });\n    _this.aggregate = ko.pureComputed({\n      read: function () {\n        return targetColumn() ? targetColumn().aggregate() : columnModelMeta_1.AggregationType.None;\n      },\n      write: function (value) {\n        targetColumn() && targetColumn().aggregate(value);\n      }\n    });\n    _this.alias = ko.pureComputed({\n      read: function () {\n        return targetColumn() ? targetColumn().alias() : '';\n      },\n      write: function (value) {\n        targetColumn() && targetColumn().alias(value || null);\n      }\n    });\n    var orderByItem = ko.pureComputed(function () {\n      return _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.find(query.sorting, parent.actualName(), _this.name());\n    });\n    _this.sortingType = ko.computed({\n      read: function () {\n        if (!orderByItem()) return 'Unsorted';\n        return orderByItem().descending() ? 'Descending' : 'Ascending';\n      },\n      write: function (newValue) {\n        if (newValue !== 'Unsorted') {\n          if (orderByItem()) {\n            orderByItem().descending(newValue === 'Descending');\n          } else {\n            _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.addNew(query, query.sorting, parent.actualName(), _this.name()).descending(newValue === 'Descending');\n          }\n        } else if (orderByItem()) {\n          _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.remove(query.sorting, parent.actualName(), _this.name());\n        }\n      }\n    });\n    _this.sortOrder = ko.computed({\n      read: function () {\n        var index = query.sorting().indexOf(orderByItem());\n        return index < 0 ? undefined : index + 1;\n      },\n      write: function (newValue) {\n        if (!orderByItem()) return;\n        newValue = Math.min(newValue, query.sorting().length);\n        newValue = Math.max(newValue, 1);\n        var oldValue = query.sorting().indexOf(orderByItem());\n        var item = query.sorting.splice(oldValue, 1);\n        query.sorting.splice(newValue - 1, 0, item[0]);\n      }\n    });\n    var groupByItem = ko.computed(function () {\n      return _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.find(query.grouping, parent.actualName(), _this.name());\n    });\n\n    _this.aggregate.subscribe(function (value) {\n      var parentTable = _this.parentModel();\n\n      if (value !== columnModelMeta_1.AggregationType.None) {\n        _this.groupBy(false);\n\n        if (!_this.alias() || _this._isAliasAutoGenerated(parentTable.actualName())) {\n          var aggregateAlias = _this.name() + '_' + value;\n\n          _this.alias(_columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.setUniqueAlias(query.columns, aggregateAlias));\n        }\n      } else if (_this._isAliasAutoGenerated(parentTable.actualName())) {\n        _this.alias(null);\n      }\n    });\n\n    _this.groupBy = ko.computed({\n      read: function () {\n        return !!groupByItem();\n      },\n      write: function (value) {\n        if (value) {\n          _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.addNew(query, query.grouping, parent.actualName(), _this.name());\n\n          _this.aggregate(columnModelMeta_1.AggregationType.None);\n        } else {\n          _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.remove(query.grouping, parent.actualName(), _this.name());\n        }\n      }\n    });\n\n    _this.toggleSelected = function (value, lazy) {\n      if (lazy === void 0) {\n        lazy = false;\n      }\n\n      if (!!targetColumn() === value) return;\n\n      if (value) {\n        _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.addNew(query, query.columns, parent.actualName(), _this.name(), lazy);\n      } else {\n        _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.remove(query.columns, parent.actualName(), _this.name(), lazy);\n\n        _this.groupBy(false);\n      }\n    };\n\n    _this.selected = ko.pureComputed({\n      read: function () {\n        return !!targetColumn();\n      },\n      write: function (value) {\n        return _this.toggleSelected(value);\n      }\n    });\n    return _this;\n  }\n\n  ColumnViewModel.prototype._isAliasAutoGenerated = function (addedTableName) {\n    if (addedTableName && this.alias() && this.alias().indexOf(addedTableName + '_') === 0) {\n      if (this.alias().substring(addedTableName.length + 1) === this.name()) return true;\n    }\n\n    if (!this.alias() || this.alias().indexOf(this.name() + '_') !== 0) return false;\n    var funcName = this.alias().substring(this.name().length + 1);\n    if (funcName.match(new RegExp('_[0-9]+$'))) funcName = funcName.substring(0, funcName.indexOf('_'));\n    return Object.keys(columnModelMeta_1.AggregationType).indexOf(funcName) > 0;\n  };\n\n  ColumnViewModel.prototype.getInfo = function () {\n    return columnModelMeta_1.columnSerializationInfo;\n  };\n\n  ColumnViewModel.prototype.isPropertyDisabled = function (name) {\n    if (this.isNotAvailable()) return true;\n\n    if (name === 'sortOrder') {\n      return this.sortingType() === 'Unsorted';\n    } else if (name === 'aggregate' || name === 'alias') {\n      return !this.selected();\n    } else if (name === 'groupBy') {\n      var query = this.root;\n      return this.aggregate() && query.aggregatedColumnsCount() === 1;\n    } else return false;\n  };\n\n  Object.defineProperty(ColumnViewModel.prototype, \"specifics\", {\n    get: function () {\n      return dbColumn_1.DBColumn.GetSpecific(this.dataType());\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return ColumnViewModel;\n}(queryElementModel_1.QueryElementBaseViewModel);\n\nexports.ColumnViewModel = ColumnViewModel;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/query-builder/elements/columnModel.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","ColumnViewModel","ko","require","queryElementModel_1","columnModelMeta_1","dbColumn_1","utils_1","_columnExpressionCollectionHelper_1","_utils_1","_super","model","dbColumn","parent","serializer","_this","extend","isNotAvailable","observable","_type","DBColumnType","Unknown","_size","size","type","displayType","pureComputed","dataType","DBColumn","GetType","actualName","alias","name","points","getColumnConnectionPoints","rightConnectionPoint","side","PointSide","East","location","right","leftConnectionPoint","West","left","query","parentModel","targetColumn","ColumnExpressionCollectionHelper","find","columns","aggregate","read","AggregationType","None","write","orderByItem","sorting","sortingType","computed","descending","newValue","addNew","remove","sortOrder","index","indexOf","undefined","Math","min","length","max","oldValue","item","splice","groupByItem","grouping","subscribe","parentTable","groupBy","_isAliasAutoGenerated","aggregateAlias","setUniqueAlias","toggleSelected","lazy","selected","addedTableName","substring","funcName","match","RegExp","keys","getInfo","columnSerializationInfo","isPropertyDisabled","root","aggregatedColumnsCount","get","GetSpecific","enumerable","configurable","QueryElementBaseViewModel"],"mappings":"AAAA;;;;;;;AAOA;;AACA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIC,MAAM,CAACK,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EAAgDN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAFrG;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnB,QAAI,OAAOA,CAAP,KAAa,UAAb,IAA2BA,CAAC,KAAK,IAArC,EACI,MAAM,IAAIS,SAAJ,CAAc,yBAAyBC,MAAM,CAACV,CAAD,CAA/B,GAAqC,+BAAnD,CAAN;AACJF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASW,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBb,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACO,SAAF,GAAcN,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACY,MAAP,CAAcb,CAAd,CAAb,IAAiCW,EAAE,CAACL,SAAH,GAAeN,CAAC,CAACM,SAAjB,EAA4B,IAAIK,EAAJ,EAA7D,CAAd;AACH,GAND;AAOH,CAd2C,EAA5C;;AAeAV,MAAM,CAACa,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,eAAR,GAA0B,KAAK,CAA/B;;AACA,IAAIC,EAAE,GAAGC,OAAO,CAAC,UAAD,CAAhB;;AACA,IAAIC,mBAAmB,GAAGD,OAAO,CAAC,qBAAD,CAAjC;;AACA,IAAIE,iBAAiB,GAAGF,OAAO,CAAC,mBAAD,CAA/B;;AACA,IAAIG,UAAU,GAAGH,OAAO,CAAC,wBAAD,CAAxB;;AACA,IAAII,OAAO,GAAGJ,OAAO,CAAC,qBAAD,CAArB;;AACA,IAAIK,mCAAmC,GAAGL,OAAO,CAAC,4CAAD,CAAjD;;AACA,IAAIM,QAAQ,GAAGN,OAAO,CAAC,yBAAD,CAAtB;;AACA,IAAIF,eAAe,GAAI,UAAUS,MAAV,EAAkB;AACrC7B,EAAAA,SAAS,CAACoB,eAAD,EAAkBS,MAAlB,CAAT;;AACA,WAAST,eAAT,CAAyBU,KAAzB,EAAgCC,QAAhC,EAA0CC,MAA1C,EAAkDC,UAAlD,EAA8D;AAC1D,QAAIC,KAAK,GAAGL,MAAM,CAAClB,IAAP,CAAY,IAAZ,EAAkBiB,QAAQ,CAACO,MAAT,CAAgB;AAAE,sBAAgB;AAAlB,KAAhB,EAA8CL,KAA9C,CAAlB,EAAwEE,MAAxE,EAAgFC,UAAhF,KAA+F,IAA3G;;AACAC,IAAAA,KAAK,CAACE,cAAN,GAAuBf,EAAE,CAACgB,UAAH,CAAc,KAAd,CAAvB;AACAH,IAAAA,KAAK,CAACI,KAAN,GAAcjB,EAAE,CAACgB,UAAH,CAAcZ,UAAU,CAACc,YAAX,CAAwBC,OAAtC,CAAd;AACAN,IAAAA,KAAK,CAACO,KAAN,GAAcpB,EAAE,CAACgB,UAAH,CAAc,EAAd,CAAd;AACA,QAAIN,QAAQ,CAACW,IAAb,EACIR,KAAK,CAACO,KAAN,CAAYV,QAAQ,CAACW,IAArB;AACJ,QAAIX,QAAQ,CAACY,IAAb,EACIT,KAAK,CAACI,KAAN,CAAYP,QAAQ,CAACY,IAArB;AACJT,IAAAA,KAAK,CAACU,WAAN,GAAoBvB,EAAE,CAACwB,YAAH,CAAgB,YAAY;AAC5C,aAAOpB,UAAU,CAACc,YAAX,CAAwBL,KAAK,CAACI,KAAN,EAAxB,KAA0CJ,KAAK,CAACO,KAAN,KAAgB,MAAMP,KAAK,CAACO,KAAN,EAAN,GAAsB,GAAtC,GAA4C,EAAtF,CAAP;AACH,KAFmB,CAApB;AAGAP,IAAAA,KAAK,CAACY,QAAN,GAAiBzB,EAAE,CAACwB,YAAH,CAAgB,YAAY;AACzC,aAAOpB,UAAU,CAACsB,QAAX,CAAoBC,OAApB,CAA4Bd,KAAK,CAACI,KAAN,EAA5B,CAAP;AACH,KAFgB,CAAjB;AAGAJ,IAAAA,KAAK,CAACe,UAAN,GAAmB5B,EAAE,CAACwB,YAAH,CAAgB,YAAY;AAC3C,aAAOX,KAAK,CAACgB,KAAN,MAAiBhB,KAAK,CAACiB,IAAN,EAAxB;AACH,KAFkB,CAAnB;AAGA,QAAIC,MAAM,GAAGpB,MAAM,CAACqB,yBAAP,CAAiCnB,KAAjC,CAAb;AACAA,IAAAA,KAAK,CAACoB,oBAAN,GAA6B;AACzBC,MAAAA,IAAI,EAAElC,EAAE,CAACgB,UAAH,CAAcX,OAAO,CAAC8B,SAAR,CAAkBC,IAAhC,CADmB;AAEzBC,MAAAA,QAAQ,EAAEN,MAAM,CAACO;AAFQ,KAA7B;AAIAzB,IAAAA,KAAK,CAAC0B,mBAAN,GAA4B;AACxBL,MAAAA,IAAI,EAAElC,EAAE,CAACgB,UAAH,CAAcX,OAAO,CAAC8B,SAAR,CAAkBK,IAAhC,CADkB;AAExBH,MAAAA,QAAQ,EAAEN,MAAM,CAACU;AAFO,KAA5B;AAIA,QAAIC,KAAK,GAAG/B,MAAM,CAACgC,WAAP,EAAZ;AACA,QAAIC,YAAY,GAAG5C,EAAE,CAACwB,YAAH,CAAgB,YAAY;AAAE,aAAOlB,mCAAmC,CAACuC,gCAApC,CAAqEC,IAArE,CAA0EJ,KAAK,CAACK,OAAhF,EAAyFpC,MAAM,CAACiB,UAAP,EAAzF,EAA8Gf,KAAK,CAACiB,IAAN,EAA9G,CAAP;AAAqI,KAAnK,CAAnB;AACAjB,IAAAA,KAAK,CAACmC,SAAN,GAAkBhD,EAAE,CAACwB,YAAH,CAAgB;AAC9ByB,MAAAA,IAAI,EAAE,YAAY;AAAE,eAAOL,YAAY,KAAKA,YAAY,GAAGI,SAAf,EAAL,GAAkC7C,iBAAiB,CAAC+C,eAAlB,CAAkCC,IAAvF;AAA8F,OADpF;AAE9BC,MAAAA,KAAK,EAAE,UAAUtD,KAAV,EAAiB;AACpB8C,QAAAA,YAAY,MAAMA,YAAY,GAAGI,SAAf,CAAyBlD,KAAzB,CAAlB;AACH;AAJ6B,KAAhB,CAAlB;AAMAe,IAAAA,KAAK,CAACgB,KAAN,GAAc7B,EAAE,CAACwB,YAAH,CAAgB;AAC1ByB,MAAAA,IAAI,EAAE,YAAY;AAAE,eAAOL,YAAY,KAAKA,YAAY,GAAGf,KAAf,EAAL,GAA8B,EAAjD;AAAsD,OADhD;AAE1BuB,MAAAA,KAAK,EAAE,UAAUtD,KAAV,EAAiB;AACpB8C,QAAAA,YAAY,MAAMA,YAAY,GAAGf,KAAf,CAAqB/B,KAAK,IAAI,IAA9B,CAAlB;AACH;AAJyB,KAAhB,CAAd;AAMA,QAAIuD,WAAW,GAAGrD,EAAE,CAACwB,YAAH,CAAgB,YAAY;AAAE,aAAOlB,mCAAmC,CAACuC,gCAApC,CAAqEC,IAArE,CAA0EJ,KAAK,CAACY,OAAhF,EAAyF3C,MAAM,CAACiB,UAAP,EAAzF,EAA8Gf,KAAK,CAACiB,IAAN,EAA9G,CAAP;AAAqI,KAAnK,CAAlB;AACAjB,IAAAA,KAAK,CAAC0C,WAAN,GAAoBvD,EAAE,CAACwD,QAAH,CAAY;AAC5BP,MAAAA,IAAI,EAAE,YAAY;AACd,YAAI,CAACI,WAAW,EAAhB,EACI,OAAO,UAAP;AACJ,eAAOA,WAAW,GAAGI,UAAd,KAA6B,YAA7B,GAA4C,WAAnD;AACH,OAL2B;AAM5BL,MAAAA,KAAK,EAAE,UAAUM,QAAV,EAAoB;AACvB,YAAIA,QAAQ,KAAK,UAAjB,EAA6B;AACzB,cAAIL,WAAW,EAAf,EAAmB;AACfA,YAAAA,WAAW,GAAGI,UAAd,CAAyBC,QAAQ,KAAK,YAAtC;AACH,WAFD,MAGK;AACDpD,YAAAA,mCAAmC,CAACuC,gCAApC,CAAqEc,MAArE,CAA4EjB,KAA5E,EAAmFA,KAAK,CAACY,OAAzF,EAAkG3C,MAAM,CAACiB,UAAP,EAAlG,EAAuHf,KAAK,CAACiB,IAAN,EAAvH,EACK2B,UADL,CACgBC,QAAQ,KAAK,YAD7B;AAEH;AACJ,SARD,MASK,IAAIL,WAAW,EAAf,EAAmB;AACpB/C,UAAAA,mCAAmC,CAACuC,gCAApC,CAAqEe,MAArE,CAA4ElB,KAAK,CAACY,OAAlF,EAA2F3C,MAAM,CAACiB,UAAP,EAA3F,EAAgHf,KAAK,CAACiB,IAAN,EAAhH;AACH;AACJ;AAnB2B,KAAZ,CAApB;AAqBAjB,IAAAA,KAAK,CAACgD,SAAN,GAAkB7D,EAAE,CAACwD,QAAH,CAAY;AAC1BP,MAAAA,IAAI,EAAE,YAAY;AACd,YAAIa,KAAK,GAAGpB,KAAK,CAACY,OAAN,GAAgBS,OAAhB,CAAwBV,WAAW,EAAnC,CAAZ;AACA,eAAOS,KAAK,GAAG,CAAR,GAAYE,SAAZ,GAAwBF,KAAK,GAAG,CAAvC;AACH,OAJyB;AAK1BV,MAAAA,KAAK,EAAE,UAAUM,QAAV,EAAoB;AACvB,YAAI,CAACL,WAAW,EAAhB,EACI;AACJK,QAAAA,QAAQ,GAAGO,IAAI,CAACC,GAAL,CAASR,QAAT,EAAmBhB,KAAK,CAACY,OAAN,GAAgBa,MAAnC,CAAX;AACAT,QAAAA,QAAQ,GAAGO,IAAI,CAACG,GAAL,CAASV,QAAT,EAAmB,CAAnB,CAAX;AACA,YAAIW,QAAQ,GAAG3B,KAAK,CAACY,OAAN,GAAgBS,OAAhB,CAAwBV,WAAW,EAAnC,CAAf;AACA,YAAIiB,IAAI,GAAG5B,KAAK,CAACY,OAAN,CAAciB,MAAd,CAAqBF,QAArB,EAA+B,CAA/B,CAAX;AACA3B,QAAAA,KAAK,CAACY,OAAN,CAAciB,MAAd,CAAqBb,QAAQ,GAAG,CAAhC,EAAmC,CAAnC,EAAsCY,IAAI,CAAC,CAAD,CAA1C;AACH;AAbyB,KAAZ,CAAlB;AAeA,QAAIE,WAAW,GAAGxE,EAAE,CAACwD,QAAH,CAAY,YAAY;AAAE,aAAOlD,mCAAmC,CAACuC,gCAApC,CAAqEC,IAArE,CAA0EJ,KAAK,CAAC+B,QAAhF,EAA0F9D,MAAM,CAACiB,UAAP,EAA1F,EAA+Gf,KAAK,CAACiB,IAAN,EAA/G,CAAP;AAAsI,KAAhK,CAAlB;;AACAjB,IAAAA,KAAK,CAACmC,SAAN,CAAgB0B,SAAhB,CAA0B,UAAU5E,KAAV,EAAiB;AACvC,UAAI6E,WAAW,GAAG9D,KAAK,CAAC8B,WAAN,EAAlB;;AACA,UAAI7C,KAAK,KAAKK,iBAAiB,CAAC+C,eAAlB,CAAkCC,IAAhD,EAAsD;AAClDtC,QAAAA,KAAK,CAAC+D,OAAN,CAAc,KAAd;;AACA,YAAI,CAAC/D,KAAK,CAACgB,KAAN,EAAD,IAAkBhB,KAAK,CAACgE,qBAAN,CAA4BF,WAAW,CAAC/C,UAAZ,EAA5B,CAAtB,EAA6E;AACzE,cAAIkD,cAAc,GAAGjE,KAAK,CAACiB,IAAN,KAAe,GAAf,GAAqBhC,KAA1C;;AACAe,UAAAA,KAAK,CAACgB,KAAN,CAAYvB,mCAAmC,CAACuC,gCAApC,CAAqEkC,cAArE,CAAoFrC,KAAK,CAACK,OAA1F,EAAmG+B,cAAnG,CAAZ;AACH;AACJ,OAND,MAOK,IAAIjE,KAAK,CAACgE,qBAAN,CAA4BF,WAAW,CAAC/C,UAAZ,EAA5B,CAAJ,EAA2D;AAC5Df,QAAAA,KAAK,CAACgB,KAAN,CAAY,IAAZ;AACH;AACJ,KAZD;;AAaAhB,IAAAA,KAAK,CAAC+D,OAAN,GAAgB5E,EAAE,CAACwD,QAAH,CAAY;AACxBP,MAAAA,IAAI,EAAE,YAAY;AAAE,eAAO,CAAC,CAACuB,WAAW,EAApB;AAAyB,OADrB;AAExBpB,MAAAA,KAAK,EAAE,UAAUtD,KAAV,EAAiB;AACpB,YAAIA,KAAJ,EAAW;AACPQ,UAAAA,mCAAmC,CAACuC,gCAApC,CAAqEc,MAArE,CAA4EjB,KAA5E,EAAmFA,KAAK,CAAC+B,QAAzF,EAAmG9D,MAAM,CAACiB,UAAP,EAAnG,EAAwHf,KAAK,CAACiB,IAAN,EAAxH;;AACAjB,UAAAA,KAAK,CAACmC,SAAN,CAAgB7C,iBAAiB,CAAC+C,eAAlB,CAAkCC,IAAlD;AACH,SAHD,MAIK;AACD7C,UAAAA,mCAAmC,CAACuC,gCAApC,CAAqEe,MAArE,CAA4ElB,KAAK,CAAC+B,QAAlF,EAA4F9D,MAAM,CAACiB,UAAP,EAA5F,EAAiHf,KAAK,CAACiB,IAAN,EAAjH;AACH;AACJ;AAVuB,KAAZ,CAAhB;;AAYAjB,IAAAA,KAAK,CAACmE,cAAN,GAAuB,UAAUlF,KAAV,EAAiBmF,IAAjB,EAAuB;AAC1C,UAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,QAAAA,IAAI,GAAG,KAAP;AAAe;;AACtC,UAAI,CAAC,CAACrC,YAAY,EAAd,KAAqB9C,KAAzB,EACI;;AACJ,UAAIA,KAAJ,EAAW;AACPQ,QAAAA,mCAAmC,CAACuC,gCAApC,CAAqEc,MAArE,CAA4EjB,KAA5E,EAAmFA,KAAK,CAACK,OAAzF,EAAkGpC,MAAM,CAACiB,UAAP,EAAlG,EAAuHf,KAAK,CAACiB,IAAN,EAAvH,EAAqImD,IAArI;AACH,OAFD,MAGK;AACD3E,QAAAA,mCAAmC,CAACuC,gCAApC,CAAqEe,MAArE,CAA4ElB,KAAK,CAACK,OAAlF,EAA2FpC,MAAM,CAACiB,UAAP,EAA3F,EAAgHf,KAAK,CAACiB,IAAN,EAAhH,EAA8HmD,IAA9H;;AACApE,QAAAA,KAAK,CAAC+D,OAAN,CAAc,KAAd;AACH;AACJ,KAXD;;AAYA/D,IAAAA,KAAK,CAACqE,QAAN,GAAiBlF,EAAE,CAACwB,YAAH,CAAgB;AAC7ByB,MAAAA,IAAI,EAAE,YAAY;AAAE,eAAO,CAAC,CAACL,YAAY,EAArB;AAA0B,OADjB;AAE7BQ,MAAAA,KAAK,EAAE,UAAUtD,KAAV,EAAiB;AAAE,eAAOe,KAAK,CAACmE,cAAN,CAAqBlF,KAArB,CAAP;AAAqC;AAFlC,KAAhB,CAAjB;AAIA,WAAOe,KAAP;AACH;;AACDd,EAAAA,eAAe,CAACX,SAAhB,CAA0ByF,qBAA1B,GAAkD,UAAUM,cAAV,EAA0B;AACxE,QAAIA,cAAc,IAAI,KAAKtD,KAAL,EAAlB,IAAkC,KAAKA,KAAL,GAAakC,OAAb,CAAqBoB,cAAc,GAAG,GAAtC,MAA+C,CAArF,EAAwF;AACpF,UAAI,KAAKtD,KAAL,GAAauD,SAAb,CAAuBD,cAAc,CAAChB,MAAf,GAAwB,CAA/C,MAAsD,KAAKrC,IAAL,EAA1D,EACI,OAAO,IAAP;AACP;;AACD,QAAI,CAAC,KAAKD,KAAL,EAAD,IAAiB,KAAKA,KAAL,GAAakC,OAAb,CAAqB,KAAKjC,IAAL,KAAc,GAAnC,MAA4C,CAAjE,EACI,OAAO,KAAP;AACJ,QAAIuD,QAAQ,GAAG,KAAKxD,KAAL,GAAauD,SAAb,CAAuB,KAAKtD,IAAL,GAAYqC,MAAZ,GAAqB,CAA5C,CAAf;AACA,QAAIkB,QAAQ,CAACC,KAAT,CAAe,IAAIC,MAAJ,CAAW,UAAX,CAAf,CAAJ,EACIF,QAAQ,GAAGA,QAAQ,CAACD,SAAT,CAAmB,CAAnB,EAAsBC,QAAQ,CAACtB,OAAT,CAAiB,GAAjB,CAAtB,CAAX;AACJ,WAAOhF,MAAM,CAACyG,IAAP,CAAYrF,iBAAiB,CAAC+C,eAA9B,EAA+Ca,OAA/C,CAAuDsB,QAAvD,IAAmE,CAA1E;AACH,GAXD;;AAYAtF,EAAAA,eAAe,CAACX,SAAhB,CAA0BqG,OAA1B,GAAoC,YAAY;AAC5C,WAAOtF,iBAAiB,CAACuF,uBAAzB;AACH,GAFD;;AAGA3F,EAAAA,eAAe,CAACX,SAAhB,CAA0BuG,kBAA1B,GAA+C,UAAU7D,IAAV,EAAgB;AAC3D,QAAI,KAAKf,cAAL,EAAJ,EACI,OAAO,IAAP;;AACJ,QAAIe,IAAI,KAAK,WAAb,EAA0B;AACtB,aAAO,KAAKyB,WAAL,OAAuB,UAA9B;AACH,KAFD,MAGK,IAAIzB,IAAI,KAAK,WAAT,IAAwBA,IAAI,KAAK,OAArC,EAA8C;AAC/C,aAAO,CAAC,KAAKoD,QAAL,EAAR;AACH,KAFI,MAGA,IAAIpD,IAAI,KAAK,SAAb,EAAwB;AACzB,UAAIY,KAAK,GAAG,KAAKkD,IAAjB;AACA,aAAO,KAAK5C,SAAL,MAAoBN,KAAK,CAACmD,sBAAN,OAAmC,CAA9D;AACH,KAHI,MAKD,OAAO,KAAP;AACP,GAfD;;AAgBA9G,EAAAA,MAAM,CAACa,cAAP,CAAsBG,eAAe,CAACX,SAAtC,EAAiD,WAAjD,EAA8D;AAC1D0G,IAAAA,GAAG,EAAE,YAAY;AACb,aAAO1F,UAAU,CAACsB,QAAX,CAAoBqE,WAApB,CAAgC,KAAKtE,QAAL,EAAhC,CAAP;AACH,KAHyD;AAI1DuE,IAAAA,UAAU,EAAE,KAJ8C;AAK1DC,IAAAA,YAAY,EAAE;AAL4C,GAA9D;AAOA,SAAOlG,eAAP;AACH,CAnKsB,CAmKrBG,mBAAmB,CAACgG,yBAnKC,CAAvB;;AAoKArG,OAAO,CAACE,eAAR,GAA0BA,eAA1B","sourcesContent":["/**\n* DevExpress Analytics (query-builder\\elements\\columnModel.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ColumnViewModel = void 0;\nvar ko = require(\"knockout\");\nvar queryElementModel_1 = require(\"./queryElementModel\");\nvar columnModelMeta_1 = require(\"./columnModelMeta\");\nvar dbColumn_1 = require(\"../dataSource/dbColumn\");\nvar utils_1 = require(\"../../diagram/utils\");\nvar _columnExpressionCollectionHelper_1 = require(\"../utils/_columnExpressionCollectionHelper\");\nvar _utils_1 = require(\"../../serializer/_utils\");\nvar ColumnViewModel = (function (_super) {\n    __extends(ColumnViewModel, _super);\n    function ColumnViewModel(model, dbColumn, parent, serializer) {\n        var _this = _super.call(this, _utils_1.extend({ '@ControlType': 'Column' }, model), parent, serializer) || this;\n        _this.isNotAvailable = ko.observable(false);\n        _this._type = ko.observable(dbColumn_1.DBColumnType.Unknown);\n        _this._size = ko.observable('');\n        if (dbColumn.size)\n            _this._size(dbColumn.size);\n        if (dbColumn.type)\n            _this._type(dbColumn.type);\n        _this.displayType = ko.pureComputed(function () {\n            return dbColumn_1.DBColumnType[_this._type()] + (_this._size() ? '(' + _this._size() + ')' : '');\n        });\n        _this.dataType = ko.pureComputed(function () {\n            return dbColumn_1.DBColumn.GetType(_this._type());\n        });\n        _this.actualName = ko.pureComputed(function () {\n            return _this.alias() || _this.name();\n        });\n        var points = parent.getColumnConnectionPoints(_this);\n        _this.rightConnectionPoint = {\n            side: ko.observable(utils_1.PointSide.East),\n            location: points.right\n        };\n        _this.leftConnectionPoint = {\n            side: ko.observable(utils_1.PointSide.West),\n            location: points.left\n        };\n        var query = parent.parentModel();\n        var targetColumn = ko.pureComputed(function () { return _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.find(query.columns, parent.actualName(), _this.name()); });\n        _this.aggregate = ko.pureComputed({\n            read: function () { return targetColumn() ? targetColumn().aggregate() : columnModelMeta_1.AggregationType.None; },\n            write: function (value) {\n                targetColumn() && targetColumn().aggregate(value);\n            }\n        });\n        _this.alias = ko.pureComputed({\n            read: function () { return targetColumn() ? targetColumn().alias() : ''; },\n            write: function (value) {\n                targetColumn() && targetColumn().alias(value || null);\n            }\n        });\n        var orderByItem = ko.pureComputed(function () { return _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.find(query.sorting, parent.actualName(), _this.name()); });\n        _this.sortingType = ko.computed({\n            read: function () {\n                if (!orderByItem())\n                    return 'Unsorted';\n                return orderByItem().descending() ? 'Descending' : 'Ascending';\n            },\n            write: function (newValue) {\n                if (newValue !== 'Unsorted') {\n                    if (orderByItem()) {\n                        orderByItem().descending(newValue === 'Descending');\n                    }\n                    else {\n                        _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.addNew(query, query.sorting, parent.actualName(), _this.name())\n                            .descending(newValue === 'Descending');\n                    }\n                }\n                else if (orderByItem()) {\n                    _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.remove(query.sorting, parent.actualName(), _this.name());\n                }\n            }\n        });\n        _this.sortOrder = ko.computed({\n            read: function () {\n                var index = query.sorting().indexOf(orderByItem());\n                return index < 0 ? undefined : index + 1;\n            },\n            write: function (newValue) {\n                if (!orderByItem())\n                    return;\n                newValue = Math.min(newValue, query.sorting().length);\n                newValue = Math.max(newValue, 1);\n                var oldValue = query.sorting().indexOf(orderByItem());\n                var item = query.sorting.splice(oldValue, 1);\n                query.sorting.splice(newValue - 1, 0, item[0]);\n            }\n        });\n        var groupByItem = ko.computed(function () { return _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.find(query.grouping, parent.actualName(), _this.name()); });\n        _this.aggregate.subscribe(function (value) {\n            var parentTable = _this.parentModel();\n            if (value !== columnModelMeta_1.AggregationType.None) {\n                _this.groupBy(false);\n                if (!_this.alias() || _this._isAliasAutoGenerated(parentTable.actualName())) {\n                    var aggregateAlias = _this.name() + '_' + value;\n                    _this.alias(_columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.setUniqueAlias(query.columns, aggregateAlias));\n                }\n            }\n            else if (_this._isAliasAutoGenerated(parentTable.actualName())) {\n                _this.alias(null);\n            }\n        });\n        _this.groupBy = ko.computed({\n            read: function () { return !!groupByItem(); },\n            write: function (value) {\n                if (value) {\n                    _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.addNew(query, query.grouping, parent.actualName(), _this.name());\n                    _this.aggregate(columnModelMeta_1.AggregationType.None);\n                }\n                else {\n                    _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.remove(query.grouping, parent.actualName(), _this.name());\n                }\n            }\n        });\n        _this.toggleSelected = function (value, lazy) {\n            if (lazy === void 0) { lazy = false; }\n            if (!!targetColumn() === value)\n                return;\n            if (value) {\n                _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.addNew(query, query.columns, parent.actualName(), _this.name(), lazy);\n            }\n            else {\n                _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.remove(query.columns, parent.actualName(), _this.name(), lazy);\n                _this.groupBy(false);\n            }\n        };\n        _this.selected = ko.pureComputed({\n            read: function () { return !!targetColumn(); },\n            write: function (value) { return _this.toggleSelected(value); }\n        });\n        return _this;\n    }\n    ColumnViewModel.prototype._isAliasAutoGenerated = function (addedTableName) {\n        if (addedTableName && this.alias() && this.alias().indexOf(addedTableName + '_') === 0) {\n            if (this.alias().substring(addedTableName.length + 1) === this.name())\n                return true;\n        }\n        if (!this.alias() || this.alias().indexOf(this.name() + '_') !== 0)\n            return false;\n        var funcName = this.alias().substring(this.name().length + 1);\n        if (funcName.match(new RegExp('_[0-9]+$')))\n            funcName = funcName.substring(0, funcName.indexOf('_'));\n        return Object.keys(columnModelMeta_1.AggregationType).indexOf(funcName) > 0;\n    };\n    ColumnViewModel.prototype.getInfo = function () {\n        return columnModelMeta_1.columnSerializationInfo;\n    };\n    ColumnViewModel.prototype.isPropertyDisabled = function (name) {\n        if (this.isNotAvailable())\n            return true;\n        if (name === 'sortOrder') {\n            return this.sortingType() === 'Unsorted';\n        }\n        else if (name === 'aggregate' || name === 'alias') {\n            return !this.selected();\n        }\n        else if (name === 'groupBy') {\n            var query = this.root;\n            return this.aggregate() && query.aggregatedColumnsCount() === 1;\n        }\n        else\n            return false;\n    };\n    Object.defineProperty(ColumnViewModel.prototype, \"specifics\", {\n        get: function () {\n            return dbColumn_1.DBColumn.GetSpecific(this.dataType());\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ColumnViewModel;\n}(queryElementModel_1.QueryElementBaseViewModel));\nexports.ColumnViewModel = ColumnViewModel;\n"]},"metadata":{},"sourceType":"script"}