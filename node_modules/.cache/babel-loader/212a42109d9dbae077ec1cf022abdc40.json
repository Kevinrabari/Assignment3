{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_dashboard-tabs-view-model.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DashboardTabsViewModel = void 0;\n\nvar ko = require(\"knockout\");\n\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\n\nvar disposable_object_1 = require(\"../../../model/disposable-object\");\n\nvar _knockout_utils_1 = require(\"../../../model/internal/_knockout-utils\");\n\nvar _tab_header_calculator_1 = require(\"../../../viewer-parts/layout/_tab-header-calculator\");\n\nvar _base_item_1 = require(\"../../../viewer-parts/viewer-items/_base-item\");\n\nvar _popup_menu_creator_1 = require(\"../../../viewer-parts/widgets/caption-toolbar/_popup-menu-creator\");\n\nvar _interfaces_1 = require(\"../../internal/_interfaces\");\n\nvar _dashboard_item_bindings_1 = require(\"../../viewer/_dashboard-item-bindings\");\n\nvar _element_size_utils_1 = require(\"../../viewer/_element-size-utils\");\n\nvar DashboardTabsViewModel = function (_super) {\n  __extends(DashboardTabsViewModel, _super);\n\n  function DashboardTabsViewModel(layoutItem, headerHeight, element) {\n    var _this = _super.call(this) || this;\n\n    _this.layoutItem = layoutItem;\n    _this.headerHeight = headerHeight;\n    _this.element = element;\n    _this.showMenu = ko.observable(false);\n    _this.tabPageBindings = ko.observableArray([]).extend({\n      deferred: true\n    });\n    _this.selectedItemKeys = ko.observableArray([]);\n    _this.showAddButton = ko.computed(function () {\n      return _this.layoutItem.isDesignMode() && _this.showCaption;\n    });\n    _this._defaultButtonWidth = 34;\n    _this._tabsInfoCache = {};\n    _this._toolbarCache = {};\n\n    if (_this.viewModel.item()) {\n      _this.toDispose(_knockout_utils_1.subscribeAndPerform(_this.viewModel.item().showCaption, function (newValue) {\n        headerHeight(newValue ? _dashboard_item_bindings_1.DashboardItemHeaderHeight : 0);\n      }));\n    }\n\n    _this._initialize();\n\n    return _this;\n  }\n\n  Object.defineProperty(DashboardTabsViewModel.prototype, \"viewModel\", {\n    get: function () {\n      return this.layoutItem.viewModel;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DashboardTabsViewModel.prototype, \"showCaption\", {\n    get: function () {\n      return this.viewModel.item() ? this.viewModel.item().showCaption() : true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DashboardTabsViewModel.prototype, \"_containerSizeController\", {\n    get: function () {\n      return this.layoutItem.sizeController;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DashboardTabsViewModel.prototype.toggleMenu = function (bindings, args) {\n    var menu = this._createMenuToolbarItem(this.headersViewModel.leftVisibleIndex, this.headersViewModel.rightVisibleIndex);\n\n    var boundaryContainer = _base_item_1.getControlContainer(this.element);\n\n    var container = this.element.firstElementChild;\n\n    _popup_menu_creator_1.PopupMenuCreator.toggleMenu(args.currentTarget, menu, container, boundaryContainer);\n  };\n\n  DashboardTabsViewModel.prototype.createTabPage = function () {\n    this.viewModel.createTabPage();\n  };\n\n  DashboardTabsViewModel.prototype.onSelectionChanged = function (e) {\n    if (e.addedItems.length > 0) {\n      var tabPageBinding = this.tabPageBindings().filter(function (tabPageBinding) {\n        return tabPageBinding.id === e.addedItems[0].id;\n      })[0];\n\n      if (tabPageBinding && tabPageBinding.pageDashboardItem !== this.viewModel.activeTabPage()) {\n        this.viewModel.activeTabPage(tabPageBinding.pageDashboardItem);\n      }\n    }\n  };\n\n  DashboardTabsViewModel.prototype._syncTabPageBindings = function (childItems) {\n    var _this = this;\n\n    var subscriptions = [];\n\n    var createTabPageBindings = function (pageViewModels) {\n      var tabPageBindings = pageViewModels.filter(function (pageViewModel) {\n        return pageViewModel.hasItem();\n      }).map(function (pageViewModel) {\n        return _this._createPageBinding(pageViewModel.item, pageViewModel.model);\n      });\n\n      _this.tabPageBindings(tabPageBindings);\n    };\n\n    this.toDispose(_knockout_utils_1.safeSubscribe({\n      childItems: childItems\n    }, function (args) {\n      var pageViewModels = args.childItems.map(function (pageLayoutItem) {\n        return pageLayoutItem._createViewModel();\n      });\n      subscriptions.forEach(function (d) {\n        return d.dispose();\n      });\n      subscriptions = pageViewModels.map(function (pageViewModel) {\n        return pageViewModel.item.subscribe(function () {\n          return createTabPageBindings(pageViewModels);\n        });\n      });\n      createTabPageBindings(pageViewModels);\n      return {\n        dispose: function () {\n          return subscriptions.forEach(function (d) {\n            return d.dispose();\n          });\n        }\n      };\n    }));\n  };\n\n  DashboardTabsViewModel.prototype._initialize = function () {\n    var _this = this;\n\n    this.element.setAttribute('data-layout-item-name', this.viewModel.dashboardItem());\n\n    _element_size_utils_1.setElementSize(this.element, this._containerSizeController);\n\n    this._syncTabPageBindings(this.viewModel.childItems);\n\n    this.tabPageBindings.subscribe(function () {\n      return _this._updateTabHeaders();\n    });\n\n    this._containerSizeController.requestRepaint.add(function () {\n      return _this._onContainerRepaint();\n    });\n\n    this.toDispose(this.layoutItem.isDesignMode.subscribe(function (newValue) {\n      _this._updateTabHeaders();\n    }));\n    this.toDispose(_knockout_utils_1.safeSubscribe({\n      activeTabPage: this.viewModel.activeTabPage,\n      tabPageBindings: this.tabPageBindings\n    }, function (args) {\n      _this.selectedItemKeys(_this._getSelectedKeys(args.activeTabPage));\n\n      args.tabPageBindings.forEach(function (page) {\n        if (_this._toolbarCache[page.dashboardItem.componentName()] && args.activeTabPage) {\n          _this._toolbarCache[page.dashboardItem.componentName()].disabled = page.id !== args.activeTabPage.componentName();\n        }\n      });\n    }));\n  };\n\n  DashboardTabsViewModel.prototype._createMenuToolbarItem = function (leftVisibleIndex, rightVisibleIndex) {\n    var _this = this;\n\n    var hiddenTabs = [];\n    this.viewModel.childItems().forEach(function (layoutPageItem, i) {\n      var layoutViewModel = layoutPageItem._createViewModel();\n\n      if (layoutViewModel.hasItem()) {\n        hiddenTabs.push({\n          name: layoutViewModel.item().name() ? layoutViewModel.item().name() : '',\n          page: layoutPageItem.item\n        });\n      }\n    });\n    hiddenTabs.splice(leftVisibleIndex, rightVisibleIndex - leftVisibleIndex + 1);\n    return {\n      type: 'list',\n      items: hiddenTabs.map(function (tab) {\n        return tab.name;\n      }),\n      itemClick: function (itemData, itemElement, menuItemIndex) {\n        _this.viewModel.activeTabPage(hiddenTabs[menuItemIndex].page);\n\n        _this._updateTabHeaders();\n      }\n    };\n  };\n\n  DashboardTabsViewModel.prototype._getSelectedKeys = function (activePage) {\n    return activePage ? [activePage.componentName()] : [];\n  };\n\n  DashboardTabsViewModel.prototype._createPageBinding = function (toolbarHolder, pageLayoutItem) {\n    return {\n      dashboardItem: toolbarHolder(),\n      id: pageLayoutItem.dashboardItem(),\n      pageDashboardItem: pageLayoutItem.item,\n      sizeController: new _interfaces_1.SingleTabItemSizeController(this.layoutItem.sizeController.requestRepaint, ko.observable(0), ko.observable(0)),\n      context: this.layoutItem.getContext(),\n      localContext: this._prepareLocalContext(this.layoutItem.getLocalContext()),\n      ignoreBorder: ko.observable(false)\n    };\n  };\n\n  DashboardTabsViewModel.prototype._prepareLocalContext = function (localContext) {\n    var _this = this;\n\n    localContext.viewerItemCreated.add(function (item, viewerItem) {\n      viewerItem.deferredToolbarRenderingPromise = function (itemName, width, height) {\n        var def = _jquery_helpers_1.createJQueryDeferred();\n\n        _this._onToolbarUpdated(itemName, width, height, def);\n\n        return def.promise();\n      };\n    });\n    localContext.beforeApplyViewerItemOptions.add(function (item, options, isCreation) {\n      if (_this.viewModel.item()) {\n        options.CaptionViewModel.ShowCaption = _this.showCaption;\n      }\n    });\n    localContext.boundaryContainer = this.element;\n\n    localContext.createCaptionToolbar = function (viewerItem, container, controlContainer, popupContainer, viewOptions) {\n      var toolbar = _base_item_1.createDefaultToolbar(viewerItem, container, controlContainer, popupContainer, viewOptions);\n\n      if (container) {\n        _this._toolbarCache[viewerItem.options.Name] = toolbar;\n\n        var binding = _this.tabPageBindings().filter(function (binding) {\n          return binding.dashboardItem.componentName() === viewerItem.options.Name;\n        })[0];\n\n        toolbar.disabled = !_this.viewModel.activeTabPage() || binding.id !== _this.viewModel.activeTabPage().componentName();\n      }\n\n      return toolbar;\n    };\n\n    localContext.viewerItemDispose.add(function (item, viewerItem) {\n      delete _this._tabsInfoCache[item.componentName()];\n      delete _this._toolbarCache[item.componentName()];\n    });\n    return localContext;\n  };\n\n  DashboardTabsViewModel.prototype._onContainerRepaint = function () {\n    _element_size_utils_1.setElementSize(this.element, this._containerSizeController);\n\n    this._updateTabHeaders();\n  };\n\n  DashboardTabsViewModel.prototype._onToolbarUpdated = function (itemName, width, height, def) {\n    var page = this.tabPageBindings().filter(function (page) {\n      return page.dashboardItem.componentName() === itemName;\n    })[0];\n    this.headerHeight(Math.max(this.headerHeight(), height));\n    if (page) this._tabsInfoCache[page.id] = {\n      width: width,\n      deferredRender: def\n    };\n\n    this._updateTabHeaders();\n  };\n\n  DashboardTabsViewModel.prototype._updateTabHeaders = function () {\n    var _this = this;\n\n    var tabHeadersWidth = this.tabPageBindings().map(function (page) {\n      return _this._tabsInfoCache[page.id] ? _this._tabsInfoCache[page.id].width : 100;\n    });\n    var tabHeadersDeferredRender = this.tabPageBindings().map(function (page) {\n      return _this._tabsInfoCache[page.id] ? _this._tabsInfoCache[page.id].deferredRender : _jquery_helpers_1.createJQueryDeferred();\n    });\n\n    if (tabHeadersWidth.length > 0) {\n      var buttonsWidth_1 = this.showAddButton() ? this._defaultButtonWidth : 0;\n      var activeTabIndex = Math.max(0, this.viewModel.activeTabIndex());\n      this.headersViewModel = _tab_header_calculator_1.calcTabHeadersWidth(tabHeadersWidth, this._containerSizeController.getWidth() - buttonsWidth_1, activeTabIndex, this.showCaption);\n      this.showMenu(this.showCaption && this.headersViewModel.widths.some(function (width) {\n        return width === 0;\n      }));\n\n      if (this.showMenu()) {\n        buttonsWidth_1 += this._defaultButtonWidth;\n        this.headersViewModel = _tab_header_calculator_1.calcTabHeadersWidth(tabHeadersWidth, this._containerSizeController.getWidth() - buttonsWidth_1, activeTabIndex, this.showCaption);\n      }\n\n      this.tabPageBindings().forEach(function (page, index) {\n        return page.ignoreBorder(index === _this.headersViewModel.rightVisibleIndex && buttonsWidth_1 === 0);\n      });\n      this.headersViewModel.widths.forEach(function (width, i) {\n        _this.tabPageBindings()[i].sizeController.width(width);\n\n        _this.tabPageBindings()[i].sizeController.height(_this.headerHeight());\n\n        if (i >= _this.headersViewModel.leftVisibleIndex && i <= _this.headersViewModel.rightVisibleIndex) {\n          tabHeadersDeferredRender[i].resolve();\n        }\n      });\n    }\n  };\n\n  return DashboardTabsViewModel;\n}(disposable_object_1.DisposableObject);\n\nexports.DashboardTabsViewModel = DashboardTabsViewModel;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/common/docking-layout/tab-container-item/_dashboard-tabs-view-model.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","DashboardTabsViewModel","ko","require","_jquery_helpers_1","disposable_object_1","_knockout_utils_1","_tab_header_calculator_1","_base_item_1","_popup_menu_creator_1","_interfaces_1","_dashboard_item_bindings_1","_element_size_utils_1","_super","layoutItem","headerHeight","element","_this","showMenu","observable","tabPageBindings","observableArray","extend","deferred","selectedItemKeys","showAddButton","computed","isDesignMode","showCaption","_defaultButtonWidth","_tabsInfoCache","_toolbarCache","viewModel","item","toDispose","subscribeAndPerform","newValue","DashboardItemHeaderHeight","_initialize","get","enumerable","configurable","sizeController","toggleMenu","bindings","args","menu","_createMenuToolbarItem","headersViewModel","leftVisibleIndex","rightVisibleIndex","boundaryContainer","getControlContainer","container","firstElementChild","PopupMenuCreator","currentTarget","createTabPage","onSelectionChanged","e","addedItems","length","tabPageBinding","filter","id","pageDashboardItem","activeTabPage","_syncTabPageBindings","childItems","subscriptions","createTabPageBindings","pageViewModels","pageViewModel","hasItem","map","_createPageBinding","model","safeSubscribe","pageLayoutItem","_createViewModel","forEach","dispose","subscribe","setAttribute","dashboardItem","setElementSize","_containerSizeController","_updateTabHeaders","requestRepaint","add","_onContainerRepaint","_getSelectedKeys","page","componentName","disabled","hiddenTabs","layoutPageItem","i","layoutViewModel","push","name","splice","type","items","tab","itemClick","itemData","itemElement","menuItemIndex","activePage","toolbarHolder","SingleTabItemSizeController","context","getContext","localContext","_prepareLocalContext","getLocalContext","ignoreBorder","viewerItemCreated","viewerItem","deferredToolbarRenderingPromise","itemName","width","height","def","createJQueryDeferred","_onToolbarUpdated","promise","beforeApplyViewerItemOptions","options","isCreation","CaptionViewModel","ShowCaption","createCaptionToolbar","controlContainer","popupContainer","viewOptions","toolbar","createDefaultToolbar","Name","binding","viewerItemDispose","Math","max","deferredRender","tabHeadersWidth","tabHeadersDeferredRender","buttonsWidth_1","activeTabIndex","calcTabHeadersWidth","getWidth","widths","some","index","resolve","DisposableObject"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_dashboard-tabs-view-model.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DashboardTabsViewModel = void 0;\nvar ko = require(\"knockout\");\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\nvar disposable_object_1 = require(\"../../../model/disposable-object\");\nvar _knockout_utils_1 = require(\"../../../model/internal/_knockout-utils\");\nvar _tab_header_calculator_1 = require(\"../../../viewer-parts/layout/_tab-header-calculator\");\nvar _base_item_1 = require(\"../../../viewer-parts/viewer-items/_base-item\");\nvar _popup_menu_creator_1 = require(\"../../../viewer-parts/widgets/caption-toolbar/_popup-menu-creator\");\nvar _interfaces_1 = require(\"../../internal/_interfaces\");\nvar _dashboard_item_bindings_1 = require(\"../../viewer/_dashboard-item-bindings\");\nvar _element_size_utils_1 = require(\"../../viewer/_element-size-utils\");\nvar DashboardTabsViewModel = (function (_super) {\n    __extends(DashboardTabsViewModel, _super);\n    function DashboardTabsViewModel(layoutItem, headerHeight, element) {\n        var _this = _super.call(this) || this;\n        _this.layoutItem = layoutItem;\n        _this.headerHeight = headerHeight;\n        _this.element = element;\n        _this.showMenu = ko.observable(false);\n        _this.tabPageBindings = ko.observableArray([]).extend({ deferred: true });\n        _this.selectedItemKeys = ko.observableArray([]);\n        _this.showAddButton = ko.computed(function () {\n            return _this.layoutItem.isDesignMode() && _this.showCaption;\n        });\n        _this._defaultButtonWidth = 34;\n        _this._tabsInfoCache = {};\n        _this._toolbarCache = {};\n        if (_this.viewModel.item()) {\n            _this.toDispose(_knockout_utils_1.subscribeAndPerform(_this.viewModel.item().showCaption, function (newValue) {\n                headerHeight(newValue ? _dashboard_item_bindings_1.DashboardItemHeaderHeight : 0);\n            }));\n        }\n        _this._initialize();\n        return _this;\n    }\n    Object.defineProperty(DashboardTabsViewModel.prototype, \"viewModel\", {\n        get: function () {\n            return this.layoutItem.viewModel;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DashboardTabsViewModel.prototype, \"showCaption\", {\n        get: function () {\n            return this.viewModel.item() ? this.viewModel.item().showCaption() : true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DashboardTabsViewModel.prototype, \"_containerSizeController\", {\n        get: function () {\n            return this.layoutItem.sizeController;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DashboardTabsViewModel.prototype.toggleMenu = function (bindings, args) {\n        var menu = this._createMenuToolbarItem(this.headersViewModel.leftVisibleIndex, this.headersViewModel.rightVisibleIndex);\n        var boundaryContainer = _base_item_1.getControlContainer(this.element);\n        var container = this.element.firstElementChild;\n        _popup_menu_creator_1.PopupMenuCreator.toggleMenu(args.currentTarget, menu, container, boundaryContainer);\n    };\n    DashboardTabsViewModel.prototype.createTabPage = function () {\n        this.viewModel.createTabPage();\n    };\n    DashboardTabsViewModel.prototype.onSelectionChanged = function (e) {\n        if (e.addedItems.length > 0) {\n            var tabPageBinding = this.tabPageBindings().filter(function (tabPageBinding) { return tabPageBinding.id === e.addedItems[0].id; })[0];\n            if (tabPageBinding && tabPageBinding.pageDashboardItem !== this.viewModel.activeTabPage()) {\n                this.viewModel.activeTabPage(tabPageBinding.pageDashboardItem);\n            }\n        }\n    };\n    DashboardTabsViewModel.prototype._syncTabPageBindings = function (childItems) {\n        var _this = this;\n        var subscriptions = [];\n        var createTabPageBindings = function (pageViewModels) {\n            var tabPageBindings = pageViewModels\n                .filter(function (pageViewModel) { return pageViewModel.hasItem(); })\n                .map(function (pageViewModel) { return _this._createPageBinding(pageViewModel.item, pageViewModel.model); });\n            _this.tabPageBindings(tabPageBindings);\n        };\n        this.toDispose(_knockout_utils_1.safeSubscribe({ childItems: childItems }, function (args) {\n            var pageViewModels = args.childItems.map(function (pageLayoutItem) { return pageLayoutItem._createViewModel(); });\n            subscriptions.forEach(function (d) { return d.dispose(); });\n            subscriptions = pageViewModels.map(function (pageViewModel) { return pageViewModel.item.subscribe(function () { return createTabPageBindings(pageViewModels); }); });\n            createTabPageBindings(pageViewModels);\n            return {\n                dispose: function () { return subscriptions.forEach(function (d) { return d.dispose(); }); }\n            };\n        }));\n    };\n    DashboardTabsViewModel.prototype._initialize = function () {\n        var _this = this;\n        this.element.setAttribute('data-layout-item-name', this.viewModel.dashboardItem());\n        _element_size_utils_1.setElementSize(this.element, this._containerSizeController);\n        this._syncTabPageBindings(this.viewModel.childItems);\n        this.tabPageBindings.subscribe(function () { return _this._updateTabHeaders(); });\n        this._containerSizeController.requestRepaint.add(function () { return _this._onContainerRepaint(); });\n        this.toDispose(this.layoutItem.isDesignMode.subscribe(function (newValue) {\n            _this._updateTabHeaders();\n        }));\n        this.toDispose(_knockout_utils_1.safeSubscribe({\n            activeTabPage: this.viewModel.activeTabPage,\n            tabPageBindings: this.tabPageBindings\n        }, function (args) {\n            _this.selectedItemKeys(_this._getSelectedKeys(args.activeTabPage));\n            args.tabPageBindings.forEach(function (page) {\n                if (_this._toolbarCache[page.dashboardItem.componentName()] && args.activeTabPage) {\n                    _this._toolbarCache[page.dashboardItem.componentName()].disabled = page.id !== args.activeTabPage.componentName();\n                }\n            });\n        }));\n    };\n    DashboardTabsViewModel.prototype._createMenuToolbarItem = function (leftVisibleIndex, rightVisibleIndex) {\n        var _this = this;\n        var hiddenTabs = [];\n        this.viewModel.childItems().forEach(function (layoutPageItem, i) {\n            var layoutViewModel = layoutPageItem._createViewModel();\n            if (layoutViewModel.hasItem()) {\n                hiddenTabs.push({\n                    name: layoutViewModel.item().name() ? layoutViewModel.item().name() : '',\n                    page: layoutPageItem.item\n                });\n            }\n        });\n        hiddenTabs.splice(leftVisibleIndex, rightVisibleIndex - leftVisibleIndex + 1);\n        return {\n            type: 'list',\n            items: hiddenTabs.map(function (tab) { return tab.name; }),\n            itemClick: function (itemData, itemElement, menuItemIndex) {\n                _this.viewModel.activeTabPage(hiddenTabs[menuItemIndex].page);\n                _this._updateTabHeaders();\n            }\n        };\n    };\n    DashboardTabsViewModel.prototype._getSelectedKeys = function (activePage) {\n        return activePage ? [activePage.componentName()] : [];\n    };\n    DashboardTabsViewModel.prototype._createPageBinding = function (toolbarHolder, pageLayoutItem) {\n        return {\n            dashboardItem: toolbarHolder(),\n            id: pageLayoutItem.dashboardItem(),\n            pageDashboardItem: pageLayoutItem.item,\n            sizeController: new _interfaces_1.SingleTabItemSizeController(this.layoutItem.sizeController.requestRepaint, ko.observable(0), ko.observable(0)),\n            context: this.layoutItem.getContext(),\n            localContext: this._prepareLocalContext(this.layoutItem.getLocalContext()),\n            ignoreBorder: ko.observable(false)\n        };\n    };\n    DashboardTabsViewModel.prototype._prepareLocalContext = function (localContext) {\n        var _this = this;\n        localContext.viewerItemCreated.add(function (item, viewerItem) {\n            viewerItem.deferredToolbarRenderingPromise = function (itemName, width, height) {\n                var def = _jquery_helpers_1.createJQueryDeferred();\n                _this._onToolbarUpdated(itemName, width, height, def);\n                return def.promise();\n            };\n        });\n        localContext.beforeApplyViewerItemOptions.add(function (item, options, isCreation) {\n            if (_this.viewModel.item()) {\n                options.CaptionViewModel.ShowCaption = _this.showCaption;\n            }\n        });\n        localContext.boundaryContainer = this.element;\n        localContext.createCaptionToolbar = function (viewerItem, container, controlContainer, popupContainer, viewOptions) {\n            var toolbar = _base_item_1.createDefaultToolbar(viewerItem, container, controlContainer, popupContainer, viewOptions);\n            if (container) {\n                _this._toolbarCache[viewerItem.options.Name] = toolbar;\n                var binding = _this.tabPageBindings().filter(function (binding) { return binding.dashboardItem.componentName() === viewerItem.options.Name; })[0];\n                toolbar.disabled = !_this.viewModel.activeTabPage() || binding.id !== _this.viewModel.activeTabPage().componentName();\n            }\n            return toolbar;\n        };\n        localContext.viewerItemDispose.add(function (item, viewerItem) {\n            delete _this._tabsInfoCache[item.componentName()];\n            delete _this._toolbarCache[item.componentName()];\n        });\n        return localContext;\n    };\n    DashboardTabsViewModel.prototype._onContainerRepaint = function () {\n        _element_size_utils_1.setElementSize(this.element, this._containerSizeController);\n        this._updateTabHeaders();\n    };\n    DashboardTabsViewModel.prototype._onToolbarUpdated = function (itemName, width, height, def) {\n        var page = this.tabPageBindings().filter(function (page) { return page.dashboardItem.componentName() === itemName; })[0];\n        this.headerHeight(Math.max(this.headerHeight(), height));\n        if (page)\n            this._tabsInfoCache[page.id] = {\n                width: width,\n                deferredRender: def\n            };\n        this._updateTabHeaders();\n    };\n    DashboardTabsViewModel.prototype._updateTabHeaders = function () {\n        var _this = this;\n        var tabHeadersWidth = this.tabPageBindings().map(function (page) { return _this._tabsInfoCache[page.id] ? _this._tabsInfoCache[page.id].width : 100; });\n        var tabHeadersDeferredRender = this.tabPageBindings().map(function (page) { return _this._tabsInfoCache[page.id] ? _this._tabsInfoCache[page.id].deferredRender : _jquery_helpers_1.createJQueryDeferred(); });\n        if (tabHeadersWidth.length > 0) {\n            var buttonsWidth_1 = this.showAddButton() ? this._defaultButtonWidth : 0;\n            var activeTabIndex = Math.max(0, this.viewModel.activeTabIndex());\n            this.headersViewModel = _tab_header_calculator_1.calcTabHeadersWidth(tabHeadersWidth, this._containerSizeController.getWidth() - buttonsWidth_1, activeTabIndex, this.showCaption);\n            this.showMenu(this.showCaption && this.headersViewModel.widths.some(function (width) { return width === 0; }));\n            if (this.showMenu()) {\n                buttonsWidth_1 += this._defaultButtonWidth;\n                this.headersViewModel = _tab_header_calculator_1.calcTabHeadersWidth(tabHeadersWidth, this._containerSizeController.getWidth() - buttonsWidth_1, activeTabIndex, this.showCaption);\n            }\n            this.tabPageBindings().forEach(function (page, index) { return page.ignoreBorder(index === _this.headersViewModel.rightVisibleIndex && buttonsWidth_1 === 0); });\n            this.headersViewModel.widths.forEach(function (width, i) {\n                _this.tabPageBindings()[i].sizeController.width(width);\n                _this.tabPageBindings()[i].sizeController.height(_this.headerHeight());\n                if (i >= _this.headersViewModel.leftVisibleIndex && i <= _this.headersViewModel.rightVisibleIndex) {\n                    tabHeadersDeferredRender[i].resolve();\n                }\n            });\n        }\n    };\n    return DashboardTabsViewModel;\n}(disposable_object_1.DisposableObject));\nexports.DashboardTabsViewModel = DashboardTabsViewModel;\n"]},"metadata":{},"sourceType":"script"}