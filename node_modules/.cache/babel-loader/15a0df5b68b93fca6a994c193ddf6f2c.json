{"ast":null,"code":"/**\r\n* DevExpress Dashboard (toolbox-extension.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ToolboxExtension = void 0;\n\nvar ko = require(\"knockout\");\n\nvar control_options_1 = require(\"../../common/control-options\");\n\nvar _docking_layout_controller_1 = require(\"../../common/docking-layout/_docking-layout-controller\");\n\nvar _helpers_1 = require(\"../../common/_helpers\");\n\nvar _jquery_helpers_1 = require(\"../../data/_jquery-helpers\");\n\nvar model_1 = require(\"../../model\");\n\nvar disposable_object_1 = require(\"../../model/disposable-object\");\n\nvar index_internal_1 = require(\"../../model/index.internal\");\n\nvar _dashboard_item_helper_1 = require(\"../../model/internal/_dashboard-item_helper\");\n\nvar _obsolete_helper_1 = require(\"../../model/internal/_obsolete-helper\");\n\nvar serializable_model_1 = require(\"../../model/serializable-model\");\n\nvar toolbox_items_1 = require(\"./toolbox-items\");\n\nvar _toolbox_extension_1 = require(\"./_toolbox-extension\");\n\nvar _toolbox_view_model_1 = require(\"./_toolbox-view-model\");\n\nvar nameAlias = 'toolbox';\n\nvar ToolboxExtension = function (_super) {\n  __extends(ToolboxExtension, _super);\n\n  function ToolboxExtension(dashboardControl) {\n    var _this = _super.call(this) || this;\n\n    _this.dashboardControl = dashboardControl;\n    _this.name = 'toolbox';\n    _this.menuItems = ko.observableArray();\n\n    _this.addMenuItem = function (menuItem) {\n      if (!!_this._findMenuItem(menuItem.id)) {\n        throw Error(\"The '\" + menuItem.id + \"' menu item already exists.\");\n      }\n\n      _this.menuItems.push(menuItem);\n    };\n\n    _this.removeMenuItem = function (menuItemId) {\n      var menuItem = _this._findMenuItem(menuItemId);\n\n      _this.menuItems.remove(menuItem);\n    };\n\n    _this.selectMenuItem = function (menuItem) {\n      if (!!menuItem) {\n        _this._viewModel.menuVisible(true);\n\n        _this._viewModel.menuItemClick(menuItem);\n      }\n    };\n\n    _this.toolboxGroups = ko.observableArray();\n\n    _this.addToolboxItem = function (groupName, toolboxItem) {\n      var group = _this._findToolboxGroup(groupName);\n\n      if (!!group) {\n        group.items.push(toolboxItem);\n      } else {\n        throw Error(\"The '\" + groupName + \"' group does not exist.\");\n      }\n    };\n\n    _this.removeToolboxItem = function (groupName, toolboxItemName) {\n      var group = _this._findToolboxGroup(groupName);\n\n      if (group) {\n        _this._unregisterToolboxItem(group, toolboxItemName);\n      } else {\n        throw Error(\"The '\" + groupName + \"' group does not exist.\");\n      }\n    };\n\n    _this.toolbarGroups = ko.observableArray();\n\n    _this.addToolbarItem = function (groupName, toolbarItem) {\n      var group = _this.toolbarGroups().filter(function (group) {\n        return group.name === groupName;\n      })[0];\n\n      if (!!group) {\n        group.items.push(toolbarItem);\n      } else {\n        throw Error(\"The '\" + groupName + \"' group does not exist.\");\n      }\n    };\n\n    _this.removeToolbarItem = function (groupName, toolbarItemName) {\n      var group = _this.toolbarGroups().filter(function (group) {\n        return group.name === groupName;\n      })[0];\n\n      if (!!group) {\n        var toolbarItem = group.items().filter(function (item) {\n          return item.name === toolbarItemName;\n        })[0];\n        group.items.remove(toolbarItem);\n      } else {\n        throw Error(\"The '\" + groupName + \"' group does not exist.\");\n      }\n    };\n\n    _this.showPanelAsync = function (options) {\n      return _this._showPanelAsync(options, _helpers_1.CancellationToken.None);\n    };\n\n    _this._showPanelAsync = function (options, cancellationToken) {\n      var def = _jquery_helpers_1.createJQueryDeferred();\n\n      if (cancellationToken.canceled) def.reject();else {\n        _this._viewModel.showDesignerPanel();\n\n        setTimeout(function () {\n          if (!cancellationToken.canceled) {\n            options.surfaceLeft = _toolbox_extension_1.toolboxConstants.leftPanelWidth;\n            def.resolve(options);\n          } else {\n            def.reject();\n          }\n        }, 500);\n      }\n      return def.promise();\n    };\n\n    _this.hidePanelAsync = function (options) {\n      return _this._hidePanelAsync(options, _helpers_1.CancellationToken.None);\n    };\n\n    _this._hidePanelAsync = function (options, cancellationToken) {\n      var def = _jquery_helpers_1.createJQueryDeferred();\n\n      if (cancellationToken.canceled) def.reject();else {\n        _this._viewModel.hideDesignerPanel();\n\n        setTimeout(function () {\n          if (!cancellationToken.canceled) {\n            options.surfaceLeft = 0;\n            def.resolve(options);\n          } else {\n            def.reject();\n          }\n        }, 500);\n      }\n      return def.promise();\n    };\n\n    _this._layoutItemPlaceholderService = function (layoutItem) {\n      var currentDashboardItem = layoutItem._parent().viewModel.model;\n\n      return {\n        data: {\n          dashboardItems: ko.computed(function () {\n            var placeholderItems = [];\n\n            _this._viewModel.toolboxGroupsSorted().forEach(function (group) {\n              group.items().filter(function (toolboxItem) {\n                return model_1.DashboardLayoutNode._canAttach(currentDashboardItem, {\n                  '@ItemType': toolboxItem.type\n                });\n              }).forEach(function (toolboxItem) {\n                placeholderItems.push({\n                  type: toolboxItem.type,\n                  name: toolboxItem.name,\n                  iconName: toolboxItem.icon,\n                  title: toolboxItem.title\n                });\n              });\n            });\n\n            return placeholderItems;\n          }),\n          addDashboardItem: function (data) {\n            layoutItem.create(_dashboard_item_helper_1.getItemJson(data.type), 'left');\n          }\n        },\n        name: 'dx-toolbox-extension-layout-item-placeholder'\n      };\n    };\n\n    var cancelableDesignerToViewerAction = {\n      orderNo: 40,\n      action: function (options) {\n        _this.closeMenu();\n\n        return _this.hidePanelAsync(options);\n      },\n      cancelableAction: function (options, cancellationToken) {\n        _this.closeMenu();\n\n        return _this._hidePanelAsync(options, cancellationToken);\n      }\n    };\n    _this.designerToViewerAction = cancelableDesignerToViewerAction;\n    var cancelableViewerToDesignerAction = {\n      orderNo: 40,\n      action: _this.showPanelAsync,\n      cancelableAction: _this._showPanelAsync\n    };\n    _this.viewerToDesignerAction = cancelableViewerToDesignerAction;\n\n    _this._createDefaultGroups();\n\n    var draggableController = index_internal_1.safeComputed({\n      dockingLayoutController: _this.dashboardControl._dockingLayoutAdapter._dockingLayoutController\n    }, function (args) {\n      if (args.dockingLayoutController) {\n        return args.dockingLayoutController.dragController;\n      }\n    });\n\n    _this.toDispose(draggableController);\n\n    _this._viewModel = new _toolbox_view_model_1.ToolboxViewModel(dashboardControl.isDesignMode(), _this.dashboardControl, _this.menuItems, _this.toolboxGroups, _this.toolbarGroups, draggableController);\n    _this.template = {\n      data: _this._viewModel,\n      name: 'dx-dashboard-toolbox-extension'\n    };\n\n    if (dashboardControl.isDesignMode()) {\n      dashboardControl.surfaceLeft(_toolbox_extension_1.toolboxConstants.leftPanelWidth);\n    }\n\n    dashboardControl.subscribeExtensionsChanged({\n      added: function (extension) {\n        if (extension.name === 'dashboard-panel') {\n          _this._switchToViewerToolbar = new toolbox_items_1.DashboardToolbarGroup('viewer-button', '', 100);\n          var toViewerItem = new toolbox_items_1.DashboardToolbarItem('toviewer', function () {\n            return dashboardControl.switchToViewer();\n          });\n          toViewerItem.template = 'dx-dashboard-working-mode-extension-viewer-button';\n          toViewerItem.disabled = ko.pureComputed(function () {\n            return !!_this.dashboardControl.dashboard();\n          });\n\n          _this._switchToViewerToolbar.items.push(toViewerItem);\n\n          _this.toolbarGroups.push(_this._switchToViewerToolbar);\n        }\n      },\n      deleted: function (extension) {\n        if (extension.name === 'dashboard-panel') {\n          _this.toolbarGroups.remove(_this._switchToViewerToolbar);\n        }\n      }\n    });\n\n    _obsolete_helper_1.defineObsoleteProperty({\n      target: _this,\n      memberName: 'settingsForm',\n      oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.settingsForm',\n      newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.DashboardMenuItem.template',\n      action: function () {\n        return _this._viewModel.settingsForm;\n      }\n    });\n\n    _obsolete_helper_1.defineObsoleteProperty({\n      target: _this,\n      memberName: 'settingsFormVisible',\n      oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.settingsFormVisible',\n      newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.DashboardMenuItem.template',\n      action: function () {\n        return _this._viewModel.settingsFormVisible;\n      }\n    });\n\n    _obsolete_helper_1.defineObsoleteProperty({\n      target: _this,\n      memberName: 'toggleMenu',\n      oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.toggleMenu',\n      newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.ToolboxExtension.openMenu/closeMenu',\n      action: function () {\n        return _this._viewModel.toggleMenu;\n      }\n    });\n\n    _obsolete_helper_1.defineObsoleteMethod({\n      target: _this,\n      memberName: 'menuItemClick',\n      oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.menuItemClick',\n      newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.ToolboxExtension.selectMenuItem',\n      action: function (menuItem) {\n        return _this._viewModel.menuItemClick(menuItem);\n      }\n    });\n\n    return _this;\n  }\n\n  Object.defineProperty(ToolboxExtension.prototype, \"menuVisible\", {\n    get: function () {\n      return this._viewModel.menuVisible;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ToolboxExtension.prototype.openMenu = function () {\n    this._viewModel.showMenu();\n  };\n\n  ToolboxExtension.prototype.closeMenu = function () {\n    this._viewModel.closeMenu();\n  };\n\n  ToolboxExtension.prototype.processKeyEvent = function (keyEventType, eventArgs) {\n    return this._viewModel.processKeyEvent(keyEventType, eventArgs);\n  };\n\n  ToolboxExtension.prototype.start = function () {\n    var _this = this;\n\n    var standardItems = Object.keys(serializable_model_1.itemTypesMap).filter(function (key) {\n      return !serializable_model_1.itemTypesMap[key].customItemType;\n    });\n    var itemTypeNames = standardItems.sort(function (t1, t2) {\n      return serializable_model_1.itemTypesMap[t1].index - serializable_model_1.itemTypesMap[t2].index;\n    });\n    itemTypeNames.forEach(function (itemTypeName) {\n      return _this._registerToolboxItem(itemTypeName, serializable_model_1.itemTypesMap[itemTypeName]);\n    });\n    this.dashboardControl.extensions.forEach(function (extension) {\n      return _this._registerCustomItemToolbox(extension);\n    });\n    this.toDispose(this.dashboardControl.subscribeExtensionsChanged({\n      added: function (extension) {\n        _this._registerCustomItemToolbox(extension);\n      },\n      deleted: function (extension) {\n        _this.toolboxGroups().forEach(function (group) {\n          return _this._unregisterToolboxItem(group, extension.name);\n        });\n      }\n    }));\n    index_internal_1.subscribeAndPerform(this.dashboardControl._actualLayoutController, function (layout) {\n      if (layout && layout instanceof _docking_layout_controller_1.DockingLayoutController) {\n        layout.layoutItemPlaceholderService = _this._layoutItemPlaceholderService;\n      }\n    });\n  };\n\n  ToolboxExtension.prototype.stop = function () {\n    this.dashboardControl.surfaceLeft(0);\n  };\n\n  ToolboxExtension.prototype._registerCustomItemToolbox = function (extension) {\n    var customItemExtension = extension;\n\n    if (customItemExtension.metaData) {\n      this._registerToolboxItem(customItemExtension.name, customItemExtension.metaData);\n    }\n  };\n\n  ToolboxExtension.prototype._createDefaultGroups = function () {\n    this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('common', 'DashboardWebStringId.AccordionTab.Common', 100));\n    this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('maps', 'DashboardStringId.DescriptionMaps', 110));\n    this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('filter', 'DashboardWebStringId.DataSources.Filter', 120));\n    this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('layout', 'DashboardWebStringId.AccordionTab.Layout', 130));\n  };\n\n  ToolboxExtension.prototype._registerToolboxItem = function (itemTypeName, itemDescription) {\n    var _this = this;\n\n    var group = this._findToolboxGroup(itemDescription.groupName) || this._findToolboxGroup('custom');\n\n    if (!group) {\n      group = new toolbox_items_1.DashboardToolboxGroup('custom', 'DashboardStringId.CustomItems', 130);\n      this.toolboxGroups.push(group);\n    }\n\n    var itemClickHandlerCreator = function (type) {\n      return function () {\n        var layout = _this.dashboardControl._actualLayoutController();\n\n        layout && layout instanceof _docking_layout_controller_1.DockingLayoutController && layout.addDashboardItem({\n          type: type\n        });\n      };\n    };\n\n    var item = new toolbox_items_1.DashboardToolboxItem(itemTypeName, itemClickHandlerCreator(itemTypeName), _dashboard_item_helper_1.getIconName(itemTypeName, itemDescription.icon), itemDescription.title, itemTypeName);\n    item.disabled = ko.computed(function () {\n      return !_this.dashboardControl.dashboard();\n    });\n    group.items.push(item);\n    return itemClickHandlerCreator;\n  };\n\n  ToolboxExtension.prototype._unregisterToolboxItem = function (group, toolboxItemName) {\n    var toolboxItem = group.items().filter(function (item) {\n      return item.name === toolboxItemName;\n    })[0];\n\n    if (!!toolboxItem) {\n      group.items.remove(toolboxItem);\n    }\n  };\n\n  ToolboxExtension.prototype._findToolboxGroup = function (groupName) {\n    return this.toolboxGroups().filter(function (gr) {\n      return gr.name === groupName;\n    })[0];\n  };\n\n  ToolboxExtension.prototype._findMenuItem = function (menuItemId) {\n    return this.menuItems().filter(function (mi) {\n      return mi.id === menuItemId;\n    })[0];\n  };\n\n  return ToolboxExtension;\n}(disposable_object_1.DisposableObject);\n\nexports.ToolboxExtension = ToolboxExtension;\n\ncontrol_options_1.designerExtensions['toolbox'] = function (dashboardControl, options) {\n  return new ToolboxExtension(dashboardControl);\n};\n\ncontrol_options_1.extensionNameMap['toolbox'] = nameAlias;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/toolbox-extension/toolbox-extension.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","ToolboxExtension","ko","require","control_options_1","_docking_layout_controller_1","_helpers_1","_jquery_helpers_1","model_1","disposable_object_1","index_internal_1","_dashboard_item_helper_1","_obsolete_helper_1","serializable_model_1","toolbox_items_1","_toolbox_extension_1","_toolbox_view_model_1","nameAlias","_super","dashboardControl","_this","name","menuItems","observableArray","addMenuItem","menuItem","_findMenuItem","id","Error","push","removeMenuItem","menuItemId","remove","selectMenuItem","_viewModel","menuVisible","menuItemClick","toolboxGroups","addToolboxItem","groupName","toolboxItem","group","_findToolboxGroup","items","removeToolboxItem","toolboxItemName","_unregisterToolboxItem","toolbarGroups","addToolbarItem","toolbarItem","filter","removeToolbarItem","toolbarItemName","item","showPanelAsync","options","_showPanelAsync","CancellationToken","None","cancellationToken","def","createJQueryDeferred","canceled","reject","showDesignerPanel","setTimeout","surfaceLeft","toolboxConstants","leftPanelWidth","resolve","promise","hidePanelAsync","_hidePanelAsync","hideDesignerPanel","_layoutItemPlaceholderService","layoutItem","currentDashboardItem","_parent","viewModel","model","data","dashboardItems","computed","placeholderItems","toolboxGroupsSorted","forEach","DashboardLayoutNode","_canAttach","type","iconName","icon","title","addDashboardItem","getItemJson","cancelableDesignerToViewerAction","orderNo","action","closeMenu","cancelableAction","designerToViewerAction","cancelableViewerToDesignerAction","viewerToDesignerAction","_createDefaultGroups","draggableController","safeComputed","dockingLayoutController","_dockingLayoutAdapter","_dockingLayoutController","args","dragController","toDispose","ToolboxViewModel","isDesignMode","template","subscribeExtensionsChanged","added","extension","_switchToViewerToolbar","DashboardToolbarGroup","toViewerItem","DashboardToolbarItem","switchToViewer","disabled","pureComputed","dashboard","deleted","defineObsoleteProperty","target","memberName","oldMemberDisplayName","newMemberDisplayName","settingsForm","settingsFormVisible","toggleMenu","defineObsoleteMethod","get","enumerable","configurable","openMenu","showMenu","processKeyEvent","keyEventType","eventArgs","start","standardItems","keys","itemTypesMap","key","customItemType","itemTypeNames","sort","t1","t2","index","itemTypeName","_registerToolboxItem","extensions","_registerCustomItemToolbox","subscribeAndPerform","_actualLayoutController","layout","DockingLayoutController","layoutItemPlaceholderService","stop","customItemExtension","metaData","DashboardToolboxGroup","itemDescription","itemClickHandlerCreator","DashboardToolboxItem","getIconName","gr","mi","DisposableObject","designerExtensions","extensionNameMap"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (toolbox-extension.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ToolboxExtension = void 0;\nvar ko = require(\"knockout\");\nvar control_options_1 = require(\"../../common/control-options\");\nvar _docking_layout_controller_1 = require(\"../../common/docking-layout/_docking-layout-controller\");\nvar _helpers_1 = require(\"../../common/_helpers\");\nvar _jquery_helpers_1 = require(\"../../data/_jquery-helpers\");\nvar model_1 = require(\"../../model\");\nvar disposable_object_1 = require(\"../../model/disposable-object\");\nvar index_internal_1 = require(\"../../model/index.internal\");\nvar _dashboard_item_helper_1 = require(\"../../model/internal/_dashboard-item_helper\");\nvar _obsolete_helper_1 = require(\"../../model/internal/_obsolete-helper\");\nvar serializable_model_1 = require(\"../../model/serializable-model\");\nvar toolbox_items_1 = require(\"./toolbox-items\");\nvar _toolbox_extension_1 = require(\"./_toolbox-extension\");\nvar _toolbox_view_model_1 = require(\"./_toolbox-view-model\");\nvar nameAlias = 'toolbox';\nvar ToolboxExtension = (function (_super) {\n    __extends(ToolboxExtension, _super);\n    function ToolboxExtension(dashboardControl) {\n        var _this = _super.call(this) || this;\n        _this.dashboardControl = dashboardControl;\n        _this.name = 'toolbox';\n        _this.menuItems = ko.observableArray();\n        _this.addMenuItem = function (menuItem) {\n            if (!!_this._findMenuItem(menuItem.id)) {\n                throw Error(\"The '\" + menuItem.id + \"' menu item already exists.\");\n            }\n            _this.menuItems.push(menuItem);\n        };\n        _this.removeMenuItem = function (menuItemId) {\n            var menuItem = _this._findMenuItem(menuItemId);\n            _this.menuItems.remove(menuItem);\n        };\n        _this.selectMenuItem = function (menuItem) {\n            if (!!menuItem) {\n                _this._viewModel.menuVisible(true);\n                _this._viewModel.menuItemClick(menuItem);\n            }\n        };\n        _this.toolboxGroups = ko.observableArray();\n        _this.addToolboxItem = function (groupName, toolboxItem) {\n            var group = _this._findToolboxGroup(groupName);\n            if (!!group) {\n                group.items.push(toolboxItem);\n            }\n            else {\n                throw Error(\"The '\" + groupName + \"' group does not exist.\");\n            }\n        };\n        _this.removeToolboxItem = function (groupName, toolboxItemName) {\n            var group = _this._findToolboxGroup(groupName);\n            if (group) {\n                _this._unregisterToolboxItem(group, toolboxItemName);\n            }\n            else {\n                throw Error(\"The '\" + groupName + \"' group does not exist.\");\n            }\n        };\n        _this.toolbarGroups = ko.observableArray();\n        _this.addToolbarItem = function (groupName, toolbarItem) {\n            var group = _this.toolbarGroups().filter(function (group) { return group.name === groupName; })[0];\n            if (!!group) {\n                group.items.push(toolbarItem);\n            }\n            else {\n                throw Error(\"The '\" + groupName + \"' group does not exist.\");\n            }\n        };\n        _this.removeToolbarItem = function (groupName, toolbarItemName) {\n            var group = _this.toolbarGroups().filter(function (group) { return group.name === groupName; })[0];\n            if (!!group) {\n                var toolbarItem = group.items().filter(function (item) { return item.name === toolbarItemName; })[0];\n                group.items.remove(toolbarItem);\n            }\n            else {\n                throw Error(\"The '\" + groupName + \"' group does not exist.\");\n            }\n        };\n        _this.showPanelAsync = function (options) {\n            return _this._showPanelAsync(options, _helpers_1.CancellationToken.None);\n        };\n        _this._showPanelAsync = function (options, cancellationToken) {\n            var def = _jquery_helpers_1.createJQueryDeferred();\n            if (cancellationToken.canceled)\n                def.reject();\n            else {\n                _this._viewModel.showDesignerPanel();\n                setTimeout(function () {\n                    if (!cancellationToken.canceled) {\n                        options.surfaceLeft = _toolbox_extension_1.toolboxConstants.leftPanelWidth;\n                        def.resolve(options);\n                    }\n                    else {\n                        def.reject();\n                    }\n                }, 500);\n            }\n            return def.promise();\n        };\n        _this.hidePanelAsync = function (options) {\n            return _this._hidePanelAsync(options, _helpers_1.CancellationToken.None);\n        };\n        _this._hidePanelAsync = function (options, cancellationToken) {\n            var def = _jquery_helpers_1.createJQueryDeferred();\n            if (cancellationToken.canceled)\n                def.reject();\n            else {\n                _this._viewModel.hideDesignerPanel();\n                setTimeout(function () {\n                    if (!cancellationToken.canceled) {\n                        options.surfaceLeft = 0;\n                        def.resolve(options);\n                    }\n                    else {\n                        def.reject();\n                    }\n                }, 500);\n            }\n            return def.promise();\n        };\n        _this._layoutItemPlaceholderService = function (layoutItem) {\n            var currentDashboardItem = layoutItem._parent().viewModel.model;\n            return {\n                data: {\n                    dashboardItems: ko.computed(function () {\n                        var placeholderItems = [];\n                        _this._viewModel.toolboxGroupsSorted().forEach(function (group) {\n                            group\n                                .items()\n                                .filter(function (toolboxItem) { return model_1.DashboardLayoutNode._canAttach(currentDashboardItem, { '@ItemType': toolboxItem.type }); })\n                                .forEach(function (toolboxItem) {\n                                placeholderItems.push({\n                                    type: toolboxItem.type,\n                                    name: toolboxItem.name,\n                                    iconName: toolboxItem.icon,\n                                    title: toolboxItem.title\n                                });\n                            });\n                        });\n                        return placeholderItems;\n                    }),\n                    addDashboardItem: function (data) {\n                        layoutItem.create(_dashboard_item_helper_1.getItemJson(data.type), 'left');\n                    }\n                },\n                name: 'dx-toolbox-extension-layout-item-placeholder'\n            };\n        };\n        var cancelableDesignerToViewerAction = {\n            orderNo: 40,\n            action: function (options) {\n                _this.closeMenu();\n                return _this.hidePanelAsync(options);\n            },\n            cancelableAction: function (options, cancellationToken) {\n                _this.closeMenu();\n                return _this._hidePanelAsync(options, cancellationToken);\n            }\n        };\n        _this.designerToViewerAction = cancelableDesignerToViewerAction;\n        var cancelableViewerToDesignerAction = {\n            orderNo: 40,\n            action: _this.showPanelAsync,\n            cancelableAction: _this._showPanelAsync\n        };\n        _this.viewerToDesignerAction = cancelableViewerToDesignerAction;\n        _this._createDefaultGroups();\n        var draggableController = index_internal_1.safeComputed({ dockingLayoutController: _this.dashboardControl._dockingLayoutAdapter._dockingLayoutController }, function (args) {\n            if (args.dockingLayoutController) {\n                return args.dockingLayoutController.dragController;\n            }\n        });\n        _this.toDispose(draggableController);\n        _this._viewModel = new _toolbox_view_model_1.ToolboxViewModel(dashboardControl.isDesignMode(), _this.dashboardControl, _this.menuItems, _this.toolboxGroups, _this.toolbarGroups, draggableController);\n        _this.template = {\n            data: _this._viewModel,\n            name: 'dx-dashboard-toolbox-extension'\n        };\n        if (dashboardControl.isDesignMode()) {\n            dashboardControl.surfaceLeft(_toolbox_extension_1.toolboxConstants.leftPanelWidth);\n        }\n        dashboardControl.subscribeExtensionsChanged({\n            added: function (extension) {\n                if (extension.name === 'dashboard-panel') {\n                    _this._switchToViewerToolbar = new toolbox_items_1.DashboardToolbarGroup('viewer-button', '', 100);\n                    var toViewerItem = new toolbox_items_1.DashboardToolbarItem('toviewer', function () { return dashboardControl.switchToViewer(); });\n                    toViewerItem.template = 'dx-dashboard-working-mode-extension-viewer-button';\n                    toViewerItem.disabled = ko.pureComputed(function () { return !!_this.dashboardControl.dashboard(); });\n                    _this._switchToViewerToolbar.items.push(toViewerItem);\n                    _this.toolbarGroups.push(_this._switchToViewerToolbar);\n                }\n            },\n            deleted: function (extension) {\n                if (extension.name === 'dashboard-panel') {\n                    _this.toolbarGroups.remove(_this._switchToViewerToolbar);\n                }\n            }\n        });\n        _obsolete_helper_1.defineObsoleteProperty({\n            target: _this,\n            memberName: 'settingsForm',\n            oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.settingsForm',\n            newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.DashboardMenuItem.template',\n            action: function () { return _this._viewModel.settingsForm; }\n        });\n        _obsolete_helper_1.defineObsoleteProperty({\n            target: _this,\n            memberName: 'settingsFormVisible',\n            oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.settingsFormVisible',\n            newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.DashboardMenuItem.template',\n            action: function () { return _this._viewModel.settingsFormVisible; }\n        });\n        _obsolete_helper_1.defineObsoleteProperty({\n            target: _this,\n            memberName: 'toggleMenu',\n            oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.toggleMenu',\n            newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.ToolboxExtension.openMenu/closeMenu',\n            action: function () { return _this._viewModel.toggleMenu; }\n        });\n        _obsolete_helper_1.defineObsoleteMethod({\n            target: _this,\n            memberName: 'menuItemClick',\n            oldMemberDisplayName: 'DevExpress.Dashboard.Designer.ToolboxExtension.menuItemClick',\n            newMemberDisplayName: 'DevExpress.Dasbhoard.Designer.ToolboxExtension.selectMenuItem',\n            action: function (menuItem) { return _this._viewModel.menuItemClick(menuItem); }\n        });\n        return _this;\n    }\n    Object.defineProperty(ToolboxExtension.prototype, \"menuVisible\", {\n        get: function () { return this._viewModel.menuVisible; },\n        enumerable: false,\n        configurable: true\n    });\n    ToolboxExtension.prototype.openMenu = function () {\n        this._viewModel.showMenu();\n    };\n    ToolboxExtension.prototype.closeMenu = function () {\n        this._viewModel.closeMenu();\n    };\n    ToolboxExtension.prototype.processKeyEvent = function (keyEventType, eventArgs) {\n        return this._viewModel.processKeyEvent(keyEventType, eventArgs);\n    };\n    ToolboxExtension.prototype.start = function () {\n        var _this = this;\n        var standardItems = Object.keys(serializable_model_1.itemTypesMap).filter(function (key) { return !serializable_model_1.itemTypesMap[key].customItemType; });\n        var itemTypeNames = standardItems.sort(function (t1, t2) { return serializable_model_1.itemTypesMap[t1].index - serializable_model_1.itemTypesMap[t2].index; });\n        itemTypeNames.forEach(function (itemTypeName) { return _this._registerToolboxItem(itemTypeName, serializable_model_1.itemTypesMap[itemTypeName]); });\n        this.dashboardControl.extensions.forEach(function (extension) { return _this._registerCustomItemToolbox(extension); });\n        this.toDispose(this.dashboardControl.subscribeExtensionsChanged({\n            added: function (extension) {\n                _this._registerCustomItemToolbox(extension);\n            },\n            deleted: function (extension) {\n                _this.toolboxGroups().forEach(function (group) { return _this._unregisterToolboxItem(group, extension.name); });\n            }\n        }));\n        index_internal_1.subscribeAndPerform(this.dashboardControl._actualLayoutController, function (layout) {\n            if (layout && layout instanceof _docking_layout_controller_1.DockingLayoutController) {\n                layout.layoutItemPlaceholderService = _this._layoutItemPlaceholderService;\n            }\n        });\n    };\n    ToolboxExtension.prototype.stop = function () {\n        this.dashboardControl.surfaceLeft(0);\n    };\n    ToolboxExtension.prototype._registerCustomItemToolbox = function (extension) {\n        var customItemExtension = extension;\n        if (customItemExtension.metaData) {\n            this._registerToolboxItem(customItemExtension.name, customItemExtension.metaData);\n        }\n    };\n    ToolboxExtension.prototype._createDefaultGroups = function () {\n        this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('common', 'DashboardWebStringId.AccordionTab.Common', 100));\n        this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('maps', 'DashboardStringId.DescriptionMaps', 110));\n        this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('filter', 'DashboardWebStringId.DataSources.Filter', 120));\n        this.toolboxGroups.push(new toolbox_items_1.DashboardToolboxGroup('layout', 'DashboardWebStringId.AccordionTab.Layout', 130));\n    };\n    ToolboxExtension.prototype._registerToolboxItem = function (itemTypeName, itemDescription) {\n        var _this = this;\n        var group = this._findToolboxGroup(itemDescription.groupName) || this._findToolboxGroup('custom');\n        if (!group) {\n            group = new toolbox_items_1.DashboardToolboxGroup('custom', 'DashboardStringId.CustomItems', 130);\n            this.toolboxGroups.push(group);\n        }\n        var itemClickHandlerCreator = function (type) { return function () {\n            var layout = _this.dashboardControl._actualLayoutController();\n            layout && layout instanceof _docking_layout_controller_1.DockingLayoutController && layout.addDashboardItem({ type: type });\n        }; };\n        var item = new toolbox_items_1.DashboardToolboxItem(itemTypeName, itemClickHandlerCreator(itemTypeName), _dashboard_item_helper_1.getIconName(itemTypeName, itemDescription.icon), itemDescription.title, itemTypeName);\n        item.disabled = ko.computed(function () { return !_this.dashboardControl.dashboard(); });\n        group.items.push(item);\n        return itemClickHandlerCreator;\n    };\n    ToolboxExtension.prototype._unregisterToolboxItem = function (group, toolboxItemName) {\n        var toolboxItem = group.items().filter(function (item) { return item.name === toolboxItemName; })[0];\n        if (!!toolboxItem) {\n            group.items.remove(toolboxItem);\n        }\n    };\n    ToolboxExtension.prototype._findToolboxGroup = function (groupName) {\n        return this.toolboxGroups().filter(function (gr) { return gr.name === groupName; })[0];\n    };\n    ToolboxExtension.prototype._findMenuItem = function (menuItemId) {\n        return this.menuItems().filter(function (mi) { return mi.id === menuItemId; })[0];\n    };\n    return ToolboxExtension;\n}(disposable_object_1.DisposableObject));\nexports.ToolboxExtension = ToolboxExtension;\ncontrol_options_1.designerExtensions['toolbox'] = function (dashboardControl, options) { return new ToolboxExtension(dashboardControl); };\ncontrol_options_1.extensionNameMap['toolbox'] = nameAlias;\n"]},"metadata":{},"sourceType":"script"}