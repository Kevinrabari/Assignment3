{"ast":null,"code":"/**\n* DevExpress Analytics (widgets\\treelist\\_treeListSearchViewModel.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TreeListSearchViewModel = exports.TreeListSearchOptions = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar _utils_1 = require(\"../../property-grid/widgets/internal/_utils\");\n\nvar utils_1 = require(\"../../serializer/utils\");\n\nvar _localization_1 = require(\"../../property-grid/localization/_localization\");\n\nvar templateUtils_1 = require(\"../../property-grid/widgets/templateUtils\");\n\nvar TreeListSearchOptions = function () {\n  function TreeListSearchOptions() {\n    this.globalMatch = true;\n    this.canUseRegex = false;\n    this.caseSensitive = false;\n    this.searchMode = _utils_1.SearchMode.contains;\n    this.searchTimeout = 500;\n    this.searchExpr = 'displayName';\n    this.searchBoxTemplate = 'dx-treelist-searchbox';\n  }\n\n  return TreeListSearchOptions;\n}();\n\nexports.TreeListSearchOptions = TreeListSearchOptions;\n\nvar TreeListSearchViewModel = function (_super) {\n  __extends(TreeListSearchViewModel, _super);\n\n  function TreeListSearchViewModel() {\n    var _this = _super.call(this) || this;\n\n    _this._processedNodes = [];\n    _this._currentProcess = [];\n    _this.searchTimeout = 500;\n    _this._roots = [];\n\n    _this.searchPlaceholder = function () {\n      return _localization_1.searchPlaceholder();\n    };\n\n    var _textToSearch = ko.observable('');\n\n    var timeout = null;\n\n    _this._disposables.push(_this.value = ko.computed({\n      read: function () {\n        return _textToSearch();\n      },\n      write: function (newVal) {\n        clearTimeout(timeout);\n        timeout = setTimeout(function () {\n          _textToSearch(newVal);\n        }, _this.searchTimeout);\n      }\n    }));\n\n    _this._disposables.push(_this.value.subscribe(function (newValue) {\n      return _this.valueChanged(newValue);\n    }));\n\n    return _this;\n  }\n\n  TreeListSearchViewModel.createController = function (element, controllers, modelType, templateName) {\n    if (modelType === void 0) {\n      modelType = TreeListSearchViewModel;\n    }\n\n    if (templateName === void 0) {\n      templateName = 'dx-treelist-search-panel';\n    }\n\n    var model = new modelType();\n    var $element = $(element);\n    var subscriptions = [];\n    controllers.forEach(function (controller) {\n      if (!controller) return;\n      controller.root = controller.root || ko.observable();\n      subscriptions.push(controller.root.subscribe(function (newRoot) {\n        model.addController(newRoot);\n        model.valueChanged('');\n      }));\n    });\n\n    model._disposables.push({\n      dispose: function () {\n        controllers.forEach(function (controller) {\n          if (controller) {\n            controller.root(null);\n            delete controller.root;\n          }\n        });\n      }\n    });\n\n    var template = templateUtils_1.getTemplate(templateName);\n    $element.addClass('dxrd-treelist-search-panel-container').addClass('dxd-border-primary');\n    $element.children().remove();\n    $element.append(template);\n    ko.cleanNode($element.children()[0]);\n    ko.applyBindings(model, $element.children()[0]);\n\n    var disposeCallback = function () {\n      subscriptions.forEach(function (x) {\n        return x.dispose();\n      });\n      model && model.dispose();\n      ko.utils.domNodeDisposal.removeDisposeCallback(element, disposeCallback);\n    };\n\n    ko.utils.domNodeDisposal.addDisposeCallback(element, disposeCallback);\n  };\n\n  TreeListSearchViewModel.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this.clearProcess();\n  };\n\n  TreeListSearchViewModel.prototype.clearProcess = function () {\n    this._currentProcess.forEach(function (x) {\n      return x.stop && x.stop();\n    });\n\n    this._currentProcess = [];\n    this._processedNodes = [];\n  };\n\n  TreeListSearchViewModel.prototype.valueChanged = function (newValue) {\n    var _this = this;\n\n    if (!newValue) this._processedNodes.forEach(function (x) {\n      return x.setVisible(true);\n    });\n    this.clearProcess();\n\n    this._roots.forEach(function (root) {\n      root.treeListController.textToSearch(newValue);\n\n      if (newValue) {\n        _this._currentProcess.push(root.walkOnTree(function (node) {\n          var regexResult = _utils_1.findMatchesInString(node.data[root.treeListController.searchOptions.searchExpr], newValue, root.treeListController.searchOptions);\n\n          _this._processedNodes.push(node);\n\n          node.setVisible(!!regexResult);\n          regexResult && _this._collapseTreeBranch(node);\n        }));\n      } else {\n        root.items.valueHasMutated();\n      }\n    });\n  };\n\n  TreeListSearchViewModel.prototype._collapseTreeBranch = function (node) {\n    if (node.parent) {\n      if (node.parent.collapsed()) node.parent.toggleCollapsed();\n\n      this._collapseTreeBranch(node.parent);\n    }\n  };\n\n  TreeListSearchViewModel.prototype.addController = function (root) {\n    this._roots = this._roots.filter(function (a) {\n      return !a.isDisposing;\n    });\n    root.treeListController.textToSearch = root.treeListController.textToSearch || ko.observable('');\n    if (this._roots.indexOf(root) === -1) this._roots.push(root);\n    this.searchTimeout = Math.max.apply(Math, this._roots.map(function (x) {\n      return x.treeListController.searchOptions.searchTimeout;\n    })) || 500;\n  };\n\n  return TreeListSearchViewModel;\n}(utils_1.Disposable);\n\nexports.TreeListSearchViewModel = TreeListSearchViewModel;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/widgets/treelist/_treeListSearchViewModel.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","TreeListSearchViewModel","TreeListSearchOptions","ko","require","$","_utils_1","utils_1","_localization_1","templateUtils_1","globalMatch","canUseRegex","caseSensitive","searchMode","SearchMode","contains","searchTimeout","searchExpr","searchBoxTemplate","_super","_this","_processedNodes","_currentProcess","_roots","searchPlaceholder","_textToSearch","observable","timeout","_disposables","push","computed","read","write","newVal","clearTimeout","setTimeout","subscribe","newValue","valueChanged","createController","element","controllers","modelType","templateName","model","$element","subscriptions","forEach","controller","root","newRoot","addController","dispose","template","getTemplate","addClass","children","remove","append","cleanNode","applyBindings","disposeCallback","x","utils","domNodeDisposal","removeDisposeCallback","addDisposeCallback","clearProcess","stop","setVisible","treeListController","textToSearch","walkOnTree","node","regexResult","findMatchesInString","data","searchOptions","_collapseTreeBranch","items","valueHasMutated","parent","collapsed","toggleCollapsed","filter","a","isDisposing","indexOf","Math","max","apply","map","Disposable"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (widgets\\treelist\\_treeListSearchViewModel.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TreeListSearchViewModel = exports.TreeListSearchOptions = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar _utils_1 = require(\"../../property-grid/widgets/internal/_utils\");\nvar utils_1 = require(\"../../serializer/utils\");\nvar _localization_1 = require(\"../../property-grid/localization/_localization\");\nvar templateUtils_1 = require(\"../../property-grid/widgets/templateUtils\");\nvar TreeListSearchOptions = (function () {\n    function TreeListSearchOptions() {\n        this.globalMatch = true;\n        this.canUseRegex = false;\n        this.caseSensitive = false;\n        this.searchMode = _utils_1.SearchMode.contains;\n        this.searchTimeout = 500;\n        this.searchExpr = 'displayName';\n        this.searchBoxTemplate = 'dx-treelist-searchbox';\n    }\n    return TreeListSearchOptions;\n}());\nexports.TreeListSearchOptions = TreeListSearchOptions;\nvar TreeListSearchViewModel = (function (_super) {\n    __extends(TreeListSearchViewModel, _super);\n    function TreeListSearchViewModel() {\n        var _this = _super.call(this) || this;\n        _this._processedNodes = [];\n        _this._currentProcess = [];\n        _this.searchTimeout = 500;\n        _this._roots = [];\n        _this.searchPlaceholder = function () { return _localization_1.searchPlaceholder(); };\n        var _textToSearch = ko.observable('');\n        var timeout = null;\n        _this._disposables.push(_this.value = ko.computed({\n            read: function () { return _textToSearch(); },\n            write: function (newVal) {\n                clearTimeout(timeout);\n                timeout = setTimeout(function () {\n                    _textToSearch(newVal);\n                }, _this.searchTimeout);\n            }\n        }));\n        _this._disposables.push(_this.value.subscribe(function (newValue) { return _this.valueChanged(newValue); }));\n        return _this;\n    }\n    TreeListSearchViewModel.createController = function (element, controllers, modelType, templateName) {\n        if (modelType === void 0) { modelType = TreeListSearchViewModel; }\n        if (templateName === void 0) { templateName = 'dx-treelist-search-panel'; }\n        var model = new modelType();\n        var $element = $(element);\n        var subscriptions = [];\n        controllers.forEach(function (controller) {\n            if (!controller)\n                return;\n            controller.root = controller.root || ko.observable();\n            subscriptions.push(controller.root.subscribe(function (newRoot) {\n                model.addController(newRoot);\n                model.valueChanged('');\n            }));\n        });\n        model._disposables.push({\n            dispose: function () {\n                controllers.forEach(function (controller) {\n                    if (controller) {\n                        controller.root(null);\n                        delete controller.root;\n                    }\n                });\n            }\n        });\n        var template = templateUtils_1.getTemplate(templateName);\n        $element.addClass('dxrd-treelist-search-panel-container').addClass('dxd-border-primary');\n        $element.children().remove();\n        $element.append(template);\n        ko.cleanNode($element.children()[0]);\n        ko.applyBindings(model, $element.children()[0]);\n        var disposeCallback = function () {\n            subscriptions.forEach(function (x) { return x.dispose(); });\n            model && model.dispose();\n            ko.utils.domNodeDisposal.removeDisposeCallback(element, disposeCallback);\n        };\n        ko.utils.domNodeDisposal.addDisposeCallback(element, disposeCallback);\n    };\n    TreeListSearchViewModel.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this.clearProcess();\n    };\n    TreeListSearchViewModel.prototype.clearProcess = function () {\n        this._currentProcess.forEach(function (x) { return x.stop && x.stop(); });\n        this._currentProcess = [];\n        this._processedNodes = [];\n    };\n    TreeListSearchViewModel.prototype.valueChanged = function (newValue) {\n        var _this = this;\n        if (!newValue)\n            this._processedNodes.forEach(function (x) { return x.setVisible(true); });\n        this.clearProcess();\n        this._roots.forEach(function (root) {\n            root.treeListController.textToSearch(newValue);\n            if (newValue) {\n                _this._currentProcess.push(root.walkOnTree(function (node) {\n                    var regexResult = _utils_1.findMatchesInString(node.data[root.treeListController.searchOptions.searchExpr], newValue, root.treeListController.searchOptions);\n                    _this._processedNodes.push(node);\n                    node.setVisible(!!regexResult);\n                    regexResult && _this._collapseTreeBranch(node);\n                }));\n            }\n            else {\n                root.items.valueHasMutated();\n            }\n        });\n    };\n    TreeListSearchViewModel.prototype._collapseTreeBranch = function (node) {\n        if (node.parent) {\n            if (node.parent.collapsed())\n                node.parent.toggleCollapsed();\n            this._collapseTreeBranch(node.parent);\n        }\n    };\n    TreeListSearchViewModel.prototype.addController = function (root) {\n        this._roots = this._roots.filter(function (a) { return !a.isDisposing; });\n        root.treeListController.textToSearch = root.treeListController.textToSearch || ko.observable('');\n        if (this._roots.indexOf(root) === -1)\n            this._roots.push(root);\n        this.searchTimeout = Math.max.apply(Math, this._roots.map(function (x) { return x.treeListController.searchOptions.searchTimeout; })) || 500;\n    };\n    return TreeListSearchViewModel;\n}(utils_1.Disposable));\nexports.TreeListSearchViewModel = TreeListSearchViewModel;\n"]},"metadata":{},"sourceType":"script"}