{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/html_editor/modules/toolbar.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport Quill from \"devextreme-quill\";\nimport $ from \"../../../core/renderer\";\nimport BaseModule from \"./base\";\nimport Toolbar from \"../../toolbar\";\nimport \"../../select_box\";\nimport \"../../color_box/color_view\";\nimport \"../../number_box\";\nimport errors from \"../../widget/ui.errors\";\nimport WidgetCollector from \"./widget_collector\";\nimport { each } from \"../../../core/utils/iterator\";\nimport { isString, isObject, isDefined, isEmptyObject } from \"../../../core/utils/type\";\nimport { extend } from \"../../../core/utils/extend\";\nimport localizationMessage from \"../../../localization/message\";\nimport { titleize, camelize } from \"../../../core/utils/inflector\";\nimport eventsEngine from \"../../../events/core/events_engine\";\nimport { addNamespace } from \"../../../events/utils/index\";\nimport { getTableFormats, TABLE_OPERATIONS } from \"../utils/table_helper\";\nimport { getFormatHandlers, getDefaultClickHandler, ICON_MAP, applyFormat } from \"../utils/toolbar_helper\";\nvar ToolbarModule = BaseModule;\n\nif (Quill) {\n  var TOOLBAR_WRAPPER_CLASS = \"dx-htmleditor-toolbar-wrapper\";\n  var TOOLBAR_CLASS = \"dx-htmleditor-toolbar\";\n  var TOOLBAR_FORMAT_WIDGET_CLASS = \"dx-htmleditor-toolbar-format\";\n  var TOOLBAR_SEPARATOR_CLASS = \"dx-htmleditor-toolbar-separator\";\n  var TOOLBAR_MENU_SEPARATOR_CLASS = \"dx-htmleditor-toolbar-menu-separator\";\n  var ACTIVE_FORMAT_CLASS = \"dx-format-active\";\n  var ICON_CLASS = \"dx-icon\";\n  var SELECTION_CHANGE_EVENT = \"selection-change\";\n  var USER_ACTION = \"user\";\n  var SILENT_ACTION = \"silent\";\n  var FORMAT_HOTKEYS = {\n    66: \"bold\",\n    73: \"italic\",\n    85: \"underline\"\n  };\n  var KEY_CODES = {\n    b: 66,\n    i: 73,\n    u: 85\n  };\n\n  var localize = name => localizationMessage.format(\"dxHtmlEditor-\".concat(camelize(name)));\n\n  var localizeValue = (value, name) => {\n    if (\"header\" === name) {\n      var isHeaderValue = isDefined(value) && false !== value;\n      return isHeaderValue ? \"\".concat(localize(\"heading\"), \" \").concat(value) : localize(\"normalText\");\n    }\n\n    return localize(value) || value;\n  };\n\n  ToolbarModule = class extends BaseModule {\n    constructor(quill, options) {\n      super(quill, options);\n      this._toolbarWidgets = new WidgetCollector();\n      this._formatHandlers = getFormatHandlers(this);\n      this._tableFormats = getTableFormats(quill);\n\n      if (isDefined(options.items)) {\n        this._addCallbacks();\n\n        this._renderToolbar();\n\n        this.quill.on(\"editor-change\", (eventName, newValue, oldValue, eventSource) => {\n          var isSilentMode = eventSource === SILENT_ACTION && isEmptyObject(this.quill.getFormat());\n\n          if (!isSilentMode) {\n            var isSelectionChanged = eventName === SELECTION_CHANGE_EVENT;\n\n            this._updateToolbar(isSelectionChanged);\n          }\n        });\n      }\n    }\n\n    _addCallbacks() {\n      this.addCleanCallback(this.clean.bind(this));\n      this.editorInstance.addContentInitializedCallback(this.updateHistoryWidgets.bind(this));\n    }\n\n    _updateToolbar(isSelectionChanged) {\n      this.updateFormatWidgets(isSelectionChanged);\n      this.updateHistoryWidgets();\n      this.updateTableWidgets();\n    }\n\n    _updateFormatWidget(name, isApplied, formats) {\n      var widget = this._toolbarWidgets.getByName(name);\n\n      if (!widget) {\n        return;\n      }\n\n      if (isApplied) {\n        this._markActiveFormatWidget(name, widget, formats);\n      } else {\n        this._resetFormatWidget(name, widget);\n\n        if (Object.prototype.hasOwnProperty.call(name)) {\n          delete formats[name];\n        }\n      }\n\n      this._toggleClearFormatting(isApplied || !isEmptyObject(formats));\n    }\n\n    _renderToolbar() {\n      var container = this.options.container || this._getContainer();\n\n      this._$toolbar = $(\"<div>\").addClass(TOOLBAR_CLASS).appendTo(container);\n      this._$toolbarContainer = $(container).addClass(TOOLBAR_WRAPPER_CLASS);\n      eventsEngine.on(this._$toolbarContainer, addNamespace(\"mousedown\", this.editorInstance.NAME), e => {\n        e.preventDefault();\n      });\n\n      this._subscribeFormatHotKeys();\n\n      this.toolbarInstance = this.editorInstance._createComponent(this._$toolbar, Toolbar, this.toolbarConfig);\n      this.editorInstance.on(\"optionChanged\", _ref => {\n        var {\n          name: name\n        } = _ref;\n\n        if (\"readOnly\" === name || \"disabled\" === name) {\n          this.toolbarInstance.option(\"disabled\", this.isInteractionDisabled);\n        }\n      });\n    }\n\n    get toolbarConfig() {\n      return {\n        dataSource: this._prepareToolbarItems(),\n        disabled: this.isInteractionDisabled,\n        menuContainer: this._$toolbarContainer,\n        multiline: this.isMultilineMode()\n      };\n    }\n\n    get isInteractionDisabled() {\n      return this.editorInstance.option(\"readOnly\") || this.editorInstance.option(\"disabled\");\n    }\n\n    isMultilineMode() {\n      var _this$options$multili;\n\n      return null !== (_this$options$multili = this.options.multiline) && void 0 !== _this$options$multili ? _this$options$multili : true;\n    }\n\n    clean() {\n      this._toolbarWidgets.clear();\n\n      if (this._$toolbarContainer) {\n        this._$toolbarContainer.empty().removeClass(TOOLBAR_WRAPPER_CLASS);\n      }\n    }\n\n    repaint() {\n      this.toolbarInstance && this.toolbarInstance.repaint();\n    }\n\n    _getContainer() {\n      var $container = $(\"<div>\");\n      this.editorInstance.$element().prepend($container);\n      return $container;\n    }\n\n    _detectRenamedOptions(item) {\n      if (isObject(item)) {\n        each([{\n          newName: \"name\",\n          oldName: \"formatName\"\n        }, {\n          newName: \"acceptedValues\",\n          oldName: \"formatValues\"\n        }], (index, optionName) => {\n          if (Object.prototype.hasOwnProperty.call(item, optionName.oldName)) {\n            errors.log(\"W1016\", optionName.oldName, optionName.newName);\n          }\n        });\n      }\n    }\n\n    _subscribeFormatHotKeys() {\n      this.quill.keyboard.addBinding({\n        which: KEY_CODES.b,\n        shortKey: true\n      }, this._handleFormatHotKey.bind(this));\n      this.quill.keyboard.addBinding({\n        which: KEY_CODES.i,\n        shortKey: true\n      }, this._handleFormatHotKey.bind(this));\n      this.quill.keyboard.addBinding({\n        which: KEY_CODES.u,\n        shortKey: true\n      }, this._handleFormatHotKey.bind(this));\n    }\n\n    _handleFormatHotKey(range, context, _ref2) {\n      var {\n        which: which\n      } = _ref2;\n      var formatName = FORMAT_HOTKEYS[which];\n\n      this._updateButtonState(formatName);\n    }\n\n    _updateButtonState(formatName) {\n      var formatWidget = this._toolbarWidgets.getByName(formatName);\n\n      var currentFormat = this.quill.getFormat();\n      var formatValue = currentFormat[formatName];\n\n      if (formatValue) {\n        this._markActiveFormatWidget(formatName, formatWidget, currentFormat);\n      } else {\n        this._resetFormatWidget(formatName, formatWidget);\n      }\n    }\n\n    _prepareToolbarItems() {\n      var resultItems = [];\n      each(this.options.items, (index, item) => {\n        var newItem;\n\n        this._detectRenamedOptions(item);\n\n        if (isObject(item)) {\n          newItem = this._handleObjectItem(item);\n        } else if (isString(item)) {\n          var buttonItemConfig = this._prepareButtonItemConfig(item);\n\n          newItem = this._getToolbarItem(buttonItemConfig);\n        }\n\n        if (newItem) {\n          resultItems.push(newItem);\n        }\n      });\n      return resultItems;\n    }\n\n    _handleObjectItem(item) {\n      if (item.name && item.acceptedValues && this._isAcceptableItem(item.widget, \"dxSelectBox\")) {\n        var selectItemConfig = this._prepareSelectItemConfig(item);\n\n        return this._getToolbarItem(selectItemConfig);\n      } else if (item.name && this._isAcceptableItem(item.widget, \"dxButton\")) {\n        var defaultButtonItemConfig = this._prepareButtonItemConfig(item.name);\n\n        var buttonItemConfig = extend(true, defaultButtonItemConfig, item);\n        return this._getToolbarItem(buttonItemConfig);\n      } else {\n        return this._getToolbarItem(item);\n      }\n    }\n\n    _isAcceptableItem(widget, acceptableWidgetName) {\n      return !widget || widget === acceptableWidgetName;\n    }\n\n    _prepareButtonItemConfig(name) {\n      var _ICON_MAP$name;\n\n      var iconName = null !== (_ICON_MAP$name = ICON_MAP[name]) && void 0 !== _ICON_MAP$name ? _ICON_MAP$name : name;\n      var buttonText = titleize(name);\n      return {\n        widget: \"dxButton\",\n        name: name,\n        options: {\n          hint: localize(buttonText),\n          text: localize(buttonText),\n          icon: iconName.toLowerCase(),\n          onClick: this._formatHandlers[name] || getDefaultClickHandler(this, name),\n          stylingMode: \"text\"\n        },\n        showText: \"inMenu\"\n      };\n    }\n\n    _prepareSelectItemConfig(item) {\n      var {\n        name: name,\n        acceptedValues: acceptedValues\n      } = item;\n      return extend(true, {\n        widget: \"dxSelectBox\",\n        name: name,\n        options: {\n          stylingMode: \"filled\",\n          dataSource: acceptedValues,\n          displayExpr: value => localizeValue(value, name),\n          placeholder: localize(name),\n          onValueChanged: e => {\n            if (!this._isReset) {\n              this._hideAdaptiveMenu();\n\n              applyFormat(this, [name, e.value, USER_ACTION], e.event);\n\n              this._setValueSilent(e.component, e.value);\n            }\n          }\n        }\n      }, item);\n    }\n\n    _hideAdaptiveMenu() {\n      if (this.toolbarInstance.option(\"overflowMenuVisible\")) {\n        this.toolbarInstance.option(\"overflowMenuVisible\", false);\n      }\n    }\n\n    _getToolbarItem(item) {\n      var baseItem = {\n        options: {\n          onInitialized: e => {\n            if (item.name) {\n              e.component.$element().addClass(TOOLBAR_FORMAT_WIDGET_CLASS);\n              e.component.$element().toggleClass(\"dx-\".concat(item.name.toLowerCase(), \"-format\"), !!item.name);\n\n              this._toolbarWidgets.add(item.name, e.component);\n            }\n          }\n        }\n      };\n      var multilineItem = this.isMultilineMode() ? {\n        location: \"before\",\n        locateInMenu: \"never\"\n      } : {};\n      return extend(true, {\n        location: \"before\",\n        locateInMenu: \"auto\"\n      }, this._getDefaultConfig(item.name), item, baseItem, multilineItem);\n    }\n\n    _getDefaultItemsConfig() {\n      return {\n        clear: {\n          options: {\n            disabled: true\n          }\n        },\n        undo: {\n          options: {\n            disabled: true\n          }\n        },\n        redo: {\n          options: {\n            disabled: true\n          }\n        },\n        insertRowAbove: {\n          options: {\n            disabled: true\n          }\n        },\n        insertRowBelow: {\n          options: {\n            disabled: true\n          }\n        },\n        insertHeaderRow: {\n          options: {\n            disabled: true\n          }\n        },\n        insertColumnLeft: {\n          options: {\n            disabled: true\n          }\n        },\n        insertColumnRight: {\n          options: {\n            disabled: true\n          }\n        },\n        deleteRow: {\n          options: {\n            disabled: true\n          }\n        },\n        deleteColumn: {\n          options: {\n            disabled: true\n          }\n        },\n        deleteTable: {\n          options: {\n            disabled: true\n          }\n        },\n        cellProperties: {\n          options: {\n            disabled: true\n          }\n        },\n        tableProperties: {\n          options: {\n            disabled: true\n          }\n        },\n        separator: {\n          template: (data, index, element) => {\n            $(element).addClass(TOOLBAR_SEPARATOR_CLASS);\n          },\n          menuItemTemplate: (data, index, element) => {\n            $(element).addClass(TOOLBAR_MENU_SEPARATOR_CLASS);\n          }\n        }\n      };\n    }\n\n    _getDefaultConfig(name) {\n      return this._getDefaultItemsConfig()[name];\n    }\n\n    updateHistoryWidgets() {\n      var historyModule = this.quill.history;\n\n      if (!historyModule) {\n        return;\n      }\n\n      var {\n        undo: undoOps,\n        redo: redoOps\n      } = historyModule.stack;\n\n      this._updateManipulationWidget(this._toolbarWidgets.getByName(\"undo\"), Boolean(undoOps.length));\n\n      this._updateManipulationWidget(this._toolbarWidgets.getByName(\"redo\"), Boolean(redoOps.length));\n    }\n\n    updateTableWidgets() {\n      var table = this.quill.getModule(\"table\");\n\n      if (!table) {\n        return;\n      }\n\n      var selection = this.quill.getSelection();\n      var formats = selection && this.quill.getFormat(selection) || {};\n\n      var isTableOperationsEnabled = this._tableFormats.some(format => Boolean(formats[format]));\n\n      TABLE_OPERATIONS.forEach(operationName => {\n        var isInsertTable = \"insertTable\" === operationName;\n\n        var widget = this._toolbarWidgets.getByName(operationName);\n\n        this._updateManipulationWidget(widget, isInsertTable ? !isTableOperationsEnabled : isTableOperationsEnabled);\n      });\n    }\n\n    _updateManipulationWidget(widget, isOperationEnabled) {\n      if (!widget) {\n        return;\n      }\n\n      widget.option(\"disabled\", !isOperationEnabled);\n    }\n\n    updateFormatWidgets(isResetRequired) {\n      var selection = this.quill.getSelection();\n\n      if (!selection) {\n        return;\n      }\n\n      var formats = this.quill.getFormat(selection);\n      var hasFormats = !isEmptyObject(formats);\n\n      if (!hasFormats || isResetRequired) {\n        this._resetFormatWidgets();\n      }\n\n      for (var formatName in formats) {\n        var widgetName = this._getFormatWidgetName(formatName, formats);\n\n        var formatWidget = this._toolbarWidgets.getByName(widgetName) || this._toolbarWidgets.getByName(formatName);\n\n        if (!formatWidget) {\n          continue;\n        }\n\n        this._markActiveFormatWidget(formatName, formatWidget, formats);\n      }\n\n      this._toggleClearFormatting(hasFormats || selection.length > 1);\n    }\n\n    _markActiveFormatWidget(name, widget, formats) {\n      if (this._isColorFormat(name)) {\n        this._updateColorWidget(name, formats[name]);\n      }\n\n      if (\"value\" in widget.option()) {\n        this._setValueSilent(widget, formats[name]);\n      } else {\n        widget.$element().addClass(ACTIVE_FORMAT_CLASS);\n      }\n    }\n\n    _toggleClearFormatting(hasFormats) {\n      var clearWidget = this._toolbarWidgets.getByName(\"clear\");\n\n      if (clearWidget) {\n        clearWidget.option(\"disabled\", !hasFormats);\n      }\n    }\n\n    _isColorFormat(name) {\n      return \"color\" === name || \"background\" === name;\n    }\n\n    _updateColorWidget(name, color) {\n      var formatWidget = this._toolbarWidgets.getByName(name);\n\n      if (!formatWidget) {\n        return;\n      }\n\n      formatWidget.$element().find(\".\".concat(ICON_CLASS)).css(\"borderBottomColor\", color || \"transparent\");\n    }\n\n    _getFormatWidgetName(name, formats) {\n      var widgetName;\n\n      switch (name) {\n        case \"align\":\n          widgetName = name + titleize(formats[name]);\n          break;\n\n        case \"list\":\n          widgetName = formats[name] + titleize(name);\n          break;\n\n        case \"code-block\":\n          widgetName = \"codeBlock\";\n          break;\n\n        case \"script\":\n          widgetName = formats[name] + name;\n          break;\n\n        case \"imageSrc\":\n          widgetName = \"image\";\n          break;\n\n        default:\n          widgetName = name;\n      }\n\n      return widgetName;\n    }\n\n    _setValueSilent(widget, value) {\n      this._isReset = true;\n      widget.option(\"value\", value);\n      this._isReset = false;\n    }\n\n    _resetFormatWidgets() {\n      this._toolbarWidgets.each((name, widget) => {\n        this._resetFormatWidget(name, widget);\n      });\n    }\n\n    _resetFormatWidget(name, widget) {\n      widget.$element().removeClass(ACTIVE_FORMAT_CLASS);\n\n      if (this._isColorFormat(name)) {\n        this._updateColorWidget(name);\n      }\n\n      if (\"clear\" === name) {\n        widget.option(\"disabled\", true);\n      }\n\n      if (\"dxSelectBox\" === widget.NAME) {\n        this._setValueSilent(widget, null);\n      }\n    }\n\n    addClickHandler(name, handler) {\n      this._formatHandlers[name] = handler;\n\n      var formatWidget = this._toolbarWidgets.getByName(name);\n\n      if (formatWidget && \"dxButton\" === formatWidget.NAME) {\n        formatWidget.option(\"onClick\", handler);\n      }\n    }\n\n  };\n}\n\nexport default ToolbarModule;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devextreme/esm/ui/html_editor/modules/toolbar.js"],"names":["Quill","$","BaseModule","Toolbar","errors","WidgetCollector","each","isString","isObject","isDefined","isEmptyObject","extend","localizationMessage","titleize","camelize","eventsEngine","addNamespace","getTableFormats","TABLE_OPERATIONS","getFormatHandlers","getDefaultClickHandler","ICON_MAP","applyFormat","ToolbarModule","TOOLBAR_WRAPPER_CLASS","TOOLBAR_CLASS","TOOLBAR_FORMAT_WIDGET_CLASS","TOOLBAR_SEPARATOR_CLASS","TOOLBAR_MENU_SEPARATOR_CLASS","ACTIVE_FORMAT_CLASS","ICON_CLASS","SELECTION_CHANGE_EVENT","USER_ACTION","SILENT_ACTION","FORMAT_HOTKEYS","KEY_CODES","b","i","u","localize","name","format","concat","localizeValue","value","isHeaderValue","constructor","quill","options","_toolbarWidgets","_formatHandlers","_tableFormats","items","_addCallbacks","_renderToolbar","on","eventName","newValue","oldValue","eventSource","isSilentMode","getFormat","isSelectionChanged","_updateToolbar","addCleanCallback","clean","bind","editorInstance","addContentInitializedCallback","updateHistoryWidgets","updateFormatWidgets","updateTableWidgets","_updateFormatWidget","isApplied","formats","widget","getByName","_markActiveFormatWidget","_resetFormatWidget","Object","prototype","hasOwnProperty","call","_toggleClearFormatting","container","_getContainer","_$toolbar","addClass","appendTo","_$toolbarContainer","NAME","e","preventDefault","_subscribeFormatHotKeys","toolbarInstance","_createComponent","toolbarConfig","_ref","option","isInteractionDisabled","dataSource","_prepareToolbarItems","disabled","menuContainer","multiline","isMultilineMode","_this$options$multili","clear","empty","removeClass","repaint","$container","$element","prepend","_detectRenamedOptions","item","newName","oldName","index","optionName","log","keyboard","addBinding","which","shortKey","_handleFormatHotKey","range","context","_ref2","formatName","_updateButtonState","formatWidget","currentFormat","formatValue","resultItems","newItem","_handleObjectItem","buttonItemConfig","_prepareButtonItemConfig","_getToolbarItem","push","acceptedValues","_isAcceptableItem","selectItemConfig","_prepareSelectItemConfig","defaultButtonItemConfig","acceptableWidgetName","_ICON_MAP$name","iconName","buttonText","hint","text","icon","toLowerCase","onClick","stylingMode","showText","displayExpr","placeholder","onValueChanged","_isReset","_hideAdaptiveMenu","event","_setValueSilent","component","baseItem","onInitialized","toggleClass","add","multilineItem","location","locateInMenu","_getDefaultConfig","_getDefaultItemsConfig","undo","redo","insertRowAbove","insertRowBelow","insertHeaderRow","insertColumnLeft","insertColumnRight","deleteRow","deleteColumn","deleteTable","cellProperties","tableProperties","separator","template","data","element","menuItemTemplate","historyModule","history","undoOps","redoOps","stack","_updateManipulationWidget","Boolean","length","table","getModule","selection","getSelection","isTableOperationsEnabled","some","forEach","operationName","isInsertTable","isOperationEnabled","isResetRequired","hasFormats","_resetFormatWidgets","widgetName","_getFormatWidgetName","_isColorFormat","_updateColorWidget","clearWidget","color","find","css","addClickHandler","handler"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/html_editor/modules/toolbar.js)\r\n * Version: 22.1.3\r\n * Build date: Mon Jun 13 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport Quill from \"devextreme-quill\";\r\nimport $ from \"../../../core/renderer\";\r\nimport BaseModule from \"./base\";\r\nimport Toolbar from \"../../toolbar\";\r\nimport \"../../select_box\";\r\nimport \"../../color_box/color_view\";\r\nimport \"../../number_box\";\r\nimport errors from \"../../widget/ui.errors\";\r\nimport WidgetCollector from \"./widget_collector\";\r\nimport {\r\n    each\r\n} from \"../../../core/utils/iterator\";\r\nimport {\r\n    isString,\r\n    isObject,\r\n    isDefined,\r\n    isEmptyObject\r\n} from \"../../../core/utils/type\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport localizationMessage from \"../../../localization/message\";\r\nimport {\r\n    titleize,\r\n    camelize\r\n} from \"../../../core/utils/inflector\";\r\nimport eventsEngine from \"../../../events/core/events_engine\";\r\nimport {\r\n    addNamespace\r\n} from \"../../../events/utils/index\";\r\nimport {\r\n    getTableFormats,\r\n    TABLE_OPERATIONS\r\n} from \"../utils/table_helper\";\r\nimport {\r\n    getFormatHandlers,\r\n    getDefaultClickHandler,\r\n    ICON_MAP,\r\n    applyFormat\r\n} from \"../utils/toolbar_helper\";\r\nvar ToolbarModule = BaseModule;\r\nif (Quill) {\r\n    var TOOLBAR_WRAPPER_CLASS = \"dx-htmleditor-toolbar-wrapper\";\r\n    var TOOLBAR_CLASS = \"dx-htmleditor-toolbar\";\r\n    var TOOLBAR_FORMAT_WIDGET_CLASS = \"dx-htmleditor-toolbar-format\";\r\n    var TOOLBAR_SEPARATOR_CLASS = \"dx-htmleditor-toolbar-separator\";\r\n    var TOOLBAR_MENU_SEPARATOR_CLASS = \"dx-htmleditor-toolbar-menu-separator\";\r\n    var ACTIVE_FORMAT_CLASS = \"dx-format-active\";\r\n    var ICON_CLASS = \"dx-icon\";\r\n    var SELECTION_CHANGE_EVENT = \"selection-change\";\r\n    var USER_ACTION = \"user\";\r\n    var SILENT_ACTION = \"silent\";\r\n    var FORMAT_HOTKEYS = {\r\n        66: \"bold\",\r\n        73: \"italic\",\r\n        85: \"underline\"\r\n    };\r\n    var KEY_CODES = {\r\n        b: 66,\r\n        i: 73,\r\n        u: 85\r\n    };\r\n    var localize = name => localizationMessage.format(\"dxHtmlEditor-\".concat(camelize(name)));\r\n    var localizeValue = (value, name) => {\r\n        if (\"header\" === name) {\r\n            var isHeaderValue = isDefined(value) && false !== value;\r\n            return isHeaderValue ? \"\".concat(localize(\"heading\"), \" \").concat(value) : localize(\"normalText\")\r\n        }\r\n        return localize(value) || value\r\n    };\r\n    ToolbarModule = class extends BaseModule {\r\n        constructor(quill, options) {\r\n            super(quill, options);\r\n            this._toolbarWidgets = new WidgetCollector;\r\n            this._formatHandlers = getFormatHandlers(this);\r\n            this._tableFormats = getTableFormats(quill);\r\n            if (isDefined(options.items)) {\r\n                this._addCallbacks();\r\n                this._renderToolbar();\r\n                this.quill.on(\"editor-change\", (eventName, newValue, oldValue, eventSource) => {\r\n                    var isSilentMode = eventSource === SILENT_ACTION && isEmptyObject(this.quill.getFormat());\r\n                    if (!isSilentMode) {\r\n                        var isSelectionChanged = eventName === SELECTION_CHANGE_EVENT;\r\n                        this._updateToolbar(isSelectionChanged)\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        _addCallbacks() {\r\n            this.addCleanCallback(this.clean.bind(this));\r\n            this.editorInstance.addContentInitializedCallback(this.updateHistoryWidgets.bind(this))\r\n        }\r\n        _updateToolbar(isSelectionChanged) {\r\n            this.updateFormatWidgets(isSelectionChanged);\r\n            this.updateHistoryWidgets();\r\n            this.updateTableWidgets()\r\n        }\r\n        _updateFormatWidget(name, isApplied, formats) {\r\n            var widget = this._toolbarWidgets.getByName(name);\r\n            if (!widget) {\r\n                return\r\n            }\r\n            if (isApplied) {\r\n                this._markActiveFormatWidget(name, widget, formats)\r\n            } else {\r\n                this._resetFormatWidget(name, widget);\r\n                if (Object.prototype.hasOwnProperty.call(name)) {\r\n                    delete formats[name]\r\n                }\r\n            }\r\n            this._toggleClearFormatting(isApplied || !isEmptyObject(formats))\r\n        }\r\n        _renderToolbar() {\r\n            var container = this.options.container || this._getContainer();\r\n            this._$toolbar = $(\"<div>\").addClass(TOOLBAR_CLASS).appendTo(container);\r\n            this._$toolbarContainer = $(container).addClass(TOOLBAR_WRAPPER_CLASS);\r\n            eventsEngine.on(this._$toolbarContainer, addNamespace(\"mousedown\", this.editorInstance.NAME), e => {\r\n                e.preventDefault()\r\n            });\r\n            this._subscribeFormatHotKeys();\r\n            this.toolbarInstance = this.editorInstance._createComponent(this._$toolbar, Toolbar, this.toolbarConfig);\r\n            this.editorInstance.on(\"optionChanged\", _ref => {\r\n                var {\r\n                    name: name\r\n                } = _ref;\r\n                if (\"readOnly\" === name || \"disabled\" === name) {\r\n                    this.toolbarInstance.option(\"disabled\", this.isInteractionDisabled)\r\n                }\r\n            })\r\n        }\r\n        get toolbarConfig() {\r\n            return {\r\n                dataSource: this._prepareToolbarItems(),\r\n                disabled: this.isInteractionDisabled,\r\n                menuContainer: this._$toolbarContainer,\r\n                multiline: this.isMultilineMode()\r\n            }\r\n        }\r\n        get isInteractionDisabled() {\r\n            return this.editorInstance.option(\"readOnly\") || this.editorInstance.option(\"disabled\")\r\n        }\r\n        isMultilineMode() {\r\n            var _this$options$multili;\r\n            return null !== (_this$options$multili = this.options.multiline) && void 0 !== _this$options$multili ? _this$options$multili : true\r\n        }\r\n        clean() {\r\n            this._toolbarWidgets.clear();\r\n            if (this._$toolbarContainer) {\r\n                this._$toolbarContainer.empty().removeClass(TOOLBAR_WRAPPER_CLASS)\r\n            }\r\n        }\r\n        repaint() {\r\n            this.toolbarInstance && this.toolbarInstance.repaint()\r\n        }\r\n        _getContainer() {\r\n            var $container = $(\"<div>\");\r\n            this.editorInstance.$element().prepend($container);\r\n            return $container\r\n        }\r\n        _detectRenamedOptions(item) {\r\n            if (isObject(item)) {\r\n                each([{\r\n                    newName: \"name\",\r\n                    oldName: \"formatName\"\r\n                }, {\r\n                    newName: \"acceptedValues\",\r\n                    oldName: \"formatValues\"\r\n                }], (index, optionName) => {\r\n                    if (Object.prototype.hasOwnProperty.call(item, optionName.oldName)) {\r\n                        errors.log(\"W1016\", optionName.oldName, optionName.newName)\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        _subscribeFormatHotKeys() {\r\n            this.quill.keyboard.addBinding({\r\n                which: KEY_CODES.b,\r\n                shortKey: true\r\n            }, this._handleFormatHotKey.bind(this));\r\n            this.quill.keyboard.addBinding({\r\n                which: KEY_CODES.i,\r\n                shortKey: true\r\n            }, this._handleFormatHotKey.bind(this));\r\n            this.quill.keyboard.addBinding({\r\n                which: KEY_CODES.u,\r\n                shortKey: true\r\n            }, this._handleFormatHotKey.bind(this))\r\n        }\r\n        _handleFormatHotKey(range, context, _ref2) {\r\n            var {\r\n                which: which\r\n            } = _ref2;\r\n            var formatName = FORMAT_HOTKEYS[which];\r\n            this._updateButtonState(formatName)\r\n        }\r\n        _updateButtonState(formatName) {\r\n            var formatWidget = this._toolbarWidgets.getByName(formatName);\r\n            var currentFormat = this.quill.getFormat();\r\n            var formatValue = currentFormat[formatName];\r\n            if (formatValue) {\r\n                this._markActiveFormatWidget(formatName, formatWidget, currentFormat)\r\n            } else {\r\n                this._resetFormatWidget(formatName, formatWidget)\r\n            }\r\n        }\r\n        _prepareToolbarItems() {\r\n            var resultItems = [];\r\n            each(this.options.items, (index, item) => {\r\n                var newItem;\r\n                this._detectRenamedOptions(item);\r\n                if (isObject(item)) {\r\n                    newItem = this._handleObjectItem(item)\r\n                } else if (isString(item)) {\r\n                    var buttonItemConfig = this._prepareButtonItemConfig(item);\r\n                    newItem = this._getToolbarItem(buttonItemConfig)\r\n                }\r\n                if (newItem) {\r\n                    resultItems.push(newItem)\r\n                }\r\n            });\r\n            return resultItems\r\n        }\r\n        _handleObjectItem(item) {\r\n            if (item.name && item.acceptedValues && this._isAcceptableItem(item.widget, \"dxSelectBox\")) {\r\n                var selectItemConfig = this._prepareSelectItemConfig(item);\r\n                return this._getToolbarItem(selectItemConfig)\r\n            } else if (item.name && this._isAcceptableItem(item.widget, \"dxButton\")) {\r\n                var defaultButtonItemConfig = this._prepareButtonItemConfig(item.name);\r\n                var buttonItemConfig = extend(true, defaultButtonItemConfig, item);\r\n                return this._getToolbarItem(buttonItemConfig)\r\n            } else {\r\n                return this._getToolbarItem(item)\r\n            }\r\n        }\r\n        _isAcceptableItem(widget, acceptableWidgetName) {\r\n            return !widget || widget === acceptableWidgetName\r\n        }\r\n        _prepareButtonItemConfig(name) {\r\n            var _ICON_MAP$name;\r\n            var iconName = null !== (_ICON_MAP$name = ICON_MAP[name]) && void 0 !== _ICON_MAP$name ? _ICON_MAP$name : name;\r\n            var buttonText = titleize(name);\r\n            return {\r\n                widget: \"dxButton\",\r\n                name: name,\r\n                options: {\r\n                    hint: localize(buttonText),\r\n                    text: localize(buttonText),\r\n                    icon: iconName.toLowerCase(),\r\n                    onClick: this._formatHandlers[name] || getDefaultClickHandler(this, name),\r\n                    stylingMode: \"text\"\r\n                },\r\n                showText: \"inMenu\"\r\n            }\r\n        }\r\n        _prepareSelectItemConfig(item) {\r\n            var {\r\n                name: name,\r\n                acceptedValues: acceptedValues\r\n            } = item;\r\n            return extend(true, {\r\n                widget: \"dxSelectBox\",\r\n                name: name,\r\n                options: {\r\n                    stylingMode: \"filled\",\r\n                    dataSource: acceptedValues,\r\n                    displayExpr: value => localizeValue(value, name),\r\n                    placeholder: localize(name),\r\n                    onValueChanged: e => {\r\n                        if (!this._isReset) {\r\n                            this._hideAdaptiveMenu();\r\n                            applyFormat(this, [name, e.value, USER_ACTION], e.event);\r\n                            this._setValueSilent(e.component, e.value)\r\n                        }\r\n                    }\r\n                }\r\n            }, item)\r\n        }\r\n        _hideAdaptiveMenu() {\r\n            if (this.toolbarInstance.option(\"overflowMenuVisible\")) {\r\n                this.toolbarInstance.option(\"overflowMenuVisible\", false)\r\n            }\r\n        }\r\n        _getToolbarItem(item) {\r\n            var baseItem = {\r\n                options: {\r\n                    onInitialized: e => {\r\n                        if (item.name) {\r\n                            e.component.$element().addClass(TOOLBAR_FORMAT_WIDGET_CLASS);\r\n                            e.component.$element().toggleClass(\"dx-\".concat(item.name.toLowerCase(), \"-format\"), !!item.name);\r\n                            this._toolbarWidgets.add(item.name, e.component)\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            var multilineItem = this.isMultilineMode() ? {\r\n                location: \"before\",\r\n                locateInMenu: \"never\"\r\n            } : {};\r\n            return extend(true, {\r\n                location: \"before\",\r\n                locateInMenu: \"auto\"\r\n            }, this._getDefaultConfig(item.name), item, baseItem, multilineItem)\r\n        }\r\n        _getDefaultItemsConfig() {\r\n            return {\r\n                clear: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                undo: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                redo: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                insertRowAbove: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                insertRowBelow: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                insertHeaderRow: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                insertColumnLeft: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                insertColumnRight: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                deleteRow: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                deleteColumn: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                deleteTable: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                cellProperties: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                tableProperties: {\r\n                    options: {\r\n                        disabled: true\r\n                    }\r\n                },\r\n                separator: {\r\n                    template: (data, index, element) => {\r\n                        $(element).addClass(TOOLBAR_SEPARATOR_CLASS)\r\n                    },\r\n                    menuItemTemplate: (data, index, element) => {\r\n                        $(element).addClass(TOOLBAR_MENU_SEPARATOR_CLASS)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        _getDefaultConfig(name) {\r\n            return this._getDefaultItemsConfig()[name]\r\n        }\r\n        updateHistoryWidgets() {\r\n            var historyModule = this.quill.history;\r\n            if (!historyModule) {\r\n                return\r\n            }\r\n            var {\r\n                undo: undoOps,\r\n                redo: redoOps\r\n            } = historyModule.stack;\r\n            this._updateManipulationWidget(this._toolbarWidgets.getByName(\"undo\"), Boolean(undoOps.length));\r\n            this._updateManipulationWidget(this._toolbarWidgets.getByName(\"redo\"), Boolean(redoOps.length))\r\n        }\r\n        updateTableWidgets() {\r\n            var table = this.quill.getModule(\"table\");\r\n            if (!table) {\r\n                return\r\n            }\r\n            var selection = this.quill.getSelection();\r\n            var formats = selection && this.quill.getFormat(selection) || {};\r\n            var isTableOperationsEnabled = this._tableFormats.some(format => Boolean(formats[format]));\r\n            TABLE_OPERATIONS.forEach(operationName => {\r\n                var isInsertTable = \"insertTable\" === operationName;\r\n                var widget = this._toolbarWidgets.getByName(operationName);\r\n                this._updateManipulationWidget(widget, isInsertTable ? !isTableOperationsEnabled : isTableOperationsEnabled)\r\n            })\r\n        }\r\n        _updateManipulationWidget(widget, isOperationEnabled) {\r\n            if (!widget) {\r\n                return\r\n            }\r\n            widget.option(\"disabled\", !isOperationEnabled)\r\n        }\r\n        updateFormatWidgets(isResetRequired) {\r\n            var selection = this.quill.getSelection();\r\n            if (!selection) {\r\n                return\r\n            }\r\n            var formats = this.quill.getFormat(selection);\r\n            var hasFormats = !isEmptyObject(formats);\r\n            if (!hasFormats || isResetRequired) {\r\n                this._resetFormatWidgets()\r\n            }\r\n            for (var formatName in formats) {\r\n                var widgetName = this._getFormatWidgetName(formatName, formats);\r\n                var formatWidget = this._toolbarWidgets.getByName(widgetName) || this._toolbarWidgets.getByName(formatName);\r\n                if (!formatWidget) {\r\n                    continue\r\n                }\r\n                this._markActiveFormatWidget(formatName, formatWidget, formats)\r\n            }\r\n            this._toggleClearFormatting(hasFormats || selection.length > 1)\r\n        }\r\n        _markActiveFormatWidget(name, widget, formats) {\r\n            if (this._isColorFormat(name)) {\r\n                this._updateColorWidget(name, formats[name])\r\n            }\r\n            if (\"value\" in widget.option()) {\r\n                this._setValueSilent(widget, formats[name])\r\n            } else {\r\n                widget.$element().addClass(ACTIVE_FORMAT_CLASS)\r\n            }\r\n        }\r\n        _toggleClearFormatting(hasFormats) {\r\n            var clearWidget = this._toolbarWidgets.getByName(\"clear\");\r\n            if (clearWidget) {\r\n                clearWidget.option(\"disabled\", !hasFormats)\r\n            }\r\n        }\r\n        _isColorFormat(name) {\r\n            return \"color\" === name || \"background\" === name\r\n        }\r\n        _updateColorWidget(name, color) {\r\n            var formatWidget = this._toolbarWidgets.getByName(name);\r\n            if (!formatWidget) {\r\n                return\r\n            }\r\n            formatWidget.$element().find(\".\".concat(ICON_CLASS)).css(\"borderBottomColor\", color || \"transparent\")\r\n        }\r\n        _getFormatWidgetName(name, formats) {\r\n            var widgetName;\r\n            switch (name) {\r\n                case \"align\":\r\n                    widgetName = name + titleize(formats[name]);\r\n                    break;\r\n                case \"list\":\r\n                    widgetName = formats[name] + titleize(name);\r\n                    break;\r\n                case \"code-block\":\r\n                    widgetName = \"codeBlock\";\r\n                    break;\r\n                case \"script\":\r\n                    widgetName = formats[name] + name;\r\n                    break;\r\n                case \"imageSrc\":\r\n                    widgetName = \"image\";\r\n                    break;\r\n                default:\r\n                    widgetName = name\r\n            }\r\n            return widgetName\r\n        }\r\n        _setValueSilent(widget, value) {\r\n            this._isReset = true;\r\n            widget.option(\"value\", value);\r\n            this._isReset = false\r\n        }\r\n        _resetFormatWidgets() {\r\n            this._toolbarWidgets.each((name, widget) => {\r\n                this._resetFormatWidget(name, widget)\r\n            })\r\n        }\r\n        _resetFormatWidget(name, widget) {\r\n            widget.$element().removeClass(ACTIVE_FORMAT_CLASS);\r\n            if (this._isColorFormat(name)) {\r\n                this._updateColorWidget(name)\r\n            }\r\n            if (\"clear\" === name) {\r\n                widget.option(\"disabled\", true)\r\n            }\r\n            if (\"dxSelectBox\" === widget.NAME) {\r\n                this._setValueSilent(widget, null)\r\n            }\r\n        }\r\n        addClickHandler(name, handler) {\r\n            this._formatHandlers[name] = handler;\r\n            var formatWidget = this._toolbarWidgets.getByName(name);\r\n            if (formatWidget && \"dxButton\" === formatWidget.NAME) {\r\n                formatWidget.option(\"onClick\", handler)\r\n            }\r\n        }\r\n    }\r\n}\r\nexport default ToolbarModule;\r\n"]},"metadata":{},"sourceType":"module"}