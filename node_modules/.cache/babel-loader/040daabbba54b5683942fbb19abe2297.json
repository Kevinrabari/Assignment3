{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_data-item-collection-surface.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataItemCollectionSurface = void 0;\n\nvar ko = require(\"knockout\");\n\nvar data_item_1 = require(\"../../../model/data-item/data-item\");\n\nvar dimension_1 = require(\"../../../model/data-item/dimension\");\n\nvar _data_field_1 = require(\"../../../model/data-sources/_data-field\");\n\nvar _undo_engine_helper_1 = require(\"../../../model/internal/_undo-engine-helper\");\n\nvar _display_name_provider_1 = require(\"../../_display-name-provider\");\n\nvar _data_item_surface_1 = require(\"../binding-details/_data-item-surface\");\n\nvar DataItemCollectionSurface = function () {\n  function DataItemCollectionSurface(itemSurface, sectionInfo, extendTabsHandler, warning) {\n    var _this = this;\n\n    this.itemSurface = itemSurface;\n    this.sectionInfo = sectionInfo;\n    this.extendTabsHandler = extendTabsHandler;\n    this.warning = warning;\n    this._disposables = [];\n    this.supportGroups = true;\n\n    this.addClick = function () {\n      var dataLink = new data_item_1.DataItemLink(_this.itemSurface.dashboardItem);\n\n      _this.newItemSample(dataLink);\n\n      var surface = new _data_item_surface_1.DataItemSurface(dataLink, _this.sectionInfo.bindingProperty, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, true, null, _this.extendTabsHandler);\n      surface.newItemCreated.add(function (model) {\n        return _this._addDataItem(model);\n      });\n      surface.itemSelected.add(function (model) {\n        _this.newItemSample(undefined);\n\n        _this.selectDataItem(model);\n      });\n\n      _this.itemSurface.propertiesController.mainModel({\n        data: surface,\n        containingCollection: _this.dataItems\n      });\n    };\n\n    this.removeDataItem = function (data) {\n      _this._removeDataItem(data);\n    };\n\n    this.dataItemDisplayNameProvider = function (dataItem) {\n      return _display_name_provider_1.getDataItemDisplayName(_this.itemSurface._dataSourceBrowser, _this.itemSurface.dashboardItem, dataItem);\n    };\n\n    this.selectDataItem = function (data) {\n      var surface = new _data_item_surface_1.DataItemSurface(data, _this.sectionInfo.bindingProperty, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, true, null, _this.extendTabsHandler);\n      surface.newItemCreated.add(function (model) {\n        _this._addDataItem(model);\n      });\n\n      _this.dataItemSurface(surface);\n\n      _this.itemSurface.propertiesController.mainModel({\n        data: _this.dataItemSurface(),\n        containingCollection: _this.dataItems\n      });\n    };\n\n    this.dataItemSurface = ko.observable();\n    this.newItemSample = ko.observable();\n    this.template = 'dx-dashboard-data-item-collection';\n    this.dataItems = itemSurface.dashboardItem[sectionInfo.bindingProperty.propertyName];\n    this.groups = ko.computed(function () {\n      var result = [],\n          position = 0;\n\n      _this.dataItems().forEach(function (dataItemLink) {\n        if (dataItemLink.dataItem() instanceof dimension_1.Dimension && _data_field_1.IsOlapHierarchyField(dataItemLink.dataItem())) {\n          var dimension = dataItemLink.dataItem();\n          var group = result.filter(function (group) {\n            return group.groupIndex === dimension.groupIndex();\n          })[0];\n\n          if (!group) {\n            group = {\n              groupIndex: dimension.groupIndex(),\n              items: [],\n              position: position++\n            };\n            result.push(group);\n          }\n\n          group.items.push(dataItemLink);\n        } else {\n          result.push({\n            groupIndex: undefined,\n            items: [dataItemLink],\n            position: position++\n          });\n        }\n      });\n\n      return result;\n    });\n  }\n\n  Object.defineProperty(DataItemCollectionSurface.prototype, \"items\", {\n    get: function () {\n      return this.dataItems;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DataItemCollectionSurface.prototype._addDataItem = function (model) {\n    this.dataItems.push(model);\n  };\n\n  DataItemCollectionSurface.prototype._removeDataItem = function (link) {\n    var dataItem = link.dataItem();\n    this.dataItems.remove(link);\n\n    this.itemSurface.dashboardItem._removeDataItem(dataItem, true);\n\n    if (dataItem instanceof dimension_1.Dimension && _data_field_1.IsOlapHierarchyField(dataItem)) {\n      for (var i = this.dataItems().length - 1; i >= 0; i--) {\n        var groupItemLink = this.dataItems()[i];\n        var groupItem = groupItemLink.dataItem();\n\n        if (groupItem instanceof dimension_1.Dimension && groupItem.groupIndex() == dataItem.groupIndex()) {\n          this.dataItems.remove(groupItemLink);\n\n          this.itemSurface.dashboardItem._removeDataItem(groupItem, true);\n        }\n      }\n    }\n  };\n\n  DataItemCollectionSurface.prototype.relocateItem = function (item, placeholderIndex) {\n    var _this = this;\n\n    var dataLink = new data_item_1.DataItemLink(this.itemSurface.dashboardItem);\n    var dataItem;\n\n    if (item instanceof data_item_1.DataItemLink) {\n      dataItem = item.dataItem();\n    } else if (item['_getBindingModel']) {\n      var x = item;\n\n      var filledBinding = x._getBindingModel().filter(function (b) {\n        return !!item[b.propertyName].uniqueName();\n      })[0];\n\n      dataItem = item[filledBinding.propertyName].dataItem();\n    }\n\n    this.itemSurface._dataSourceBrowser.findDataField(this.itemSurface.dashboardItem.dataSource(), this.itemSurface.dashboardItem.dataMember(), dataItem.dataMember()).done(function (dataField) {\n      _this.itemSurface.dashboardItem._removeDataItem(dataItem);\n\n      var newDataItem = _this.itemSurface.dashboardItem._createDataItem(dataField, _this.sectionInfo.bindingProperty);\n\n      newDataItem.grabFrom(dataItem);\n      newDataItem.uniqueName(dataItem.uniqueName());\n      dataLink.dataItem(newDataItem);\n\n      _this.items.splice(placeholderIndex, 0, dataLink);\n    });\n  };\n\n  DataItemCollectionSurface.prototype.isOlap = function () {\n    var filledItem = this.items().filter(function (item) {\n      return item.dataItem();\n    })[0];\n    return _data_field_1.DataField.isOlap(filledItem.dataItem().dataMember());\n  };\n\n  DataItemCollectionSurface.prototype.errorFactory = function (link) {\n    var linkErrorState = ko.observable(false);\n\n    if (link.dataItem()) {\n      this.itemSurface._dataSourceBrowser.findDataField(this.itemSurface.dashboardItem.dataSource(), this.itemSurface.dashboardItem.dataMember(), link.dataItem().dataMember()).done(function (result) {\n        linkErrorState(!result);\n      });\n    }\n\n    return linkErrorState;\n  };\n\n  DataItemCollectionSurface.prototype.dispose = function () {\n    this._disposables.forEach(function (d) {\n      d.dispose();\n    });\n  };\n\n  __decorate([_undo_engine_helper_1.wrapWithUndoRedo], DataItemCollectionSurface.prototype, \"_addDataItem\", null);\n\n  __decorate([_undo_engine_helper_1.wrapWithUndoRedo], DataItemCollectionSurface.prototype, \"_removeDataItem\", null);\n\n  __decorate([_undo_engine_helper_1.wrapWithUndoRedo], DataItemCollectionSurface.prototype, \"relocateItem\", null);\n\n  return DataItemCollectionSurface;\n}();\n\nexports.DataItemCollectionSurface = DataItemCollectionSurface;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/items/sections/_data-item-collection-surface.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","exports","value","DataItemCollectionSurface","ko","require","data_item_1","dimension_1","_data_field_1","_undo_engine_helper_1","_display_name_provider_1","_data_item_surface_1","itemSurface","sectionInfo","extendTabsHandler","warning","_this","_disposables","supportGroups","addClick","dataLink","DataItemLink","dashboardItem","newItemSample","surface","DataItemSurface","bindingProperty","_dataSourceBrowser","propertiesController","newItemCreated","add","model","_addDataItem","itemSelected","undefined","selectDataItem","mainModel","data","containingCollection","dataItems","removeDataItem","_removeDataItem","dataItemDisplayNameProvider","dataItem","getDataItemDisplayName","dataItemSurface","observable","template","propertyName","groups","computed","result","position","forEach","dataItemLink","Dimension","IsOlapHierarchyField","dimension","group","filter","groupIndex","items","push","prototype","get","enumerable","configurable","link","remove","groupItemLink","groupItem","relocateItem","item","placeholderIndex","x","filledBinding","_getBindingModel","b","uniqueName","findDataField","dataSource","dataMember","done","dataField","newDataItem","_createDataItem","grabFrom","splice","isOlap","filledItem","DataField","errorFactory","linkErrorState","dispose","wrapWithUndoRedo"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_data-item-collection-surface.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DataItemCollectionSurface = void 0;\nvar ko = require(\"knockout\");\nvar data_item_1 = require(\"../../../model/data-item/data-item\");\nvar dimension_1 = require(\"../../../model/data-item/dimension\");\nvar _data_field_1 = require(\"../../../model/data-sources/_data-field\");\nvar _undo_engine_helper_1 = require(\"../../../model/internal/_undo-engine-helper\");\nvar _display_name_provider_1 = require(\"../../_display-name-provider\");\nvar _data_item_surface_1 = require(\"../binding-details/_data-item-surface\");\nvar DataItemCollectionSurface = (function () {\n    function DataItemCollectionSurface(itemSurface, sectionInfo, extendTabsHandler, warning) {\n        var _this = this;\n        this.itemSurface = itemSurface;\n        this.sectionInfo = sectionInfo;\n        this.extendTabsHandler = extendTabsHandler;\n        this.warning = warning;\n        this._disposables = [];\n        this.supportGroups = true;\n        this.addClick = function () {\n            var dataLink = new data_item_1.DataItemLink(_this.itemSurface.dashboardItem);\n            _this.newItemSample(dataLink);\n            var surface = new _data_item_surface_1.DataItemSurface(dataLink, _this.sectionInfo.bindingProperty, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, true, null, _this.extendTabsHandler);\n            surface.newItemCreated.add(function (model) { return _this._addDataItem(model); });\n            surface.itemSelected.add(function (model) {\n                _this.newItemSample(undefined);\n                _this.selectDataItem(model);\n            });\n            _this.itemSurface.propertiesController.mainModel({\n                data: surface,\n                containingCollection: _this.dataItems\n            });\n        };\n        this.removeDataItem = function (data) {\n            _this._removeDataItem(data);\n        };\n        this.dataItemDisplayNameProvider = function (dataItem) {\n            return _display_name_provider_1.getDataItemDisplayName(_this.itemSurface._dataSourceBrowser, _this.itemSurface.dashboardItem, dataItem);\n        };\n        this.selectDataItem = function (data) {\n            var surface = new _data_item_surface_1.DataItemSurface(data, _this.sectionInfo.bindingProperty, _this.itemSurface.dashboardItem, _this.itemSurface._dataSourceBrowser, _this.itemSurface.propertiesController, true, null, _this.extendTabsHandler);\n            surface.newItemCreated.add(function (model) {\n                _this._addDataItem(model);\n            });\n            _this.dataItemSurface(surface);\n            _this.itemSurface.propertiesController.mainModel({\n                data: _this.dataItemSurface(),\n                containingCollection: _this.dataItems\n            });\n        };\n        this.dataItemSurface = ko.observable();\n        this.newItemSample = ko.observable();\n        this.template = 'dx-dashboard-data-item-collection';\n        this.dataItems = itemSurface.dashboardItem[sectionInfo.bindingProperty.propertyName];\n        this.groups = ko.computed(function () {\n            var result = [], position = 0;\n            _this.dataItems().forEach(function (dataItemLink) {\n                if (dataItemLink.dataItem() instanceof dimension_1.Dimension && _data_field_1.IsOlapHierarchyField(dataItemLink.dataItem())) {\n                    var dimension = dataItemLink.dataItem();\n                    var group = result.filter(function (group) { return group.groupIndex === dimension.groupIndex(); })[0];\n                    if (!group) {\n                        group = {\n                            groupIndex: dimension.groupIndex(),\n                            items: [],\n                            position: position++\n                        };\n                        result.push(group);\n                    }\n                    group.items.push(dataItemLink);\n                }\n                else {\n                    result.push({\n                        groupIndex: undefined,\n                        items: [dataItemLink],\n                        position: position++\n                    });\n                }\n            });\n            return result;\n        });\n    }\n    Object.defineProperty(DataItemCollectionSurface.prototype, \"items\", {\n        get: function () {\n            return this.dataItems;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DataItemCollectionSurface.prototype._addDataItem = function (model) {\n        this.dataItems.push(model);\n    };\n    DataItemCollectionSurface.prototype._removeDataItem = function (link) {\n        var dataItem = link.dataItem();\n        this.dataItems.remove(link);\n        this.itemSurface.dashboardItem._removeDataItem(dataItem, true);\n        if (dataItem instanceof dimension_1.Dimension && _data_field_1.IsOlapHierarchyField(dataItem)) {\n            for (var i = this.dataItems().length - 1; i >= 0; i--) {\n                var groupItemLink = this.dataItems()[i];\n                var groupItem = groupItemLink.dataItem();\n                if (groupItem instanceof dimension_1.Dimension && groupItem.groupIndex() == dataItem.groupIndex()) {\n                    this.dataItems.remove(groupItemLink);\n                    this.itemSurface.dashboardItem._removeDataItem(groupItem, true);\n                }\n            }\n        }\n    };\n    DataItemCollectionSurface.prototype.relocateItem = function (item, placeholderIndex) {\n        var _this = this;\n        var dataLink = new data_item_1.DataItemLink(this.itemSurface.dashboardItem);\n        var dataItem;\n        if (item instanceof data_item_1.DataItemLink) {\n            dataItem = item.dataItem();\n        }\n        else if (item['_getBindingModel']) {\n            var x = item;\n            var filledBinding = x._getBindingModel().filter(function (b) { return !!item[b.propertyName].uniqueName(); })[0];\n            dataItem = item[filledBinding.propertyName].dataItem();\n        }\n        this.itemSurface\n            ._dataSourceBrowser.findDataField(this.itemSurface.dashboardItem.dataSource(), this.itemSurface.dashboardItem.dataMember(), dataItem.dataMember())\n            .done(function (dataField) {\n            _this.itemSurface.dashboardItem._removeDataItem(dataItem);\n            var newDataItem = _this.itemSurface.dashboardItem._createDataItem(dataField, _this.sectionInfo.bindingProperty);\n            newDataItem.grabFrom(dataItem);\n            newDataItem.uniqueName(dataItem.uniqueName());\n            dataLink.dataItem(newDataItem);\n            _this.items.splice(placeholderIndex, 0, dataLink);\n        });\n    };\n    DataItemCollectionSurface.prototype.isOlap = function () {\n        var filledItem = this\n            .items()\n            .filter(function (item) { return item.dataItem(); })[0];\n        return _data_field_1.DataField.isOlap(filledItem.dataItem().dataMember());\n    };\n    DataItemCollectionSurface.prototype.errorFactory = function (link) {\n        var linkErrorState = ko.observable(false);\n        if (link.dataItem()) {\n            this.itemSurface._dataSourceBrowser.findDataField(this.itemSurface.dashboardItem.dataSource(), this.itemSurface.dashboardItem.dataMember(), link.dataItem().dataMember()).done(function (result) {\n                linkErrorState(!result);\n            });\n        }\n        return linkErrorState;\n    };\n    DataItemCollectionSurface.prototype.dispose = function () {\n        this._disposables.forEach(function (d) {\n            d.dispose();\n        });\n    };\n    __decorate([\n        _undo_engine_helper_1.wrapWithUndoRedo\n    ], DataItemCollectionSurface.prototype, \"_addDataItem\", null);\n    __decorate([\n        _undo_engine_helper_1.wrapWithUndoRedo\n    ], DataItemCollectionSurface.prototype, \"_removeDataItem\", null);\n    __decorate([\n        _undo_engine_helper_1.wrapWithUndoRedo\n    ], DataItemCollectionSurface.prototype, \"relocateItem\", null);\n    return DataItemCollectionSurface;\n}());\nexports.DataItemCollectionSurface = DataItemCollectionSurface;\n"]},"metadata":{},"sourceType":"script"}