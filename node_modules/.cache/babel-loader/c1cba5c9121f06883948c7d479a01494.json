{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_data-source-browser-viewmodel.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataSourceTreeListViewModel = exports.DataSourceBrowserViewModel = void 0;\n\nvar analytics_widgets_1 = require(\"@devexpress/analytics-core/analytics-widgets\");\n\nvar analytics_widgets_internal_1 = require(\"@devexpress/analytics-core/analytics-widgets-internal\");\n\nvar ko = require(\"knockout\");\n\nvar _data_source_browser_1 = require(\"../../common/_data-source-browser\");\n\nvar _default_1 = require(\"../../data/localization/_default\");\n\nvar model_1 = require(\"../../model\");\n\nvar json_data_source_1 = require(\"../../model/data-sources/json-data-source\");\n\nvar sql_data_source_1 = require(\"../../model/data-sources/sql-data-source\");\n\nvar disposable_object_1 = require(\"../../model/disposable-object\");\n\nvar index_internal_1 = require(\"../../model/index.internal\");\n\nvar _helper_classes_1 = require(\"../../model/internal/_helper-classes\");\n\nvar _undo_engine_helper_1 = require(\"../../model/internal/_undo-engine-helper\");\n\nvar _calc_field_editor_1 = require(\"../calc-field-editor/_calc-field-editor\");\n\nvar _expression_editor_item_provider_1 = require(\"../expression-editor/_expression-editor-item-provider\");\n\nvar _filter_utils_1 = require(\"../filtering/_filter-utils\");\n\nvar _field_list_item_provider_1 = require(\"./item-providers/_field-list-item-provider\");\n\nvar _rename_data_source_popup_1 = require(\"./rename-data-source-popup/_rename-data-source-popup\");\n\nvar _add_data_source_popup_1 = require(\"./_add-data-source-popup\");\n\nvar DataSourceBrowserViewModel = function (_super) {\n  __extends(DataSourceBrowserViewModel, _super);\n\n  function DataSourceBrowserViewModel(dataSourceBrowser, dataSourceWizardExtension, accessibleDataSourcesExtension, updateHub) {\n    var _this = _super.call(this) || this;\n\n    _this.dataSourceBrowser = dataSourceBrowser;\n    _this.dataSourceWizardExtension = dataSourceWizardExtension;\n    _this.accessibleDataSourcesExtension = accessibleDataSourcesExtension;\n    _this.editDataSourceActions = ko.observableArray();\n\n    _this.addDataSources = function (dataSources) {\n      dataSources.forEach(function (dataSource) {\n        if (!dataSource.name() || !_helper_classes_1.NameGenerator.isValidName(dataSource.name(), _this.dataSourceBrowser._dataSources(), 'name')) {\n          var prefix = !dataSource.name() ? _default_1.getLocalizationById(dataSource.getDisplayNamePrefix()) : dataSource.name();\n          dataSource.name(_helper_classes_1.NameGenerator.generateName(prefix + ' ', _this.dataSourceBrowser._dataSources(), 'name', 1));\n        }\n\n        _this.dataSourceBrowser._dataSources.push(dataSource);\n\n        _this.selectedDataSource(dataSource);\n      });\n    };\n\n    _this.addQuery = function () {\n      _this.editQuery(null);\n    };\n\n    _this.manageQueries = function () {\n      _this.manageFederationQueries();\n    };\n\n    _this.dataSourceActions = ko.observableArray();\n\n    _this.removeDataSource = function (dataSource) {\n      _this._removeDataSource(dataSource);\n    };\n\n    _this.showRenameDataSourceForm = function (dataSource) {\n      _this.renameDataSourcePopup.show(dataSource);\n    };\n\n    _this.usedDataSourcesExist = function () {\n      return _this.dataSourceBrowser._dataSources().length > 0;\n    };\n\n    _this.availableDataSourcesExist = function () {\n      return _this.accessibleDataSourcesExtension() && _this.accessibleDataSourcesExtension().dataSources().length > 0;\n    };\n\n    _this.popupContent = ko.observable();\n    _this.popupVisible = ko.computed({\n      read: function () {\n        return !!_this.popupContent();\n      },\n      write: function (val) {\n        if (!val) {\n          _this.popupContent(undefined);\n        }\n      }\n    });\n\n    _this.addCalculatedField = function () {\n      if (_this.canAddCalculatedField) {\n        var dataSource = _this.selectedDataSource();\n\n        var _a = _data_source_browser_1.findDataMember(dataSource, _data_source_browser_1.trimLeadingPathElement(_this.selectedPath(), dataSource.componentName())),\n            dataMember = _a.dataMember,\n            fieldPath = _a.fieldPath;\n\n        if (!dataMember && dataSource.supportDataMembers) {\n          dataMember = _data_source_browser_1.getFirstDataMember(dataSource);\n        }\n\n        var pathInCache = [_this.selectedDataSourceComponentName()].concat(dataMember ? [dataMember] : []);\n\n        _this.calcFieldEditor.showAddDialog(dataSource.componentName(), dataMember).then(function (calcField) {\n          var newCalculatedFieldPath = pathInCache.concat([calcField.name()]);\n\n          _this.selectedPath(newCalculatedFieldPath.join('.'));\n        });\n      }\n    };\n\n    _this.editCalcField = function (field) {\n      _this.calcFieldEditor.showEditDialog(field, _this.selectedDataSourceComponentName(), field.dataMember());\n    };\n\n    _this.removeCalcField = function (field) {\n      _this.calcFieldEditor.removeCalcField(field, _this.selectedDataSource().componentName());\n    };\n\n    _this.selectedPath = ko.observable();\n    _this.selectedDataSource = ko.observable();\n    _this.filterEditorModel = ko.computed(function () {\n      if (_this.selectedDataSource() && _this.selectedDataSource().hasFilter) {\n        var filterString = _this.selectedDataSource().filter;\n\n        var options = _filter_utils_1.createItemFilterOptions(filterString, undefined, _this.dataSourceBrowser);\n\n        options().path(_this.selectedDataSource().componentName());\n        var filterEditorItemsProvider = new _expression_editor_item_provider_1.ExpressionEditorItemsProvider(_this.dataSourceBrowser, _this.dataSourceBrowser, _this.dataSourceBrowser.parameters(), _this.selectedDataSource().componentName, ko.observable(''), function (field) {\n          return !field.isAggregate();\n        });\n        return new analytics_widgets_1.FilterEditor(options, ko.observable(filterEditorItemsProvider));\n      }\n\n      return null;\n    });\n\n    _this.editFilter = function () {\n      _this.filterEditorModel() && _this.filterEditorModel().popupVisible(true);\n    };\n\n    _this.calcFieldEditor = new _calc_field_editor_1.CalcFieldEditor(_this.dataSourceBrowser);\n    _this.renameDataSourcePopup = new _rename_data_source_popup_1.RenameDataSourcePopup(_this.dataSourceBrowser);\n\n    if (dataSourceBrowser._dataSources().length > 0) {\n      _this.selectedDataSource(dataSourceBrowser._dataSources()[0]);\n    }\n\n    _this.selectedDataSourceComponentName = ko.computed(function () {\n      return _this.selectedDataSource() && _this.selectedDataSource().componentName() || '';\n    });\n    _this.allowAddQuery = ko.computed(function () {\n      return _this.selectedDataSource() instanceof sql_data_source_1.SqlDataSource;\n    });\n    _this.allowManageQueries = ko.computed(function () {\n      return _this.selectedDataSource() instanceof model_1.FederationDataSource;\n    });\n    _this.allowEditDataSource = ko.computed(function () {\n      return _this.selectedDataSource() instanceof json_data_source_1.JsonDataSource;\n    });\n\n    _this.toDispose(_this.allowAddQuery);\n\n    _this.toDispose(_this.allowManageQueries);\n\n    _this.toDispose(_this.allowEditDataSource);\n\n    _this.toDispose(updateHub.dataSourcePropertyChanged.add(function (args) {\n      return _this._onDataSourcePropertyChanged(args);\n    }));\n\n    _this.toDispose(_this.selectedDataSource.subscribe(function (dataSource) {\n      _this.selectedPath('');\n\n      if (dataSource instanceof sql_data_source_1.SqlDataSource) {\n        var sqlDataSource = dataSource;\n        if (sqlDataSource.queries().length > 0) _this._expandQuery(sqlDataSource, sqlDataSource.queries()[0].name());\n      }\n    }));\n\n    if (_this.accessibleDataSourcesExtension()) {\n      _this.dataSourceActions.push({\n        click: function () {\n          return _this.showAddDataSourceForm();\n        },\n        text: _default_1.getLocalizationById('DashboardWebStringId.Add'),\n        disabled: ko.computed(function () {\n          return false;\n        })\n      });\n    }\n\n    _this.editDataSourceActions.push({\n      click: function () {\n        return _this.addCalculatedField();\n      },\n      text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.AddCalculatedField'),\n      visible: ko.computed(function () {\n        return _this.canAddCalculatedField;\n      })\n    });\n\n    if (_this.canEditDataSource) {\n      _this.editDataSourceActions.push({\n        click: function () {\n          return _this.addQuery();\n        },\n        text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.AddQuery'),\n        visible: ko.computed(function () {\n          return _this.allowAddQuery();\n        })\n      });\n\n      _this.editDataSourceActions.push({\n        click: function () {\n          return _this.editDataSource();\n        },\n        text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.Edit'),\n        visible: ko.computed(function () {\n          return _this.allowEditDataSource();\n        })\n      });\n\n      _this.editDataSourceActions.push({\n        click: function () {\n          return _this.manageQueries();\n        },\n        text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.ManageQueries'),\n        visible: ko.computed(function () {\n          return _this.allowManageQueries();\n        })\n      });\n    }\n\n    _this.editDataSourceActions.push({\n      click: function () {\n        return _this.editFilter();\n      },\n      text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.Filter'),\n      visible: ko.computed(function () {\n        return _this.filterEditorModel() !== null;\n      })\n    });\n\n    _this.dataSourceTreeListViewModel = new DataSourceTreeListViewModel(_this);\n    return _this;\n  }\n\n  DataSourceBrowserViewModel.prototype._expandQuery = function (dataSource, queryName) {\n    var _this = this;\n\n    this.dataSourceBrowser.getDataFieldsArray(dataSource.componentName(), queryName, '', _data_source_browser_1.isNonCollectionDataField).done(function (dataFields) {\n      if (dataFields.length > 0) {\n        _this.selectedPath([dataSource.componentName(), queryName, dataFields[0].name()].join('.'));\n      }\n    });\n  };\n\n  Object.defineProperty(DataSourceBrowserViewModel.prototype, \"canEditDataSource\", {\n    get: function () {\n      return !!this.dataSourceWizardExtension();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataSourceBrowserViewModel.prototype, \"canEditCustomSqlQueries\", {\n    get: function () {\n      return this.dataSourceWizardExtension() && this.dataSourceWizardExtension().isCustomSqlEnabled || false;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DataSourceBrowserViewModel.prototype.refreshFieldList = function () {\n    this.dataSourceBrowser.clearFieldsCache(this.selectedDataSourceComponentName());\n    this.dataSourceBrowser.initDataSource(this.selectedDataSource());\n    this.dataSourceTreeListViewModel.triggerItemsChanged();\n  };\n\n  DataSourceBrowserViewModel.prototype.showAddDataSourceForm = function () {\n    var _this = this;\n\n    this.popupContent(new _add_data_source_popup_1.AddDataSourcePopup(this.accessibleDataSourcesExtension, function (ds) {\n      return !ds.componentName() || _helper_classes_1.NameGenerator.isValidName(ds.componentName(), _this.dataSourceBrowser._dataSources(), 'componentName');\n    }, this.addDataSources, this.popupVisible));\n  };\n\n  DataSourceBrowserViewModel.prototype.editQuery = function (queryName) {\n    if (this.canEditDataSource) {\n      this.dataSourceWizardExtension().showSqlQueryEditingDialog(this.selectedDataSource(), queryName);\n    }\n  };\n\n  DataSourceBrowserViewModel.prototype.editFederationQuery = function (queryName) {\n    if (this.canEditDataSource) {\n      this.dataSourceWizardExtension().showFederationQueryEditingDialog(this.selectedDataSource(), queryName);\n    }\n  };\n\n  DataSourceBrowserViewModel.prototype.manageFederationQueries = function () {\n    if (this.canEditDataSource) {\n      this.dataSourceWizardExtension().showManageFederationQueriesDialog(this.selectedDataSource());\n    }\n  };\n\n  DataSourceBrowserViewModel.prototype.removeQuery = function (queryName) {\n    var sqlDataSource = this.selectedDataSource();\n\n    if (sqlDataSource) {\n      var queryToRemove = sqlDataSource.queries().filter(function (query) {\n        return query.name() === queryName;\n      })[0];\n\n      if (queryToRemove) {\n        sqlDataSource.queries.remove(queryToRemove);\n        sqlDataSource.calculatedFields.remove(function (calcField) {\n          return calcField.dataMember() === queryName;\n        });\n      }\n    }\n  };\n\n  DataSourceBrowserViewModel.prototype.removeFederationQuery = function (queryName) {\n    var federationDataSource = this.selectedDataSource();\n\n    if (federationDataSource) {\n      var queryToRemove = federationDataSource.queries().find(function (query) {\n        return query.alias() === queryName;\n      });\n\n      if (queryToRemove) {\n        federationDataSource.queries.remove(queryToRemove);\n        federationDataSource.calculatedFields.remove(function (calcField) {\n          return calcField.dataMember() === queryName;\n        });\n      }\n    }\n  };\n\n  DataSourceBrowserViewModel.prototype.editDataSource = function () {\n    if (this.canEditDataSource) {\n      var selectedDataSource = this.selectedDataSource();\n      if (selectedDataSource instanceof json_data_source_1.JsonDataSource) this.dataSourceWizardExtension()._showEditJsonDataSourceDialog(selectedDataSource);\n    }\n  };\n\n  DataSourceBrowserViewModel.prototype._removeDataSource = function (dataSource) {\n    this.selectedDataSource(null);\n    this.dataSourceBrowser.removeDataSource(dataSource);\n\n    if (this.dataSourceBrowser._dataSources().length > 0) {\n      this.selectedDataSource(this.dataSourceBrowser._dataSources()[0]);\n    }\n  };\n\n  Object.defineProperty(DataSourceBrowserViewModel.prototype, \"canAddCalculatedField\", {\n    get: function () {\n      return this.calcFieldEditor.canAddCalculatedField(this.selectedDataSourceComponentName());\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DataSourceBrowserViewModel.prototype._onDataSourcePropertyChanged = function (args) {\n    if (!args.propertyName) this.refreshFieldList();else {\n      if (args.dataSource instanceof sql_data_source_1.SqlDataSource) {\n        var sqlDataSource = args.dataSource;\n\n        switch (args.propertyName) {\n          case 'queries':\n            if (args.status === 'added') {\n              var queryName = args.model.name();\n\n              this._expandQuery(sqlDataSource, queryName);\n\n              this.refreshFieldList();\n            } else if (args.status === 'deleted') {\n              this.refreshFieldList();\n            }\n\n        }\n      } else if (args.dataSource instanceof json_data_source_1.JsonDataSource) {\n        switch (args.propertyName) {\n          case 'rootElement':\n          case 'schema':\n            this.refreshFieldList();\n            break;\n        }\n      } else if (args.dataSource instanceof model_1.FederationDataSource) {\n        var federationDataSource = args.dataSource;\n\n        switch (args.propertyName) {\n          case 'queries':\n            if (args.status === 'added') {\n              var queryName = args.model.alias();\n\n              this._expandQuery(federationDataSource, queryName);\n\n              this.refreshFieldList();\n            } else if (args.status === 'deleted') {\n              this.refreshFieldList();\n            }\n\n        }\n      }\n\n      if (args.dataSource.hasCalculatedFields) {\n        switch (args.propertyName) {\n          case 'fieldType':\n          case 'expression':\n            this.refreshFieldList();\n            break;\n\n          case 'calculatedFields':\n            if (args.status === 'added' || args.status === 'deleted') this.refreshFieldList();\n            break;\n        }\n      }\n    }\n  };\n\n  __decorate([_undo_engine_helper_1.wrapWithUndoRedo], DataSourceBrowserViewModel.prototype, \"_removeDataSource\", null);\n\n  return DataSourceBrowserViewModel;\n}(disposable_object_1.DisposableObject);\n\nexports.DataSourceBrowserViewModel = DataSourceBrowserViewModel;\n\nvar DataSourceTreeListViewModel = function () {\n  function DataSourceTreeListViewModel(dataSourceBrowserViewModel) {\n    var _this = this;\n\n    this.treeListEditorOption = ko.observable();\n    index_internal_1.subscribeAndPerform(dataSourceBrowserViewModel.selectedDataSource, function (newDataSource) {\n      if (newDataSource) {\n        var getFieldsCallback = function (dataSourceName, dataMember, fieldPath) {\n          return dataSourceBrowserViewModel.dataSourceBrowser.getDataFieldsArray(dataSourceName, dataMember, fieldPath, function () {\n            return true;\n          });\n        };\n\n        _this._itemsProvider = new _field_list_item_provider_1.FieldListItemProvider(dataSourceBrowserViewModel, getFieldsCallback);\n\n        _this.treeListEditorOption({\n          itemsProvider: _this._itemsProvider,\n          treeListController: new DashboardTreeListController(),\n          selectedPath: dataSourceBrowserViewModel.selectedPath,\n          templateName: 'dx-dashboard-treelist-item-template',\n          path: ko.observable(dataSourceBrowserViewModel.selectedDataSourceComponentName())\n        });\n      } else {\n        _this.treeListEditorOption(null);\n      }\n    });\n  }\n\n  DataSourceTreeListViewModel.prototype.triggerItemsChanged = function () {\n    this._itemsProvider && this._itemsProvider.triggerItemsChanged();\n  };\n\n  return DataSourceTreeListViewModel;\n}();\n\nexports.DataSourceTreeListViewModel = DataSourceTreeListViewModel;\n\nvar DashboardTreeListController = function (_super) {\n  __extends(DashboardTreeListController, _super);\n\n  function DashboardTreeListController() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DashboardTreeListController.prototype.hasItems = function (item) {\n    return item['hasItems'];\n  };\n\n  DashboardTreeListController.prototype.canSelect = function (value) {\n    return !value.data.isList;\n  };\n\n  return DashboardTreeListController;\n}(analytics_widgets_internal_1.TreeListController);","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/data-source-browser/_data-source-browser-viewmodel.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","exports","value","DataSourceTreeListViewModel","DataSourceBrowserViewModel","analytics_widgets_1","require","analytics_widgets_internal_1","ko","_data_source_browser_1","_default_1","model_1","json_data_source_1","sql_data_source_1","disposable_object_1","index_internal_1","_helper_classes_1","_undo_engine_helper_1","_calc_field_editor_1","_expression_editor_item_provider_1","_filter_utils_1","_field_list_item_provider_1","_rename_data_source_popup_1","_add_data_source_popup_1","_super","dataSourceBrowser","dataSourceWizardExtension","accessibleDataSourcesExtension","updateHub","_this","editDataSourceActions","observableArray","addDataSources","dataSources","forEach","dataSource","name","NameGenerator","isValidName","_dataSources","prefix","getLocalizationById","getDisplayNamePrefix","generateName","push","selectedDataSource","addQuery","editQuery","manageQueries","manageFederationQueries","dataSourceActions","removeDataSource","_removeDataSource","showRenameDataSourceForm","renameDataSourcePopup","show","usedDataSourcesExist","availableDataSourcesExist","popupContent","observable","popupVisible","computed","read","write","val","undefined","addCalculatedField","canAddCalculatedField","_a","findDataMember","trimLeadingPathElement","selectedPath","componentName","dataMember","fieldPath","supportDataMembers","getFirstDataMember","pathInCache","selectedDataSourceComponentName","concat","calcFieldEditor","showAddDialog","then","calcField","newCalculatedFieldPath","join","editCalcField","field","showEditDialog","removeCalcField","filterEditorModel","hasFilter","filterString","filter","options","createItemFilterOptions","path","filterEditorItemsProvider","ExpressionEditorItemsProvider","parameters","isAggregate","FilterEditor","editFilter","CalcFieldEditor","RenameDataSourcePopup","allowAddQuery","SqlDataSource","allowManageQueries","FederationDataSource","allowEditDataSource","JsonDataSource","toDispose","dataSourcePropertyChanged","add","args","_onDataSourcePropertyChanged","subscribe","sqlDataSource","queries","_expandQuery","click","showAddDataSourceForm","text","disabled","visible","canEditDataSource","editDataSource","dataSourceTreeListViewModel","queryName","getDataFieldsArray","isNonCollectionDataField","done","dataFields","get","enumerable","configurable","isCustomSqlEnabled","refreshFieldList","clearFieldsCache","initDataSource","triggerItemsChanged","AddDataSourcePopup","ds","showSqlQueryEditingDialog","editFederationQuery","showFederationQueryEditingDialog","showManageFederationQueriesDialog","removeQuery","queryToRemove","query","remove","calculatedFields","removeFederationQuery","federationDataSource","find","alias","_showEditJsonDataSourceDialog","propertyName","status","model","hasCalculatedFields","wrapWithUndoRedo","DisposableObject","dataSourceBrowserViewModel","treeListEditorOption","subscribeAndPerform","newDataSource","getFieldsCallback","dataSourceName","_itemsProvider","FieldListItemProvider","itemsProvider","treeListController","DashboardTreeListController","templateName","apply","hasItems","item","canSelect","data","isList","TreeListController"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_data-source-browser-viewmodel.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DataSourceTreeListViewModel = exports.DataSourceBrowserViewModel = void 0;\nvar analytics_widgets_1 = require(\"@devexpress/analytics-core/analytics-widgets\");\nvar analytics_widgets_internal_1 = require(\"@devexpress/analytics-core/analytics-widgets-internal\");\nvar ko = require(\"knockout\");\nvar _data_source_browser_1 = require(\"../../common/_data-source-browser\");\nvar _default_1 = require(\"../../data/localization/_default\");\nvar model_1 = require(\"../../model\");\nvar json_data_source_1 = require(\"../../model/data-sources/json-data-source\");\nvar sql_data_source_1 = require(\"../../model/data-sources/sql-data-source\");\nvar disposable_object_1 = require(\"../../model/disposable-object\");\nvar index_internal_1 = require(\"../../model/index.internal\");\nvar _helper_classes_1 = require(\"../../model/internal/_helper-classes\");\nvar _undo_engine_helper_1 = require(\"../../model/internal/_undo-engine-helper\");\nvar _calc_field_editor_1 = require(\"../calc-field-editor/_calc-field-editor\");\nvar _expression_editor_item_provider_1 = require(\"../expression-editor/_expression-editor-item-provider\");\nvar _filter_utils_1 = require(\"../filtering/_filter-utils\");\nvar _field_list_item_provider_1 = require(\"./item-providers/_field-list-item-provider\");\nvar _rename_data_source_popup_1 = require(\"./rename-data-source-popup/_rename-data-source-popup\");\nvar _add_data_source_popup_1 = require(\"./_add-data-source-popup\");\nvar DataSourceBrowserViewModel = (function (_super) {\n    __extends(DataSourceBrowserViewModel, _super);\n    function DataSourceBrowserViewModel(dataSourceBrowser, dataSourceWizardExtension, accessibleDataSourcesExtension, updateHub) {\n        var _this = _super.call(this) || this;\n        _this.dataSourceBrowser = dataSourceBrowser;\n        _this.dataSourceWizardExtension = dataSourceWizardExtension;\n        _this.accessibleDataSourcesExtension = accessibleDataSourcesExtension;\n        _this.editDataSourceActions = ko.observableArray();\n        _this.addDataSources = function (dataSources) {\n            dataSources.forEach(function (dataSource) {\n                if (!dataSource.name() || !_helper_classes_1.NameGenerator.isValidName(dataSource.name(), _this.dataSourceBrowser._dataSources(), 'name')) {\n                    var prefix = !dataSource.name() ? _default_1.getLocalizationById(dataSource.getDisplayNamePrefix()) : dataSource.name();\n                    dataSource.name(_helper_classes_1.NameGenerator.generateName(prefix + ' ', _this.dataSourceBrowser._dataSources(), 'name', 1));\n                }\n                _this.dataSourceBrowser._dataSources.push(dataSource);\n                _this.selectedDataSource(dataSource);\n            });\n        };\n        _this.addQuery = function () {\n            _this.editQuery(null);\n        };\n        _this.manageQueries = function () {\n            _this.manageFederationQueries();\n        };\n        _this.dataSourceActions = ko.observableArray();\n        _this.removeDataSource = function (dataSource) {\n            _this._removeDataSource(dataSource);\n        };\n        _this.showRenameDataSourceForm = function (dataSource) {\n            _this.renameDataSourcePopup.show(dataSource);\n        };\n        _this.usedDataSourcesExist = function () {\n            return _this.dataSourceBrowser._dataSources().length > 0;\n        };\n        _this.availableDataSourcesExist = function () {\n            return _this.accessibleDataSourcesExtension() && _this.accessibleDataSourcesExtension().dataSources().length > 0;\n        };\n        _this.popupContent = ko.observable();\n        _this.popupVisible = ko.computed({\n            read: function () {\n                return !!_this.popupContent();\n            },\n            write: function (val) {\n                if (!val) {\n                    _this.popupContent(undefined);\n                }\n            }\n        });\n        _this.addCalculatedField = function () {\n            if (_this.canAddCalculatedField) {\n                var dataSource = _this.selectedDataSource();\n                var _a = _data_source_browser_1.findDataMember(dataSource, _data_source_browser_1.trimLeadingPathElement(_this.selectedPath(), dataSource.componentName())), dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n                if (!dataMember && dataSource.supportDataMembers) {\n                    dataMember = _data_source_browser_1.getFirstDataMember(dataSource);\n                }\n                var pathInCache = [_this.selectedDataSourceComponentName()].concat(dataMember ? [dataMember] : []);\n                _this.calcFieldEditor.showAddDialog(dataSource.componentName(), dataMember)\n                    .then(function (calcField) {\n                    var newCalculatedFieldPath = pathInCache.concat([calcField.name()]);\n                    _this.selectedPath(newCalculatedFieldPath.join('.'));\n                });\n            }\n        };\n        _this.editCalcField = function (field) {\n            _this.calcFieldEditor.showEditDialog(field, _this.selectedDataSourceComponentName(), field.dataMember());\n        };\n        _this.removeCalcField = function (field) {\n            _this.calcFieldEditor.removeCalcField(field, _this.selectedDataSource().componentName());\n        };\n        _this.selectedPath = ko.observable();\n        _this.selectedDataSource = ko.observable();\n        _this.filterEditorModel = ko.computed(function () {\n            if (_this.selectedDataSource() && _this.selectedDataSource().hasFilter) {\n                var filterString = _this.selectedDataSource().filter;\n                var options = _filter_utils_1.createItemFilterOptions(filterString, undefined, _this.dataSourceBrowser);\n                options().path(_this.selectedDataSource().componentName());\n                var filterEditorItemsProvider = new _expression_editor_item_provider_1.ExpressionEditorItemsProvider(_this.dataSourceBrowser, _this.dataSourceBrowser, _this.dataSourceBrowser.parameters(), _this.selectedDataSource().componentName, ko.observable(''), function (field) { return !field.isAggregate(); });\n                return new analytics_widgets_1.FilterEditor(options, ko.observable(filterEditorItemsProvider));\n            }\n            return null;\n        });\n        _this.editFilter = function () {\n            _this.filterEditorModel() && _this.filterEditorModel().popupVisible(true);\n        };\n        _this.calcFieldEditor = new _calc_field_editor_1.CalcFieldEditor(_this.dataSourceBrowser);\n        _this.renameDataSourcePopup = new _rename_data_source_popup_1.RenameDataSourcePopup(_this.dataSourceBrowser);\n        if (dataSourceBrowser._dataSources().length > 0) {\n            _this.selectedDataSource(dataSourceBrowser._dataSources()[0]);\n        }\n        _this.selectedDataSourceComponentName = ko.computed(function () {\n            return _this.selectedDataSource() && _this.selectedDataSource().componentName() || '';\n        });\n        _this.allowAddQuery = ko.computed(function () {\n            return _this.selectedDataSource() instanceof sql_data_source_1.SqlDataSource;\n        });\n        _this.allowManageQueries = ko.computed(function () {\n            return _this.selectedDataSource() instanceof model_1.FederationDataSource;\n        });\n        _this.allowEditDataSource = ko.computed(function () {\n            return _this.selectedDataSource() instanceof json_data_source_1.JsonDataSource;\n        });\n        _this.toDispose(_this.allowAddQuery);\n        _this.toDispose(_this.allowManageQueries);\n        _this.toDispose(_this.allowEditDataSource);\n        _this.toDispose(updateHub.dataSourcePropertyChanged.add(function (args) { return _this._onDataSourcePropertyChanged(args); }));\n        _this.toDispose(_this.selectedDataSource.subscribe(function (dataSource) {\n            _this.selectedPath('');\n            if (dataSource instanceof sql_data_source_1.SqlDataSource) {\n                var sqlDataSource = dataSource;\n                if (sqlDataSource.queries().length > 0)\n                    _this._expandQuery(sqlDataSource, sqlDataSource.queries()[0].name());\n            }\n        }));\n        if (_this.accessibleDataSourcesExtension()) {\n            _this.dataSourceActions.push({\n                click: function () { return _this.showAddDataSourceForm(); },\n                text: _default_1.getLocalizationById('DashboardWebStringId.Add'),\n                disabled: ko.computed(function () { return false; })\n            });\n        }\n        _this.editDataSourceActions.push({\n            click: function () { return _this.addCalculatedField(); },\n            text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.AddCalculatedField'),\n            visible: ko.computed(function () { return _this.canAddCalculatedField; })\n        });\n        if (_this.canEditDataSource) {\n            _this.editDataSourceActions.push({\n                click: function () { return _this.addQuery(); },\n                text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.AddQuery'),\n                visible: ko.computed(function () { return _this.allowAddQuery(); })\n            });\n            _this.editDataSourceActions.push({\n                click: function () { return _this.editDataSource(); },\n                text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.Edit'),\n                visible: ko.computed(function () { return _this.allowEditDataSource(); })\n            });\n            _this.editDataSourceActions.push({\n                click: function () { return _this.manageQueries(); },\n                text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.ManageQueries'),\n                visible: ko.computed(function () { return _this.allowManageQueries(); })\n            });\n        }\n        _this.editDataSourceActions.push({\n            click: function () { return _this.editFilter(); },\n            text: _default_1.getLocalizationById('DashboardWebStringId.DataSources.Filter'),\n            visible: ko.computed(function () { return _this.filterEditorModel() !== null; })\n        });\n        _this.dataSourceTreeListViewModel = new DataSourceTreeListViewModel(_this);\n        return _this;\n    }\n    DataSourceBrowserViewModel.prototype._expandQuery = function (dataSource, queryName) {\n        var _this = this;\n        this.dataSourceBrowser.getDataFieldsArray(dataSource.componentName(), queryName, '', _data_source_browser_1.isNonCollectionDataField).done(function (dataFields) {\n            if (dataFields.length > 0) {\n                _this.selectedPath([dataSource.componentName(), queryName, dataFields[0].name()].join('.'));\n            }\n        });\n    };\n    Object.defineProperty(DataSourceBrowserViewModel.prototype, \"canEditDataSource\", {\n        get: function () {\n            return !!this.dataSourceWizardExtension();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataSourceBrowserViewModel.prototype, \"canEditCustomSqlQueries\", {\n        get: function () {\n            return this.dataSourceWizardExtension() && this.dataSourceWizardExtension().isCustomSqlEnabled || false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DataSourceBrowserViewModel.prototype.refreshFieldList = function () {\n        this.dataSourceBrowser.clearFieldsCache(this.selectedDataSourceComponentName());\n        this.dataSourceBrowser.initDataSource(this.selectedDataSource());\n        this.dataSourceTreeListViewModel.triggerItemsChanged();\n    };\n    DataSourceBrowserViewModel.prototype.showAddDataSourceForm = function () {\n        var _this = this;\n        this.popupContent(new _add_data_source_popup_1.AddDataSourcePopup(this.accessibleDataSourcesExtension, function (ds) { return !ds.componentName() || _helper_classes_1.NameGenerator.isValidName(ds.componentName(), _this.dataSourceBrowser._dataSources(), 'componentName'); }, this.addDataSources, this.popupVisible));\n    };\n    DataSourceBrowserViewModel.prototype.editQuery = function (queryName) {\n        if (this.canEditDataSource) {\n            this.dataSourceWizardExtension().showSqlQueryEditingDialog(this.selectedDataSource(), queryName);\n        }\n    };\n    DataSourceBrowserViewModel.prototype.editFederationQuery = function (queryName) {\n        if (this.canEditDataSource) {\n            this.dataSourceWizardExtension().showFederationQueryEditingDialog(this.selectedDataSource(), queryName);\n        }\n    };\n    DataSourceBrowserViewModel.prototype.manageFederationQueries = function () {\n        if (this.canEditDataSource) {\n            this.dataSourceWizardExtension().showManageFederationQueriesDialog(this.selectedDataSource());\n        }\n    };\n    DataSourceBrowserViewModel.prototype.removeQuery = function (queryName) {\n        var sqlDataSource = this.selectedDataSource();\n        if (sqlDataSource) {\n            var queryToRemove = sqlDataSource.queries().filter(function (query) { return query.name() === queryName; })[0];\n            if (queryToRemove) {\n                sqlDataSource.queries.remove(queryToRemove);\n                sqlDataSource.calculatedFields.remove(function (calcField) { return calcField.dataMember() === queryName; });\n            }\n        }\n    };\n    DataSourceBrowserViewModel.prototype.removeFederationQuery = function (queryName) {\n        var federationDataSource = this.selectedDataSource();\n        if (federationDataSource) {\n            var queryToRemove = federationDataSource.queries().find(function (query) { return query.alias() === queryName; });\n            if (queryToRemove) {\n                federationDataSource.queries.remove(queryToRemove);\n                federationDataSource.calculatedFields.remove(function (calcField) { return calcField.dataMember() === queryName; });\n            }\n        }\n    };\n    DataSourceBrowserViewModel.prototype.editDataSource = function () {\n        if (this.canEditDataSource) {\n            var selectedDataSource = this.selectedDataSource();\n            if (selectedDataSource instanceof json_data_source_1.JsonDataSource)\n                this.dataSourceWizardExtension()._showEditJsonDataSourceDialog(selectedDataSource);\n        }\n    };\n    DataSourceBrowserViewModel.prototype._removeDataSource = function (dataSource) {\n        this.selectedDataSource(null);\n        this.dataSourceBrowser.removeDataSource(dataSource);\n        if (this.dataSourceBrowser._dataSources().length > 0) {\n            this.selectedDataSource(this.dataSourceBrowser._dataSources()[0]);\n        }\n    };\n    Object.defineProperty(DataSourceBrowserViewModel.prototype, \"canAddCalculatedField\", {\n        get: function () {\n            return this.calcFieldEditor.canAddCalculatedField(this.selectedDataSourceComponentName());\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DataSourceBrowserViewModel.prototype._onDataSourcePropertyChanged = function (args) {\n        if (!args.propertyName)\n            this.refreshFieldList();\n        else {\n            if (args.dataSource instanceof sql_data_source_1.SqlDataSource) {\n                var sqlDataSource = args.dataSource;\n                switch (args.propertyName) {\n                    case 'queries':\n                        if (args.status === 'added') {\n                            var queryName = args.model.name();\n                            this._expandQuery(sqlDataSource, queryName);\n                            this.refreshFieldList();\n                        }\n                        else if (args.status === 'deleted') {\n                            this.refreshFieldList();\n                        }\n                }\n            }\n            else if (args.dataSource instanceof json_data_source_1.JsonDataSource) {\n                switch (args.propertyName) {\n                    case 'rootElement':\n                    case 'schema':\n                        this.refreshFieldList();\n                        break;\n                }\n            }\n            else if (args.dataSource instanceof model_1.FederationDataSource) {\n                var federationDataSource = args.dataSource;\n                switch (args.propertyName) {\n                    case 'queries':\n                        if (args.status === 'added') {\n                            var queryName = args.model.alias();\n                            this._expandQuery(federationDataSource, queryName);\n                            this.refreshFieldList();\n                        }\n                        else if (args.status === 'deleted') {\n                            this.refreshFieldList();\n                        }\n                }\n            }\n            if (args.dataSource.hasCalculatedFields) {\n                switch (args.propertyName) {\n                    case 'fieldType':\n                    case 'expression':\n                        this.refreshFieldList();\n                        break;\n                    case 'calculatedFields':\n                        if (args.status === 'added' || args.status === 'deleted')\n                            this.refreshFieldList();\n                        break;\n                }\n            }\n        }\n    };\n    __decorate([\n        _undo_engine_helper_1.wrapWithUndoRedo\n    ], DataSourceBrowserViewModel.prototype, \"_removeDataSource\", null);\n    return DataSourceBrowserViewModel;\n}(disposable_object_1.DisposableObject));\nexports.DataSourceBrowserViewModel = DataSourceBrowserViewModel;\nvar DataSourceTreeListViewModel = (function () {\n    function DataSourceTreeListViewModel(dataSourceBrowserViewModel) {\n        var _this = this;\n        this.treeListEditorOption = ko.observable();\n        index_internal_1.subscribeAndPerform(dataSourceBrowserViewModel.selectedDataSource, function (newDataSource) {\n            if (newDataSource) {\n                var getFieldsCallback = function (dataSourceName, dataMember, fieldPath) { return dataSourceBrowserViewModel.dataSourceBrowser.getDataFieldsArray(dataSourceName, dataMember, fieldPath, function () { return true; }); };\n                _this._itemsProvider = new _field_list_item_provider_1.FieldListItemProvider(dataSourceBrowserViewModel, getFieldsCallback);\n                _this.treeListEditorOption({\n                    itemsProvider: _this._itemsProvider,\n                    treeListController: new DashboardTreeListController(),\n                    selectedPath: dataSourceBrowserViewModel.selectedPath,\n                    templateName: 'dx-dashboard-treelist-item-template',\n                    path: ko.observable(dataSourceBrowserViewModel.selectedDataSourceComponentName())\n                });\n            }\n            else {\n                _this.treeListEditorOption(null);\n            }\n        });\n    }\n    DataSourceTreeListViewModel.prototype.triggerItemsChanged = function () {\n        this._itemsProvider && this._itemsProvider.triggerItemsChanged();\n    };\n    return DataSourceTreeListViewModel;\n}());\nexports.DataSourceTreeListViewModel = DataSourceTreeListViewModel;\nvar DashboardTreeListController = (function (_super) {\n    __extends(DashboardTreeListController, _super);\n    function DashboardTreeListController() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DashboardTreeListController.prototype.hasItems = function (item) {\n        return item['hasItems'];\n    };\n    DashboardTreeListController.prototype.canSelect = function (value) {\n        return !value.data.isList;\n    };\n    return DashboardTreeListController;\n}(analytics_widgets_internal_1.TreeListController));\n"]},"metadata":{},"sourceType":"script"}