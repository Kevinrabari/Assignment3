{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_pie-map-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.pieMapItem = void 0;\n\nvar color_1 = require(\"devextreme/color\");\n\nvar string_1 = require(\"devextreme/core/utils/string\");\n\nvar _jquery_helpers_1 = require(\"../../data/_jquery-helpers\");\n\nvar _geo_point_map_item_base_1 = require(\"./_geo-point-map-item-base\");\n\nvar pieMapItem = function (_super) {\n  __extends(pieMapItem, _super);\n\n  function pieMapItem(container, options) {\n    var _this = _super.call(this, container, options) || this;\n\n    _this.itemElementCustomColor = _jquery_helpers_1.createJQueryCallbacks();\n    _this._pieUniqueArguments = undefined;\n    _this._pieArgumentDisplayTexts = undefined;\n    _this._pieArgumentColors = undefined;\n    _this.itemElementCustomColor = _jquery_helpers_1.createJQueryCallbacks();\n    return _this;\n  }\n\n  Object.defineProperty(pieMapItem.prototype, \"dataController\", {\n    get: function () {\n      return this._dataController;\n    },\n    set: function (dataController) {\n      this._dataController = dataController;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  pieMapItem.prototype._getMarkerLayers = function () {\n    return [this.mapViewer.getLayerByName('pie')];\n  };\n\n  pieMapItem.prototype._configureMarkerLayers = function (viewModel) {\n    var viewModel = this.options.ViewModel,\n        pieSegments = this._getPieSegments(),\n        pies = this._getPiesData(pieSegments, viewModel),\n        markerDataSource = this._getMarkerDataSource(pies, viewModel.IsWeighted),\n        markerSettings = this._getPieMapMarker(viewModel, markerDataSource, pies);\n\n    return [__assign({\n      name: 'pie',\n      type: 'marker',\n      elementType: 'pie',\n      dataField: 'values',\n      dataSource: markerDataSource\n    }, markerSettings)];\n  };\n\n  pieMapItem.prototype._getPieMapMarker = function (viewModel, markerDataSource, pies) {\n    if (markerDataSource.length === 0) {\n      return;\n    }\n\n    var markerSettings = this._getMarker(viewModel, markerDataSource);\n\n    if (viewModel.IsWeighted) {\n      markerSettings.sizeGroupingField = 'sizeValue';\n      markerSettings.sizeGroups = this._getPieRangeStops(pies);\n      markerSettings.minSize = 20;\n      markerSettings.maxSize = 60;\n    }\n\n    markerSettings.palette = this._pieArgumentColors;\n    return markerSettings;\n  };\n\n  pieMapItem.prototype._getMarkerDataSource = function (pies, isWeighted) {\n    var markerDataSource = [],\n        attributes,\n        rangeStops = [0, 1, 2];\n\n    for (var name in pies) {\n      attributes = pies[name].attributes;\n\n      if (!isWeighted) {\n        attributes.size = 20 + this._getRangeStopIndex(pies[name].attributes.sizeValue, rangeStops) * 10;\n      }\n\n      markerDataSource.push({\n        coordinates: pies[name].coordinates,\n        attributes: attributes\n      });\n    }\n\n    return markerDataSource;\n  };\n\n  pieMapItem.prototype._getColorLegend = function (viewModel) {\n    var that = this;\n\n    var legend = _super.prototype._getColorLegend.call(this, viewModel);\n\n    if (legend) {\n      legend.source.layer = 'pie';\n\n      legend.customizeText = function (arg) {\n        return that._pieArgumentDisplayTexts[arg.index];\n      };\n    }\n\n    return legend;\n  };\n\n  pieMapItem.prototype._getWeightLegend = function (viewModel) {\n    var that = this;\n\n    if (!viewModel.IsWeighted) {\n      return;\n    }\n\n    var legend = _super.prototype._getWeightLegend.call(this, viewModel);\n\n    if (legend) {\n      legend.source.layer = 'pie';\n\n      legend.customizeText = function (arg) {\n        return that._dataController.formatValue(arg.start);\n      };\n    }\n\n    return legend;\n  };\n\n  pieMapItem.prototype._getPieSegments = function () {\n    var that = this,\n        viewModel = this.options.ViewModel,\n        pieSegments = [],\n        pieSegment,\n        filledValues = viewModel.Values && viewModel.Values.length > 0,\n        getPieSegment = function (point) {\n      return {\n        clusterCount: point.pointsCount,\n        lat: point.lat,\n        lon: point.lon,\n        latSel: point.latSel,\n        lonSel: point.lonSel,\n        dimensionsTooltipText: that._getDimensionsTooltipHtml(point.tooltipDimensions),\n        measuresTooltipText: that._getMeasuresTooltipHtml(point.tooltipMeasures),\n        value: point.value,\n        valueDisplayText: point.valueDisplayText,\n        argumentValue: point.argument,\n        argumentDisplayText: point.argumentDisplayText,\n        color: point.color,\n        valueId: point.valueId,\n        axisPoint: point.axisPoint\n      };\n    };\n\n    that._pieUniqueArguments = [];\n    that._pieArgumentDisplayTexts = [];\n    that._pieArgumentColors = [];\n\n    for (var i = 0; i < that._dataController.getCount(); i++) {\n      if (viewModel.ArgumentDataId) {\n        pieSegment = getPieSegment(that._dataController.getPoint(i));\n\n        if (that._pieUniqueArguments.indexOf(pieSegment.argumentValue) === -1) {\n          that._fillArgumentParams(pieSegment);\n        }\n\n        pieSegments.push(pieSegment);\n      } else {\n        if (filledValues) {\n          for (var j = 0; j < viewModel.Values.length; j++) {\n            pieSegment = getPieSegment(that._dataController.getPoint(i, j));\n\n            if (that._pieUniqueArguments.indexOf(pieSegment.argumentValue) === -1 || i === 0) {\n              that._fillArgumentParams(pieSegment);\n            }\n\n            pieSegments.push(pieSegment);\n          }\n        }\n      }\n    }\n\n    return pieSegments;\n  };\n\n  pieMapItem.prototype._fillArgumentParams = function (pieSegment) {\n    var that = this,\n        color = pieSegment.color,\n        dxColor = new color_1.default(color);\n\n    this._pieUniqueArguments.push(pieSegment.argumentValue);\n\n    this._pieArgumentDisplayTexts.push(pieSegment.argumentDisplayText);\n\n    if (that.itemElementCustomColor && color) {\n      var customElementColorEventArgs = {\n        targetElement: [pieSegment.axisPoint],\n        measureIds: pieSegment ? [pieSegment.valueId] : null,\n        color: dxColor.toHex()\n      };\n      that.itemElementCustomColor.fire(this.getName(), customElementColorEventArgs);\n      color = customElementColorEventArgs.color;\n    }\n\n    this._pieArgumentColors.push(color);\n  };\n\n  pieMapItem.prototype._getPiesData = function (pieSegments, viewModel) {\n    var pies = {},\n        segment,\n        key,\n        tooltip,\n        dimensionsTooltip,\n        measuresTooltip;\n\n    for (var i = 0; i < pieSegments.length; i++) {\n      segment = pieSegments[i];\n      key = string_1.format('{0};{1}', segment.lat, segment.lon);\n\n      if (!pies.hasOwnProperty(key)) {\n        dimensionsTooltip = segment.dimensionsTooltipText;\n        measuresTooltip = segment.measuresTooltipText;\n        pies[key] = {\n          coordinates: [segment.lon, segment.lat],\n          attributes: {\n            latSelection: segment.latSel,\n            lonSelection: segment.lonSel,\n            selected: this._isSelected([segment.latSel, segment.lonSel]),\n            values: this._getEmptyValues(this._pieUniqueArguments.length),\n            dimensionsTooltip: dimensionsTooltip,\n            measuresTooltip: measuresTooltip,\n            sizeValue: viewModel.IsWeighted ? 0 : segment.clusterCount > 1 ? 1 : 0\n          }\n        };\n\n        if (segment.clusterCount > 1) {\n          pies[key].attributes.tooltip = this._pointsCountTooltip(segment.clusterCount);\n        }\n      }\n\n      for (var j = 0; j < pies[key].attributes.values.length; j++) {\n        if (segment.argumentValue === this._pieUniqueArguments[j]) {\n          pies[key].attributes.values[j] = segment.value;\n        }\n      }\n\n      if (viewModel.Values && viewModel.Values.length > 0) {\n        if (segment.argumentValue && segment.value > 0) {\n          tooltip = this._getToolTip(segment.argumentDisplayText, segment.valueDisplayText);\n        } else {\n          tooltip = undefined;\n        }\n      } else {\n        tooltip = segment.argumentDisplayText;\n      }\n\n      if (tooltip) {\n        if (pies[key].attributes.tooltip) {\n          pies[key].attributes.tooltip += '<br>' + tooltip;\n        } else {\n          pies[key].attributes.tooltip = tooltip;\n        }\n      }\n\n      if (viewModel.IsWeighted) {\n        pies[key].attributes.sizeValue += segment.value;\n      } else if (this._getPieSegmentCount(pies[key]) === 2) {\n        pies[key].attributes.sizeValue++;\n      }\n    }\n\n    return pies;\n  };\n\n  pieMapItem.prototype._getPieSegmentCount = function (pie) {\n    var count = 0;\n\n    for (var i = 0; i < pie.attributes.values.length; i++) {\n      if (pie.attributes.values[i] > 0) {\n        count++;\n      }\n    }\n\n    return count;\n  };\n\n  pieMapItem.prototype._getEmptyValues = function (length) {\n    var emptyValues = [];\n\n    for (var j = 0; j < length; j++) {\n      emptyValues.push(0);\n    }\n\n    return emptyValues;\n  };\n\n  pieMapItem.prototype._getPieRangeStops = function (pies) {\n    var minSizeValue, maxSizeValue;\n\n    for (var name in pies) {\n      if (minSizeValue === undefined || pies[name].attributes.sizeValue < minSizeValue) {\n        minSizeValue = pies[name].attributes.sizeValue;\n      }\n\n      if (maxSizeValue === undefined || pies[name].attributes.sizeValue > maxSizeValue) {\n        maxSizeValue = pies[name].attributes.sizeValue;\n      }\n    }\n\n    return this._updateRangeStops([0, 25, 50, 75], minSizeValue, maxSizeValue, true);\n  };\n\n  pieMapItem.prototype._getRangeStopIndex = function (value, rangeStops) {\n    if (value < rangeStops[0]) {\n      return 0;\n    }\n\n    for (var i = 0; i < rangeStops.length - 1; i++) {\n      if (value >= rangeStops[i] && value < rangeStops[i + 1]) {\n        return i;\n      }\n    }\n\n    return rangeStops.length - 1;\n  };\n\n  pieMapItem.prototype._getDataPointMeasureIds = function () {\n    var viewModel = this.options.ViewModel,\n        measureIds = [];\n\n    if (viewModel.ArgumentDataId != null && viewModel.Values.length > 0) {\n      measureIds.push(viewModel.Values[0]);\n    } else {\n      viewModel.Values.forEach(function (value) {\n        measureIds.push(value);\n      });\n    }\n\n    return measureIds;\n  };\n\n  pieMapItem.prototype._elementCustomColor = function (eventArgs) {\n    this.itemElementCustomColor.fire(this.getName(), eventArgs);\n  };\n\n  return pieMapItem;\n}(_geo_point_map_item_base_1.geoPointMapItemBase);\n\nexports.pieMapItem = pieMapItem;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/viewer-parts/viewer-items/_pie-map-item.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","defineProperty","exports","value","pieMapItem","color_1","require","string_1","_jquery_helpers_1","_geo_point_map_item_base_1","_super","container","options","_this","itemElementCustomColor","createJQueryCallbacks","_pieUniqueArguments","undefined","_pieArgumentDisplayTexts","_pieArgumentColors","get","_dataController","set","dataController","enumerable","configurable","_getMarkerLayers","mapViewer","getLayerByName","_configureMarkerLayers","viewModel","ViewModel","pieSegments","_getPieSegments","pies","_getPiesData","markerDataSource","_getMarkerDataSource","IsWeighted","markerSettings","_getPieMapMarker","name","type","elementType","dataField","dataSource","_getMarker","sizeGroupingField","sizeGroups","_getPieRangeStops","minSize","maxSize","palette","isWeighted","attributes","rangeStops","size","_getRangeStopIndex","sizeValue","push","coordinates","_getColorLegend","that","legend","source","layer","customizeText","arg","index","_getWeightLegend","formatValue","start","pieSegment","filledValues","Values","getPieSegment","point","clusterCount","pointsCount","lat","lon","latSel","lonSel","dimensionsTooltipText","_getDimensionsTooltipHtml","tooltipDimensions","measuresTooltipText","_getMeasuresTooltipHtml","tooltipMeasures","valueDisplayText","argumentValue","argument","argumentDisplayText","color","valueId","axisPoint","getCount","ArgumentDataId","getPoint","indexOf","_fillArgumentParams","j","dxColor","default","customElementColorEventArgs","targetElement","measureIds","toHex","fire","getName","segment","key","tooltip","dimensionsTooltip","measuresTooltip","format","latSelection","lonSelection","selected","_isSelected","values","_getEmptyValues","_pointsCountTooltip","_getToolTip","_getPieSegmentCount","pie","count","emptyValues","minSizeValue","maxSizeValue","_updateRangeStops","_getDataPointMeasureIds","forEach","_elementCustomColor","eventArgs","geoPointMapItemBase"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_pie-map-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pieMapItem = void 0;\nvar color_1 = require(\"devextreme/color\");\nvar string_1 = require(\"devextreme/core/utils/string\");\nvar _jquery_helpers_1 = require(\"../../data/_jquery-helpers\");\nvar _geo_point_map_item_base_1 = require(\"./_geo-point-map-item-base\");\nvar pieMapItem = (function (_super) {\n    __extends(pieMapItem, _super);\n    function pieMapItem(container, options) {\n        var _this = _super.call(this, container, options) || this;\n        _this.itemElementCustomColor = _jquery_helpers_1.createJQueryCallbacks();\n        _this._pieUniqueArguments = undefined;\n        _this._pieArgumentDisplayTexts = undefined;\n        _this._pieArgumentColors = undefined;\n        _this.itemElementCustomColor = _jquery_helpers_1.createJQueryCallbacks();\n        return _this;\n    }\n    Object.defineProperty(pieMapItem.prototype, \"dataController\", {\n        get: function () { return this._dataController; },\n        set: function (dataController) { this._dataController = dataController; },\n        enumerable: false,\n        configurable: true\n    });\n    pieMapItem.prototype._getMarkerLayers = function () {\n        return [this.mapViewer.getLayerByName('pie')];\n    };\n    pieMapItem.prototype._configureMarkerLayers = function (viewModel) {\n        var viewModel = this.options.ViewModel, pieSegments = this._getPieSegments(), pies = this._getPiesData(pieSegments, viewModel), markerDataSource = this._getMarkerDataSource(pies, viewModel.IsWeighted), markerSettings = this._getPieMapMarker(viewModel, markerDataSource, pies);\n        return [__assign({ name: 'pie', type: 'marker', elementType: 'pie', dataField: 'values', dataSource: markerDataSource }, markerSettings)];\n    };\n    pieMapItem.prototype._getPieMapMarker = function (viewModel, markerDataSource, pies) {\n        if (markerDataSource.length === 0) {\n            return;\n        }\n        var markerSettings = this._getMarker(viewModel, markerDataSource);\n        if (viewModel.IsWeighted) {\n            markerSettings.sizeGroupingField = 'sizeValue';\n            markerSettings.sizeGroups = this._getPieRangeStops(pies);\n            markerSettings.minSize = 20;\n            markerSettings.maxSize = 60;\n        }\n        markerSettings.palette = this._pieArgumentColors;\n        return markerSettings;\n    };\n    pieMapItem.prototype._getMarkerDataSource = function (pies, isWeighted) {\n        var markerDataSource = [], attributes, rangeStops = [0, 1, 2];\n        for (var name in pies) {\n            attributes = pies[name].attributes;\n            if (!isWeighted) {\n                attributes.size = 20 + this._getRangeStopIndex(pies[name].attributes.sizeValue, rangeStops) * 10;\n            }\n            markerDataSource.push({\n                coordinates: pies[name].coordinates,\n                attributes: attributes\n            });\n        }\n        return markerDataSource;\n    };\n    pieMapItem.prototype._getColorLegend = function (viewModel) {\n        var that = this;\n        var legend = _super.prototype._getColorLegend.call(this, viewModel);\n        if (legend) {\n            legend.source.layer = 'pie';\n            legend.customizeText = function (arg) {\n                return that._pieArgumentDisplayTexts[arg.index];\n            };\n        }\n        return legend;\n    };\n    pieMapItem.prototype._getWeightLegend = function (viewModel) {\n        var that = this;\n        if (!viewModel.IsWeighted) {\n            return;\n        }\n        var legend = _super.prototype._getWeightLegend.call(this, viewModel);\n        if (legend) {\n            legend.source.layer = 'pie';\n            legend.customizeText = function (arg) {\n                return that._dataController.formatValue(arg.start);\n            };\n        }\n        return legend;\n    };\n    pieMapItem.prototype._getPieSegments = function () {\n        var that = this, viewModel = this.options.ViewModel, pieSegments = [], pieSegment, filledValues = viewModel.Values && viewModel.Values.length > 0, getPieSegment = function (point) {\n            return {\n                clusterCount: point.pointsCount,\n                lat: point.lat,\n                lon: point.lon,\n                latSel: point.latSel,\n                lonSel: point.lonSel,\n                dimensionsTooltipText: that._getDimensionsTooltipHtml(point.tooltipDimensions),\n                measuresTooltipText: that._getMeasuresTooltipHtml(point.tooltipMeasures),\n                value: point.value,\n                valueDisplayText: point.valueDisplayText,\n                argumentValue: point.argument,\n                argumentDisplayText: point.argumentDisplayText,\n                color: point.color,\n                valueId: point.valueId,\n                axisPoint: point.axisPoint\n            };\n        };\n        that._pieUniqueArguments = [];\n        that._pieArgumentDisplayTexts = [];\n        that._pieArgumentColors = [];\n        for (var i = 0; i < that._dataController.getCount(); i++) {\n            if (viewModel.ArgumentDataId) {\n                pieSegment = getPieSegment(that._dataController.getPoint(i));\n                if (that._pieUniqueArguments.indexOf(pieSegment.argumentValue) === -1) {\n                    that._fillArgumentParams(pieSegment);\n                }\n                pieSegments.push(pieSegment);\n            }\n            else {\n                if (filledValues) {\n                    for (var j = 0; j < viewModel.Values.length; j++) {\n                        pieSegment = getPieSegment(that._dataController.getPoint(i, j));\n                        if (that._pieUniqueArguments.indexOf(pieSegment.argumentValue) === -1 || i === 0) {\n                            that._fillArgumentParams(pieSegment);\n                        }\n                        pieSegments.push(pieSegment);\n                    }\n                }\n            }\n        }\n        return pieSegments;\n    };\n    pieMapItem.prototype._fillArgumentParams = function (pieSegment) {\n        var that = this, color = pieSegment.color, dxColor = new color_1.default(color);\n        this._pieUniqueArguments.push(pieSegment.argumentValue);\n        this._pieArgumentDisplayTexts.push(pieSegment.argumentDisplayText);\n        if (that.itemElementCustomColor && color) {\n            var customElementColorEventArgs = {\n                targetElement: [pieSegment.axisPoint],\n                measureIds: pieSegment ? [pieSegment.valueId] : null,\n                color: dxColor.toHex()\n            };\n            that.itemElementCustomColor.fire(this.getName(), customElementColorEventArgs);\n            color = customElementColorEventArgs.color;\n        }\n        this._pieArgumentColors.push(color);\n    };\n    pieMapItem.prototype._getPiesData = function (pieSegments, viewModel) {\n        var pies = {}, segment, key, tooltip, dimensionsTooltip, measuresTooltip;\n        for (var i = 0; i < pieSegments.length; i++) {\n            segment = pieSegments[i];\n            key = string_1.format('{0};{1}', segment.lat, segment.lon);\n            if (!pies.hasOwnProperty(key)) {\n                dimensionsTooltip = segment.dimensionsTooltipText;\n                measuresTooltip = segment.measuresTooltipText;\n                pies[key] = {\n                    coordinates: [segment.lon, segment.lat],\n                    attributes: {\n                        latSelection: segment.latSel,\n                        lonSelection: segment.lonSel,\n                        selected: this._isSelected([segment.latSel, segment.lonSel]),\n                        values: this._getEmptyValues(this._pieUniqueArguments.length),\n                        dimensionsTooltip: dimensionsTooltip,\n                        measuresTooltip: measuresTooltip,\n                        sizeValue: viewModel.IsWeighted ? 0 : segment.clusterCount > 1 ? 1 : 0\n                    }\n                };\n                if (segment.clusterCount > 1) {\n                    pies[key].attributes.tooltip = this._pointsCountTooltip(segment.clusterCount);\n                }\n            }\n            for (var j = 0; j < pies[key].attributes.values.length; j++) {\n                if (segment.argumentValue === this._pieUniqueArguments[j]) {\n                    pies[key].attributes.values[j] = segment.value;\n                }\n            }\n            if (viewModel.Values && viewModel.Values.length > 0) {\n                if (segment.argumentValue && segment.value > 0) {\n                    tooltip = this._getToolTip(segment.argumentDisplayText, segment.valueDisplayText);\n                }\n                else {\n                    tooltip = undefined;\n                }\n            }\n            else {\n                tooltip = segment.argumentDisplayText;\n            }\n            if (tooltip) {\n                if (pies[key].attributes.tooltip) {\n                    pies[key].attributes.tooltip += '<br>' + tooltip;\n                }\n                else {\n                    pies[key].attributes.tooltip = tooltip;\n                }\n            }\n            if (viewModel.IsWeighted) {\n                pies[key].attributes.sizeValue += segment.value;\n            }\n            else if (this._getPieSegmentCount(pies[key]) === 2) {\n                pies[key].attributes.sizeValue++;\n            }\n        }\n        return pies;\n    };\n    pieMapItem.prototype._getPieSegmentCount = function (pie) {\n        var count = 0;\n        for (var i = 0; i < pie.attributes.values.length; i++) {\n            if (pie.attributes.values[i] > 0) {\n                count++;\n            }\n        }\n        return count;\n    };\n    pieMapItem.prototype._getEmptyValues = function (length) {\n        var emptyValues = [];\n        for (var j = 0; j < length; j++) {\n            emptyValues.push(0);\n        }\n        return emptyValues;\n    };\n    pieMapItem.prototype._getPieRangeStops = function (pies) {\n        var minSizeValue, maxSizeValue;\n        for (var name in pies) {\n            if (minSizeValue === undefined || pies[name].attributes.sizeValue < minSizeValue) {\n                minSizeValue = pies[name].attributes.sizeValue;\n            }\n            if (maxSizeValue === undefined || pies[name].attributes.sizeValue > maxSizeValue) {\n                maxSizeValue = pies[name].attributes.sizeValue;\n            }\n        }\n        return this._updateRangeStops([0, 25, 50, 75], minSizeValue, maxSizeValue, true);\n    };\n    pieMapItem.prototype._getRangeStopIndex = function (value, rangeStops) {\n        if (value < rangeStops[0]) {\n            return 0;\n        }\n        for (var i = 0; i < rangeStops.length - 1; i++) {\n            if (value >= rangeStops[i] && value < rangeStops[i + 1]) {\n                return i;\n            }\n        }\n        return rangeStops.length - 1;\n    };\n    pieMapItem.prototype._getDataPointMeasureIds = function () {\n        var viewModel = this.options.ViewModel, measureIds = [];\n        if (viewModel.ArgumentDataId != null && viewModel.Values.length > 0) {\n            measureIds.push(viewModel.Values[0]);\n        }\n        else {\n            viewModel.Values.forEach(function (value) {\n                measureIds.push(value);\n            });\n        }\n        return measureIds;\n    };\n    pieMapItem.prototype._elementCustomColor = function (eventArgs) {\n        this.itemElementCustomColor.fire(this.getName(), eventArgs);\n    };\n    return pieMapItem;\n}(_geo_point_map_item_base_1.geoPointMapItemBase));\nexports.pieMapItem = pieMapItem;\n"]},"metadata":{},"sourceType":"script"}