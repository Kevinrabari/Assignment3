{"ast":null,"code":"/**\n* DevExpress Analytics (widgets\\treelist\\_treelistItem.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TreeListRootItemViewModel = exports.TreeListItemViewModel = exports.TreeListEllipsisButton = exports.DefaultTreeListItemFactory = exports.treeListEditAction = exports.maxSearchLevel = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar localization_utils_1 = require(\"../../property-grid/localization/localization_utils\");\n\nvar utils_1 = require(\"../../serializer/utils\");\n\nvar _svgTemplateEngine_1 = require(\"../../property-grid/widgets/internal/_svgTemplateEngine\");\n\nvar pathRequest_1 = require(\"../common/pathRequest\");\n\nvar _codeResolver_1 = require(\"../../property-grid/internal/_codeResolver\");\n\nvar options_1 = require(\"./options\");\n\nvar _internal_1 = require(\"../../serializer/_internal\");\n\nexports.maxSearchLevel = _internal_1.createGlobalModuleVariableFunc(5);\nexports.treeListEditAction = {\n  templateName: 'dx-treelist-edit-action',\n  imageClassName: '',\n  text: 'Edit',\n  clickAction: $.noop,\n  displayText: function () {\n    return localization_utils_1.getLocalization('Edit', 'AnalyticsCoreStringId.Group_Edit');\n  }\n};\n\nvar DefaultTreeListItemFactory = function () {\n  function DefaultTreeListItemFactory() {}\n\n  DefaultTreeListItemFactory.prototype.createRootItem = function (options, path, onItemsVisibilityChanged, rtl) {\n    return new TreeListRootItemViewModel(options, path, onItemsVisibilityChanged, rtl);\n  };\n\n  DefaultTreeListItemFactory.prototype.createItem = function (options, path, onItemsVisibilityChanged, rtl, resolver) {\n    return new TreeListItemViewModel(options, path, onItemsVisibilityChanged, rtl, resolver);\n  };\n\n  return DefaultTreeListItemFactory;\n}();\n\nexports.DefaultTreeListItemFactory = DefaultTreeListItemFactory;\n\nvar TreeListEllipsisButton = function () {\n  function TreeListEllipsisButton(_availableItemsCount, padding, pageSize) {\n    this._availableItemsCount = _availableItemsCount;\n    this.padding = padding;\n    this.pageSize = pageSize;\n    this.templateName = 'dx-treelist-item-ellipsis';\n\n    this.collapsed = function () {\n      return true;\n    };\n\n    this.visibleItems = function () {\n      return [];\n    };\n\n    this.text = function () {\n      return localization_utils_1.getLocalization('Show more...', 'AnalyticsCoreStringId.QueryBuilder_Tables_ShowMore');\n    };\n  }\n\n  TreeListEllipsisButton.prototype.renderNext = function () {\n    this._availableItemsCount(this._availableItemsCount() + this.pageSize);\n  };\n\n  return TreeListEllipsisButton;\n}();\n\nexports.TreeListEllipsisButton = TreeListEllipsisButton;\n\nvar TreeListItemViewModel = function (_super) {\n  __extends(TreeListItemViewModel, _super);\n\n  function TreeListItemViewModel(options, path, onItemsVisibilityChanged, rtl, resolver) {\n    if (path === void 0) {\n      path = [];\n    }\n\n    if (onItemsVisibilityChanged === void 0) {\n      onItemsVisibilityChanged = $.noop;\n    }\n\n    if (rtl === void 0) {\n      rtl = false;\n    }\n\n    if (resolver === void 0) {\n      resolver = new _codeResolver_1.CodeResolver();\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.resolver = resolver;\n    _this._rtl = false;\n    _this._data = ko.observable(null);\n    _this._actions = ko.observable([]);\n    _this._isVisible = ko.observable(true);\n    _this._pageSize = -1;\n    _this._actionsSubscription = null;\n\n    _this._iconName = function () {\n      return (ko.unwrap(_this.data && _this.data.icon || _this.data && _this.data.specifics) || 'default').split('.').join('_').toLowerCase();\n    };\n\n    _this._nodeIsLocked = false;\n    _this.level = -1;\n    _this.items = ko.observableArray();\n    _this.collapsed = ko.observable(true);\n    _this.isSelected = ko.observable(false);\n    _this.isHovered = ko.observable(false);\n    _this.isMultiSelected = ko.observable(false);\n    _this._pageSize = options.pageSize || -1;\n    _this._path = path;\n    _this._rtl = rtl;\n    _this._factory = options.factory || new DefaultTreeListItemFactory();\n    _this._treeListController = options.treeListController;\n    _this._templateName = options.templateName;\n    _this._onItemsVisibilityChanged = onItemsVisibilityChanged;\n    _this.dragDropHandler = options.treeListController.dragDropHandler;\n    _this._onItemsChangedCallback = options.onItemsChanged;\n\n    _this.getItems = function () {\n      if (_this.items().length > 0) return $.Deferred().resolve(_this.items()).promise();\n      return _this._loadItems(options);\n    };\n\n    _this._initPaginate();\n\n    _this.toggleSelected = function (_, event) {\n      if (event && (event.shiftKey || event.ctrlKey || event.metaKey) && _this.selectedItems().length > 0 && _this._treeListController.canMultiSelect && _this._treeListController.canMultiSelect(_this)) {\n        options.selectedPath('');\n\n        _this._treeListController.multiSelect(_this, event.shiftKey, event.ctrlKey || event.metaKey);\n      } else if (_this._treeListController.canSelect(_this)) {\n        options.treeListController.clickHandler && options.treeListController.clickHandler(_this);\n        options.selectedPath(_this.path);\n      }\n    };\n\n    if (options.treeListController.dblClickHandler) {\n      _this.dblClickHandler = function (item) {\n        options.treeListController.dblClickHandler && options.treeListController.dblClickHandler(item);\n      };\n    }\n\n    _this.toggleCollapsed = function () {\n      if (_this.hasItems) {\n        _this.collapsed(!_this.collapsed.peek());\n\n        if (!_this.collapsed.peek() && _this.items().length === 0) {\n          _this._loadItems(options, options_1.LoadChildItemsForCollapsedNodes()).always(function () {\n            onItemsVisibilityChanged();\n          });\n        } else if (options_1.LoadChildItemsForCollapsedNodes()) {\n          _this.items().forEach(function (item) {\n            item._treeListController.hasItems(item.data) && item.items().length === 0 && item._loadItems(options);\n          });\n\n          onItemsVisibilityChanged();\n        }\n      }\n    };\n\n    _this.nodeImageClass = _this._getNodeImageClassName();\n    return _this;\n  }\n\n  TreeListItemViewModel.prototype._equal = function (obj1, obj2) {\n    var ignore = ['innerActions', 'noDragable', 'dragData'];\n    if (obj2 === obj1) return true;\n    return Object.keys(obj2).filter(function (key) {\n      return ignore.indexOf(key) === -1;\n    }).every(function (key) {\n      return obj2[key] === obj1[key];\n    });\n  };\n\n  TreeListItemViewModel.prototype._getImageClassName = function (showIcon) {\n    var _this = this;\n\n    return ko.computed(function () {\n      return 'dx-image-fieldlist-' + _this._iconName() + (!showIcon ? ' dx-treelist-image-empty' : '');\n    });\n  };\n\n  TreeListItemViewModel.prototype._getImageTemplateName = function () {\n    var _this = this;\n\n    return ko.computed(function () {\n      var _templateName = 'dxrd-svg-fieldlist-' + _this._iconName();\n\n      return _svgTemplateEngine_1.SvgTemplatesEngine.getExistingTemplate(_templateName);\n    });\n  };\n\n  TreeListItemViewModel.prototype._getNodeImageClassName = function () {\n    var _this = this;\n\n    var imageClassName = ko.observable('dx-collapsing-image');\n    return ko.computed({\n      read: function () {\n        if (!_this.hasItems) {\n          return 'dx-image-leaf-node';\n        }\n\n        return _this.collapsed() ? 'dx-collapsing-image' : imageClassName();\n      },\n      write: function (newValue) {\n        imageClassName(newValue);\n      }\n    });\n  };\n\n  TreeListItemViewModel.prototype._createItemsObj = function (items) {\n    var obj = {};\n\n    for (var i = 0; i < items.length; i++) {\n      obj[items[i].name] = {\n        item: items[i],\n        index: i\n      };\n    }\n\n    return obj;\n  };\n\n  TreeListItemViewModel.prototype._loadItems = function (options, loadInnerItems) {\n    var _this = this;\n\n    if (loadInnerItems === void 0) {\n      loadInnerItems = false;\n    }\n\n    var deferred = $.Deferred();\n\n    if (this._loader) {\n      this._loader.dispose();\n    }\n\n    this._disposables.reverse().forEach(function (x) {\n      return x.dispose && x.dispose();\n    });\n\n    this._disposables.splice(0);\n\n    var promise = ko.observable();\n    var subscription = promise.subscribe(function (value) {\n      if (!value) return;\n      value.done(function (data) {\n        if (_this.isDisposing) {\n          deferred.reject();\n          return;\n        }\n\n        var _data = data;\n\n        var items = _this.items.peek();\n\n        var dataObj = _this._createItemsObj(_data);\n\n        var isMutated = false;\n        var splicedItems = 0;\n        var tempItems = [].concat.apply([], items);\n\n        for (var i = 0; i < tempItems.length; i++) {\n          if (!dataObj[tempItems[i].data.name]) {\n            tempItems[i].dispose();\n            items.splice(i - splicedItems, 1);\n            splicedItems++;\n            isMutated = true;\n          }\n        }\n\n        var itemsObj = _this._createItemsObj(items);\n\n        var resorted = false;\n\n        var showIconsForChildItems = !_this._treeListController.showIconsForChildItems || _this._treeListController.showIconsForChildItems(_this);\n\n        var showIconTemplate = _this._treeListController.showIconsForChildItems && _this._treeListController.showIconsForChildItems(_this);\n\n        _data.forEach(function (d, index) {\n          var currentItem = itemsObj[d.name];\n\n          if (!currentItem) {\n            isMutated = true;\n\n            var newItem = _this._factory.createItem(options, _this.pathParts, _this._onItemsVisibilityChanged, _this._rtl, _this.resolver);\n\n            newItem.data = d;\n            newItem.level = _this.level + 1;\n            newItem.parent = _this;\n            newItem.padding = _this._applyPadding(_this._rtl ? 'right' : 'left', 20 * newItem.level + 12);\n            newItem.imageClassName = newItem._getImageClassName(showIconsForChildItems);\n            newItem.imageTemplateName = newItem._getImageTemplateName();\n            newItem.showIcon = showIconTemplate;\n            items.splice(index, 0, newItem);\n            itemsObj[d.name] = {\n              item: newItem,\n              index: index\n            };\n          } else {\n            if (!_this._equal(d, currentItem.item.data)) currentItem.item.data = d;\n            if (!resorted) resorted = currentItem.index !== index;\n          }\n        });\n\n        if (resorted) {\n          var index = items.reduce(function (acc, x, index) {\n            var max = Math.abs(index - (dataObj[x.data.name] ? dataObj[x.data.name].index : -1));\n\n            if (!acc || acc.max < max) {\n              return {\n                max: max,\n                index: index\n              };\n            }\n\n            return acc;\n          }, null).index;\n          var curItem = items[index];\n          items.splice(index, 1);\n          items.splice(dataObj[curItem.data.name] ? dataObj[curItem.data.name].index : -1, 0, curItem);\n          isMutated = true;\n        }\n\n        dataObj = null;\n        itemsObj = null;\n\n        if (isMutated) {\n          _this.items.valueHasMutated();\n\n          _this._onItemsChanged();\n        }\n\n        if (!_this.collapsed() || loadInnerItems) {\n          _this.items().forEach(function (item) {\n            if (item._treeListController.hasItems(item.data)) {\n              item._loadItems(options);\n            }\n          });\n        }\n\n        _this.nodeImageClass(_this.items.peek().some(function (x) {\n          return x.visible;\n        }) ? 'dx-collapsing-image dx-image-expanded' : 'dx-image-leaf-node');\n\n        deferred.resolve(_this.items.peek());\n        var selectedPath = options.selectedPath.peek();\n\n        if (selectedPath) {\n          var item2Select = _this.items.peek().filter(function (item) {\n            return selectedPath.indexOf(item.path) === 0;\n          })[0];\n\n          if (item2Select) {\n            _this._selectItem(item2Select.name + selectedPath.substring(item2Select.path.length));\n          }\n        }\n      });\n    });\n\n    this._disposables.push({\n      dispose: function () {\n        subscription.dispose();\n        promise(null);\n      }\n    });\n\n    this._disposables.push(this._loader = ko.computed(function () {\n      promise(options.itemsProvider.getItems(new pathRequest_1.PathRequest(_this.path, _this.pathParts)));\n    }));\n\n    return deferred.promise();\n  };\n\n  TreeListItemViewModel.prototype._onItemsChanged = function () {\n    if (this._onItemsChangedCallback) this._onItemsChangedCallback(this.items());\n  };\n\n  TreeListItemViewModel.prototype._getTemplateName = function () {\n    return this._templateName || this.data && this.data.templateName || 'dx-treelist-item';\n  };\n\n  TreeListItemViewModel.prototype._selectItem = function (itemPath) {\n    var _this = this;\n\n    if (!this.hasItems) {\n      return;\n    }\n\n    var selectItemDelegate = function () {\n      _this._find(itemPath);\n\n      if (_this.collapsed.peek()) {\n        _this.toggleCollapsed();\n      }\n    };\n\n    if (this.items.peek().length === 0) {\n      this.getItems().done(function (items) {\n        selectItemDelegate();\n      });\n    } else {\n      selectItemDelegate();\n    }\n  };\n\n  TreeListItemViewModel.prototype._find = function (itemPath) {\n    var item = itemPath && this.items.peek().filter(function (childItem) {\n      return itemPath === childItem.name || itemPath.indexOf(childItem.name) === 0 && itemPath[childItem.name.length] === '.';\n    })[0];\n\n    if (item) {\n      if (itemPath.length > item.name.length) {\n        item._selectItem(itemPath.substr(item.name.length + 1));\n      } else {\n        this._treeListController.select(item);\n      }\n    }\n  };\n\n  TreeListItemViewModel.prototype._getItemsWithLock = function () {\n    var _this = this;\n\n    var deffered = $.Deferred();\n    if (this._nodeIsLocked) return deffered.reject().promise();\n    this._nodeIsLocked = true;\n    this.getItems().done(function (result) {\n      _this._nodeIsLocked = false;\n      deffered.resolve(result);\n    }).fail(function () {\n      _this._nodeIsLocked = false;\n      deffered.reject();\n    });\n    return deffered.promise();\n  };\n\n  TreeListItemViewModel.prototype._applyPadding = function (position, value) {\n    var padding = {};\n    padding['padding-' + position] = value;\n    return padding;\n  };\n\n  TreeListItemViewModel.prototype._initPaginate = function () {\n    var _this = this;\n\n    if (this._pageSize === -1) return;\n    this.maxItemsCount = ko.observable(this._pageSize);\n    this.visibleItems = ko.computed(function () {\n      if (_this.items().length === 0) return [];\n\n      var result = _this.items().filter(function (x) {\n        return x._isVisible.peek();\n      });\n\n      if (result.length > _this.maxItemsCount()) {\n        result = result.slice(0, _this.maxItemsCount());\n        result.push(new TreeListEllipsisButton(_this.maxItemsCount, result[0].padding, _this._pageSize));\n      }\n\n      return result;\n    });\n  };\n\n  Object.defineProperty(TreeListItemViewModel.prototype, \"hasItems\", {\n    get: function () {\n      if (!this.data) {\n        return true;\n      }\n\n      var hasItems = this._treeListController.hasItems(this.data);\n\n      return options_1.LoadChildItemsForCollapsedNodes() ? hasItems && this.items().some(function (item) {\n        return item.visible;\n      }) : hasItems;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"data\", {\n    get: function () {\n      return this._data();\n    },\n    set: function (newVal) {\n      var _this = this;\n\n      this._data(newVal);\n\n      this._actionsSubscription && this._actionsSubscription.dispose();\n      this._actionsSubscription = ko.computed(function () {\n        _this._actions(_this._treeListController && _this._treeListController.getActions ? _this._treeListController.getActions(_this) : []);\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"name\", {\n    get: function () {\n      return ko.unwrap(this.data && this.data.name);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"path\", {\n    get: function () {\n      return this.pathParts.join('.');\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"pathParts\", {\n    get: function () {\n      if (this.name) {\n        return (ko.unwrap(this._path) || []).concat([this.name]);\n      } else {\n        return ko.unwrap(this._path);\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"text\", {\n    get: function () {\n      return this.data && this.data.displayName;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"templateName\", {\n    get: function () {\n      return this._getTemplateName();\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  TreeListItemViewModel.prototype.actionsTemplate = function () {\n    return this.data && ko.unwrap(this.data['actionsTemplate']) || 'dx-treelist-item-actions-with-edit';\n  };\n\n  TreeListItemViewModel.prototype.treeListEditAction = function () {\n    return exports.treeListEditAction;\n  };\n\n  Object.defineProperty(TreeListItemViewModel.prototype, \"hasContent\", {\n    get: function () {\n      return this.data && this.data['contenttemplate'];\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"actions\", {\n    get: function () {\n      return this._actions();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"isDraggable\", {\n    get: function () {\n      if (this.data && this.data['dragData']) {\n        return !this.data['dragData'].noDragable;\n      }\n\n      if (this._treeListController.isDraggable) {\n        return this._treeListController.isDraggable(this);\n      }\n\n      return false;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(TreeListItemViewModel.prototype, \"treeListController\", {\n    get: function () {\n      return this._treeListController;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  TreeListItemViewModel.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this._actions([]);\n\n    this.visibleItems && this.visibleItems.dispose();\n    this._actionsSubscription && this._actionsSubscription.dispose();\n    this.disposeObservableArray(this.items);\n    this.resetObservableArray(this.items);\n    this.parent = null;\n  };\n\n  Object.defineProperty(TreeListItemViewModel.prototype, \"visible\", {\n    get: function () {\n      if (this.data && this._treeListController.itemsFilter && !this._treeListController.itemsFilter(this.data, this.path, this)) return false;\n      return this._isVisible();\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  TreeListItemViewModel.prototype.setVisible = function (value) {\n    this._isVisible(value);\n\n    if (value && this.parent && !this.parent.visible) this.parent.setVisible(true);\n  };\n\n  TreeListItemViewModel.prototype.mouseenter = function () {\n    this.isHovered(true);\n  };\n\n  TreeListItemViewModel.prototype.mouseleave = function () {\n    this.isHovered(false);\n  };\n\n  TreeListItemViewModel.prototype.selectedItems = function () {\n    return this._treeListController.selectedItems && this._treeListController.selectedItems() || [];\n  };\n\n  return TreeListItemViewModel;\n}(utils_1.Disposable);\n\nexports.TreeListItemViewModel = TreeListItemViewModel;\n\nvar TreeListRootItemViewModel = function (_super) {\n  __extends(TreeListRootItemViewModel, _super);\n\n  function TreeListRootItemViewModel(_options, path, onItemsVisibilityChanged, rtl) {\n    if (path === void 0) {\n      path = [];\n    }\n\n    if (onItemsVisibilityChanged === void 0) {\n      onItemsVisibilityChanged = $.noop;\n    }\n\n    if (rtl === void 0) {\n      rtl = false;\n    }\n\n    var _this = _super.call(this, _options, path, onItemsVisibilityChanged, rtl) || this;\n\n    _this._options = _options;\n    _this._resolver = new _codeResolver_1.CodeResolver();\n    _this._selectedPathSubscription = null;\n\n    _this.resolver.done(function () {\n      onItemsVisibilityChanged();\n    });\n\n    _this._selectedPathSubscription = _options.selectedPath.subscribe(function (newPath) {\n      _this._selectItem(!!_this.path ? newPath.substr(_this.path.length + 1) : newPath);\n    });\n\n    _this._selectItem(!!_this.path ? _this.path + '.' + _options.selectedPath() : _options.selectedPath());\n\n    return _this;\n  }\n\n  TreeListRootItemViewModel.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this._resolver.clear();\n\n    if (this._selectedPathSubscription) {\n      this._selectedPathSubscription.dispose();\n\n      this._selectedPathSubscription = null;\n    }\n  };\n\n  TreeListRootItemViewModel.prototype.walkOnTree = function (walkCallBack) {\n    var _this = this;\n\n    this._resolver.clear();\n\n    this._visitNextNode(this, walkCallBack);\n\n    if (this['_pageSize'] != -1) this._resolver.doneOnce(function () {\n      return _this.items.valueHasMutated();\n    });\n    return {\n      stop: function () {\n        return _this._resolver.clear();\n      }\n    };\n  };\n\n  TreeListRootItemViewModel.prototype._visitNextNode = function (item, walkCallback) {\n    var _this = this;\n\n    if (walkCallback === void 0) {\n      walkCallback = function (_item) {};\n    }\n\n    if (item.data && !item.data.specifics) throw new Error('Specific should be set');\n    if (item.level >= exports.maxSearchLevel()) return;\n    var processItemsFunc = null;\n\n    if (item.items().length > 0) {\n      processItemsFunc = function () {\n        return item.items().forEach(function (node) {\n          walkCallback(node);\n\n          _this._visitNextNode(node, walkCallback);\n        });\n      };\n    } else if (!item.data || item.treeListController.hasItems(item.data)) {\n      processItemsFunc = function () {\n        return item._getItemsWithLock().done(function (result) {\n          result.forEach(function (node) {\n            walkCallback(node);\n\n            _this._visitNextNode(node, walkCallback);\n          });\n        });\n      };\n    }\n\n    if (processItemsFunc) this._resolver.execute(processItemsFunc, 1);\n  };\n\n  TreeListRootItemViewModel.prototype._onItemsChanged = function () {\n    if (this._options.expandRootItems) this.items().forEach(function (item) {\n      item.collapsed(false);\n    });\n\n    _super.prototype._onItemsChanged.call(this);\n  };\n\n  return TreeListRootItemViewModel;\n}(TreeListItemViewModel);\n\nexports.TreeListRootItemViewModel = TreeListRootItemViewModel;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/widgets/treelist/_treelistItem.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","TreeListRootItemViewModel","TreeListItemViewModel","TreeListEllipsisButton","DefaultTreeListItemFactory","treeListEditAction","maxSearchLevel","ko","require","$","localization_utils_1","utils_1","_svgTemplateEngine_1","pathRequest_1","_codeResolver_1","options_1","_internal_1","createGlobalModuleVariableFunc","templateName","imageClassName","text","clickAction","noop","displayText","getLocalization","createRootItem","options","path","onItemsVisibilityChanged","rtl","createItem","resolver","_availableItemsCount","padding","pageSize","collapsed","visibleItems","renderNext","_super","CodeResolver","_this","_rtl","_data","observable","_actions","_isVisible","_pageSize","_actionsSubscription","_iconName","unwrap","data","icon","specifics","split","join","toLowerCase","_nodeIsLocked","level","items","observableArray","isSelected","isHovered","isMultiSelected","_path","_factory","factory","_treeListController","treeListController","_templateName","_onItemsVisibilityChanged","dragDropHandler","_onItemsChangedCallback","onItemsChanged","getItems","length","Deferred","resolve","promise","_loadItems","_initPaginate","toggleSelected","_","event","shiftKey","ctrlKey","metaKey","selectedItems","canMultiSelect","selectedPath","multiSelect","canSelect","clickHandler","dblClickHandler","item","toggleCollapsed","hasItems","peek","LoadChildItemsForCollapsedNodes","always","forEach","nodeImageClass","_getNodeImageClassName","_equal","obj1","obj2","ignore","keys","filter","key","indexOf","every","_getImageClassName","showIcon","computed","_getImageTemplateName","SvgTemplatesEngine","getExistingTemplate","read","write","newValue","_createItemsObj","obj","i","name","index","loadInnerItems","deferred","_loader","dispose","_disposables","reverse","x","splice","subscription","subscribe","done","isDisposing","reject","dataObj","isMutated","splicedItems","tempItems","concat","apply","itemsObj","resorted","showIconsForChildItems","showIconTemplate","currentItem","newItem","pathParts","parent","_applyPadding","imageTemplateName","reduce","acc","max","Math","abs","curItem","valueHasMutated","_onItemsChanged","some","visible","item2Select","_selectItem","substring","push","itemsProvider","PathRequest","_getTemplateName","itemPath","selectItemDelegate","_find","childItem","substr","select","_getItemsWithLock","deffered","result","fail","position","maxItemsCount","slice","get","enumerable","configurable","set","newVal","getActions","displayName","actionsTemplate","noDragable","isDraggable","disposeObservableArray","resetObservableArray","itemsFilter","setVisible","mouseenter","mouseleave","Disposable","_options","_resolver","_selectedPathSubscription","newPath","clear","walkOnTree","walkCallBack","_visitNextNode","doneOnce","stop","walkCallback","_item","Error","processItemsFunc","node","execute","expandRootItems"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (widgets\\treelist\\_treelistItem.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TreeListRootItemViewModel = exports.TreeListItemViewModel = exports.TreeListEllipsisButton = exports.DefaultTreeListItemFactory = exports.treeListEditAction = exports.maxSearchLevel = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar localization_utils_1 = require(\"../../property-grid/localization/localization_utils\");\nvar utils_1 = require(\"../../serializer/utils\");\nvar _svgTemplateEngine_1 = require(\"../../property-grid/widgets/internal/_svgTemplateEngine\");\nvar pathRequest_1 = require(\"../common/pathRequest\");\nvar _codeResolver_1 = require(\"../../property-grid/internal/_codeResolver\");\nvar options_1 = require(\"./options\");\nvar _internal_1 = require(\"../../serializer/_internal\");\nexports.maxSearchLevel = _internal_1.createGlobalModuleVariableFunc(5);\nexports.treeListEditAction = {\n    templateName: 'dx-treelist-edit-action',\n    imageClassName: '',\n    text: 'Edit',\n    clickAction: $.noop,\n    displayText: function () { return localization_utils_1.getLocalization('Edit', 'AnalyticsCoreStringId.Group_Edit'); }\n};\nvar DefaultTreeListItemFactory = (function () {\n    function DefaultTreeListItemFactory() {\n    }\n    DefaultTreeListItemFactory.prototype.createRootItem = function (options, path, onItemsVisibilityChanged, rtl) {\n        return new TreeListRootItemViewModel(options, path, onItemsVisibilityChanged, rtl);\n    };\n    DefaultTreeListItemFactory.prototype.createItem = function (options, path, onItemsVisibilityChanged, rtl, resolver) {\n        return new TreeListItemViewModel(options, path, onItemsVisibilityChanged, rtl, resolver);\n    };\n    return DefaultTreeListItemFactory;\n}());\nexports.DefaultTreeListItemFactory = DefaultTreeListItemFactory;\nvar TreeListEllipsisButton = (function () {\n    function TreeListEllipsisButton(_availableItemsCount, padding, pageSize) {\n        this._availableItemsCount = _availableItemsCount;\n        this.padding = padding;\n        this.pageSize = pageSize;\n        this.templateName = 'dx-treelist-item-ellipsis';\n        this.collapsed = function () { return true; };\n        this.visibleItems = function () { return []; };\n        this.text = function () { return localization_utils_1.getLocalization('Show more...', 'AnalyticsCoreStringId.QueryBuilder_Tables_ShowMore'); };\n    }\n    TreeListEllipsisButton.prototype.renderNext = function () {\n        this._availableItemsCount(this._availableItemsCount() + this.pageSize);\n    };\n    return TreeListEllipsisButton;\n}());\nexports.TreeListEllipsisButton = TreeListEllipsisButton;\nvar TreeListItemViewModel = (function (_super) {\n    __extends(TreeListItemViewModel, _super);\n    function TreeListItemViewModel(options, path, onItemsVisibilityChanged, rtl, resolver) {\n        if (path === void 0) { path = []; }\n        if (onItemsVisibilityChanged === void 0) { onItemsVisibilityChanged = $.noop; }\n        if (rtl === void 0) { rtl = false; }\n        if (resolver === void 0) { resolver = new _codeResolver_1.CodeResolver(); }\n        var _this = _super.call(this) || this;\n        _this.resolver = resolver;\n        _this._rtl = false;\n        _this._data = ko.observable(null);\n        _this._actions = ko.observable([]);\n        _this._isVisible = ko.observable(true);\n        _this._pageSize = -1;\n        _this._actionsSubscription = null;\n        _this._iconName = function () { return (ko.unwrap((_this.data && _this.data.icon) || (_this.data && _this.data.specifics)) || 'default').split('.').join('_').toLowerCase(); };\n        _this._nodeIsLocked = false;\n        _this.level = -1;\n        _this.items = ko.observableArray();\n        _this.collapsed = ko.observable(true);\n        _this.isSelected = ko.observable(false);\n        _this.isHovered = ko.observable(false);\n        _this.isMultiSelected = ko.observable(false);\n        _this._pageSize = options.pageSize || -1;\n        _this._path = path;\n        _this._rtl = rtl;\n        _this._factory = options.factory || new DefaultTreeListItemFactory();\n        _this._treeListController = options.treeListController;\n        _this._templateName = options.templateName;\n        _this._onItemsVisibilityChanged = onItemsVisibilityChanged;\n        _this.dragDropHandler = options.treeListController.dragDropHandler;\n        _this._onItemsChangedCallback = options.onItemsChanged;\n        _this.getItems = function () {\n            if (_this.items().length > 0)\n                return $.Deferred().resolve(_this.items()).promise();\n            return _this._loadItems(options);\n        };\n        _this._initPaginate();\n        _this.toggleSelected = function (_, event) {\n            if (event && (event.shiftKey || event.ctrlKey || event.metaKey) && _this.selectedItems().length > 0 && _this._treeListController.canMultiSelect && _this._treeListController.canMultiSelect(_this)) {\n                options.selectedPath('');\n                _this._treeListController.multiSelect(_this, event.shiftKey, event.ctrlKey || event.metaKey);\n            }\n            else if (_this._treeListController.canSelect(_this)) {\n                options.treeListController.clickHandler && options.treeListController.clickHandler(_this);\n                options.selectedPath(_this.path);\n            }\n        };\n        if (options.treeListController.dblClickHandler) {\n            _this.dblClickHandler = function (item) {\n                options.treeListController.dblClickHandler && options.treeListController.dblClickHandler(item);\n            };\n        }\n        _this.toggleCollapsed = function () {\n            if (_this.hasItems) {\n                _this.collapsed(!_this.collapsed.peek());\n                if (!_this.collapsed.peek() && _this.items().length === 0) {\n                    _this._loadItems(options, options_1.LoadChildItemsForCollapsedNodes()).always(function () { onItemsVisibilityChanged(); });\n                }\n                else if (options_1.LoadChildItemsForCollapsedNodes()) {\n                    _this.items().forEach(function (item) {\n                        item._treeListController.hasItems(item.data) && item.items().length === 0 && item._loadItems(options);\n                    });\n                    onItemsVisibilityChanged();\n                }\n            }\n        };\n        _this.nodeImageClass = _this._getNodeImageClassName();\n        return _this;\n    }\n    TreeListItemViewModel.prototype._equal = function (obj1, obj2) {\n        var ignore = ['innerActions', 'noDragable', 'dragData'];\n        if (obj2 === obj1)\n            return true;\n        return Object.keys(obj2).filter(function (key) { return ignore.indexOf(key) === -1; }).every(function (key) {\n            return obj2[key] === obj1[key];\n        });\n    };\n    TreeListItemViewModel.prototype._getImageClassName = function (showIcon) {\n        var _this = this;\n        return ko.computed(function () {\n            return 'dx-image-fieldlist-'\n                + _this._iconName()\n                + (!showIcon ? ' dx-treelist-image-empty' : '');\n        });\n    };\n    TreeListItemViewModel.prototype._getImageTemplateName = function () {\n        var _this = this;\n        return ko.computed(function () {\n            var _templateName = 'dxrd-svg-fieldlist-' + _this._iconName();\n            return _svgTemplateEngine_1.SvgTemplatesEngine.getExistingTemplate(_templateName);\n        });\n    };\n    TreeListItemViewModel.prototype._getNodeImageClassName = function () {\n        var _this = this;\n        var imageClassName = ko.observable('dx-collapsing-image');\n        return ko.computed({\n            read: function () {\n                if (!_this.hasItems) {\n                    return 'dx-image-leaf-node';\n                }\n                return _this.collapsed() ? 'dx-collapsing-image' : imageClassName();\n            },\n            write: function (newValue) {\n                imageClassName(newValue);\n            }\n        });\n    };\n    TreeListItemViewModel.prototype._createItemsObj = function (items) {\n        var obj = {};\n        for (var i = 0; i < items.length; i++) {\n            obj[items[i].name] = { item: items[i], index: i };\n        }\n        return obj;\n    };\n    TreeListItemViewModel.prototype._loadItems = function (options, loadInnerItems) {\n        var _this = this;\n        if (loadInnerItems === void 0) { loadInnerItems = false; }\n        var deferred = $.Deferred();\n        if (this._loader) {\n            this._loader.dispose();\n        }\n        this._disposables.reverse().forEach(function (x) { return x.dispose && x.dispose(); });\n        this._disposables.splice(0);\n        var promise = ko.observable();\n        var subscription = promise.subscribe(function (value) {\n            if (!value)\n                return;\n            value.done(function (data) {\n                if (_this.isDisposing) {\n                    deferred.reject();\n                    return;\n                }\n                var _data = data;\n                var items = _this.items.peek();\n                var dataObj = _this._createItemsObj(_data);\n                var isMutated = false;\n                var splicedItems = 0;\n                var tempItems = [].concat.apply([], items);\n                for (var i = 0; i < tempItems.length; i++) {\n                    if (!dataObj[tempItems[i].data.name]) {\n                        tempItems[i].dispose();\n                        items.splice(i - splicedItems, 1);\n                        splicedItems++;\n                        isMutated = true;\n                    }\n                }\n                var itemsObj = _this._createItemsObj(items);\n                var resorted = false;\n                var showIconsForChildItems = !_this._treeListController.showIconsForChildItems || _this._treeListController.showIconsForChildItems(_this);\n                var showIconTemplate = _this._treeListController.showIconsForChildItems && _this._treeListController.showIconsForChildItems(_this);\n                _data.forEach(function (d, index) {\n                    var currentItem = itemsObj[d.name];\n                    if (!currentItem) {\n                        isMutated = true;\n                        var newItem = _this._factory.createItem(options, _this.pathParts, _this._onItemsVisibilityChanged, _this._rtl, _this.resolver);\n                        newItem.data = d;\n                        newItem.level = _this.level + 1;\n                        newItem.parent = _this;\n                        newItem.padding = _this._applyPadding(_this._rtl ? 'right' : 'left', 20 * newItem.level + 12);\n                        newItem.imageClassName = newItem._getImageClassName(showIconsForChildItems);\n                        newItem.imageTemplateName = newItem._getImageTemplateName();\n                        newItem.showIcon = showIconTemplate;\n                        items.splice(index, 0, newItem);\n                        itemsObj[d.name] = { item: newItem, index: index };\n                    }\n                    else {\n                        if (!_this._equal(d, currentItem.item.data))\n                            currentItem.item.data = d;\n                        if (!resorted)\n                            resorted = currentItem.index !== index;\n                    }\n                });\n                if (resorted) {\n                    var index = items.reduce(function (acc, x, index) {\n                        var max = Math.abs(index - (dataObj[x.data.name] ? dataObj[x.data.name].index : -1));\n                        if (!acc || acc.max < max) {\n                            return { max: max, index: index };\n                        }\n                        return acc;\n                    }, null).index;\n                    var curItem = items[index];\n                    items.splice(index, 1);\n                    items.splice(dataObj[curItem.data.name] ? dataObj[curItem.data.name].index : -1, 0, curItem);\n                    isMutated = true;\n                }\n                dataObj = null;\n                itemsObj = null;\n                if (isMutated) {\n                    _this.items.valueHasMutated();\n                    _this._onItemsChanged();\n                }\n                if (!_this.collapsed() || loadInnerItems) {\n                    _this.items().forEach(function (item) {\n                        if (item._treeListController.hasItems(item.data)) {\n                            item._loadItems(options);\n                        }\n                    });\n                }\n                _this.nodeImageClass(_this.items.peek().some(function (x) { return x.visible; }) ? 'dx-collapsing-image dx-image-expanded' : 'dx-image-leaf-node');\n                deferred.resolve(_this.items.peek());\n                var selectedPath = options.selectedPath.peek();\n                if (selectedPath) {\n                    var item2Select = _this.items.peek().filter(function (item) { return selectedPath.indexOf(item.path) === 0; })[0];\n                    if (item2Select) {\n                        _this._selectItem(item2Select.name + selectedPath.substring(item2Select.path.length));\n                    }\n                }\n            });\n        });\n        this._disposables.push({\n            dispose: function () {\n                subscription.dispose();\n                promise(null);\n            }\n        });\n        this._disposables.push(this._loader = ko.computed(function () {\n            promise(options.itemsProvider.getItems(new pathRequest_1.PathRequest(_this.path, _this.pathParts)));\n        }));\n        return deferred.promise();\n    };\n    TreeListItemViewModel.prototype._onItemsChanged = function () {\n        if (this._onItemsChangedCallback)\n            this._onItemsChangedCallback(this.items());\n    };\n    TreeListItemViewModel.prototype._getTemplateName = function () {\n        return this._templateName || this.data && this.data.templateName || 'dx-treelist-item';\n    };\n    TreeListItemViewModel.prototype._selectItem = function (itemPath) {\n        var _this = this;\n        if (!this.hasItems) {\n            return;\n        }\n        var selectItemDelegate = function () {\n            _this._find(itemPath);\n            if (_this.collapsed.peek()) {\n                _this.toggleCollapsed();\n            }\n        };\n        if (this.items.peek().length === 0) {\n            this.getItems().done(function (items) {\n                selectItemDelegate();\n            });\n        }\n        else {\n            selectItemDelegate();\n        }\n    };\n    TreeListItemViewModel.prototype._find = function (itemPath) {\n        var item = itemPath && this.items.peek().filter(function (childItem) {\n            return itemPath === childItem.name\n                || itemPath.indexOf(childItem.name) === 0 && itemPath[childItem.name.length] === '.';\n        })[0];\n        if (item) {\n            if (itemPath.length > item.name.length) {\n                item._selectItem(itemPath.substr(item.name.length + 1));\n            }\n            else {\n                this._treeListController.select(item);\n            }\n        }\n    };\n    TreeListItemViewModel.prototype._getItemsWithLock = function () {\n        var _this = this;\n        var deffered = $.Deferred();\n        if (this._nodeIsLocked)\n            return deffered.reject().promise();\n        this._nodeIsLocked = true;\n        this.getItems().done(function (result) {\n            _this._nodeIsLocked = false;\n            deffered.resolve(result);\n        }).fail(function () {\n            _this._nodeIsLocked = false;\n            deffered.reject();\n        });\n        return deffered.promise();\n    };\n    TreeListItemViewModel.prototype._applyPadding = function (position, value) {\n        var padding = {};\n        padding['padding-' + position] = value;\n        return padding;\n    };\n    TreeListItemViewModel.prototype._initPaginate = function () {\n        var _this = this;\n        if (this._pageSize === -1)\n            return;\n        this.maxItemsCount = ko.observable(this._pageSize);\n        this.visibleItems = ko.computed(function () {\n            if (_this.items().length === 0)\n                return [];\n            var result = _this.items().filter(function (x) { return x._isVisible.peek(); });\n            if (result.length > _this.maxItemsCount()) {\n                result = result.slice(0, _this.maxItemsCount());\n                result.push(new TreeListEllipsisButton(_this.maxItemsCount, result[0].padding, _this._pageSize));\n            }\n            return result;\n        });\n    };\n    Object.defineProperty(TreeListItemViewModel.prototype, \"hasItems\", {\n        get: function () {\n            if (!this.data) {\n                return true;\n            }\n            var hasItems = this._treeListController.hasItems(this.data);\n            return options_1.LoadChildItemsForCollapsedNodes() ?\n                hasItems && this.items().some(function (item) { return item.visible; }) :\n                hasItems;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"data\", {\n        get: function () {\n            return this._data();\n        },\n        set: function (newVal) {\n            var _this = this;\n            this._data(newVal);\n            this._actionsSubscription && this._actionsSubscription.dispose();\n            this._actionsSubscription = ko.computed(function () {\n                _this._actions(_this._treeListController && _this._treeListController.getActions ? _this._treeListController.getActions(_this) : []);\n            });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"name\", {\n        get: function () {\n            return ko.unwrap(this.data && this.data.name);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"path\", {\n        get: function () {\n            return this.pathParts.join('.');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"pathParts\", {\n        get: function () {\n            if (this.name) {\n                return (ko.unwrap(this._path) || []).concat([this.name]);\n            }\n            else {\n                return ko.unwrap(this._path);\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"text\", {\n        get: function () {\n            return this.data && this.data.displayName;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"templateName\", {\n        get: function () {\n            return this._getTemplateName();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TreeListItemViewModel.prototype.actionsTemplate = function () {\n        return this.data && ko.unwrap(this.data['actionsTemplate']) || 'dx-treelist-item-actions-with-edit';\n    };\n    TreeListItemViewModel.prototype.treeListEditAction = function () {\n        return exports.treeListEditAction;\n    };\n    Object.defineProperty(TreeListItemViewModel.prototype, \"hasContent\", {\n        get: function () {\n            return this.data && this.data['contenttemplate'];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"actions\", {\n        get: function () {\n            return this._actions();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"isDraggable\", {\n        get: function () {\n            if (this.data && this.data['dragData']) {\n                return !this.data['dragData'].noDragable;\n            }\n            if (this._treeListController.isDraggable) {\n                return this._treeListController.isDraggable(this);\n            }\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TreeListItemViewModel.prototype, \"treeListController\", {\n        get: function () {\n            return this._treeListController;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TreeListItemViewModel.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._actions([]);\n        this.visibleItems && this.visibleItems.dispose();\n        this._actionsSubscription && this._actionsSubscription.dispose();\n        this.disposeObservableArray(this.items);\n        this.resetObservableArray(this.items);\n        this.parent = null;\n    };\n    Object.defineProperty(TreeListItemViewModel.prototype, \"visible\", {\n        get: function () {\n            if (this.data && this._treeListController.itemsFilter && !this._treeListController.itemsFilter(this.data, this.path, this))\n                return false;\n            return this._isVisible();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TreeListItemViewModel.prototype.setVisible = function (value) {\n        this._isVisible(value);\n        if (value && this.parent && !this.parent.visible)\n            this.parent.setVisible(true);\n    };\n    TreeListItemViewModel.prototype.mouseenter = function () {\n        this.isHovered(true);\n    };\n    TreeListItemViewModel.prototype.mouseleave = function () {\n        this.isHovered(false);\n    };\n    TreeListItemViewModel.prototype.selectedItems = function () {\n        return this._treeListController.selectedItems && this._treeListController.selectedItems() || [];\n    };\n    return TreeListItemViewModel;\n}(utils_1.Disposable));\nexports.TreeListItemViewModel = TreeListItemViewModel;\nvar TreeListRootItemViewModel = (function (_super) {\n    __extends(TreeListRootItemViewModel, _super);\n    function TreeListRootItemViewModel(_options, path, onItemsVisibilityChanged, rtl) {\n        if (path === void 0) { path = []; }\n        if (onItemsVisibilityChanged === void 0) { onItemsVisibilityChanged = $.noop; }\n        if (rtl === void 0) { rtl = false; }\n        var _this = _super.call(this, _options, path, onItemsVisibilityChanged, rtl) || this;\n        _this._options = _options;\n        _this._resolver = new _codeResolver_1.CodeResolver();\n        _this._selectedPathSubscription = null;\n        _this.resolver.done(function () {\n            onItemsVisibilityChanged();\n        });\n        _this._selectedPathSubscription = _options.selectedPath.subscribe(function (newPath) {\n            _this._selectItem(!!_this.path ? newPath.substr(_this.path.length + 1) : newPath);\n        });\n        _this._selectItem(!!_this.path ? _this.path + '.' + _options.selectedPath() : _options.selectedPath());\n        return _this;\n    }\n    TreeListRootItemViewModel.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._resolver.clear();\n        if (this._selectedPathSubscription) {\n            this._selectedPathSubscription.dispose();\n            this._selectedPathSubscription = null;\n        }\n    };\n    TreeListRootItemViewModel.prototype.walkOnTree = function (walkCallBack) {\n        var _this = this;\n        this._resolver.clear();\n        this._visitNextNode(this, walkCallBack);\n        if (this['_pageSize'] != -1)\n            this._resolver.doneOnce(function () { return _this.items.valueHasMutated(); });\n        return { stop: function () { return _this._resolver.clear(); } };\n    };\n    TreeListRootItemViewModel.prototype._visitNextNode = function (item, walkCallback) {\n        var _this = this;\n        if (walkCallback === void 0) { walkCallback = function (_item) { }; }\n        if (item.data && !item.data.specifics)\n            throw new Error('Specific should be set');\n        if (item.level >= exports.maxSearchLevel())\n            return;\n        var processItemsFunc = null;\n        if (item.items().length > 0) {\n            processItemsFunc = function () { return item.items().forEach(function (node) {\n                walkCallback(node);\n                _this._visitNextNode(node, walkCallback);\n            }); };\n        }\n        else if (!item.data || item.treeListController.hasItems(item.data)) {\n            processItemsFunc = function () { return item._getItemsWithLock().done(function (result) {\n                result.forEach(function (node) {\n                    walkCallback(node);\n                    _this._visitNextNode(node, walkCallback);\n                });\n            }); };\n        }\n        if (processItemsFunc)\n            this._resolver.execute(processItemsFunc, 1);\n    };\n    TreeListRootItemViewModel.prototype._onItemsChanged = function () {\n        if (this._options.expandRootItems)\n            this.items().forEach(function (item) {\n                item.collapsed(false);\n            });\n        _super.prototype._onItemsChanged.call(this);\n    };\n    return TreeListRootItemViewModel;\n}(TreeListItemViewModel));\nexports.TreeListRootItemViewModel = TreeListRootItemViewModel;\n"]},"metadata":{},"sourceType":"script"}