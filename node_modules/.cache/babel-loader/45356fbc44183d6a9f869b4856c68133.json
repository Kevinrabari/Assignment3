{"ast":null,"code":"/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\_dbSchemaItemsProvider.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DBSchemaItemsProvider = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar _arrayutils_1 = require(\"../../../core/utils/_arrayutils\");\n\nvar _treeListNode_1 = require(\"./_treeListNode\");\n\nvar localization_utils_1 = require(\"../../../property-grid/localization/localization_utils\");\n\nvar _storedProceduresQueryControl_1 = require(\"./_storedProceduresQueryControl\");\n\nvar utils_1 = require(\"../../../serializer/utils\");\n\nvar DBSchemaItemsProvider = function (_super) {\n  __extends(DBSchemaItemsProvider, _super);\n\n  function DBSchemaItemsProvider(dbSchemaProvider, customQueries, showQbCallBack, disableCustomSql, afterCheckToggled) {\n    var _a;\n\n    var _this = _super.call(this) || this;\n\n    _this._callBack = ko.observable({\n      deleteAction: function (name) {\n        _this._customQueries.remove(_arrayutils_1.findFirstItemMatchesCondition(_this._customQueries(), function (item) {\n          return (item.name() || item.generateName()) === name;\n        }));\n      },\n      showQbCallBack: null,\n      disableCustomSql: false\n    });\n    _this._checkedRootNodesCount = ko.pureComputed(function () {\n      var count = 0;\n\n      for (var i = 0; i < _this._rootItems.length && count < 2; i++) {\n        count += _this._rootItems[i].countChecked();\n      }\n\n      return count;\n    });\n    _this.hasCheckedItems = ko.pureComputed(function () {\n      return !(_this._checkedRootNodesCount() === 0);\n    });\n    _this.nextButtonDisabled = ko.pureComputed(function () {\n      if (_this._checkedRootNodesCount() > 1) {\n        return false;\n      }\n\n      return !_this.hasParametersToEdit();\n    });\n    _this.hasParametersToEdit = ko.pureComputed(function () {\n      for (var i = 0; i < _this._rootItems.length; i++) {\n        if (_this._rootItems[i]['hasParamsToEdit'] && _this._rootItems[i]['hasParamsToEdit']()) return true;\n      }\n\n      return false;\n    });\n\n    _this.tables = function () {\n      return _this._tables;\n    };\n\n    _this.views = function () {\n      return _this._views;\n    };\n\n    _this.procedures = function () {\n      return _this._procedures;\n    };\n\n    _this.queries = function () {\n      return _this._queries;\n    };\n\n    _this.customQueries = function () {\n      return _this._customQueries;\n    };\n\n    _this._callBack().showQbCallBack = showQbCallBack;\n    _this._callBack().disableCustomSql = disableCustomSql;\n    _this._tables = new _treeListNode_1.TreeNode('tables', localization_utils_1.getLocalization('Tables', 'DataAccessStringId.ConfigureMultiQueryPage_TableCategory'), 'list', false, afterCheckToggled);\n    _this._views = new _treeListNode_1.TreeNode('views', localization_utils_1.getLocalization('Views', 'DataAccessStringId.ConfigureMultiQueryPage_ViewCategory'), 'list', false, afterCheckToggled);\n    _this._procedures = new _treeListNode_1.ParameterTreeNode('procedures', localization_utils_1.getLocalization('Stored Procedures', 'DataAccessStringId.ConfigureMultiQueryPage_SpCategory'), 'list', false, afterCheckToggled);\n    _this._queries = new _treeListNode_1.QueriesTreeNode('queries', localization_utils_1.getLocalization('Queries', 'DataAccessStringId.ConfigureMultiQueryPage_QueryCategory'), 'list', false, _this._callBack, afterCheckToggled);\n\n    (_a = _this._disposables).push.apply(_a, [_this._tables, _this._views, _this._procedures, _this._queries]);\n\n    _this._rootItems = [_this._tables, _this._views, _this._procedures, _this._queries];\n\n    _this.getItems = function (pathRequest) {\n      var result = $.Deferred();\n\n      if (!pathRequest.fullPath) {\n        result.resolve(_this._rootItems);\n      } else if (pathRequest.fullPath === 'tables') {\n        dbSchemaProvider.getDbSchema().done(function (dbSchema) {\n          if (_this._tables.children().length === 0) {\n            var tables = [];\n            dbSchema.tables.forEach(function (table) {\n              if (!table.isView) {\n                tables.push(new _treeListNode_1.TreeNode(table.name, table.name, 'table', _this._tables.checked.peek(), afterCheckToggled));\n              }\n            });\n\n            _this._tables.initializeChildren(tables);\n\n            result.resolve(tables);\n          } else {\n            result.resolve(_this._tables.children());\n          }\n        }).fail(result.reject);\n      } else if (pathRequest.fullPath === 'views') {\n        dbSchemaProvider.getDbSchema().done(function (dbSchema) {\n          if (_this._views.children().length === 0) {\n            var views = [];\n            dbSchema.tables.forEach(function (table) {\n              if (table.isView) {\n                views.push(new _treeListNode_1.TreeNode(table.name, table.name, 'view', _this._views.checked.peek(), afterCheckToggled));\n              }\n            });\n\n            _this._views.initializeChildren(views);\n\n            result.resolve(views);\n          } else {\n            result.resolve(_this._views.children());\n          }\n        }).fail(result.reject);\n      } else if (pathRequest.fullPath === 'procedures') {\n        dbSchemaProvider.getDbStoredProcedures().done(function (storedProcedures) {\n          if (_this._procedures.children().length === 0) {\n            var procedures = storedProcedures.map(function (proc) {\n              var node = new _treeListNode_1.TreeLeafNode(proc.name, _storedProceduresQueryControl_1.StoredProceduresQueryControl.generateStoredProcedureDisplayName(proc), 'procedure', _this._procedures.checked.peek(), proc.arguments, afterCheckToggled);\n\n              _this._disposables.push(node);\n\n              return node;\n            });\n\n            _this._procedures.initializeChildren(procedures);\n\n            result.resolve(procedures);\n          } else {\n            result.resolve(_this._procedures.children());\n          }\n        }).fail(result.reject);\n      } else if (pathRequest.fullPath === 'queries') {\n        var queries = customQueries().map(function (query) {\n          var name = query.name() || query.generateName();\n\n          var currentQuery = _this._queries.children().filter(function (q) {\n            return q['query'] === query;\n          })[0];\n\n          if (currentQuery) return currentQuery;\n          var queryNode = new _treeListNode_1.TreeQueryNode(name, name, 'query', !!currentQuery && currentQuery.checked(), query.parameters, _this._callBack, afterCheckToggled, query);\n\n          _this._disposables.push(queryNode);\n\n          queryNode.setObservableName(ko.computed({\n            read: function () {\n              return query.name() || query.generateName();\n            },\n            write: function (newVal) {\n              return query.name(newVal);\n            }\n          }));\n          return queryNode;\n        });\n\n        _this._queries.initializeChildren(queries);\n\n        result.resolve(queries);\n      } else {\n        dbSchemaProvider.getDbTable(pathRequest.path).done(function (table) {\n          var tableTreeNode;\n\n          if (table.isView) {\n            tableTreeNode = _arrayutils_1.findFirstItemMatchesCondition(_this._views.children(), function (item) {\n              return item.name === table.name;\n            });\n          } else {\n            tableTreeNode = _arrayutils_1.findFirstItemMatchesCondition(_this._tables.children(), function (item) {\n              return item.name === table.name;\n            });\n          }\n\n          if (tableTreeNode.children().length === 0) {\n            var columns = table.columns.map(function (column) {\n              var node = new _treeListNode_1.TreeLeafNode(column.name, column.name, 'column', tableTreeNode.checked.peek(), null, afterCheckToggled);\n\n              _this._disposables.push(node);\n\n              return node;\n            });\n            tableTreeNode.initializeChildren(columns);\n            result.resolve(columns);\n          } else {\n            result.resolve(tableTreeNode.children());\n          }\n        }).fail(result.reject);\n      }\n\n      return result.promise();\n    };\n\n    _this._customQueries = customQueries;\n    return _this;\n  }\n\n  return DBSchemaItemsProvider;\n}(utils_1.Disposable);\n\nexports.DBSchemaItemsProvider = DBSchemaItemsProvider;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/query-builder/wizard/internal/_dbSchemaItemsProvider.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","DBSchemaItemsProvider","ko","require","$","_arrayutils_1","_treeListNode_1","localization_utils_1","_storedProceduresQueryControl_1","utils_1","_super","dbSchemaProvider","customQueries","showQbCallBack","disableCustomSql","afterCheckToggled","_a","_this","_callBack","observable","deleteAction","name","_customQueries","remove","findFirstItemMatchesCondition","item","generateName","_checkedRootNodesCount","pureComputed","count","i","_rootItems","length","countChecked","hasCheckedItems","nextButtonDisabled","hasParametersToEdit","tables","_tables","views","_views","procedures","_procedures","queries","_queries","TreeNode","getLocalization","ParameterTreeNode","QueriesTreeNode","_disposables","push","apply","getItems","pathRequest","result","Deferred","fullPath","resolve","getDbSchema","done","dbSchema","children","forEach","table","isView","checked","peek","initializeChildren","fail","reject","getDbStoredProcedures","storedProcedures","map","proc","node","TreeLeafNode","StoredProceduresQueryControl","generateStoredProcedureDisplayName","arguments","query","currentQuery","filter","q","queryNode","TreeQueryNode","parameters","setObservableName","computed","read","write","newVal","getDbTable","path","tableTreeNode","columns","column","promise","Disposable"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\_dbSchemaItemsProvider.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DBSchemaItemsProvider = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar _arrayutils_1 = require(\"../../../core/utils/_arrayutils\");\nvar _treeListNode_1 = require(\"./_treeListNode\");\nvar localization_utils_1 = require(\"../../../property-grid/localization/localization_utils\");\nvar _storedProceduresQueryControl_1 = require(\"./_storedProceduresQueryControl\");\nvar utils_1 = require(\"../../../serializer/utils\");\nvar DBSchemaItemsProvider = (function (_super) {\n    __extends(DBSchemaItemsProvider, _super);\n    function DBSchemaItemsProvider(dbSchemaProvider, customQueries, showQbCallBack, disableCustomSql, afterCheckToggled) {\n        var _a;\n        var _this = _super.call(this) || this;\n        _this._callBack = ko.observable({\n            deleteAction: function (name) {\n                _this._customQueries\n                    .remove(_arrayutils_1.findFirstItemMatchesCondition(_this._customQueries(), function (item) { return (item.name() || item.generateName()) === name; }));\n            },\n            showQbCallBack: null,\n            disableCustomSql: false,\n        });\n        _this._checkedRootNodesCount = ko.pureComputed(function () {\n            var count = 0;\n            for (var i = 0; i < _this._rootItems.length && count < 2; i++) {\n                count += _this._rootItems[i].countChecked();\n            }\n            return count;\n        });\n        _this.hasCheckedItems = ko.pureComputed(function () {\n            return !(_this._checkedRootNodesCount() === 0);\n        });\n        _this.nextButtonDisabled = ko.pureComputed(function () {\n            if (_this._checkedRootNodesCount() > 1) {\n                return false;\n            }\n            return !_this.hasParametersToEdit();\n        });\n        _this.hasParametersToEdit = ko.pureComputed(function () {\n            for (var i = 0; i < _this._rootItems.length; i++) {\n                if (_this._rootItems[i]['hasParamsToEdit'] && _this._rootItems[i]['hasParamsToEdit']())\n                    return true;\n            }\n            return false;\n        });\n        _this.tables = function () { return _this._tables; };\n        _this.views = function () { return _this._views; };\n        _this.procedures = function () { return _this._procedures; };\n        _this.queries = function () { return _this._queries; };\n        _this.customQueries = function () { return _this._customQueries; };\n        _this._callBack().showQbCallBack = showQbCallBack;\n        _this._callBack().disableCustomSql = disableCustomSql;\n        _this._tables = new _treeListNode_1.TreeNode('tables', localization_utils_1.getLocalization('Tables', 'DataAccessStringId.ConfigureMultiQueryPage_TableCategory'), 'list', false, afterCheckToggled);\n        _this._views = new _treeListNode_1.TreeNode('views', localization_utils_1.getLocalization('Views', 'DataAccessStringId.ConfigureMultiQueryPage_ViewCategory'), 'list', false, afterCheckToggled);\n        _this._procedures = new _treeListNode_1.ParameterTreeNode('procedures', localization_utils_1.getLocalization('Stored Procedures', 'DataAccessStringId.ConfigureMultiQueryPage_SpCategory'), 'list', false, afterCheckToggled);\n        _this._queries = new _treeListNode_1.QueriesTreeNode('queries', localization_utils_1.getLocalization('Queries', 'DataAccessStringId.ConfigureMultiQueryPage_QueryCategory'), 'list', false, _this._callBack, afterCheckToggled);\n        (_a = _this._disposables).push.apply(_a, [_this._tables, _this._views, _this._procedures, _this._queries]);\n        _this._rootItems = [\n            _this._tables,\n            _this._views,\n            _this._procedures,\n            _this._queries\n        ];\n        _this.getItems = function (pathRequest) {\n            var result = $.Deferred();\n            if (!pathRequest.fullPath) {\n                result.resolve(_this._rootItems);\n            }\n            else if (pathRequest.fullPath === 'tables') {\n                dbSchemaProvider.getDbSchema().done(function (dbSchema) {\n                    if (_this._tables.children().length === 0) {\n                        var tables = [];\n                        dbSchema.tables.forEach(function (table) {\n                            if (!table.isView) {\n                                tables.push(new _treeListNode_1.TreeNode(table.name, table.name, 'table', _this._tables.checked.peek(), afterCheckToggled));\n                            }\n                        });\n                        _this._tables.initializeChildren(tables);\n                        result.resolve(tables);\n                    }\n                    else {\n                        result.resolve(_this._tables.children());\n                    }\n                }).fail(result.reject);\n            }\n            else if (pathRequest.fullPath === 'views') {\n                dbSchemaProvider.getDbSchema().done(function (dbSchema) {\n                    if (_this._views.children().length === 0) {\n                        var views = [];\n                        dbSchema.tables.forEach(function (table) {\n                            if (table.isView) {\n                                views.push(new _treeListNode_1.TreeNode(table.name, table.name, 'view', _this._views.checked.peek(), afterCheckToggled));\n                            }\n                        });\n                        _this._views.initializeChildren(views);\n                        result.resolve(views);\n                    }\n                    else {\n                        result.resolve(_this._views.children());\n                    }\n                }).fail(result.reject);\n            }\n            else if (pathRequest.fullPath === 'procedures') {\n                dbSchemaProvider.getDbStoredProcedures().done(function (storedProcedures) {\n                    if (_this._procedures.children().length === 0) {\n                        var procedures = storedProcedures.map(function (proc) {\n                            var node = new _treeListNode_1.TreeLeafNode(proc.name, _storedProceduresQueryControl_1.StoredProceduresQueryControl.generateStoredProcedureDisplayName(proc), 'procedure', _this._procedures.checked.peek(), proc.arguments, afterCheckToggled);\n                            _this._disposables.push(node);\n                            return node;\n                        });\n                        _this._procedures.initializeChildren(procedures);\n                        result.resolve(procedures);\n                    }\n                    else {\n                        result.resolve(_this._procedures.children());\n                    }\n                }).fail(result.reject);\n            }\n            else if (pathRequest.fullPath === 'queries') {\n                var queries = customQueries().map(function (query) {\n                    var name = query.name() || query.generateName();\n                    var currentQuery = _this._queries.children().filter(function (q) { return q['query'] === query; })[0];\n                    if (currentQuery)\n                        return currentQuery;\n                    var queryNode = new _treeListNode_1.TreeQueryNode(name, name, 'query', !!currentQuery && currentQuery.checked(), query.parameters, _this._callBack, afterCheckToggled, query);\n                    _this._disposables.push(queryNode);\n                    queryNode.setObservableName(ko.computed({\n                        read: function () { return query.name() || query.generateName(); },\n                        write: function (newVal) { return query.name(newVal); }\n                    }));\n                    return queryNode;\n                });\n                _this._queries.initializeChildren(queries);\n                result.resolve(queries);\n            }\n            else {\n                dbSchemaProvider.getDbTable(pathRequest.path).done(function (table) {\n                    var tableTreeNode;\n                    if (table.isView) {\n                        tableTreeNode = _arrayutils_1.findFirstItemMatchesCondition(_this._views.children(), function (item) { return item.name === table.name; });\n                    }\n                    else {\n                        tableTreeNode = _arrayutils_1.findFirstItemMatchesCondition(_this._tables.children(), function (item) { return item.name === table.name; });\n                    }\n                    if (tableTreeNode.children().length === 0) {\n                        var columns = table.columns.map(function (column) {\n                            var node = new _treeListNode_1.TreeLeafNode(column.name, column.name, 'column', tableTreeNode.checked.peek(), null, afterCheckToggled);\n                            _this._disposables.push(node);\n                            return node;\n                        });\n                        tableTreeNode.initializeChildren(columns);\n                        result.resolve(columns);\n                    }\n                    else {\n                        result.resolve(tableTreeNode.children());\n                    }\n                }).fail(result.reject);\n            }\n            return result.promise();\n        };\n        _this._customQueries = customQueries;\n        return _this;\n    }\n    return DBSchemaItemsProvider;\n}(utils_1.Disposable));\nexports.DBSchemaItemsProvider = DBSchemaItemsProvider;\n"]},"metadata":{},"sourceType":"script"}