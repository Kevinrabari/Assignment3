{"ast":null,"code":"/**\n* DevExpress Analytics (widgets\\filtereditor\\filtereditor.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FilterEditorPlain = exports.FilterEditor = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar localization_utils_1 = require(\"../../property-grid/localization/localization_utils\");\n\nvar unary_1 = require(\"../criteria/operators/unary\");\n\nvar unaryOperandSurface_1 = require(\"./operators/unaryOperandSurface\");\n\nvar _popupService_1 = require(\"../../property-grid/internal/_popupService\");\n\nvar _displayNameProvider_1 = require(\"../common/_displayNameProvider\");\n\nvar _expressioneditor_1 = require(\"../expressioneditor/_expressioneditor\");\n\nvar _codeCompletor_1 = require(\"./helpers/_codeCompletor\");\n\nvar _utils_1 = require(\"../_utils\");\n\nvar _internal_1 = require(\"../../serializer/_internal\");\n\nvar text_area_1 = require(\"devextreme/ui/text_area\");\n\nvar _ace_available_1 = require(\"../ace/_ace-available\");\n\nvar templateUtils_1 = require(\"../../property-grid/widgets/templateUtils\");\n\nvar group_1 = require(\"../criteria/operators/group\");\n\nvar _popupEditorBase_1 = require(\"../../core/widgets/_popupEditorBase\");\n\nvar group_2 = require(\"../criteria/operators/options/group\");\n\nvar criteriaOperatorPreprocessor_1 = require(\"../criteria/utils/criteriaOperatorPreprocessor\");\n\nvar FilterEditor = function (_super) {\n  __extends(FilterEditor, _super);\n\n  function FilterEditor(options, fieldListProvider, rtl, _displayNameProvider) {\n    if (rtl === void 0) {\n      rtl = false;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.options = options;\n    _this._displayNameProvider = _displayNameProvider;\n    _this._advancedMode = ko.observable(false);\n    _this.textFocused = ko.observable(false);\n    _this.aceAvailable = _ace_available_1.aceAvailable();\n    _this.languageHelper = {\n      getLanguageMode: function () {\n        return 'ace/mode/criteria';\n      },\n      createCompleters: function (editor, bindingContext, viewModel) {\n        var path = ko.computed(function () {\n          return _this.path && _this.path();\n        }),\n            completor = new _codeCompletor_1.FilterEditorCodeCompletor({\n          editor: editor,\n          bindingContext: bindingContext,\n          fieldListProvider: viewModel.fieldListProvider(),\n          path: path,\n          getRealExpression: function (path, expression) {\n            return _this.displayExpressionConverter && _this.displayExpressionConverter.toRealExpression(path, expression) || $.Deferred().resolve(expression).promise();\n          }\n        });\n\n        completor._disposables.push(path);\n\n        return [completor];\n      }\n    };\n    _this.aceOptions = {\n      showLineNumbers: false,\n      showPrintMargin: false,\n      enableBasicAutocompletion: true,\n      enableLiveAutocompletion: true,\n      showGutter: false\n    };\n    _this.additionalOptions = {\n      onChange: function (session) {\n        return _this.onValueChange(session.getValue());\n      },\n      changeTimeout: 200,\n      onFocus: function (_) {\n        return _this.onFocus();\n      },\n      onBlur: function (_) {\n        return _this.onBlur();\n      }\n    };\n    _this.editorContainer = ko.observable();\n    _this.textVisible = ko.observable(false);\n\n    _this.getPopupContainer = function (el) {\n      return _utils_1.getParentContainer(el, _this.options()['popupContainer']);\n    };\n\n    _this.timeout = null;\n    _this.animationTimeout = null;\n    _this.advancedMode = ko.computed({\n      read: function () {\n        return _this._advancedMode();\n      },\n      write: function (newVal) {\n        _this.timeout && clearTimeout(_this.timeout);\n        _this.animationTimeout && clearTimeout(_this.animationTimeout);\n\n        if (newVal) {\n          _this.textVisible(true);\n\n          _this.timeout = setTimeout(function () {\n            _this._advancedMode(true);\n\n            _this.focusText();\n          }, 1);\n          _this.animationTimeout = setTimeout(function () {\n            _this.editorContainer() && _this.editorContainer().resize && _this.editorContainer().resize();\n          }, 210);\n        } else {\n          _this._advancedMode(false);\n\n          _this.timeout = setTimeout(function () {\n            _this.textVisible(false);\n          }, 200);\n        }\n      }\n    });\n\n    _this.invalidMessage = function () {\n      return localization_utils_1.getLocalization('Cannot create a tree for this expression', 'AnalyticsCoreStringId.FilterEditor_TreeCreationError');\n    };\n\n    _this.advancedModeText = ko.observable(localization_utils_1.getLocalization('Advanced Mode', 'AnalyticsCoreStringId.FilterEditor_AdvancedMode'));\n    _this.operandSurface = ko.observable(null);\n    _this.operand = null;\n    _this.popupService = new _popupService_1.PopupService();\n    _this.rtl = rtl;\n    options() && options().helper && (options().helper.rtl = rtl);\n\n    _this._disposables.push(_this.disabled = ko.computed(function () {\n      return ko.unwrap(_this.options() && _this.options().disabled());\n    }));\n\n    _this.value = ko.observable('');\n    _this.displayExpressionConverter = _displayNameProvider && new _displayNameProvider_1.DisplayExpressionConverter(_displayNameProvider);\n\n    _this.save = function () {\n      _this.helper.onSave(_this.value());\n\n      if (_this.operandSurface() && _this.isSurfaceValid()) {\n        var value = options().helper.serializer.serialize(_this.operand, false);\n\n        _this.options().value(value);\n      } else {\n        _this.options().value(_this.value());\n      }\n\n      _this.popupVisible(false);\n    };\n\n    _this.displayValue = _expressioneditor_1.wrapExpressionValue(_this.path, _this.value, _this.displayExpressionConverter, _this._disposables);\n    var modelValue = ko.computed({\n      read: function () {\n        var options = _this.options();\n\n        return options && options.value();\n      },\n      write: function (newVal) {\n        var options = _this.options();\n\n        options && options.value(newVal);\n      }\n    });\n    _this.modelDisplayValue = _expressioneditor_1.wrapExpressionValue(_this.path, modelValue, _this.displayExpressionConverter, _this._disposables);\n    _this.fieldListProvider = fieldListProvider;\n    _this.modelValueIsValid = ko.computed(function () {\n      return options() && _this._validateValue(options().value());\n    });\n    _this.isValid = ko.computed(function () {\n      return _this._validateValue(_this.value());\n    });\n    _this.isSurfaceValid = ko.computed(function () {\n      try {\n        return _this.options() && _this.isValid() && _this.options().helper.criteriaTreeValidator.validateModel(_this.options().helper.serializer.deserialize(_this.value()));\n      } catch (e) {\n        return false;\n      }\n    });\n\n    _this._disposables.push(modelValue);\n\n    _this._disposables.push(_this.modelValueIsValid);\n\n    _this._disposables.push(_this.isValid);\n\n    _this._disposables.push(_this.isSurfaceValid);\n\n    _this._disposables.push(_this.popupVisible.subscribe(function (newVal) {\n      if (newVal) {\n        _this.value(_this.options().value());\n\n        if (_this.isSurfaceValid()) {\n          _this.operand = _this._generateOperand(_this.value());\n\n          _this.operandSurface(_this._generateSurface(_this.operand));\n        } else {\n          _this.textVisible(true);\n\n          _this._advancedMode(true);\n\n          _this.editorContainer() && _this.focusText();\n        }\n\n        options().helper.onChange = function () {\n          _this.value(options().helper.serializer.serialize(_this.operand, false));\n        };\n      } else {\n        _this.helper.onClosing();\n\n        _this.value(null);\n\n        _this.operandSurface() && _this.operandSurface().dispose();\n\n        _this.operandSurface(null);\n\n        _this.operand = null;\n      }\n    }));\n\n    _this.createAddButton = function (criteria) {\n      return options().helper.handlers.create(criteria, _this.popupService);\n    };\n\n    _this.createChangeType = function (criteria) {\n      return options().helper.handlers.change(criteria, _this.popupService);\n    };\n\n    _this.createChangeProperty = function (criteria) {\n      return options().helper.handlers.changeProperty(criteria, _this.popupService);\n    };\n\n    _this.createChangeParameter = function (criteria) {\n      return options().helper.handlers.changeParameter(criteria, _this.popupService);\n    };\n\n    _this.createChangeValueType = function (criteria) {\n      return options().helper.handlers.changeValueType(criteria, _this.popupService);\n    };\n\n    _this._disposables.push(_this.advancedMode);\n\n    _this.buttonItems.push({\n      toolbar: 'bottom',\n      location: 'before',\n      widget: 'dxCheckBox',\n      options: {\n        value: _this.advancedMode,\n        text: _this.advancedModeText()\n      }\n    });\n\n    return _this;\n  }\n\n  FilterEditor.prototype._generateOperand = function (value) {\n    return this.options().helper.serializer.deserialize(value);\n  };\n\n  FilterEditor.prototype._generateSurface = function (operand) {\n    var type = null;\n\n    if (operand instanceof unary_1.UnaryOperator) {\n      type = this.options().helper.mapper.unary;\n    } else {\n      type = this.options().helper.mapper.group;\n    }\n\n    var surface = new type(operand, this, this.fieldListProvider, this.path);\n\n    if (surface instanceof unaryOperandSurface_1.UnaryOperandSurface) {\n      if (!(surface.model.operand instanceof group_1.GroupOperator)) {\n        this.operand = new group_1.GroupOperator(group_2.GroupOperatorType.And, [this.operand]);\n        surface.dispose();\n        return this._generateSurface(this.operand);\n      }\n\n      surface.operand().canRemove = false;\n    }\n\n    surface.canRemove = false;\n    return surface;\n  };\n\n  FilterEditor.prototype._validateValue = function (value) {\n    try {\n      if (this.options() && this.options().helper) {\n        this.options().helper.serializer.deserialize(value);\n        return true;\n      } else {\n        return false;\n      }\n    } catch (e) {\n      return false;\n    }\n  };\n\n  FilterEditor.prototype.canSave = function () {\n    return this.isValid();\n  };\n\n  FilterEditor.prototype.change = function (type, surface) {\n    this.operand = criteriaOperatorPreprocessor_1.criteriaCreator.changeByType(type);\n    this.operand.assignFrom(surface.model);\n    var type = null;\n\n    if (this.operand instanceof unary_1.UnaryOperator) {\n      type = this.options().helper.mapper.unary;\n    } else {\n      type = this.options().helper.mapper.group;\n    }\n\n    var surface = new type(this.operand, this, this.fieldListProvider, this.path);\n    surface.canRemove = false;\n\n    if (surface instanceof unaryOperandSurface_1.UnaryOperandSurface) {\n      surface.operand().canRemove = false;\n    }\n\n    this.operandSurface(surface);\n  };\n\n  Object.defineProperty(FilterEditor.prototype, \"helper\", {\n    get: function () {\n      return this.options() && this.options().helper;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FilterEditor.prototype, \"path\", {\n    get: function () {\n      return this.options() && this.options().path;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  FilterEditor.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this.editorContainer(null);\n    this.operandSurface() && this.operandSurface().dispose();\n  };\n\n  FilterEditor.prototype.onInput = function (s, e) {\n    var self = this;\n    this.timeout && clearTimeout(this.timeout);\n    this.timeout = setTimeout(function () {\n      self.onValueChange(s.component.option('text'));\n    }, 200);\n  };\n\n  FilterEditor.prototype.onFocus = function () {\n    this.textFocused(true);\n  };\n\n  FilterEditor.prototype.onBlur = function () {\n    this.textFocused(false);\n    this.helper.onEditorFocusOut(this.operand);\n  };\n\n  FilterEditor.prototype.cacheElement = function ($element) {\n    this.editorContainer(text_area_1.default.getInstance($element.get(0)));\n  };\n\n  FilterEditor.prototype.updateCriteria = function () {\n    if (this.isSurfaceValid()) {\n      this.operand = this._generateOperand(this.value());\n      this.operandSurface() && this.operandSurface().dispose();\n      this.operandSurface(this._generateSurface(this.operand));\n    }\n  };\n\n  FilterEditor.prototype.onValueChange = function (value) {\n    var _this = this;\n\n    if (this.displayValue() === value.trim()) return;\n    this.displayValue(value);\n\n    if (this.displayExpressionConverter) {\n      this.displayExpressionConverter.toRealExpression(this.path(), value).done(function (result) {\n        _this.value(result);\n\n        _this.updateCriteria();\n      }).fail(function () {\n        _this.value(value);\n\n        _this.updateCriteria();\n      });\n    } else {\n      this.updateCriteria();\n    }\n  };\n\n  FilterEditor.prototype.focusText = function () {\n    var focusFn = function (editor) {\n      setTimeout(function (_) {\n        if (editor.renderer) editor.renderer.updateText();\n        editor.focus();\n      }, 1);\n    };\n\n    if (!this.editorContainer()) var subscription = this.editorContainer.subscribe(function (editor) {\n      subscription.dispose();\n      focusFn(editor);\n    });else focusFn(this.editorContainer());\n  };\n\n  Object.defineProperty(FilterEditor.prototype, \"cancelLocalization\", {\n    get: function () {\n      return localization_utils_1.getLocalization('Cancel', 'StringId.Cancel');\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FilterEditor.prototype, \"saveLocalization\", {\n    get: function () {\n      return localization_utils_1.getLocalization('OK', 'StringId.OK');\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return FilterEditor;\n}(_popupEditorBase_1.PopupEditorBase);\n\nexports.FilterEditor = FilterEditor;\nko.bindingHandlers['dxFilterEditor'] = {\n  init: function (element, valueAccessor) {\n    $(element).children().remove();\n    $(element).addClass('dx-popup-general');\n    var templateHtml = templateUtils_1.getTemplate('dx-filtereditor'),\n        $element = $(element).append(templateHtml),\n        values = valueAccessor();\n    var itemsProvider = ko.observable(ko.unwrap(values.fieldListProvider));\n    var computedFunctions = [];\n    computedFunctions.push(ko.computed(function () {\n      if (values.options() && values.options().itemsProvider) {\n        itemsProvider(ko.unwrap(values.options().itemsProvider));\n      } else {\n        itemsProvider(ko.unwrap(values.fieldListProvider));\n      }\n    }));\n    computedFunctions.push(ko.computed(function () {\n      if (values.getDisplayNameByPath && values.options() && values.options().helper && !values.options().helper.getDisplayPropertyName) {\n        values.options().helper.getDisplayPropertyName = values.getDisplayNameByPath;\n      }\n    }));\n    var editor = new FilterEditor(values.options, itemsProvider, $(element).closest('.dx-rtl').length > 0, values.displayNameProvider);\n    ko.applyBindingsToDescendants(editor, $element.children()[0]);\n\n    _internal_1.addDisposeCallback($element.children()[0], function () {\n      computedFunctions.forEach(function (x) {\n        return x.dispose();\n      });\n      editor.dispose();\n    });\n\n    return {\n      controlsDescendantBindings: true\n    };\n  }\n};\n\nvar FilterEditorPlain = function (_super) {\n  __extends(FilterEditorPlain, _super);\n\n  function FilterEditorPlain(element, options, fieldListProvider, rtl, _displayNameProvider) {\n    if (rtl === void 0) {\n      rtl = false;\n    }\n\n    var _this = _super.call(this, options, fieldListProvider, rtl, _displayNameProvider) || this;\n\n    _this.element = element;\n    _this._contentMargins = 20;\n    _this._topOffset = 30;\n    _this._defaultActiveTextContentHeightPerc = 25;\n    _this._defaultActiveTreeContentHeightPerc = 75;\n    _this._currentActiveTextContentHeightPerc = _this._defaultActiveTextContentHeightPerc;\n    _this._currentActiveTreeContentHeightPerc = _this._defaultActiveTreeContentHeightPerc;\n    _this.plainContentHeightPerc = ko.observable('100%');\n    _this.textContentHeightPerc = ko.observable(null);\n    _this.treeContentHeightPerc = ko.observable(null);\n    var $element = $(element);\n\n    var updateHeight = function () {\n      var currentHeight = $element.height();\n\n      _this.plainContentHeightPerc((1 - _this._topOffset / currentHeight) * 100 + '%');\n\n      var diffPerc = _this._contentMargins / (currentHeight - _this._topOffset) * 100 / 2;\n      _this._currentActiveTextContentHeightPerc = _this._defaultActiveTextContentHeightPerc - diffPerc;\n      _this._currentActiveTreeContentHeightPerc = _this._defaultActiveTreeContentHeightPerc - diffPerc;\n\n      if (_this.advancedMode()) {\n        _this.treeContentHeightPerc(_this._currentActiveTreeContentHeightPerc);\n\n        _this.textContentHeightPerc(_this._currentActiveTextContentHeightPerc);\n      }\n    };\n\n    updateHeight();\n\n    _this._disposables.push(_this.advancedMode.subscribe(function (newVal) {\n      if (newVal) {\n        _this.treeContentHeightPerc(_this._currentActiveTreeContentHeightPerc + '%');\n\n        _this.textContentHeightPerc(_this._currentActiveTextContentHeightPerc + '%');\n      } else {\n        _this.treeContentHeightPerc(null);\n\n        _this.textContentHeightPerc(null);\n      }\n    }));\n\n    window.addEventListener('resize', updateHeight);\n\n    _internal_1.addDisposeCallback(element, function () {\n      window.removeEventListener('resize', updateHeight);\n\n      _this.dispose();\n    });\n\n    return _this;\n  }\n\n  return FilterEditorPlain;\n}(FilterEditor);\n\nexports.FilterEditorPlain = FilterEditorPlain;\nko.components.register('dx-filtereditor-plain', {\n  viewModel: {\n    createViewModel: function (params, componentInfo) {\n      var viewModel = new FilterEditorPlain(componentInfo.element, params.options, ko.observable(params.fieldListProvider), undefined, params.displayNameProvider);\n      viewModel.popupVisible(true);\n      params.options().value.subscribe(function () {\n        viewModel.popupVisible(false);\n        viewModel.popupVisible(true);\n      });\n      return viewModel;\n    }\n  },\n  template: templateUtils_1.getTemplate('dx-filtereditor-plain')\n});\nko.components.register('dx-filtereditor-advanced', {\n  viewModel: {\n    createViewModel: function (params, componentInfo) {\n      var viewModel = new FilterEditor(params.options, ko.observable(params.fieldListProvider), undefined, params.displayNameProvider);\n      viewModel.advancedMode(true);\n      viewModel.popupVisible(true);\n      params.options().value.subscribe(function () {\n        viewModel.popupVisible(false);\n        viewModel.popupVisible(true);\n      });\n      return viewModel;\n    }\n  },\n  template: templateUtils_1.getTemplate('dx-filtereditor-advanced')\n});\nko.bindingHandlers['cacheElement'] = {\n  init: function (element, valueAccessor, allBindings, viewModel, bindingContext) {\n    var value = valueAccessor();\n    value.action($(element));\n  }\n};","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/widgets/filtereditor/filtereditor.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","FilterEditorPlain","FilterEditor","ko","require","$","localization_utils_1","unary_1","unaryOperandSurface_1","_popupService_1","_displayNameProvider_1","_expressioneditor_1","_codeCompletor_1","_utils_1","_internal_1","text_area_1","_ace_available_1","templateUtils_1","group_1","_popupEditorBase_1","group_2","criteriaOperatorPreprocessor_1","_super","options","fieldListProvider","rtl","_displayNameProvider","_this","_advancedMode","observable","textFocused","aceAvailable","languageHelper","getLanguageMode","createCompleters","editor","bindingContext","viewModel","path","computed","completor","FilterEditorCodeCompletor","getRealExpression","expression","displayExpressionConverter","toRealExpression","Deferred","resolve","promise","_disposables","push","aceOptions","showLineNumbers","showPrintMargin","enableBasicAutocompletion","enableLiveAutocompletion","showGutter","additionalOptions","onChange","session","onValueChange","getValue","changeTimeout","onFocus","_","onBlur","editorContainer","textVisible","getPopupContainer","el","getParentContainer","timeout","animationTimeout","advancedMode","read","write","newVal","clearTimeout","setTimeout","focusText","resize","invalidMessage","getLocalization","advancedModeText","operandSurface","operand","popupService","PopupService","helper","disabled","unwrap","DisplayExpressionConverter","save","onSave","isSurfaceValid","serializer","serialize","popupVisible","displayValue","wrapExpressionValue","modelValue","modelDisplayValue","modelValueIsValid","_validateValue","isValid","criteriaTreeValidator","validateModel","deserialize","e","subscribe","_generateOperand","_generateSurface","onClosing","dispose","createAddButton","criteria","handlers","createChangeType","change","createChangeProperty","changeProperty","createChangeParameter","changeParameter","createChangeValueType","changeValueType","buttonItems","toolbar","location","widget","text","type","UnaryOperator","mapper","unary","group","surface","UnaryOperandSurface","model","GroupOperator","GroupOperatorType","And","canRemove","canSave","criteriaCreator","changeByType","assignFrom","get","enumerable","configurable","onInput","s","self","component","option","onEditorFocusOut","cacheElement","$element","default","getInstance","updateCriteria","trim","done","result","fail","focusFn","renderer","updateText","focus","subscription","PopupEditorBase","bindingHandlers","init","element","valueAccessor","children","remove","addClass","templateHtml","getTemplate","append","values","itemsProvider","computedFunctions","getDisplayNameByPath","getDisplayPropertyName","closest","length","displayNameProvider","applyBindingsToDescendants","addDisposeCallback","forEach","x","controlsDescendantBindings","_contentMargins","_topOffset","_defaultActiveTextContentHeightPerc","_defaultActiveTreeContentHeightPerc","_currentActiveTextContentHeightPerc","_currentActiveTreeContentHeightPerc","plainContentHeightPerc","textContentHeightPerc","treeContentHeightPerc","updateHeight","currentHeight","height","diffPerc","window","addEventListener","removeEventListener","components","register","createViewModel","params","componentInfo","undefined","template","allBindings","action"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (widgets\\filtereditor\\filtereditor.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FilterEditorPlain = exports.FilterEditor = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar localization_utils_1 = require(\"../../property-grid/localization/localization_utils\");\nvar unary_1 = require(\"../criteria/operators/unary\");\nvar unaryOperandSurface_1 = require(\"./operators/unaryOperandSurface\");\nvar _popupService_1 = require(\"../../property-grid/internal/_popupService\");\nvar _displayNameProvider_1 = require(\"../common/_displayNameProvider\");\nvar _expressioneditor_1 = require(\"../expressioneditor/_expressioneditor\");\nvar _codeCompletor_1 = require(\"./helpers/_codeCompletor\");\nvar _utils_1 = require(\"../_utils\");\nvar _internal_1 = require(\"../../serializer/_internal\");\nvar text_area_1 = require(\"devextreme/ui/text_area\");\nvar _ace_available_1 = require(\"../ace/_ace-available\");\nvar templateUtils_1 = require(\"../../property-grid/widgets/templateUtils\");\nvar group_1 = require(\"../criteria/operators/group\");\nvar _popupEditorBase_1 = require(\"../../core/widgets/_popupEditorBase\");\nvar group_2 = require(\"../criteria/operators/options/group\");\nvar criteriaOperatorPreprocessor_1 = require(\"../criteria/utils/criteriaOperatorPreprocessor\");\nvar FilterEditor = (function (_super) {\n    __extends(FilterEditor, _super);\n    function FilterEditor(options, fieldListProvider, rtl, _displayNameProvider) {\n        if (rtl === void 0) { rtl = false; }\n        var _this = _super.call(this) || this;\n        _this.options = options;\n        _this._displayNameProvider = _displayNameProvider;\n        _this._advancedMode = ko.observable(false);\n        _this.textFocused = ko.observable(false);\n        _this.aceAvailable = _ace_available_1.aceAvailable();\n        _this.languageHelper = {\n            getLanguageMode: function () { return 'ace/mode/criteria'; },\n            createCompleters: function (editor, bindingContext, viewModel) {\n                var path = ko.computed(function () { return _this.path && _this.path(); }), completor = new _codeCompletor_1.FilterEditorCodeCompletor({\n                    editor: editor,\n                    bindingContext: bindingContext,\n                    fieldListProvider: viewModel.fieldListProvider(),\n                    path: path,\n                    getRealExpression: function (path, expression) {\n                        return _this.displayExpressionConverter && _this.displayExpressionConverter.toRealExpression(path, expression) || $.Deferred().resolve(expression).promise();\n                    }\n                });\n                completor._disposables.push(path);\n                return [completor];\n            }\n        };\n        _this.aceOptions = {\n            showLineNumbers: false,\n            showPrintMargin: false,\n            enableBasicAutocompletion: true,\n            enableLiveAutocompletion: true,\n            showGutter: false\n        };\n        _this.additionalOptions = {\n            onChange: function (session) { return _this.onValueChange(session.getValue()); },\n            changeTimeout: 200,\n            onFocus: function (_) { return _this.onFocus(); },\n            onBlur: function (_) { return _this.onBlur(); }\n        };\n        _this.editorContainer = ko.observable();\n        _this.textVisible = ko.observable(false);\n        _this.getPopupContainer = function (el) {\n            return _utils_1.getParentContainer(el, _this.options()['popupContainer']);\n        };\n        _this.timeout = null;\n        _this.animationTimeout = null;\n        _this.advancedMode = ko.computed({\n            read: function () {\n                return _this._advancedMode();\n            },\n            write: function (newVal) {\n                _this.timeout && clearTimeout(_this.timeout);\n                _this.animationTimeout && clearTimeout(_this.animationTimeout);\n                if (newVal) {\n                    _this.textVisible(true);\n                    _this.timeout = setTimeout(function () {\n                        _this._advancedMode(true);\n                        _this.focusText();\n                    }, 1);\n                    _this.animationTimeout = setTimeout(function () {\n                        _this.editorContainer() && _this.editorContainer().resize && _this.editorContainer().resize();\n                    }, 210);\n                }\n                else {\n                    _this._advancedMode(false);\n                    _this.timeout = setTimeout(function () {\n                        _this.textVisible(false);\n                    }, 200);\n                }\n            },\n        });\n        _this.invalidMessage = function () { return localization_utils_1.getLocalization('Cannot create a tree for this expression', 'AnalyticsCoreStringId.FilterEditor_TreeCreationError'); };\n        _this.advancedModeText = ko.observable(localization_utils_1.getLocalization('Advanced Mode', 'AnalyticsCoreStringId.FilterEditor_AdvancedMode'));\n        _this.operandSurface = ko.observable(null);\n        _this.operand = null;\n        _this.popupService = new _popupService_1.PopupService();\n        _this.rtl = rtl;\n        options() && options().helper && (options().helper.rtl = rtl);\n        _this._disposables.push(_this.disabled = ko.computed(function () {\n            return ko.unwrap(_this.options() && _this.options().disabled());\n        }));\n        _this.value = ko.observable('');\n        _this.displayExpressionConverter = _displayNameProvider && new _displayNameProvider_1.DisplayExpressionConverter(_displayNameProvider);\n        _this.save = function () {\n            _this.helper.onSave(_this.value());\n            if (_this.operandSurface() && _this.isSurfaceValid()) {\n                var value = options().helper.serializer.serialize(_this.operand, false);\n                _this.options().value(value);\n            }\n            else {\n                _this.options().value(_this.value());\n            }\n            _this.popupVisible(false);\n        };\n        _this.displayValue = _expressioneditor_1.wrapExpressionValue(_this.path, _this.value, _this.displayExpressionConverter, _this._disposables);\n        var modelValue = ko.computed({\n            read: function () {\n                var options = _this.options();\n                return options && options.value();\n            },\n            write: function (newVal) {\n                var options = _this.options();\n                options && options.value(newVal);\n            }\n        });\n        _this.modelDisplayValue = _expressioneditor_1.wrapExpressionValue(_this.path, modelValue, _this.displayExpressionConverter, _this._disposables);\n        _this.fieldListProvider = fieldListProvider;\n        _this.modelValueIsValid = ko.computed(function () {\n            return options() && _this._validateValue(options().value());\n        });\n        _this.isValid = ko.computed(function () {\n            return _this._validateValue(_this.value());\n        });\n        _this.isSurfaceValid = ko.computed(function () {\n            try {\n                return _this.options() && _this.isValid() && _this.options().helper.criteriaTreeValidator.validateModel(_this.options().helper.serializer.deserialize(_this.value()));\n            }\n            catch (e) {\n                return false;\n            }\n        });\n        _this._disposables.push(modelValue);\n        _this._disposables.push(_this.modelValueIsValid);\n        _this._disposables.push(_this.isValid);\n        _this._disposables.push(_this.isSurfaceValid);\n        _this._disposables.push(_this.popupVisible.subscribe(function (newVal) {\n            if (newVal) {\n                _this.value(_this.options().value());\n                if (_this.isSurfaceValid()) {\n                    _this.operand = _this._generateOperand(_this.value());\n                    _this.operandSurface(_this._generateSurface(_this.operand));\n                }\n                else {\n                    _this.textVisible(true);\n                    _this._advancedMode(true);\n                    _this.editorContainer() && _this.focusText();\n                }\n                options().helper.onChange = function () {\n                    _this.value(options().helper.serializer.serialize(_this.operand, false));\n                };\n            }\n            else {\n                _this.helper.onClosing();\n                _this.value(null);\n                _this.operandSurface() && _this.operandSurface().dispose();\n                _this.operandSurface(null);\n                _this.operand = null;\n            }\n        }));\n        _this.createAddButton = function (criteria) { return options().helper.handlers.create(criteria, _this.popupService); };\n        _this.createChangeType = function (criteria) { return options().helper.handlers.change(criteria, _this.popupService); };\n        _this.createChangeProperty = function (criteria) { return options().helper.handlers.changeProperty(criteria, _this.popupService); };\n        _this.createChangeParameter = function (criteria) { return options().helper.handlers.changeParameter(criteria, _this.popupService); };\n        _this.createChangeValueType = function (criteria) { return options().helper.handlers.changeValueType(criteria, _this.popupService); };\n        _this._disposables.push(_this.advancedMode);\n        _this.buttonItems.push({ toolbar: 'bottom', location: 'before', widget: 'dxCheckBox', options: { value: _this.advancedMode, text: _this.advancedModeText() } });\n        return _this;\n    }\n    FilterEditor.prototype._generateOperand = function (value) {\n        return this.options().helper.serializer.deserialize(value);\n    };\n    FilterEditor.prototype._generateSurface = function (operand) {\n        var type = null;\n        if (operand instanceof unary_1.UnaryOperator) {\n            type = this.options().helper.mapper.unary;\n        }\n        else {\n            type = this.options().helper.mapper.group;\n        }\n        var surface = new type(operand, this, this.fieldListProvider, this.path);\n        if (surface instanceof unaryOperandSurface_1.UnaryOperandSurface) {\n            if (!(surface.model.operand instanceof group_1.GroupOperator)) {\n                this.operand = new group_1.GroupOperator(group_2.GroupOperatorType.And, [this.operand]);\n                surface.dispose();\n                return this._generateSurface(this.operand);\n            }\n            surface.operand().canRemove = false;\n        }\n        surface.canRemove = false;\n        return surface;\n    };\n    FilterEditor.prototype._validateValue = function (value) {\n        try {\n            if (this.options() && this.options().helper) {\n                this.options().helper.serializer.deserialize(value);\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        catch (e) {\n            return false;\n        }\n    };\n    FilterEditor.prototype.canSave = function () {\n        return this.isValid();\n    };\n    FilterEditor.prototype.change = function (type, surface) {\n        this.operand = criteriaOperatorPreprocessor_1.criteriaCreator.changeByType(type);\n        this.operand.assignFrom(surface.model);\n        var type = null;\n        if (this.operand instanceof unary_1.UnaryOperator) {\n            type = this.options().helper.mapper.unary;\n        }\n        else {\n            type = this.options().helper.mapper.group;\n        }\n        var surface = new type(this.operand, this, this.fieldListProvider, this.path);\n        surface.canRemove = false;\n        if (surface instanceof unaryOperandSurface_1.UnaryOperandSurface) {\n            surface.operand().canRemove = false;\n        }\n        this.operandSurface(surface);\n    };\n    Object.defineProperty(FilterEditor.prototype, \"helper\", {\n        get: function () {\n            return this.options() && this.options().helper;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FilterEditor.prototype, \"path\", {\n        get: function () {\n            return this.options() && this.options().path;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FilterEditor.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this.editorContainer(null);\n        this.operandSurface() && this.operandSurface().dispose();\n    };\n    FilterEditor.prototype.onInput = function (s, e) {\n        var self = this;\n        this.timeout && clearTimeout(this.timeout);\n        this.timeout = setTimeout(function () {\n            self.onValueChange(s.component.option('text'));\n        }, 200);\n    };\n    FilterEditor.prototype.onFocus = function () {\n        this.textFocused(true);\n    };\n    FilterEditor.prototype.onBlur = function () {\n        this.textFocused(false);\n        this.helper.onEditorFocusOut(this.operand);\n    };\n    FilterEditor.prototype.cacheElement = function ($element) {\n        this.editorContainer(text_area_1.default.getInstance($element.get(0)));\n    };\n    FilterEditor.prototype.updateCriteria = function () {\n        if (this.isSurfaceValid()) {\n            this.operand = this._generateOperand(this.value());\n            this.operandSurface() && this.operandSurface().dispose();\n            this.operandSurface(this._generateSurface(this.operand));\n        }\n    };\n    FilterEditor.prototype.onValueChange = function (value) {\n        var _this = this;\n        if (this.displayValue() === value.trim())\n            return;\n        this.displayValue(value);\n        if (this.displayExpressionConverter) {\n            this.displayExpressionConverter.toRealExpression(this.path(), value).done(function (result) {\n                _this.value(result);\n                _this.updateCriteria();\n            }).fail(function () {\n                _this.value(value);\n                _this.updateCriteria();\n            });\n        }\n        else {\n            this.updateCriteria();\n        }\n    };\n    FilterEditor.prototype.focusText = function () {\n        var focusFn = function (editor) {\n            setTimeout(function (_) {\n                if (editor.renderer)\n                    editor.renderer.updateText();\n                editor.focus();\n            }, 1);\n        };\n        if (!this.editorContainer())\n            var subscription = this.editorContainer.subscribe(function (editor) {\n                subscription.dispose();\n                focusFn(editor);\n            });\n        else\n            focusFn(this.editorContainer());\n    };\n    Object.defineProperty(FilterEditor.prototype, \"cancelLocalization\", {\n        get: function () {\n            return localization_utils_1.getLocalization('Cancel', 'StringId.Cancel');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FilterEditor.prototype, \"saveLocalization\", {\n        get: function () {\n            return localization_utils_1.getLocalization('OK', 'StringId.OK');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FilterEditor;\n}(_popupEditorBase_1.PopupEditorBase));\nexports.FilterEditor = FilterEditor;\nko.bindingHandlers['dxFilterEditor'] = {\n    init: function (element, valueAccessor) {\n        $(element).children().remove();\n        $(element).addClass('dx-popup-general');\n        var templateHtml = templateUtils_1.getTemplate('dx-filtereditor'), $element = $(element).append(templateHtml), values = valueAccessor();\n        var itemsProvider = ko.observable(ko.unwrap(values.fieldListProvider));\n        var computedFunctions = [];\n        computedFunctions.push(ko.computed(function () {\n            if (values.options() && values.options().itemsProvider) {\n                itemsProvider(ko.unwrap(values.options().itemsProvider));\n            }\n            else {\n                itemsProvider(ko.unwrap(values.fieldListProvider));\n            }\n        }));\n        computedFunctions.push(ko.computed(function () {\n            if (values.getDisplayNameByPath && values.options() && values.options().helper && !values.options().helper.getDisplayPropertyName) {\n                values.options().helper.getDisplayPropertyName = values.getDisplayNameByPath;\n            }\n        }));\n        var editor = new FilterEditor(values.options, itemsProvider, $(element).closest('.dx-rtl').length > 0, values.displayNameProvider);\n        ko.applyBindingsToDescendants(editor, $element.children()[0]);\n        _internal_1.addDisposeCallback($element.children()[0], function () {\n            computedFunctions.forEach(function (x) { return x.dispose(); });\n            editor.dispose();\n        });\n        return { controlsDescendantBindings: true };\n    }\n};\nvar FilterEditorPlain = (function (_super) {\n    __extends(FilterEditorPlain, _super);\n    function FilterEditorPlain(element, options, fieldListProvider, rtl, _displayNameProvider) {\n        if (rtl === void 0) { rtl = false; }\n        var _this = _super.call(this, options, fieldListProvider, rtl, _displayNameProvider) || this;\n        _this.element = element;\n        _this._contentMargins = 20;\n        _this._topOffset = 30;\n        _this._defaultActiveTextContentHeightPerc = 25;\n        _this._defaultActiveTreeContentHeightPerc = 75;\n        _this._currentActiveTextContentHeightPerc = _this._defaultActiveTextContentHeightPerc;\n        _this._currentActiveTreeContentHeightPerc = _this._defaultActiveTreeContentHeightPerc;\n        _this.plainContentHeightPerc = ko.observable('100%');\n        _this.textContentHeightPerc = ko.observable(null);\n        _this.treeContentHeightPerc = ko.observable(null);\n        var $element = $(element);\n        var updateHeight = function () {\n            var currentHeight = $element.height();\n            _this.plainContentHeightPerc((1 - _this._topOffset / currentHeight) * 100 + '%');\n            var diffPerc = (_this._contentMargins / (currentHeight - _this._topOffset)) * 100 / 2;\n            _this._currentActiveTextContentHeightPerc = _this._defaultActiveTextContentHeightPerc - diffPerc;\n            _this._currentActiveTreeContentHeightPerc = _this._defaultActiveTreeContentHeightPerc - diffPerc;\n            if (_this.advancedMode()) {\n                _this.treeContentHeightPerc(_this._currentActiveTreeContentHeightPerc);\n                _this.textContentHeightPerc(_this._currentActiveTextContentHeightPerc);\n            }\n        };\n        updateHeight();\n        _this._disposables.push(_this.advancedMode.subscribe(function (newVal) {\n            if (newVal) {\n                _this.treeContentHeightPerc(_this._currentActiveTreeContentHeightPerc + '%');\n                _this.textContentHeightPerc(_this._currentActiveTextContentHeightPerc + '%');\n            }\n            else {\n                _this.treeContentHeightPerc(null);\n                _this.textContentHeightPerc(null);\n            }\n        }));\n        window.addEventListener('resize', updateHeight);\n        _internal_1.addDisposeCallback(element, function () {\n            window.removeEventListener('resize', updateHeight);\n            _this.dispose();\n        });\n        return _this;\n    }\n    return FilterEditorPlain;\n}(FilterEditor));\nexports.FilterEditorPlain = FilterEditorPlain;\nko.components.register('dx-filtereditor-plain', {\n    viewModel: {\n        createViewModel: function (params, componentInfo) {\n            var viewModel = new FilterEditorPlain(componentInfo.element, params.options, ko.observable(params.fieldListProvider), undefined, params.displayNameProvider);\n            viewModel.popupVisible(true);\n            params.options().value.subscribe(function () {\n                viewModel.popupVisible(false);\n                viewModel.popupVisible(true);\n            });\n            return viewModel;\n        }\n    },\n    template: templateUtils_1.getTemplate('dx-filtereditor-plain')\n});\nko.components.register('dx-filtereditor-advanced', {\n    viewModel: {\n        createViewModel: function (params, componentInfo) {\n            var viewModel = new FilterEditor(params.options, ko.observable(params.fieldListProvider), undefined, params.displayNameProvider);\n            viewModel.advancedMode(true);\n            viewModel.popupVisible(true);\n            params.options().value.subscribe(function () {\n                viewModel.popupVisible(false);\n                viewModel.popupVisible(true);\n            });\n            return viewModel;\n        }\n    },\n    template: templateUtils_1.getTemplate('dx-filtereditor-advanced')\n});\nko.bindingHandlers['cacheElement'] = {\n    init: function (element, valueAccessor, allBindings, viewModel, bindingContext) {\n        var value = valueAccessor();\n        value.action($(element));\n    }\n};\n"]},"metadata":{},"sourceType":"script"}