{"ast":null,"code":"/**\n* DevExpress Analytics (query-builder\\_initializer.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createQueryBuilderSurface = exports.createQueryBuilder = exports.createIsLoadingFlag = exports.updateQueryBuilderSurfaceContentSize = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar queryModel_1 = require(\"./elements/queryModel\");\n\nvar _arrayutils_1 = require(\"../core/utils/_arrayutils\");\n\nvar initializer_1 = require(\"./initializer\");\n\nvar localization_utils_1 = require(\"../property-grid/localization/localization_utils\");\n\nvar querySurface_1 = require(\"./elements/querySurface\");\n\nvar dbSchemaProvider_1 = require(\"./dataSource/dbSchemaProvider\");\n\nvar requestwrapper_1 = require(\"./utils/requestwrapper\");\n\nvar _utils_1 = require(\"../core/utils/_utils\");\n\nvar _designerInitializer_1 = require(\"../core/utils/_designerInitializer\");\n\nvar _processError_1 = require(\"../core/internal/_processError\");\n\nvar parameterModelMeta_1 = require(\"./elements/parameterModelMeta\");\n\nvar _selection_1 = require(\"../core/selection/_selection\");\n\nvar controlsFactory_1 = require(\"./utils/controlsFactory\");\n\nvar _utils_2 = require(\"../widgets/_utils\");\n\nvar _options_1 = require(\"./widgets/ace/_options\");\n\nvar _columnDragHandler_1 = require(\"./dragDrop/_columnDragHandler\");\n\nvar _queryBuilderTreeListController_1 = require(\"./utils/_queryBuilderTreeListController\");\n\nvar propertygrid_1 = require(\"../property-grid/propertygrid\");\n\nvar _localization_1 = require(\"../property-grid/localization/_localization\");\n\nvar _accordionTabInfo_1 = require(\"./_accordionTabInfo\");\n\nvar _dbObjectDragDropHandler_1 = require(\"./dragDrop/_dbObjectDragDropHandler\");\n\nvar _queryBuilderObjectsProvider_1 = require(\"./widgets/filterEditor/_queryBuilderObjectsProvider\");\n\nvar _actionList_1 = require(\"../core/tools/_actionList\");\n\nvar _infoMessageHelpers_1 = require(\"../core/utils/_infoMessageHelpers\");\n\nvar _controlsFactory_1 = require(\"./utils/_controlsFactory\");\n\nvar config_1 = require(\"devextreme/core/config\");\n\nvar sqlDataSource_1 = require(\"./dataSource/sql/sqlDataSource\");\n\nvar _ace_available_1 = require(\"../widgets/ace/_ace-available\");\n\nvar _internal_1 = require(\"../serializer/_internal\");\n\nvar _rightPanelSwitcher_1 = require(\"./widgets/_rightPanelSwitcher\");\n\nvar _internal_2 = require(\"../accessibility/_internal\");\n\nvar _dataConnection_1 = require(\"./utils/_dataConnection\");\n\nvar QueryBuilderElements = {\n  Surface: 'dxrd-surface-template-base',\n  Toolbar: 'dxqb-toolbar',\n  RightPanel: 'dx-right-panel-lightweight',\n  RightPanelSwitcher: 'dx-right-panel-switcher',\n  DataPreview: 'dxqb-popup#data',\n  SqlPreview: 'dxqb-popup#sql'\n};\n\nfunction customizeDesignerActions(designerModel, nextCustomizer) {\n  var query = designerModel.model;\n  return function (actions) {\n    var del = _arrayutils_1.findFirstItemMatchesCondition(actions, function (action) {\n      return action.text === 'Delete';\n    });\n\n    del.imageClassName = 'dx-icon-dxrd-image-recycle-bin';\n    del.imageTemplateName = 'dxrd-svg-operations-recycle_bin';\n\n    var undo = _arrayutils_1.findFirstItemMatchesCondition(actions, function (action) {\n      return action.text === 'Undo';\n    });\n\n    undo.disabled = ko.pureComputed(function () {\n      return designerModel.isLoading() || !designerModel.undoEngine().undoEnabled();\n    });\n\n    var redo = _arrayutils_1.findFirstItemMatchesCondition(actions, function (action) {\n      return action.text === 'Redo';\n    });\n\n    actions.splice(0, actions.length, del, undo, redo);\n    actions.push({\n      id: initializer_1.ActionId.Save,\n      text: 'Save',\n      displayText: function () {\n        return localization_utils_1.getLocalization('Save', 'AnalyticsCoreStringId.MenuButtons_Save');\n      },\n      imageClassName: 'dxqb-image-save',\n      imageTemplateName: 'dxrd-svg-menu-save',\n      disabled: designerModel.isLoading,\n      visible: true,\n      hotKey: {\n        ctrlKey: true,\n        keyCode: 'S'.charCodeAt(0)\n      },\n      clickAction: function () {\n        query().save();\n      },\n      hasSeparator: true\n    });\n    actions.push({\n      id: initializer_1.ActionId.DataPreview,\n      text: 'Preview Results',\n      displayText: function () {\n        return localization_utils_1.getLocalization('Preview Results', 'DataAccessUIStringId.QueryBuilderButtons_PreviewResults');\n      },\n      imageClassName: 'dxrd-image-data-preview',\n      imageTemplateName: 'dxrd-svg-queryBuilder-data_preview',\n      disabled: designerModel.isLoading,\n      visible: true,\n      hotKey: {\n        ctrlKey: true,\n        keyCode: 'P'.charCodeAt(0)\n      },\n      clickAction: function () {\n        if (!query().canSave()) return;\n        designerModel.showPreview();\n      },\n      hasSeparator: true\n    });\n    actions.push({\n      id: initializer_1.ActionId.SelectStatementPreview,\n      text: 'Preview Select Statement',\n      displayText: function () {\n        return localization_utils_1.getLocalization('Preview Select Statement', 'AnalyticsCoreStringId.QueryBuilder_PreviewSelectStatement_Tooltip');\n      },\n      imageClassName: 'dxrd-image-selectstatement-preview',\n      imageTemplateName: 'dxrd-svg-queryBuilder-select_statment',\n      disabled: designerModel.isLoading,\n      visible: true,\n      hotKey: {\n        ctrlKey: true,\n        keyCode: 'E'.charCodeAt(0)\n      },\n      clickAction: function () {\n        if (!query().canSave()) return;\n        designerModel.showStatement();\n      },\n      hasSeparator: true\n    });\n    nextCustomizer && nextCustomizer(actions);\n  };\n}\n\nfunction updateQueryBuilderSurfaceContentSize(getRoot, surfaceSize, surface, updateLayoutCallbacks) {\n  return function () {\n    var $root = getRoot();\n    var rightAreaWidth = $root.find('.dxrd-right-panel:visible').outerWidth() || 0;\n    var surfaceWidth = $root.width() - (rightAreaWidth + 5);\n    $root.find('.dxrd-surface-wrapper').css(surface().rtl() ? {\n      'left': rightAreaWidth,\n      'right': 0,\n      'width': surfaceWidth\n    } : {\n      'left': 0,\n      'right': rightAreaWidth,\n      'width': surfaceWidth\n    });\n    surfaceSize(surfaceWidth);\n    surface().pageWidth(surfaceWidth);\n  };\n}\n\nexports.updateQueryBuilderSurfaceContentSize = updateQueryBuilderSurfaceContentSize;\n\nfunction createIsLoadingFlag(model, dbSchemaProvider) {\n  var isDbSchemaLoaded = ko.observable(false);\n\n  model()._disposables.push(dbSchemaProvider.subscribe(function () {\n    isDbSchemaLoaded(false);\n  }));\n\n  return ko.pureComputed(function () {\n    dbSchemaProvider.peek().getDbSchema().done(function () {\n      isDbSchemaLoaded(true);\n    });\n\n    if (isDbSchemaLoaded()) {\n      return model().tables.peek().some(function (table) {\n        return !table.isInitialized();\n      });\n    } else {\n      return true;\n    }\n  });\n}\n\nexports.createIsLoadingFlag = createIsLoadingFlag;\n\nfunction _createDesignerModel(query, surface, options) {\n  var querySubscription = query.subscribe(function (newValue) {\n    surface(new querySurface_1.QuerySurface(newValue));\n    surface().rtl(!!options.rtl);\n  });\n  var selection = new _selection_1.SurfaceSelection(['alias', 'name', 'sortOrder']);\n\n  var designer = _designerInitializer_1.createDesigner(query, surface, controlsFactory_1.controlsFactory, undefined, undefined, undefined, !!options.rtl, selection);\n\n  designer.addDisposables(querySubscription);\n\n  designer.findControl = function (s, e) {\n    var $childs = $('.dxqb-main').children('.dxrd-control');\n    $childs.each(function (_, child) {\n      var $child = $(child);\n\n      if ($child.offset().top <= e.clientY && $child.offset().left <= e.clientX) {\n        designer.selection.focused(ko.dataFor($child[0]));\n        return;\n      }\n    });\n  };\n\n  designer.addDisposables({\n    dispose: function () {\n      return designer.findControl = null;\n    }\n  });\n  return designer;\n}\n\nfunction _updateSurfaceContentSizeSubscription(element, designerModel, surface, callback) {\n  var updateSurfaceContentSize_ = updateQueryBuilderSurfaceContentSize(function () {\n    return $(element).find('.dxqb-designer');\n  }, designerModel.surfaceSize, surface);\n  designerModel.addDisposables(surface.subscribe(function () {\n    updateSurfaceContentSize_();\n  }));\n\n  var onResize = function () {\n    setTimeout(function () {\n      return updateSurfaceContentSize_();\n    });\n  };\n\n  window.addEventListener('resize', onResize);\n\n  _internal_1.addDisposeCallback(element, function () {\n    window.removeEventListener('resize', onResize);\n    designerModel.disposableContainer.dispose();\n  });\n\n  designerModel.addDisposables(designerModel.tabPanel.width.subscribe(function () {\n    updateSurfaceContentSize_();\n  }));\n\n  designerModel.updateSurfaceSize = function () {\n    updateSurfaceContentSize_();\n  };\n\n  designerModel.updateSurface = function () {\n    updateSurfaceContentSize_();\n    callback && callback();\n  };\n}\n\nfunction _createQueryBuilder(element, options, callbacks, applyBindings) {\n  if (applyBindings === void 0) {\n    applyBindings = true;\n  }\n\n  var disposableCallback = callbacks && callbacks.onServerError && _processError_1.processErrorEvent(callbacks.onServerError);\n\n  var wrapper = options.requestWrapper || new requestwrapper_1.RequestWrapper();\n  var parametersMode = options.parametersMode || parameterModelMeta_1.ParametersMode.ReadWrite;\n  initializer_1.HandlerUri(options.handlerUri);\n\n  if (options.queryModelJson) {\n    var dataSource = new sqlDataSource_1.SqlDataSource(JSON.parse(options.dataSourceJson));\n    options.dbSchemaProvider = _utils_1._wrapModelInObservable(options.dbSchemaProvider);\n    options.dbSchemaProvider(new dbSchemaProvider_1.DBSchemaProvider(dataSource.connection));\n    options.querySource = _utils_1._wrapModelInObservable(options.querySource);\n    options.querySource(JSON.parse(options.queryModelJson));\n  }\n\n  var dataConnection = options.dbSchemaProvider().connection;\n  var query = ko.observable(),\n      surface = ko.observable(),\n      treeListOptions = ko.observable();\n\n  var beforeSaveCallback = function (data) {\n    callbacks.saveQueryRequested({\n      queryLayout: encodeURIComponent(JSON.stringify(data)),\n      connection: encodeURIComponent(_dataConnection_1.serializeDataConnection(dataConnection))\n    });\n  };\n\n  var initQuery = function (querySource) {\n    query(new queryModel_1.QueryViewModel(querySource, options.dbSchemaProvider(), parametersMode, function (data) {\n      return beforeSaveCallback(data);\n    }));\n  };\n\n  initQuery(options.querySource());\n\n  var designerModel = _createDesignerModel(query, surface, options);\n\n  disposableCallback && designerModel.addDisposables(disposableCallback);\n  designerModel.rootStyle = 'dxqb-designer dxd-back-primary-invariant';\n  var previewPopupContainer = _utils_2.getParentContainer;\n  designerModel.dataPreview = {\n    isLoading: ko.observable(false),\n    isVisible: ko.observable(false),\n    title: function () {\n      return localization_utils_1.getLocalization('Data Preview (First 100 Rows Displayed)', 'AnalyticsCoreStringId.DataPreview_Title');\n    },\n    template: 'dxqb-data-preview',\n    data: {\n      value: ko.observable()\n    },\n    okButtonText: function () {\n      return localization_utils_1.getLocalization('OK', 'DataAccessUIStringId.Button_OK');\n    },\n    okButtonHandler: function (e) {\n      e.model.isVisible(false);\n    },\n    container: previewPopupContainer\n  };\n  designerModel.selectStatmentPreview = {\n    isLoading: ko.observable(false),\n    isVisible: ko.observable(false),\n    template: 'dxqb-selectstatment-preview',\n    title: function () {\n      return localization_utils_1.getLocalization('Select Statement Preview', 'AnalyticsCoreStringId.QueryBuilder_SelectStatementPreview_Title');\n    },\n    data: {\n      value: ko.observable(),\n      aceOptions: _options_1.createDefaultSQLAceOptions(true),\n      aceAvailable: _ace_available_1.aceAvailable(),\n      additionalOptions: _options_1.createDefaultSQLAdditionalOptions(function (newVal) {\n        designerModel.selectStatmentPreview.data.value(newVal);\n      }),\n      languageHelper: _options_1.createDefaultSQLLanguageHelper()\n    },\n    okButtonText: function () {\n      return localization_utils_1.getLocalization('OK', 'DataAccessUIStringId.Button_OK');\n    },\n    okButtonHandler: function (e) {\n      e.model.isVisible(false);\n    },\n    container: previewPopupContainer\n  };\n  designerModel.parts = [{\n    id: QueryBuilderElements.Surface,\n    templateName: QueryBuilderElements.Surface,\n    model: designerModel\n  }, {\n    id: QueryBuilderElements.Toolbar,\n    templateName: QueryBuilderElements.Toolbar,\n    model: designerModel\n  }, {\n    id: QueryBuilderElements.RightPanel,\n    templateName: QueryBuilderElements.RightPanel,\n    model: designerModel\n  }, {\n    id: QueryBuilderElements.DataPreview,\n    templateName: QueryBuilderElements.DataPreview.split('#')[0],\n    model: designerModel.dataPreview\n  }, {\n    id: QueryBuilderElements.SqlPreview,\n    templateName: QueryBuilderElements.SqlPreview.split('#')[0],\n    model: designerModel.selectStatmentPreview\n  }];\n  designerModel.columnDragHandler = new _columnDragHandler_1.ColumnDragHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n  designerModel.fieldDragHandler = new _dbObjectDragDropHandler_1.DbObjectDragDropHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n  designerModel.connectionPointDragHandler = designerModel.columnDragHandler;\n  designerModel.resizeHandler['handles'] = 'e, w';\n\n  designerModel.columnsLoadingMsg = function () {\n    return localization_utils_1.getLocalization('Loading...', 'DataAccessWebStringId.QueryBuilder_ColumnsLoading');\n  };\n\n  var init = function (querySource) {\n    initQuery(querySource);\n    treeListOptions({\n      itemsProvider: options.dbSchemaProvider(),\n      treeListController: new _queryBuilderTreeListController_1.QueryBuilderTreeListController(designerModel.undoEngine, query, designerModel.fieldDragHandler),\n      selectedPath: ko.observable(),\n      pageSize: 100,\n      templateName: 'dxqb-treelist-item-with-search'\n    });\n  };\n\n  designerModel.addDisposables(options.querySource.subscribe(function (newValue) {\n    init(newValue);\n  }));\n  init(options.querySource());\n  var tablesTop = ko.observable(_internal_2.calculateWithZoomFactor(355)),\n      itemPropertiesTabInfoModel = {\n    editableObject: designerModel.editableObject,\n    properties: new propertygrid_1.ObjectProperties(designerModel.editableObject, null, 1),\n    fieldListModel: {\n      treeListOptions: treeListOptions\n    },\n    tablesTop: tablesTop,\n    searchPlaceholder: function () {\n      return _localization_1.searchPlaceholder();\n    }\n  };\n  var tabPanelItem = new _accordionTabInfo_1.AccordionTabInfo(query, itemPropertiesTabInfoModel, designerModel.undoEngine, designerModel.selection.focused, parametersMode === parameterModelMeta_1.ParametersMode.ReadWrite);\n  var tabPanel = designerModel.tabPanel;\n  tabPanel.tabs.length = 0;\n  tabPanel.tabs.push(tabPanelItem);\n  tabPanel.width(_internal_2.calculateWithZoomFactor(375));\n  designerModel.fieldDragHandler = new _dbObjectDragDropHandler_1.DbObjectDragDropHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n  designerModel.fieldListProvider = new _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider(query, _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider.whereClauseObjectsFilter);\n  designerModel.dataBindingsProvider = designerModel.fieldListProvider;\n  designerModel.parametersBindingsProvider = options.parametersItemsProvider || designerModel.dataBindingsProvider;\n  designerModel.dataBindingsGroupProvider = new _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider(query, _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider.groupByObjectsFilter);\n  designerModel.isLoading = createIsLoadingFlag(designerModel.model, options.dbSchemaProvider);\n  designerModel.actionLists = new _actionList_1.ActionLists(surface, designerModel.selection, designerModel.undoEngine, customizeDesignerActions(designerModel, callbacks && callbacks.customizeActions));\n\n  if (!designerModel.isLoading()) {\n    designerModel.undoEngine && designerModel.undoEngine().clearHistory();\n  }\n\n  designerModel.addDisposables(designerModel.isLoading.subscribe(function (value) {\n    designerModel.undoEngine && designerModel.undoEngine().clearHistory();\n  }));\n  designerModel.selection.focused(surface());\n  var subscribe = surface.subscribe(function (newValue) {\n    designerModel.selection.focused(newValue);\n  });\n  designerModel.addDisposables({\n    dispose: function () {\n      return subscribe.dispose();\n    }\n  });\n  designerModel.addDisposables(designerModel.editableObject.subscribe(function (newValue) {\n    tablesTop.notifySubscribers(null);\n  }));\n\n  _utils_1.appendStaticContextToRootViewModel(designerModel);\n\n  if (applyBindings) {\n    callbacks && callbacks.beforeRender && callbacks.beforeRender(designerModel);\n    $(element).empty();\n    ko.cleanNode(element);\n    ko.applyBindings(designerModel, element);\n  }\n\n  _updateSurfaceContentSizeSubscription(element, designerModel, surface, function () {\n    return tablesTop(355);\n  });\n\n  if (applyBindings) {\n    designerModel.updateSurface();\n  }\n\n  designerModel.showPreview = function () {\n    designerModel.dataPreview.isLoading(true);\n    designerModel.dataPreview.isVisible(true);\n    wrapper.getDataPreview(dataConnection, JSON.stringify(query().serialize(true))).done(function (data) {\n      designerModel.dataPreview.data.value(JSON.parse(data.dataPreviewJSON));\n      designerModel.dataPreview.isLoading(false);\n    }).fail(function (data) {\n      designerModel.dataPreview.isVisible(false);\n\n      _infoMessageHelpers_1.ShowMessage(_infoMessageHelpers_1.getErrorMessage(data));\n    });\n  };\n\n  designerModel.showStatement = function () {\n    designerModel.selectStatmentPreview.isLoading(true);\n    designerModel.selectStatmentPreview.isVisible(true);\n    wrapper.getSelectStatement(dataConnection, JSON.stringify(query().serialize(true))).done(function (data) {\n      if (data.errorMessage) _infoMessageHelpers_1.ShowMessage(data.errorMessage);\n      designerModel.selectStatmentPreview.data.value(data.sqlSelectStatement);\n      designerModel.selectStatmentPreview.isLoading(false);\n    }).fail(function (data) {\n      designerModel.selectStatmentPreview.isVisible(false);\n\n      _infoMessageHelpers_1.ShowMessage(_infoMessageHelpers_1.getErrorMessage(data));\n    });\n  };\n\n  return designerModel;\n}\n\nfunction createQueryBuilder(element, options, callbacks, applyBindings) {\n  if (applyBindings === void 0) {\n    applyBindings = true;\n  }\n\n  if (options.localization) {\n    localization_utils_1.addCultureInfo({\n      messages: options.localization\n    });\n  }\n\n  config_1.default({\n    rtlEnabled: !!options.rtl\n  });\n\n  _controlsFactory_1.registerControls();\n\n  var promises = [];\n  callbacks && callbacks.customizeLocalization && callbacks.customizeLocalization(promises);\n  return _localization_1.resolveFromPromises(promises, function () {\n    return _createQueryBuilder(element, options, callbacks, applyBindings);\n  });\n}\n\nexports.createQueryBuilder = createQueryBuilder;\n\nfunction createQueryBuilderSurface(element, options, queryCreator) {\n  var query = ko.observable(),\n      surface = ko.observable();\n\n  _controlsFactory_1.registerControls();\n\n  var designerModel = _createDesignerModel(query, surface, options);\n\n  var selectedTabPanel = new _accordionTabInfo_1.SelectedTabInfo(new propertygrid_1.ObjectProperties(designerModel.editableObject, null, 1));\n  var tabPanel = designerModel.tabPanel;\n  var switcher = new _rightPanelSwitcher_1.RightPanelSwitcher(tabPanel.collapsed, designerModel.editableObject, options.showPropertyGridCondition, _accordionTabInfo_1.AccordionTabInfo._getSelectedItemPropertyName);\n  designerModel.addDisposables(selectedTabPanel, tabPanel, switcher);\n  tabPanel.tabs.length = 0;\n  tabPanel.tabs.push(selectedTabPanel);\n  tabPanel.width(_internal_2.calculateWithZoomFactor(325));\n  designerModel.parts = [{\n    id: QueryBuilderElements.Surface,\n    templateName: QueryBuilderElements.Surface,\n    model: designerModel\n  }, {\n    id: QueryBuilderElements.RightPanel,\n    templateName: QueryBuilderElements.RightPanel,\n    model: designerModel\n  }, {\n    id: QueryBuilderElements.RightPanelSwitcher,\n    templateName: QueryBuilderElements.RightPanelSwitcher,\n    model: switcher\n  }];\n  designerModel.columnDragHandler = new _columnDragHandler_1.ColumnDragHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n  designerModel.connectionPointDragHandler = designerModel.columnDragHandler;\n  designerModel.selection.focused(surface());\n  designerModel.addDisposables(surface.subscribe(function (newValue) {\n    designerModel.selection.focused(newValue);\n  }));\n  designerModel.rootStyle = 'dxqb-designer dxd-back-primary-invariant';\n  designerModel.resizeHandler['handles'] = 'e, w';\n\n  designerModel.columnsLoadingMsg = function () {\n    return localization_utils_1.getLocalization('Loading...', 'DataAccessWebStringId.QueryBuilder_ColumnsLoading');\n  };\n\n  _utils_1.appendStaticContextToRootViewModel(designerModel);\n\n  query(queryCreator(options));\n  $(element).empty();\n  ko.cleanNode(element);\n  ko.applyBindings(designerModel, element);\n\n  _updateSurfaceContentSizeSubscription(element, designerModel, surface);\n\n  designerModel.isLoading(false);\n  designerModel.updateSurface();\n\n  _internal_1.addDisposeCallback(element, function () {\n    query() && query().dispose();\n    surface() && surface().dispose();\n    queryCreator = null;\n    designerModel.disposableContainer.dispose();\n    designerModel.dispose();\n  });\n\n  return designerModel;\n}\n\nexports.createQueryBuilderSurface = createQueryBuilderSurface;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/query-builder/_initializer.js"],"names":["Object","defineProperty","exports","value","createQueryBuilderSurface","createQueryBuilder","createIsLoadingFlag","updateQueryBuilderSurfaceContentSize","ko","require","$","queryModel_1","_arrayutils_1","initializer_1","localization_utils_1","querySurface_1","dbSchemaProvider_1","requestwrapper_1","_utils_1","_designerInitializer_1","_processError_1","parameterModelMeta_1","_selection_1","controlsFactory_1","_utils_2","_options_1","_columnDragHandler_1","_queryBuilderTreeListController_1","propertygrid_1","_localization_1","_accordionTabInfo_1","_dbObjectDragDropHandler_1","_queryBuilderObjectsProvider_1","_actionList_1","_infoMessageHelpers_1","_controlsFactory_1","config_1","sqlDataSource_1","_ace_available_1","_internal_1","_rightPanelSwitcher_1","_internal_2","_dataConnection_1","QueryBuilderElements","Surface","Toolbar","RightPanel","RightPanelSwitcher","DataPreview","SqlPreview","customizeDesignerActions","designerModel","nextCustomizer","query","model","actions","del","findFirstItemMatchesCondition","action","text","imageClassName","imageTemplateName","undo","disabled","pureComputed","isLoading","undoEngine","undoEnabled","redo","splice","length","push","id","ActionId","Save","displayText","getLocalization","visible","hotKey","ctrlKey","keyCode","charCodeAt","clickAction","save","hasSeparator","canSave","showPreview","SelectStatementPreview","showStatement","getRoot","surfaceSize","surface","updateLayoutCallbacks","$root","rightAreaWidth","find","outerWidth","surfaceWidth","width","css","rtl","pageWidth","dbSchemaProvider","isDbSchemaLoaded","observable","_disposables","subscribe","peek","getDbSchema","done","tables","some","table","isInitialized","_createDesignerModel","options","querySubscription","newValue","QuerySurface","selection","SurfaceSelection","designer","createDesigner","controlsFactory","undefined","addDisposables","findControl","s","e","$childs","children","each","_","child","$child","offset","top","clientY","left","clientX","focused","dataFor","dispose","_updateSurfaceContentSizeSubscription","element","callback","updateSurfaceContentSize_","onResize","setTimeout","window","addEventListener","addDisposeCallback","removeEventListener","disposableContainer","tabPanel","updateSurfaceSize","updateSurface","_createQueryBuilder","callbacks","applyBindings","disposableCallback","onServerError","processErrorEvent","wrapper","requestWrapper","RequestWrapper","parametersMode","ParametersMode","ReadWrite","HandlerUri","handlerUri","queryModelJson","dataSource","SqlDataSource","JSON","parse","dataSourceJson","_wrapModelInObservable","DBSchemaProvider","connection","querySource","dataConnection","treeListOptions","beforeSaveCallback","data","saveQueryRequested","queryLayout","encodeURIComponent","stringify","serializeDataConnection","initQuery","QueryViewModel","rootStyle","previewPopupContainer","getParentContainer","dataPreview","isVisible","title","template","okButtonText","okButtonHandler","container","selectStatmentPreview","aceOptions","createDefaultSQLAceOptions","aceAvailable","additionalOptions","createDefaultSQLAdditionalOptions","newVal","languageHelper","createDefaultSQLLanguageHelper","parts","templateName","split","columnDragHandler","ColumnDragHandler","snapHelper","dragHelperContent","fieldDragHandler","DbObjectDragDropHandler","connectionPointDragHandler","resizeHandler","columnsLoadingMsg","init","itemsProvider","treeListController","QueryBuilderTreeListController","selectedPath","pageSize","tablesTop","calculateWithZoomFactor","itemPropertiesTabInfoModel","editableObject","properties","ObjectProperties","fieldListModel","searchPlaceholder","tabPanelItem","AccordionTabInfo","tabs","fieldListProvider","QueryBuilderObjectsProvider","whereClauseObjectsFilter","dataBindingsProvider","parametersBindingsProvider","parametersItemsProvider","dataBindingsGroupProvider","groupByObjectsFilter","actionLists","ActionLists","customizeActions","clearHistory","notifySubscribers","appendStaticContextToRootViewModel","beforeRender","empty","cleanNode","getDataPreview","serialize","dataPreviewJSON","fail","ShowMessage","getErrorMessage","getSelectStatement","errorMessage","sqlSelectStatement","localization","addCultureInfo","messages","default","rtlEnabled","registerControls","promises","customizeLocalization","resolveFromPromises","queryCreator","selectedTabPanel","SelectedTabInfo","switcher","collapsed","showPropertyGridCondition","_getSelectedItemPropertyName"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (query-builder\\_initializer.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createQueryBuilderSurface = exports.createQueryBuilder = exports.createIsLoadingFlag = exports.updateQueryBuilderSurfaceContentSize = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar queryModel_1 = require(\"./elements/queryModel\");\nvar _arrayutils_1 = require(\"../core/utils/_arrayutils\");\nvar initializer_1 = require(\"./initializer\");\nvar localization_utils_1 = require(\"../property-grid/localization/localization_utils\");\nvar querySurface_1 = require(\"./elements/querySurface\");\nvar dbSchemaProvider_1 = require(\"./dataSource/dbSchemaProvider\");\nvar requestwrapper_1 = require(\"./utils/requestwrapper\");\nvar _utils_1 = require(\"../core/utils/_utils\");\nvar _designerInitializer_1 = require(\"../core/utils/_designerInitializer\");\nvar _processError_1 = require(\"../core/internal/_processError\");\nvar parameterModelMeta_1 = require(\"./elements/parameterModelMeta\");\nvar _selection_1 = require(\"../core/selection/_selection\");\nvar controlsFactory_1 = require(\"./utils/controlsFactory\");\nvar _utils_2 = require(\"../widgets/_utils\");\nvar _options_1 = require(\"./widgets/ace/_options\");\nvar _columnDragHandler_1 = require(\"./dragDrop/_columnDragHandler\");\nvar _queryBuilderTreeListController_1 = require(\"./utils/_queryBuilderTreeListController\");\nvar propertygrid_1 = require(\"../property-grid/propertygrid\");\nvar _localization_1 = require(\"../property-grid/localization/_localization\");\nvar _accordionTabInfo_1 = require(\"./_accordionTabInfo\");\nvar _dbObjectDragDropHandler_1 = require(\"./dragDrop/_dbObjectDragDropHandler\");\nvar _queryBuilderObjectsProvider_1 = require(\"./widgets/filterEditor/_queryBuilderObjectsProvider\");\nvar _actionList_1 = require(\"../core/tools/_actionList\");\nvar _infoMessageHelpers_1 = require(\"../core/utils/_infoMessageHelpers\");\nvar _controlsFactory_1 = require(\"./utils/_controlsFactory\");\nvar config_1 = require(\"devextreme/core/config\");\nvar sqlDataSource_1 = require(\"./dataSource/sql/sqlDataSource\");\nvar _ace_available_1 = require(\"../widgets/ace/_ace-available\");\nvar _internal_1 = require(\"../serializer/_internal\");\nvar _rightPanelSwitcher_1 = require(\"./widgets/_rightPanelSwitcher\");\nvar _internal_2 = require(\"../accessibility/_internal\");\nvar _dataConnection_1 = require(\"./utils/_dataConnection\");\nvar QueryBuilderElements = {\n    Surface: 'dxrd-surface-template-base',\n    Toolbar: 'dxqb-toolbar',\n    RightPanel: 'dx-right-panel-lightweight',\n    RightPanelSwitcher: 'dx-right-panel-switcher',\n    DataPreview: 'dxqb-popup#data',\n    SqlPreview: 'dxqb-popup#sql'\n};\nfunction customizeDesignerActions(designerModel, nextCustomizer) {\n    var query = designerModel.model;\n    return (function (actions) {\n        var del = _arrayutils_1.findFirstItemMatchesCondition(actions, function (action) { return action.text === 'Delete'; });\n        del.imageClassName = 'dx-icon-dxrd-image-recycle-bin';\n        del.imageTemplateName = 'dxrd-svg-operations-recycle_bin';\n        var undo = _arrayutils_1.findFirstItemMatchesCondition(actions, function (action) { return action.text === 'Undo'; });\n        undo.disabled = ko.pureComputed(function () { return designerModel.isLoading() || !designerModel.undoEngine().undoEnabled(); });\n        var redo = _arrayutils_1.findFirstItemMatchesCondition(actions, function (action) { return action.text === 'Redo'; });\n        actions.splice(0, actions.length, del, undo, redo);\n        actions.push({\n            id: initializer_1.ActionId.Save,\n            text: 'Save',\n            displayText: function () { return localization_utils_1.getLocalization('Save', 'AnalyticsCoreStringId.MenuButtons_Save'); },\n            imageClassName: 'dxqb-image-save',\n            imageTemplateName: 'dxrd-svg-menu-save',\n            disabled: designerModel.isLoading,\n            visible: true,\n            hotKey: { ctrlKey: true, keyCode: 'S'.charCodeAt(0) },\n            clickAction: function () {\n                query().save();\n            },\n            hasSeparator: true\n        });\n        actions.push({\n            id: initializer_1.ActionId.DataPreview,\n            text: 'Preview Results',\n            displayText: function () { return localization_utils_1.getLocalization('Preview Results', 'DataAccessUIStringId.QueryBuilderButtons_PreviewResults'); },\n            imageClassName: 'dxrd-image-data-preview',\n            imageTemplateName: 'dxrd-svg-queryBuilder-data_preview',\n            disabled: designerModel.isLoading,\n            visible: true,\n            hotKey: { ctrlKey: true, keyCode: 'P'.charCodeAt(0) },\n            clickAction: function () {\n                if (!query().canSave())\n                    return;\n                designerModel.showPreview();\n            },\n            hasSeparator: true\n        });\n        actions.push({\n            id: initializer_1.ActionId.SelectStatementPreview,\n            text: 'Preview Select Statement',\n            displayText: function () { return localization_utils_1.getLocalization('Preview Select Statement', 'AnalyticsCoreStringId.QueryBuilder_PreviewSelectStatement_Tooltip'); },\n            imageClassName: 'dxrd-image-selectstatement-preview',\n            imageTemplateName: 'dxrd-svg-queryBuilder-select_statment',\n            disabled: designerModel.isLoading,\n            visible: true,\n            hotKey: { ctrlKey: true, keyCode: 'E'.charCodeAt(0) },\n            clickAction: function () {\n                if (!query().canSave())\n                    return;\n                designerModel.showStatement();\n            },\n            hasSeparator: true\n        });\n        nextCustomizer && nextCustomizer(actions);\n    });\n}\nfunction updateQueryBuilderSurfaceContentSize(getRoot, surfaceSize, surface, updateLayoutCallbacks) {\n    return function () {\n        var $root = getRoot();\n        var rightAreaWidth = $root.find('.dxrd-right-panel:visible').outerWidth() || 0;\n        var surfaceWidth = $root.width() - (rightAreaWidth + 5);\n        $root.find('.dxrd-surface-wrapper').css(surface().rtl() ?\n            { 'left': rightAreaWidth, 'right': 0, 'width': surfaceWidth } :\n            { 'left': 0, 'right': rightAreaWidth, 'width': surfaceWidth });\n        surfaceSize(surfaceWidth);\n        surface().pageWidth(surfaceWidth);\n    };\n}\nexports.updateQueryBuilderSurfaceContentSize = updateQueryBuilderSurfaceContentSize;\nfunction createIsLoadingFlag(model, dbSchemaProvider) {\n    var isDbSchemaLoaded = ko.observable(false);\n    model()._disposables.push(dbSchemaProvider.subscribe(function () { isDbSchemaLoaded(false); }));\n    return ko.pureComputed(function () {\n        dbSchemaProvider.peek().getDbSchema().done(function () {\n            isDbSchemaLoaded(true);\n        });\n        if (isDbSchemaLoaded()) {\n            return model().tables.peek().some(function (table) {\n                return !table.isInitialized();\n            });\n        }\n        else {\n            return true;\n        }\n    });\n}\nexports.createIsLoadingFlag = createIsLoadingFlag;\nfunction _createDesignerModel(query, surface, options) {\n    var querySubscription = query.subscribe(function (newValue) {\n        surface(new querySurface_1.QuerySurface(newValue));\n        surface().rtl(!!options.rtl);\n    });\n    var selection = new _selection_1.SurfaceSelection(['alias', 'name', 'sortOrder']);\n    var designer = _designerInitializer_1.createDesigner(query, surface, controlsFactory_1.controlsFactory, undefined, undefined, undefined, !!options.rtl, selection);\n    designer.addDisposables(querySubscription);\n    designer.findControl = function (s, e) {\n        var $childs = $('.dxqb-main').children('.dxrd-control');\n        $childs.each(function (_, child) {\n            var $child = $(child);\n            if ($child.offset().top <= e.clientY && $child.offset().left <= e.clientX) {\n                designer.selection.focused(ko.dataFor($child[0]));\n                return;\n            }\n        });\n    };\n    designer.addDisposables({ dispose: function () { return designer.findControl = null; } });\n    return designer;\n}\nfunction _updateSurfaceContentSizeSubscription(element, designerModel, surface, callback) {\n    var updateSurfaceContentSize_ = updateQueryBuilderSurfaceContentSize(function () { return $(element).find('.dxqb-designer'); }, designerModel.surfaceSize, surface);\n    designerModel.addDisposables(surface.subscribe(function () { updateSurfaceContentSize_(); }));\n    var onResize = function () {\n        setTimeout(function () { return updateSurfaceContentSize_(); });\n    };\n    window.addEventListener('resize', onResize);\n    _internal_1.addDisposeCallback(element, function () {\n        window.removeEventListener('resize', onResize);\n        designerModel.disposableContainer.dispose();\n    });\n    designerModel.addDisposables(designerModel.tabPanel.width.subscribe(function () {\n        updateSurfaceContentSize_();\n    }));\n    designerModel.updateSurfaceSize = function () {\n        updateSurfaceContentSize_();\n    };\n    designerModel.updateSurface = function () {\n        updateSurfaceContentSize_();\n        callback && callback();\n    };\n}\nfunction _createQueryBuilder(element, options, callbacks, applyBindings) {\n    if (applyBindings === void 0) { applyBindings = true; }\n    var disposableCallback = callbacks && callbacks.onServerError && _processError_1.processErrorEvent(callbacks.onServerError);\n    var wrapper = options.requestWrapper || new requestwrapper_1.RequestWrapper();\n    var parametersMode = options.parametersMode || parameterModelMeta_1.ParametersMode.ReadWrite;\n    initializer_1.HandlerUri(options.handlerUri);\n    if (options.queryModelJson) {\n        var dataSource = new sqlDataSource_1.SqlDataSource(JSON.parse(options.dataSourceJson));\n        options.dbSchemaProvider = _utils_1._wrapModelInObservable(options.dbSchemaProvider);\n        options.dbSchemaProvider(new dbSchemaProvider_1.DBSchemaProvider(dataSource.connection));\n        options.querySource = _utils_1._wrapModelInObservable(options.querySource);\n        options.querySource(JSON.parse(options.queryModelJson));\n    }\n    var dataConnection = options.dbSchemaProvider().connection;\n    var query = ko.observable(), surface = ko.observable(), treeListOptions = ko.observable();\n    var beforeSaveCallback = function (data) {\n        callbacks.saveQueryRequested({\n            queryLayout: encodeURIComponent(JSON.stringify(data)),\n            connection: encodeURIComponent(_dataConnection_1.serializeDataConnection(dataConnection))\n        });\n    };\n    var initQuery = function (querySource) {\n        query(new queryModel_1.QueryViewModel(querySource, options.dbSchemaProvider(), parametersMode, function (data) { return beforeSaveCallback(data); }));\n    };\n    initQuery(options.querySource());\n    var designerModel = _createDesignerModel(query, surface, options);\n    disposableCallback && designerModel.addDisposables(disposableCallback);\n    designerModel.rootStyle = 'dxqb-designer dxd-back-primary-invariant';\n    var previewPopupContainer = _utils_2.getParentContainer;\n    designerModel.dataPreview = {\n        isLoading: ko.observable(false),\n        isVisible: ko.observable(false),\n        title: function () { return localization_utils_1.getLocalization('Data Preview (First 100 Rows Displayed)', 'AnalyticsCoreStringId.DataPreview_Title'); },\n        template: 'dxqb-data-preview',\n        data: {\n            value: ko.observable()\n        },\n        okButtonText: function () { return localization_utils_1.getLocalization('OK', 'DataAccessUIStringId.Button_OK'); },\n        okButtonHandler: function (e) {\n            e.model.isVisible(false);\n        },\n        container: previewPopupContainer\n    };\n    designerModel.selectStatmentPreview = {\n        isLoading: ko.observable(false),\n        isVisible: ko.observable(false),\n        template: 'dxqb-selectstatment-preview',\n        title: function () { return localization_utils_1.getLocalization('Select Statement Preview', 'AnalyticsCoreStringId.QueryBuilder_SelectStatementPreview_Title'); },\n        data: {\n            value: ko.observable(),\n            aceOptions: _options_1.createDefaultSQLAceOptions(true),\n            aceAvailable: _ace_available_1.aceAvailable(),\n            additionalOptions: _options_1.createDefaultSQLAdditionalOptions(function (newVal) { designerModel.selectStatmentPreview.data.value(newVal); }),\n            languageHelper: _options_1.createDefaultSQLLanguageHelper()\n        },\n        okButtonText: function () { return localization_utils_1.getLocalization('OK', 'DataAccessUIStringId.Button_OK'); },\n        okButtonHandler: function (e) {\n            e.model.isVisible(false);\n        },\n        container: previewPopupContainer\n    };\n    designerModel.parts = [\n        { id: QueryBuilderElements.Surface, templateName: QueryBuilderElements.Surface, model: designerModel },\n        { id: QueryBuilderElements.Toolbar, templateName: QueryBuilderElements.Toolbar, model: designerModel },\n        { id: QueryBuilderElements.RightPanel, templateName: QueryBuilderElements.RightPanel, model: designerModel },\n        { id: QueryBuilderElements.DataPreview, templateName: QueryBuilderElements.DataPreview.split('#')[0], model: designerModel.dataPreview },\n        { id: QueryBuilderElements.SqlPreview, templateName: QueryBuilderElements.SqlPreview.split('#')[0], model: designerModel.selectStatmentPreview }\n    ];\n    designerModel.columnDragHandler = new _columnDragHandler_1.ColumnDragHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n    designerModel.fieldDragHandler = new _dbObjectDragDropHandler_1.DbObjectDragDropHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n    designerModel.connectionPointDragHandler = designerModel.columnDragHandler;\n    designerModel.resizeHandler['handles'] = 'e, w';\n    designerModel.columnsLoadingMsg = function () { return localization_utils_1.getLocalization('Loading...', 'DataAccessWebStringId.QueryBuilder_ColumnsLoading'); };\n    var init = function (querySource) {\n        initQuery(querySource);\n        treeListOptions({\n            itemsProvider: options.dbSchemaProvider(),\n            treeListController: new _queryBuilderTreeListController_1.QueryBuilderTreeListController(designerModel.undoEngine, query, designerModel.fieldDragHandler),\n            selectedPath: ko.observable(),\n            pageSize: 100,\n            templateName: 'dxqb-treelist-item-with-search'\n        });\n    };\n    designerModel.addDisposables(options.querySource.subscribe(function (newValue) {\n        init(newValue);\n    }));\n    init(options.querySource());\n    var tablesTop = ko.observable(_internal_2.calculateWithZoomFactor(355)), itemPropertiesTabInfoModel = {\n        editableObject: designerModel.editableObject,\n        properties: new propertygrid_1.ObjectProperties(designerModel.editableObject, null, 1),\n        fieldListModel: { treeListOptions: treeListOptions },\n        tablesTop: tablesTop,\n        searchPlaceholder: function () { return _localization_1.searchPlaceholder(); }\n    };\n    var tabPanelItem = new _accordionTabInfo_1.AccordionTabInfo(query, itemPropertiesTabInfoModel, designerModel.undoEngine, designerModel.selection.focused, parametersMode === parameterModelMeta_1.ParametersMode.ReadWrite);\n    var tabPanel = designerModel.tabPanel;\n    tabPanel.tabs.length = 0;\n    tabPanel.tabs.push(tabPanelItem);\n    tabPanel.width(_internal_2.calculateWithZoomFactor(375));\n    designerModel.fieldDragHandler = new _dbObjectDragDropHandler_1.DbObjectDragDropHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n    designerModel.fieldListProvider = new _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider(query, _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider.whereClauseObjectsFilter);\n    designerModel.dataBindingsProvider = designerModel.fieldListProvider;\n    designerModel.parametersBindingsProvider = options.parametersItemsProvider || designerModel.dataBindingsProvider;\n    designerModel.dataBindingsGroupProvider = new _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider(query, _queryBuilderObjectsProvider_1.QueryBuilderObjectsProvider.groupByObjectsFilter);\n    designerModel.isLoading = createIsLoadingFlag(designerModel.model, options.dbSchemaProvider);\n    designerModel.actionLists = new _actionList_1.ActionLists(surface, designerModel.selection, designerModel.undoEngine, customizeDesignerActions(designerModel, callbacks && callbacks.customizeActions));\n    if (!designerModel.isLoading()) {\n        designerModel.undoEngine && designerModel.undoEngine().clearHistory();\n    }\n    designerModel.addDisposables(designerModel.isLoading.subscribe(function (value) {\n        designerModel.undoEngine && designerModel.undoEngine().clearHistory();\n    }));\n    designerModel.selection.focused(surface());\n    var subscribe = surface.subscribe(function (newValue) {\n        designerModel.selection.focused(newValue);\n    });\n    designerModel.addDisposables({ dispose: function () { return subscribe.dispose(); } });\n    designerModel.addDisposables(designerModel.editableObject.subscribe(function (newValue) {\n        tablesTop.notifySubscribers(null);\n    }));\n    _utils_1.appendStaticContextToRootViewModel(designerModel);\n    if (applyBindings) {\n        callbacks && callbacks.beforeRender && callbacks.beforeRender(designerModel);\n        $(element).empty();\n        ko.cleanNode(element);\n        ko.applyBindings(designerModel, element);\n    }\n    _updateSurfaceContentSizeSubscription(element, designerModel, surface, function () { return tablesTop(355); });\n    if (applyBindings) {\n        designerModel.updateSurface();\n    }\n    designerModel.showPreview = function () {\n        designerModel.dataPreview.isLoading(true);\n        designerModel.dataPreview.isVisible(true);\n        wrapper.getDataPreview(dataConnection, JSON.stringify(query().serialize(true)))\n            .done(function (data) {\n            designerModel.dataPreview.data.value(JSON.parse(data.dataPreviewJSON));\n            designerModel.dataPreview.isLoading(false);\n        }).fail(function (data) {\n            designerModel.dataPreview.isVisible(false);\n            _infoMessageHelpers_1.ShowMessage(_infoMessageHelpers_1.getErrorMessage(data));\n        });\n    };\n    designerModel.showStatement = function () {\n        designerModel.selectStatmentPreview.isLoading(true);\n        designerModel.selectStatmentPreview.isVisible(true);\n        wrapper.getSelectStatement(dataConnection, JSON.stringify(query().serialize(true)))\n            .done(function (data) {\n            if (data.errorMessage)\n                _infoMessageHelpers_1.ShowMessage(data.errorMessage);\n            designerModel.selectStatmentPreview.data.value(data.sqlSelectStatement);\n            designerModel.selectStatmentPreview.isLoading(false);\n        }).fail(function (data) {\n            designerModel.selectStatmentPreview.isVisible(false);\n            _infoMessageHelpers_1.ShowMessage(_infoMessageHelpers_1.getErrorMessage(data));\n        });\n    };\n    return designerModel;\n}\nfunction createQueryBuilder(element, options, callbacks, applyBindings) {\n    if (applyBindings === void 0) { applyBindings = true; }\n    if (options.localization) {\n        localization_utils_1.addCultureInfo({\n            messages: options.localization\n        });\n    }\n    config_1.default({ rtlEnabled: !!options.rtl });\n    _controlsFactory_1.registerControls();\n    var promises = [];\n    callbacks && callbacks.customizeLocalization && callbacks.customizeLocalization(promises);\n    return _localization_1.resolveFromPromises(promises, function () { return _createQueryBuilder(element, options, callbacks, applyBindings); });\n}\nexports.createQueryBuilder = createQueryBuilder;\nfunction createQueryBuilderSurface(element, options, queryCreator) {\n    var query = ko.observable(), surface = ko.observable();\n    _controlsFactory_1.registerControls();\n    var designerModel = _createDesignerModel(query, surface, options);\n    var selectedTabPanel = new _accordionTabInfo_1.SelectedTabInfo(new propertygrid_1.ObjectProperties(designerModel.editableObject, null, 1));\n    var tabPanel = designerModel.tabPanel;\n    var switcher = new _rightPanelSwitcher_1.RightPanelSwitcher(tabPanel.collapsed, designerModel.editableObject, options.showPropertyGridCondition, _accordionTabInfo_1.AccordionTabInfo._getSelectedItemPropertyName);\n    designerModel.addDisposables(selectedTabPanel, tabPanel, switcher);\n    tabPanel.tabs.length = 0;\n    tabPanel.tabs.push(selectedTabPanel);\n    tabPanel.width(_internal_2.calculateWithZoomFactor(325));\n    designerModel.parts = [\n        { id: QueryBuilderElements.Surface, templateName: QueryBuilderElements.Surface, model: designerModel },\n        { id: QueryBuilderElements.RightPanel, templateName: QueryBuilderElements.RightPanel, model: designerModel },\n        { id: QueryBuilderElements.RightPanelSwitcher, templateName: QueryBuilderElements.RightPanelSwitcher, model: switcher },\n    ];\n    designerModel.columnDragHandler = new _columnDragHandler_1.ColumnDragHandler(surface, designerModel.selection, designerModel.undoEngine, designerModel.snapHelper, designerModel.dragHelperContent);\n    designerModel.connectionPointDragHandler = designerModel.columnDragHandler;\n    designerModel.selection.focused(surface());\n    designerModel.addDisposables(surface.subscribe(function (newValue) {\n        designerModel.selection.focused(newValue);\n    }));\n    designerModel.rootStyle = 'dxqb-designer dxd-back-primary-invariant';\n    designerModel.resizeHandler['handles'] = 'e, w';\n    designerModel.columnsLoadingMsg = function () { return localization_utils_1.getLocalization('Loading...', 'DataAccessWebStringId.QueryBuilder_ColumnsLoading'); };\n    _utils_1.appendStaticContextToRootViewModel(designerModel);\n    query(queryCreator(options));\n    $(element).empty();\n    ko.cleanNode(element);\n    ko.applyBindings(designerModel, element);\n    _updateSurfaceContentSizeSubscription(element, designerModel, surface);\n    designerModel.isLoading(false);\n    designerModel.updateSurface();\n    _internal_1.addDisposeCallback(element, function () {\n        query() && query().dispose();\n        surface() && surface().dispose();\n        queryCreator = null;\n        designerModel.disposableContainer.dispose();\n        designerModel.dispose();\n    });\n    return designerModel;\n}\nexports.createQueryBuilderSurface = createQueryBuilderSurface;\n"]},"metadata":{},"sourceType":"script"}