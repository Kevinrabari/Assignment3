{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_pivot-grid-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.pivotGridItem = void 0;\n\nvar pivot_grid_1 = require(\"devextreme/ui/pivot_grid\");\n\nvar data_source_1 = require(\"devextreme/ui/pivot_grid/data_source\");\n\nvar item_data_axis_names_1 = require(\"../../../data/item-data/item-data-axis-names\");\n\nvar special_values_1 = require(\"../../../data/special-values\");\n\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\n\nvar _localization_ids_1 = require(\"../../../data/_localization-ids\");\n\nvar _localizer_1 = require(\"../../../data/_localizer\");\n\nvar _utils_1 = require(\"../../../data/_utils\");\n\nvar _style_settings_provider_1 = require(\"../../conditional-formatting/_style-settings-provider\");\n\nvar _base_item_1 = require(\"../_base-item\");\n\nvar _pivot_grid_item_helper_1 = require(\"./_pivot-grid-item-helper\");\n\nvar PIVOT_BAR_ID = 'pivotBar';\n\nvar pivotGridItem = function (_super) {\n  __extends(pivotGridItem, _super);\n\n  function pivotGridItem(container, options) {\n    var _this = _super.call(this, container, options) || this;\n\n    _this._conditionalFormattingInfoCache = [];\n    _this._pointsCache = {\n      columns: {},\n      rows: {}\n    };\n    _this.expandStateChanged = _jquery_helpers_1.createJQueryCallbacks();\n\n    _this._expandValueChangingHandler = function (args) {\n      _this._resetPivotLoadingDeferred();\n\n      _this._dataUpdateHook && _this._dataUpdateHook.reject();\n      _this._dataUpdateHook = _jquery_helpers_1.createJQueryDeferred();\n      var isColumn = args.area === 'column';\n      var values = args.path;\n\n      _this._onExpandValue({\n        values: values,\n        isColumn: isColumn,\n        isExpand: args.expanded,\n        isRequestData: !!args.needExpandData\n      });\n\n      _this.onCollapseStateChanged(isColumn, values, !args.expanded);\n    };\n\n    _this._collapseStateCache = {};\n    _this._conditionalFormattingInfoCache = [];\n    _this._styleSettingsProvider = new _style_settings_provider_1.styleSettingsProvider();\n\n    _this._styleSettingsProvider.initialize(_this.options.ConditionalFormattingModel);\n\n    return _this;\n  }\n\n  Object.defineProperty(pivotGridItem.prototype, \"dataController\", {\n    get: function () {\n      return this._dataController;\n    },\n    set: function (dataController) {\n      this._dataController = dataController;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(pivotGridItem.prototype, \"_captionToolbarSeparatorRequired\", {\n    get: function () {\n      return !this.hasParentContainer() || this.hasParentContainer() && this.visualMode === 'caption';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(pivotGridItem.prototype, \"_multiData\", {\n    get: function () {\n      return this.options.multiData;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(pivotGridItem.prototype, \"_viewModel\", {\n    get: function () {\n      return this.options.ViewModel;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  pivotGridItem.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this.pivotGridViewer && this.pivotGridViewer.dispose();\n\n    this._styleSettingsProvider.dispose();\n\n    this._pivotLoadingDeferred && this._pivotLoadingDeferred.reject();\n\n    this._dataUpdateHook.reject();\n  };\n\n  pivotGridItem.prototype.hideLoadingPanel = function () {\n    var _this = this;\n\n    if (this._pivotLoadingDeferred) {\n      this._pivotLoadingDeferred.promise().then(function () {\n        _super.prototype.hideLoadingPanel.call(_this);\n      });\n    } else {\n      _super.prototype.hideLoadingPanel.call(this);\n    }\n  };\n\n  pivotGridItem.prototype.renderContentUnsafe = function (element, changeExisting, afterRenderCallback) {\n    var _this = this;\n\n    this._resetPivotLoadingDeferred();\n\n    if (this.options) {\n      this._createAndLoadDataSource().then(function (result) {\n        var pivotOptions = _this._getPivotGridOptions(result.dataSource, result.fields);\n\n        _this._raiseItemWidgetOptionsPrepared(pivotOptions);\n\n        if (changeExisting && _this.pivotGridViewer) {\n          _this.pivotGridViewer.option(pivotOptions);\n        } else {\n          _this.pivotGridViewer = new pivot_grid_1.default(element, pivotOptions);\n        }\n\n        _this._conditionalFormattingInfoCache = [];\n        afterRenderCallback();\n      });\n    }\n\n    return true;\n  };\n\n  pivotGridItem.prototype.renderPartialContentUnsafe = function () {\n    this._conditionalFormattingInfoCache = [];\n  };\n\n  pivotGridItem.prototype.getInfoUnsafe = function () {\n    return _jquery_helpers_1.deepExtend(_super.prototype.getInfoUnsafe.call(this), {\n      scroll: {\n        topPath: this.pivotGridViewer.getScrollPath('row'),\n        leftPath: this.pivotGridViewer.getScrollPath('column'),\n        horizontal: this.pivotGridViewer.hasScroll('column'),\n        vertical: this.pivotGridViewer.hasScroll('row')\n      }\n    });\n  };\n\n  pivotGridItem.prototype.getExpandingState = function (isRowsExpanding, isColumnsExpanding) {\n    if (isRowsExpanding === void 0) {\n      isRowsExpanding = true;\n    }\n\n    if (isColumnsExpanding === void 0) {\n      isColumnsExpanding = true;\n    }\n\n    var ds = this.pivotGridViewer ? this.pivotGridViewer.getDataSource() : undefined;\n    return {\n      rows: isRowsExpanding ? this._getStatePaths(ds, false, true) : this._getStatePaths(ds, false, false),\n      columns: isColumnsExpanding ? this._getStatePaths(ds, true, true) : this._getStatePaths(ds, true, false)\n    };\n  };\n\n  pivotGridItem.prototype._onExpandStateChanged = function (dxPivotState) {\n    this.expandStateChanged.fire(dxPivotState);\n  };\n\n  pivotGridItem.prototype._getStatePaths = function (ds, isColumn, getExpanded) {\n    if (!ds) return [];\n    var result = [],\n        data = ds.getData() || [],\n        area = isColumn ? 'column' : 'row',\n        fields = ds.getAreaFields(area, false);\n\n    var foreachTreeItem = function (items, members, callback) {\n      members = members || [];\n      items = items || [];\n      var item;\n\n      for (var i = 0; i < items.length; i++) {\n        item = items[i];\n        members.unshift(item);\n        callback(members, i);\n\n        if (item.children) {\n          foreachTreeItem(item.children, members, callback);\n        }\n\n        members.shift();\n      }\n    };\n\n    var createPath = function (items) {\n      var result = [];\n\n      for (var i = items.length - 1; i >= 0; i--) {\n        result.push(items[i].key || items[i].value);\n      }\n\n      return result;\n    };\n\n    foreachTreeItem(data[area + 's'], undefined, function (items) {\n      var item = items[0],\n          path = createPath(items);\n      var expanded = !!item.children;\n      if (getExpanded && expanded || !getExpanded && !expanded) path.length < fields.length && result.push(path.slice());\n    });\n    return result;\n  };\n\n  pivotGridItem.prototype._initializeData = function (newOptions) {\n    _super.prototype._initializeData.call(this, newOptions);\n\n    if (!this._dataUpdateHook) {\n      this._dataUpdateHook = _jquery_helpers_1.createJQueryDeferred();\n    }\n\n    this._dataUpdateHook.resolve();\n\n    this.options.PivotExpandViewState = newOptions.PivotExpandViewState;\n\n    if (this._styleSettingsProvider) {\n      this._styleSettingsProvider.initialize(this.options.ConditionalFormattingModel);\n    }\n  };\n\n  pivotGridItem.prototype._loadState = function (fields) {\n    var previousState = this.options.PivotExpandViewState;\n\n    if (previousState) {\n      var fieldsCopy = fields.map(function (field) {\n        return __assign({}, field);\n      });\n      fieldsCopy.forEach(function (actualField) {\n        var stateField = previousState.fields.filter(function (field) {\n          return field.name == actualField.name;\n        })[0];\n\n        if (stateField) {\n          actualField.expanded = stateField.expanded;\n        }\n      });\n      previousState.fields = fieldsCopy;\n    }\n\n    return previousState;\n  };\n\n  pivotGridItem.prototype._getPivotGridOptions = function (dataSource, fields) {\n    var _this = this;\n\n    var viewModel = this._viewModel;\n\n    if (!viewModel) {\n      return {};\n    }\n\n    var commonOptions = {};\n    commonOptions.dataSource = dataSource;\n    commonOptions.fieldChooser = {\n      enabled: false\n    };\n    commonOptions.loadPanel = {\n      enabled: false\n    };\n    commonOptions.contextMenuEnabled = false;\n    commonOptions.showRowGrandTotals = this._showRowGrandTotals(fields);\n    commonOptions.showColumnGrandTotals = this._getShowColumnGrandTotals(fields);\n    commonOptions.showColumnTotals = viewModel.ShowColumnTotals;\n    commonOptions.showRowTotals = viewModel.ShowRowTotals;\n    commonOptions.dataFieldArea = viewModel.ValuesPosition == 'Rows' ? 'row' : 'column';\n\n    if (viewModel.LayoutType == 'Compact') {\n      commonOptions.rowHeaderLayout = 'tree';\n      if (viewModel.ColumnTotalsPosition == 'Near') commonOptions.showTotalsPrior = 'columns';else commonOptions.showTotalsPrior = 'none';\n    } else {\n      commonOptions.rowHeaderLayout = 'standard';\n      if (viewModel.RowTotalsPosition == 'Top' && viewModel.ColumnTotalsPosition == 'Near') commonOptions.showTotalsPrior = 'both';else if (viewModel.RowTotalsPosition == 'Top') commonOptions.showTotalsPrior = 'rows';else if (viewModel.ColumnTotalsPosition == 'Near') commonOptions.showTotalsPrior = 'columns';else commonOptions.showTotalsPrior = 'none';\n    }\n\n    commonOptions.encodeHtml = this._isEncodeHtml();\n    commonOptions.scrolling = {\n      mode: 'virtual'\n    };\n    commonOptions.stateStoring = {\n      enabled: true,\n      type: 'custom',\n      savingTimeout: 0,\n      customLoad: function () {\n        return _jquery_helpers_1.createJQueryDeferred().resolve(_this._loadState(fields)).promise();\n      },\n      customSave: function (dxPivotState) {\n        _this._onExpandStateChanged(dxPivotState);\n      }\n    }, commonOptions.onExpandValueChanging = this._expandValueChangingHandler;\n    commonOptions.texts = {\n      grandTotal: _localizer_1.localizer.getString(_localization_ids_1.localizationId.PivotGridGrandTotal),\n      total: _localizer_1.localizer.getString(_localization_ids_1.localizationId.PivotGridTotal),\n      noData: _localizer_1.localizer.getString(_localization_ids_1.localizationId.MessagePivotHasNoData)\n    };\n\n    commonOptions.onCellClick = function (e) {\n      if (e.area === 'data') {\n        _this._raiseItemClick(e.cell);\n      }\n    };\n\n    commonOptions.onCellPrepared = function (e) {\n      return _this._onCellPrepared(e);\n    };\n\n    commonOptions.onContentReady = function (e) {\n      _this._styleSettingsProvider.draw();\n\n      _this._resolvePivotLoadingDeferred();\n    };\n\n    return commonOptions;\n  };\n\n  pivotGridItem.prototype._getShowColumnGrandTotals = function (fields) {\n    var viewModel = this._viewModel;\n    var columnFields = fields.filter(function (field) {\n      return field.area == 'column';\n    });\n    var rowFields = fields.filter(function (field) {\n      return field.area == 'row';\n    });\n\n    if (!viewModel.ShowColumnGrandTotals && columnFields.length === 0 && rowFields.length !== 0) {\n      return true;\n    }\n\n    return viewModel.ShowColumnGrandTotals;\n  };\n\n  pivotGridItem.prototype._showRowGrandTotals = function (fields) {\n    var viewModel = this._viewModel;\n    var columnFields = fields.filter(function (field) {\n      return field.area == 'column';\n    });\n    var rowFields = fields.filter(function (field) {\n      return field.area == 'row';\n    });\n\n    if (!viewModel.ShowRowGrandTotals && columnFields.length !== 0 && rowFields.length === 0) {\n      return true;\n    }\n\n    return viewModel.ShowRowGrandTotals;\n  };\n\n  pivotGridItem.prototype._resetPivotLoadingDeferred = function () {\n    this._pivotLoadingDeferred && this._pivotLoadingDeferred.reject();\n    this._pivotLoadingDeferred = _jquery_helpers_1.createJQueryDeferred();\n  };\n\n  pivotGridItem.prototype._resolvePivotLoadingDeferred = function () {\n    this._pivotLoadingDeferred && this._pivotLoadingDeferred.resolve();\n    this._pivotLoadingDeferred = null;\n  };\n\n  pivotGridItem.prototype.onCollapseStateChanged = function (isColumn, values, collapse) {\n    var that = this;\n    var collapseStateKey = values.concat(isColumn ? 'column' : 'row').toString();\n    that._conditionalFormattingInfoCache = [];\n    if (collapse) that._collapseStateCache[collapseStateKey] = true;else delete that._collapseStateCache[collapseStateKey];\n  };\n\n  pivotGridItem.prototype._resizeUnsafe = function () {\n    _super.prototype._resizeUnsafe.call(this);\n\n    this.pivotGridViewer && this.pivotGridViewer.resize();\n\n    this._styleSettingsProvider.updateBarWidth(PIVOT_BAR_ID);\n  };\n\n  pivotGridItem.prototype._getDataPoint = function (element) {\n    var that = this,\n        viewModel = that.options.ViewModel;\n    return {\n      getValues: function (name) {\n        switch (name) {\n          case item_data_axis_names_1.itemDataAxisNames.pivotRowAxis:\n            return element.rowPath;\n\n          case item_data_axis_names_1.itemDataAxisNames.pivotColumnAxis:\n            return element.columnPath;\n\n          default:\n            return null;\n        }\n      },\n      getDeltaIds: function () {\n        return [];\n      },\n      getMeasureIds: function () {\n        var dataIndex = element.dataIndex;\n\n        if (dataIndex != undefined) {\n          return [viewModel.Values[dataIndex].DataId];\n        }\n\n        return null;\n      }\n    };\n  };\n\n  pivotGridItem.prototype._getWidget = function () {\n    return this.pivotGridViewer;\n  };\n\n  pivotGridItem.prototype._onCellPrepared = function (element) {\n    var styleSettingsInfo,\n        isMeasureHeader = (element.area === _utils_1.pivotArea.column || element.area === _utils_1.pivotArea.row) && element.cell.dataIndex !== undefined,\n        cellItem = {\n      area: element.area\n    };\n\n    if (!isMeasureHeader) {\n      if (element.area === _utils_1.pivotArea.column) {\n        cellItem.columnPath = element.cell.path;\n        cellItem.columnType = element.cell.type;\n      } else if (element.area === _utils_1.pivotArea.row) {\n        cellItem.rowPath = element.cell.path;\n        cellItem.rowType = element.cell.type;\n      } else {\n        cellItem.columnPath = element.cell.columnPath;\n        cellItem.rowPath = element.cell.rowPath;\n        cellItem.cellIndex = element.cell.dataIndex;\n        cellItem.columnType = element.cell.columnType;\n        cellItem.rowType = element.cell.rowType;\n      }\n\n      styleSettingsInfo = this._dataController.getStyleSettingsInfo(cellItem, this._collapseStateCache, this._conditionalFormattingInfoCache, this._pointsCache);\n\n      this._styleSettingsProvider.applyStyleSettings(_jquery_helpers_1.$unwrap(element.cellElement), this.options.controlContainer, styleSettingsInfo, false, PIVOT_BAR_ID);\n    }\n  };\n\n  pivotGridItem.prototype._getFields = function () {\n    if (!this._viewModel) {\n      return undefined;\n    }\n\n    var columnFields = _pivot_grid_item_helper_1.pivotHelper.createAreaFields(this._viewModel.Columns, 'column', this._viewModel.AutoExpandColumnGroups);\n\n    for (var i = 0; i < this._viewModel.Columns.length; i++) {\n      columnFields[i].showTotals = this._viewModel.Columns[i].ShowTotals;\n    }\n\n    var rowFields = _pivot_grid_item_helper_1.pivotHelper.createAreaFields(this._viewModel.Rows, 'row', this._viewModel.AutoExpandRowGroups);\n\n    for (var i = 0; i < this._viewModel.Rows.length; i++) {\n      rowFields[i].showTotals = this._viewModel.Rows[i].ShowTotals;\n    }\n\n    var dataFields = _pivot_grid_item_helper_1.pivotHelper.createAreaFields(this._viewModel.Values, 'data');\n\n    for (var i = 0; i < this._viewModel.Values.length; i++) {\n      dataFields[i].showValues = this._viewModel.Values[i].ShowValues;\n      dataFields[i].showTotals = this._viewModel.Values[i].ShowTotals;\n      dataFields[i].showGrandTotals = this._viewModel.Values[i].ShowGrandTotals;\n    }\n\n    return columnFields.concat(rowFields).concat(dataFields);\n  };\n\n  pivotGridItem.prototype._createAndLoadDataSource = function () {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var fields = _this._getFields();\n\n      var firstRequest = true;\n      var dataSource = new data_source_1.default({\n        remoteOperations: true,\n        fields: fields,\n        retrieveFields: false,\n        load: function (loadOptions) {\n          if (firstRequest) {\n            firstRequest = false;\n            return [_pivot_grid_item_helper_1.pivotHelper.getSchemaRow(fields)];\n          } else {\n            return _this._dataUpdateHook ? _this._dataUpdateHook.then(function () {\n              return _this._getLoadData(loadOptions);\n            }) : _jquery_helpers_1.createJQueryDeferred().reject().promise();\n          }\n        }\n      });\n      dataSource.state(_this._loadState(fields));\n      dataSource.on('loadingChanged', function (args) {\n        if (!dataSource.isLoading()) {\n          resolve({\n            dataSource: dataSource,\n            fields: fields\n          });\n        }\n      });\n    });\n  };\n\n  pivotGridItem.prototype._getLoadData = function (loadOptions) {\n    var _this = this;\n\n    if (!this._multiData || this._multiData.isEmpty()) {\n      return undefined;\n    }\n\n    var group = loadOptions.group;\n    var groupSummary = loadOptions.groupSummary;\n    var totalSummary = loadOptions.totalSummary;\n\n    var filter = _pivot_grid_item_helper_1.OneElementFilterRemover.simplify(loadOptions.filter);\n\n    var availableByArea = {\n      columns: _pivot_grid_item_helper_1.pivotHelper.getColumnAxis(this._multiData).getDimensions().map(function (c) {\n        return c.id;\n      }),\n      rows: _pivot_grid_item_helper_1.pivotHelper.getRowAxis(this._multiData).getDimensions().map(function (r) {\n        return r.id;\n      })\n    };\n\n    var filteredFields = _pivot_grid_item_helper_1.FieldsExtractor.extract(filter);\n\n    var filteredByArea = {\n      columns: filteredFields.filter(function (f) {\n        return availableByArea.columns.filter(function (c) {\n          return c === f;\n        })[0] != undefined;\n      }).sort(function (a, b) {\n        return availableByArea.columns.indexOf(a) - availableByArea.columns.indexOf(b);\n      }),\n      rows: filteredFields.filter(function (f) {\n        return availableByArea.rows.filter(function (c) {\n          return c === f;\n        })[0] != undefined;\n      }).sort(function (a, b) {\n        return availableByArea.rows.indexOf(a) - availableByArea.rows.indexOf(b);\n      })\n    };\n    var groupedFields = group ? group.map(function (g) {\n      return g.selector;\n    }) : [];\n    var groupedByArea = {\n      columns: groupedFields.filter(function (f) {\n        return availableByArea.columns.filter(function (c) {\n          return c === f;\n        })[0] != undefined;\n      }),\n      rows: groupedFields.filter(function (f) {\n        return availableByArea.rows.filter(function (c) {\n          return c === f;\n        })[0] != undefined;\n      })\n    };\n    var firstIndexInGroup = {\n      column: _utils_1.findIndex(groupedFields, function (f) {\n        return availableByArea.columns.filter(function (c) {\n          return c === f;\n        })[0] !== undefined;\n      }),\n      row: _utils_1.findIndex(groupedFields, function (f) {\n        return availableByArea.rows.filter(function (c) {\n          return c === f;\n        })[0] !== undefined;\n      })\n    };\n    var onlyFilteredByArea = {\n      columns: _utils_1.distinct(_utils_1.minus(filteredByArea.columns, groupedByArea.columns)),\n      rows: _utils_1.distinct(_utils_1.minus(filteredByArea.rows, groupedByArea.rows))\n    };\n    var fields;\n\n    if (firstIndexInGroup.column === -1) {\n      fields = onlyFilteredByArea.rows.concat(groupedFields).concat(onlyFilteredByArea.columns);\n    } else if (firstIndexInGroup.row === -1) {\n      fields = onlyFilteredByArea.columns.concat(groupedFields).concat(onlyFilteredByArea.rows);\n    } else if (firstIndexInGroup.column < firstIndexInGroup.row) {\n      fields = onlyFilteredByArea.columns.concat(groupedFields.slice(firstIndexInGroup.column, firstIndexInGroup.row)).concat(onlyFilteredByArea.rows).concat(groupedFields.slice(firstIndexInGroup.row));\n    } else {\n      fields = onlyFilteredByArea.rows.concat(groupedFields.slice(firstIndexInGroup.row, firstIndexInGroup.column)).concat(onlyFilteredByArea.columns).concat(groupedFields.slice(firstIndexInGroup.column));\n    }\n\n    var columnRoot = _pivot_grid_item_helper_1.pivotHelper.getColumnAxis(this._multiData).getRootPoint();\n\n    var rowRoot = _pivot_grid_item_helper_1.pivotHelper.getRowAxis(this._multiData).getRootPoint();\n\n    var getItems = function (index, isColumn, point, oppositePoint, dimensionValues) {\n      var isLastGrouping = index + 1 >= fields.length;\n      var items = [];\n      var children = point.getChildren();\n      var nextLevelIsColumn;\n      var changeAreas;\n      var name = fields[index];\n      var onlyFiltered = isColumn ? onlyFilteredByArea.columns : onlyFilteredByArea.rows;\n      var isOnlyFiltered = onlyFiltered.filter(function (f) {\n        return f === name;\n      })[0] !== undefined;\n\n      if (!isLastGrouping) {\n        nextLevelIsColumn = availableByArea.columns.filter(function (c) {\n          return c === fields[index + 1];\n        })[0] !== undefined;\n        changeAreas = isColumn && !nextLevelIsColumn || !isColumn && nextLevelIsColumn;\n      }\n\n      var areaCache = isColumn ? _this._pointsCache.columns : _this._pointsCache.rows;\n\n      var _loop_1 = function (i) {\n        var _a;\n\n        var child = children[i];\n        areaCache[child.getUniquePath().toString()] = child;\n        var value = child.getUniqueValue();\n\n        var dimVals = __assign(__assign({}, dimensionValues), (_a = {}, _a[name] = value, _a));\n\n        if (filter && !_pivot_grid_item_helper_1.FilterChecker.fits(dimVals, filter)) return \"continue\";\n        var subItems = void 0;\n\n        if (!isLastGrouping) {\n          var nextLevelPoint = child;\n          var nextLevelOppositePoint = oppositePoint;\n\n          if (changeAreas) {\n            nextLevelPoint = oppositePoint;\n            nextLevelOppositePoint = child;\n          }\n\n          subItems = getItems(index + 1, nextLevelIsColumn, nextLevelPoint, nextLevelOppositePoint, dimVals);\n        } else {\n          subItems = null;\n        }\n\n        if (isOnlyFiltered) {\n          if (subItems && subItems.length > 0) items = items.concat(subItems);\n        } else {\n          items.push({\n            key: value,\n            displayText: value === special_values_1.specialValues.olapNullValueGuid ? _localizer_1.localizer.getString(_localization_ids_1.localizationId.OlapRaggedHierarchyNoneItemCaption) : child.getDisplayText(),\n            items: subItems,\n            summary: groupSummary.map(function (s) {\n              return _this._multiData.getMeasureValueByAxisPoints(s.selector, [child, oppositePoint]).getDisplayText();\n            })\n          });\n        }\n      };\n\n      for (var i = 0; i < children.length; i++) {\n        _loop_1(i);\n      }\n\n      return items.length !== 0 ? items : null;\n    };\n\n    var res = {};\n\n    if (groupedFields && groupedFields.length > 0) {\n      var isColumn = !!availableByArea.columns.filter(function (c) {\n        return c === fields[0];\n      })[0];\n      res.data = getItems(0, isColumn, isColumn ? columnRoot : rowRoot, isColumn ? rowRoot : columnRoot, {}) || [];\n    } else {\n      res.data = [_pivot_grid_item_helper_1.pivotHelper.getSchemaRow(this._getFields())];\n    }\n\n    if (totalSummary) res.summary = totalSummary.map(function (s) {\n      return _this._multiData.getMeasureValueByAxisPoints(s.selector, [columnRoot, rowRoot]).getDisplayText();\n    });\n    return res;\n  };\n\n  return pivotGridItem;\n}(_base_item_1.baseItem);\n\nexports.pivotGridItem = pivotGridItem;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/viewer-parts/viewer-items/pivot-grid-item/_pivot-grid-item.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","defineProperty","exports","value","pivotGridItem","pivot_grid_1","require","data_source_1","item_data_axis_names_1","special_values_1","_jquery_helpers_1","_localization_ids_1","_localizer_1","_utils_1","_style_settings_provider_1","_base_item_1","_pivot_grid_item_helper_1","PIVOT_BAR_ID","_super","container","options","_this","_conditionalFormattingInfoCache","_pointsCache","columns","rows","expandStateChanged","createJQueryCallbacks","_expandValueChangingHandler","args","_resetPivotLoadingDeferred","_dataUpdateHook","reject","createJQueryDeferred","isColumn","area","values","path","_onExpandValue","isExpand","expanded","isRequestData","needExpandData","onCollapseStateChanged","_collapseStateCache","_styleSettingsProvider","styleSettingsProvider","initialize","ConditionalFormattingModel","get","_dataController","set","dataController","enumerable","configurable","hasParentContainer","visualMode","multiData","ViewModel","dispose","pivotGridViewer","_pivotLoadingDeferred","hideLoadingPanel","promise","then","renderContentUnsafe","element","changeExisting","afterRenderCallback","_createAndLoadDataSource","result","pivotOptions","_getPivotGridOptions","dataSource","fields","_raiseItemWidgetOptionsPrepared","option","default","renderPartialContentUnsafe","getInfoUnsafe","deepExtend","scroll","topPath","getScrollPath","leftPath","horizontal","hasScroll","vertical","getExpandingState","isRowsExpanding","isColumnsExpanding","ds","getDataSource","undefined","_getStatePaths","_onExpandStateChanged","dxPivotState","fire","getExpanded","data","getData","getAreaFields","foreachTreeItem","items","members","callback","item","unshift","children","shift","createPath","push","key","slice","_initializeData","newOptions","resolve","PivotExpandViewState","_loadState","previousState","fieldsCopy","map","field","forEach","actualField","stateField","filter","name","viewModel","_viewModel","commonOptions","fieldChooser","enabled","loadPanel","contextMenuEnabled","showRowGrandTotals","_showRowGrandTotals","showColumnGrandTotals","_getShowColumnGrandTotals","showColumnTotals","ShowColumnTotals","showRowTotals","ShowRowTotals","dataFieldArea","ValuesPosition","LayoutType","rowHeaderLayout","ColumnTotalsPosition","showTotalsPrior","RowTotalsPosition","encodeHtml","_isEncodeHtml","scrolling","mode","stateStoring","type","savingTimeout","customLoad","customSave","onExpandValueChanging","texts","grandTotal","localizer","getString","localizationId","PivotGridGrandTotal","total","PivotGridTotal","noData","MessagePivotHasNoData","onCellClick","e","_raiseItemClick","cell","onCellPrepared","_onCellPrepared","onContentReady","draw","_resolvePivotLoadingDeferred","columnFields","rowFields","ShowColumnGrandTotals","ShowRowGrandTotals","collapse","that","collapseStateKey","concat","toString","_resizeUnsafe","resize","updateBarWidth","_getDataPoint","getValues","itemDataAxisNames","pivotRowAxis","rowPath","pivotColumnAxis","columnPath","getDeltaIds","getMeasureIds","dataIndex","Values","DataId","_getWidget","styleSettingsInfo","isMeasureHeader","pivotArea","column","row","cellItem","columnType","rowType","cellIndex","getStyleSettingsInfo","applyStyleSettings","$unwrap","cellElement","controlContainer","_getFields","pivotHelper","createAreaFields","Columns","AutoExpandColumnGroups","showTotals","ShowTotals","Rows","AutoExpandRowGroups","dataFields","showValues","ShowValues","showGrandTotals","ShowGrandTotals","Promise","firstRequest","remoteOperations","retrieveFields","load","loadOptions","getSchemaRow","_getLoadData","state","on","isLoading","_multiData","isEmpty","group","groupSummary","totalSummary","OneElementFilterRemover","simplify","availableByArea","getColumnAxis","getDimensions","c","id","getRowAxis","r","filteredFields","FieldsExtractor","extract","filteredByArea","f","sort","a","indexOf","groupedFields","g","selector","groupedByArea","firstIndexInGroup","findIndex","onlyFilteredByArea","distinct","minus","columnRoot","getRootPoint","rowRoot","getItems","index","point","oppositePoint","dimensionValues","isLastGrouping","getChildren","nextLevelIsColumn","changeAreas","onlyFiltered","isOnlyFiltered","areaCache","_loop_1","_a","child","getUniquePath","getUniqueValue","dimVals","FilterChecker","fits","subItems","nextLevelPoint","nextLevelOppositePoint","displayText","specialValues","olapNullValueGuid","OlapRaggedHierarchyNoneItemCaption","getDisplayText","summary","getMeasureValueByAxisPoints","res","baseItem"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_pivot-grid-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pivotGridItem = void 0;\nvar pivot_grid_1 = require(\"devextreme/ui/pivot_grid\");\nvar data_source_1 = require(\"devextreme/ui/pivot_grid/data_source\");\nvar item_data_axis_names_1 = require(\"../../../data/item-data/item-data-axis-names\");\nvar special_values_1 = require(\"../../../data/special-values\");\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\nvar _localization_ids_1 = require(\"../../../data/_localization-ids\");\nvar _localizer_1 = require(\"../../../data/_localizer\");\nvar _utils_1 = require(\"../../../data/_utils\");\nvar _style_settings_provider_1 = require(\"../../conditional-formatting/_style-settings-provider\");\nvar _base_item_1 = require(\"../_base-item\");\nvar _pivot_grid_item_helper_1 = require(\"./_pivot-grid-item-helper\");\nvar PIVOT_BAR_ID = 'pivotBar';\nvar pivotGridItem = (function (_super) {\n    __extends(pivotGridItem, _super);\n    function pivotGridItem(container, options) {\n        var _this = _super.call(this, container, options) || this;\n        _this._conditionalFormattingInfoCache = [];\n        _this._pointsCache = { columns: {}, rows: {} };\n        _this.expandStateChanged = _jquery_helpers_1.createJQueryCallbacks();\n        _this._expandValueChangingHandler = function (args) {\n            _this._resetPivotLoadingDeferred();\n            _this._dataUpdateHook && _this._dataUpdateHook.reject();\n            _this._dataUpdateHook = _jquery_helpers_1.createJQueryDeferred();\n            var isColumn = args.area === 'column';\n            var values = args.path;\n            _this._onExpandValue({\n                values: values,\n                isColumn: isColumn,\n                isExpand: args.expanded,\n                isRequestData: !!args.needExpandData\n            });\n            _this.onCollapseStateChanged(isColumn, values, !args.expanded);\n        };\n        _this._collapseStateCache = {};\n        _this._conditionalFormattingInfoCache = [];\n        _this._styleSettingsProvider = new _style_settings_provider_1.styleSettingsProvider();\n        _this._styleSettingsProvider.initialize(_this.options.ConditionalFormattingModel);\n        return _this;\n    }\n    Object.defineProperty(pivotGridItem.prototype, \"dataController\", {\n        get: function () { return this._dataController; },\n        set: function (dataController) { this._dataController = dataController; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(pivotGridItem.prototype, \"_captionToolbarSeparatorRequired\", {\n        get: function () {\n            return !this.hasParentContainer() || (this.hasParentContainer() && this.visualMode === 'caption');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(pivotGridItem.prototype, \"_multiData\", {\n        get: function () {\n            return this.options.multiData;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(pivotGridItem.prototype, \"_viewModel\", {\n        get: function () {\n            return this.options.ViewModel;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    pivotGridItem.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this.pivotGridViewer && this.pivotGridViewer.dispose();\n        this._styleSettingsProvider.dispose();\n        this._pivotLoadingDeferred && this._pivotLoadingDeferred.reject();\n        this._dataUpdateHook.reject();\n    };\n    pivotGridItem.prototype.hideLoadingPanel = function () {\n        var _this = this;\n        if (this._pivotLoadingDeferred) {\n            this._pivotLoadingDeferred.promise().then(function () {\n                _super.prototype.hideLoadingPanel.call(_this);\n            });\n        }\n        else {\n            _super.prototype.hideLoadingPanel.call(this);\n        }\n    };\n    pivotGridItem.prototype.renderContentUnsafe = function (element, changeExisting, afterRenderCallback) {\n        var _this = this;\n        this._resetPivotLoadingDeferred();\n        if (this.options) {\n            this._createAndLoadDataSource().then(function (result) {\n                var pivotOptions = _this._getPivotGridOptions(result.dataSource, result.fields);\n                _this._raiseItemWidgetOptionsPrepared(pivotOptions);\n                if (changeExisting && _this.pivotGridViewer) {\n                    _this.pivotGridViewer.option(pivotOptions);\n                }\n                else {\n                    _this.pivotGridViewer = new pivot_grid_1.default(element, pivotOptions);\n                }\n                _this._conditionalFormattingInfoCache = [];\n                afterRenderCallback();\n            });\n        }\n        return true;\n    };\n    pivotGridItem.prototype.renderPartialContentUnsafe = function () {\n        this._conditionalFormattingInfoCache = [];\n    };\n    pivotGridItem.prototype.getInfoUnsafe = function () {\n        return _jquery_helpers_1.deepExtend(_super.prototype.getInfoUnsafe.call(this), {\n            scroll: {\n                topPath: this.pivotGridViewer.getScrollPath('row'),\n                leftPath: this.pivotGridViewer.getScrollPath('column'),\n                horizontal: this.pivotGridViewer.hasScroll('column'),\n                vertical: this.pivotGridViewer.hasScroll('row')\n            }\n        });\n    };\n    pivotGridItem.prototype.getExpandingState = function (isRowsExpanding, isColumnsExpanding) {\n        if (isRowsExpanding === void 0) { isRowsExpanding = true; }\n        if (isColumnsExpanding === void 0) { isColumnsExpanding = true; }\n        var ds = this.pivotGridViewer ? this.pivotGridViewer.getDataSource() : undefined;\n        return {\n            rows: isRowsExpanding ? this._getStatePaths(ds, false, true) : this._getStatePaths(ds, false, false),\n            columns: isColumnsExpanding ? this._getStatePaths(ds, true, true) : this._getStatePaths(ds, true, false)\n        };\n    };\n    pivotGridItem.prototype._onExpandStateChanged = function (dxPivotState) {\n        this.expandStateChanged.fire(dxPivotState);\n    };\n    pivotGridItem.prototype._getStatePaths = function (ds, isColumn, getExpanded) {\n        if (!ds)\n            return [];\n        var result = [], data = ds.getData() || [], area = isColumn ? 'column' : 'row', fields = ds.getAreaFields(area, false);\n        var foreachTreeItem = function (items, members, callback) {\n            members = members || [];\n            items = items || [];\n            var item;\n            for (var i = 0; i < items.length; i++) {\n                item = items[i];\n                members.unshift(item);\n                callback(members, i);\n                if (item.children) {\n                    foreachTreeItem(item.children, members, callback);\n                }\n                members.shift();\n            }\n        };\n        var createPath = function (items) {\n            var result = [];\n            for (var i = items.length - 1; i >= 0; i--) {\n                result.push(items[i].key || items[i].value);\n            }\n            return result;\n        };\n        foreachTreeItem(data[area + 's'], undefined, function (items) {\n            var item = items[0], path = createPath(items);\n            var expanded = !!item.children;\n            if (getExpanded && expanded || !getExpanded && !expanded)\n                (path.length < fields.length) && result.push(path.slice());\n        });\n        return result;\n    };\n    pivotGridItem.prototype._initializeData = function (newOptions) {\n        _super.prototype._initializeData.call(this, newOptions);\n        if (!this._dataUpdateHook) {\n            this._dataUpdateHook = _jquery_helpers_1.createJQueryDeferred();\n        }\n        this._dataUpdateHook.resolve();\n        this.options.PivotExpandViewState = newOptions.PivotExpandViewState;\n        if (this._styleSettingsProvider) {\n            this._styleSettingsProvider.initialize(this.options.ConditionalFormattingModel);\n        }\n    };\n    pivotGridItem.prototype._loadState = function (fields) {\n        var previousState = this.options.PivotExpandViewState;\n        if (previousState) {\n            var fieldsCopy = fields.map(function (field) { return (__assign({}, field)); });\n            fieldsCopy.forEach(function (actualField) {\n                var stateField = previousState.fields.filter(function (field) { return field.name == actualField.name; })[0];\n                if (stateField) {\n                    actualField.expanded = stateField.expanded;\n                }\n            });\n            previousState.fields = fieldsCopy;\n        }\n        return previousState;\n    };\n    pivotGridItem.prototype._getPivotGridOptions = function (dataSource, fields) {\n        var _this = this;\n        var viewModel = this._viewModel;\n        if (!viewModel) {\n            return {};\n        }\n        var commonOptions = {};\n        commonOptions.dataSource = dataSource;\n        commonOptions.fieldChooser = { enabled: false };\n        commonOptions.loadPanel = { enabled: false };\n        commonOptions.contextMenuEnabled = false;\n        commonOptions.showRowGrandTotals = this._showRowGrandTotals(fields);\n        commonOptions.showColumnGrandTotals = this._getShowColumnGrandTotals(fields);\n        commonOptions.showColumnTotals = viewModel.ShowColumnTotals;\n        commonOptions.showRowTotals = viewModel.ShowRowTotals;\n        commonOptions.dataFieldArea = viewModel.ValuesPosition == 'Rows' ? 'row' : 'column';\n        if (viewModel.LayoutType == 'Compact') {\n            commonOptions.rowHeaderLayout = 'tree';\n            if (viewModel.ColumnTotalsPosition == 'Near')\n                commonOptions.showTotalsPrior = 'columns';\n            else\n                commonOptions.showTotalsPrior = 'none';\n        }\n        else {\n            commonOptions.rowHeaderLayout = 'standard';\n            if (viewModel.RowTotalsPosition == 'Top' && viewModel.ColumnTotalsPosition == 'Near')\n                commonOptions.showTotalsPrior = 'both';\n            else if (viewModel.RowTotalsPosition == 'Top')\n                commonOptions.showTotalsPrior = 'rows';\n            else if (viewModel.ColumnTotalsPosition == 'Near')\n                commonOptions.showTotalsPrior = 'columns';\n            else\n                commonOptions.showTotalsPrior = 'none';\n        }\n        commonOptions.encodeHtml = this._isEncodeHtml();\n        commonOptions.scrolling = {\n            mode: 'virtual'\n        };\n        commonOptions.stateStoring = {\n            enabled: true,\n            type: 'custom',\n            savingTimeout: 0,\n            customLoad: function () {\n                return _jquery_helpers_1.createJQueryDeferred().resolve(_this._loadState(fields)).promise();\n            },\n            customSave: function (dxPivotState) {\n                _this._onExpandStateChanged(dxPivotState);\n            }\n        },\n            commonOptions.onExpandValueChanging = this._expandValueChangingHandler;\n        commonOptions.texts = {\n            grandTotal: _localizer_1.localizer.getString(_localization_ids_1.localizationId.PivotGridGrandTotal),\n            total: _localizer_1.localizer.getString(_localization_ids_1.localizationId.PivotGridTotal),\n            noData: _localizer_1.localizer.getString(_localization_ids_1.localizationId.MessagePivotHasNoData)\n        };\n        commonOptions.onCellClick = function (e) {\n            if (e.area === 'data') {\n                _this._raiseItemClick(e.cell);\n            }\n        };\n        commonOptions.onCellPrepared = function (e) { return _this._onCellPrepared(e); };\n        commonOptions.onContentReady = function (e) {\n            _this._styleSettingsProvider.draw();\n            _this._resolvePivotLoadingDeferred();\n        };\n        return commonOptions;\n    };\n    pivotGridItem.prototype._getShowColumnGrandTotals = function (fields) {\n        var viewModel = this._viewModel;\n        var columnFields = fields.filter(function (field) { return field.area == 'column'; });\n        var rowFields = fields.filter(function (field) { return field.area == 'row'; });\n        if (!viewModel.ShowColumnGrandTotals && (columnFields.length === 0 && rowFields.length !== 0)) {\n            return true;\n        }\n        return viewModel.ShowColumnGrandTotals;\n    };\n    pivotGridItem.prototype._showRowGrandTotals = function (fields) {\n        var viewModel = this._viewModel;\n        var columnFields = fields.filter(function (field) { return field.area == 'column'; });\n        var rowFields = fields.filter(function (field) { return field.area == 'row'; });\n        if (!viewModel.ShowRowGrandTotals && (columnFields.length !== 0 && rowFields.length === 0)) {\n            return true;\n        }\n        return viewModel.ShowRowGrandTotals;\n    };\n    pivotGridItem.prototype._resetPivotLoadingDeferred = function () {\n        this._pivotLoadingDeferred && this._pivotLoadingDeferred.reject();\n        this._pivotLoadingDeferred = _jquery_helpers_1.createJQueryDeferred();\n    };\n    pivotGridItem.prototype._resolvePivotLoadingDeferred = function () {\n        this._pivotLoadingDeferred && this._pivotLoadingDeferred.resolve();\n        this._pivotLoadingDeferred = null;\n    };\n    pivotGridItem.prototype.onCollapseStateChanged = function (isColumn, values, collapse) {\n        var that = this;\n        var collapseStateKey = values.concat(isColumn ? 'column' : 'row').toString();\n        that._conditionalFormattingInfoCache = [];\n        if (collapse)\n            that._collapseStateCache[collapseStateKey] = true;\n        else\n            delete that._collapseStateCache[collapseStateKey];\n    };\n    pivotGridItem.prototype._resizeUnsafe = function () {\n        _super.prototype._resizeUnsafe.call(this);\n        this.pivotGridViewer && this.pivotGridViewer.resize();\n        this._styleSettingsProvider.updateBarWidth(PIVOT_BAR_ID);\n    };\n    pivotGridItem.prototype._getDataPoint = function (element) {\n        var that = this, viewModel = that.options.ViewModel;\n        return {\n            getValues: function (name) {\n                switch (name) {\n                    case item_data_axis_names_1.itemDataAxisNames.pivotRowAxis:\n                        return element.rowPath;\n                    case item_data_axis_names_1.itemDataAxisNames.pivotColumnAxis:\n                        return element.columnPath;\n                    default:\n                        return null;\n                }\n            },\n            getDeltaIds: function () {\n                return [];\n            },\n            getMeasureIds: function () {\n                var dataIndex = element.dataIndex;\n                if (dataIndex != undefined) {\n                    return [viewModel.Values[dataIndex].DataId];\n                }\n                return null;\n            }\n        };\n    };\n    pivotGridItem.prototype._getWidget = function () {\n        return this.pivotGridViewer;\n    };\n    pivotGridItem.prototype._onCellPrepared = function (element) {\n        var styleSettingsInfo, isMeasureHeader = (element.area === _utils_1.pivotArea.column || element.area === _utils_1.pivotArea.row) && element.cell.dataIndex !== undefined, cellItem = {\n            area: element.area\n        };\n        if (!isMeasureHeader) {\n            if (element.area === _utils_1.pivotArea.column) {\n                cellItem.columnPath = element.cell.path;\n                cellItem.columnType = element.cell.type;\n            }\n            else if (element.area === _utils_1.pivotArea.row) {\n                cellItem.rowPath = element.cell.path;\n                cellItem.rowType = element.cell.type;\n            }\n            else {\n                cellItem.columnPath = element.cell.columnPath;\n                cellItem.rowPath = element.cell.rowPath;\n                cellItem.cellIndex = element.cell.dataIndex;\n                cellItem.columnType = element.cell.columnType;\n                cellItem.rowType = element.cell.rowType;\n            }\n            styleSettingsInfo = this._dataController.getStyleSettingsInfo(cellItem, this._collapseStateCache, this._conditionalFormattingInfoCache, this._pointsCache);\n            this._styleSettingsProvider.applyStyleSettings(_jquery_helpers_1.$unwrap(element.cellElement), this.options.controlContainer, styleSettingsInfo, false, PIVOT_BAR_ID);\n        }\n    };\n    pivotGridItem.prototype._getFields = function () {\n        if (!this._viewModel) {\n            return undefined;\n        }\n        var columnFields = _pivot_grid_item_helper_1.pivotHelper.createAreaFields(this._viewModel.Columns, 'column', this._viewModel.AutoExpandColumnGroups);\n        for (var i = 0; i < this._viewModel.Columns.length; i++) {\n            columnFields[i].showTotals = this._viewModel.Columns[i].ShowTotals;\n        }\n        var rowFields = _pivot_grid_item_helper_1.pivotHelper.createAreaFields(this._viewModel.Rows, 'row', this._viewModel.AutoExpandRowGroups);\n        for (var i = 0; i < this._viewModel.Rows.length; i++) {\n            rowFields[i].showTotals = this._viewModel.Rows[i].ShowTotals;\n        }\n        var dataFields = _pivot_grid_item_helper_1.pivotHelper.createAreaFields(this._viewModel.Values, 'data');\n        for (var i = 0; i < this._viewModel.Values.length; i++) {\n            dataFields[i].showValues = this._viewModel.Values[i].ShowValues;\n            dataFields[i].showTotals = this._viewModel.Values[i].ShowTotals;\n            dataFields[i].showGrandTotals = this._viewModel.Values[i].ShowGrandTotals;\n        }\n        return columnFields\n            .concat(rowFields)\n            .concat(dataFields);\n    };\n    pivotGridItem.prototype._createAndLoadDataSource = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            var fields = _this._getFields();\n            var firstRequest = true;\n            var dataSource = new data_source_1.default({\n                remoteOperations: true,\n                fields: fields,\n                retrieveFields: false,\n                load: function (loadOptions) {\n                    if (firstRequest) {\n                        firstRequest = false;\n                        return [_pivot_grid_item_helper_1.pivotHelper.getSchemaRow(fields)];\n                    }\n                    else {\n                        return _this._dataUpdateHook ? _this._dataUpdateHook.then(function () { return _this._getLoadData(loadOptions); }) : _jquery_helpers_1.createJQueryDeferred().reject().promise();\n                    }\n                }\n            });\n            dataSource.state(_this._loadState(fields));\n            dataSource.on('loadingChanged', function (args) {\n                if (!dataSource.isLoading()) {\n                    resolve({ dataSource: dataSource, fields: fields });\n                }\n            });\n        });\n    };\n    pivotGridItem.prototype._getLoadData = function (loadOptions) {\n        var _this = this;\n        if (!this._multiData || this._multiData.isEmpty()) {\n            return undefined;\n        }\n        var group = loadOptions.group;\n        var groupSummary = loadOptions.groupSummary;\n        var totalSummary = loadOptions.totalSummary;\n        var filter = _pivot_grid_item_helper_1.OneElementFilterRemover.simplify(loadOptions.filter);\n        var availableByArea = {\n            columns: _pivot_grid_item_helper_1.pivotHelper.getColumnAxis(this._multiData).getDimensions().map(function (c) { return c.id; }),\n            rows: _pivot_grid_item_helper_1.pivotHelper.getRowAxis(this._multiData).getDimensions().map(function (r) { return r.id; })\n        };\n        var filteredFields = _pivot_grid_item_helper_1.FieldsExtractor.extract(filter);\n        var filteredByArea = {\n            columns: filteredFields\n                .filter(function (f) { return availableByArea.columns.filter(function (c) { return c === f; })[0] != undefined; })\n                .sort(function (a, b) { return availableByArea.columns.indexOf(a) - availableByArea.columns.indexOf(b); }),\n            rows: filteredFields\n                .filter(function (f) { return availableByArea.rows.filter(function (c) { return c === f; })[0] != undefined; })\n                .sort(function (a, b) { return availableByArea.rows.indexOf(a) - availableByArea.rows.indexOf(b); })\n        };\n        var groupedFields = group ? group.map(function (g) { return g.selector; }) : [];\n        var groupedByArea = {\n            columns: groupedFields.filter(function (f) { return availableByArea.columns.filter(function (c) { return c === f; })[0] != undefined; }),\n            rows: groupedFields.filter(function (f) { return availableByArea.rows.filter(function (c) { return c === f; })[0] != undefined; })\n        };\n        var firstIndexInGroup = {\n            column: _utils_1.findIndex(groupedFields, function (f) { return availableByArea.columns.filter(function (c) { return c === f; })[0] !== undefined; }),\n            row: _utils_1.findIndex(groupedFields, function (f) { return availableByArea.rows.filter(function (c) { return c === f; })[0] !== undefined; })\n        };\n        var onlyFilteredByArea = {\n            columns: _utils_1.distinct(_utils_1.minus(filteredByArea.columns, groupedByArea.columns)),\n            rows: _utils_1.distinct(_utils_1.minus(filteredByArea.rows, groupedByArea.rows))\n        };\n        var fields;\n        if (firstIndexInGroup.column === -1) {\n            fields = onlyFilteredByArea.rows.concat(groupedFields).concat(onlyFilteredByArea.columns);\n        }\n        else if (firstIndexInGroup.row === -1) {\n            fields = onlyFilteredByArea.columns.concat(groupedFields).concat(onlyFilteredByArea.rows);\n        }\n        else if (firstIndexInGroup.column < firstIndexInGroup.row) {\n            fields = onlyFilteredByArea.columns\n                .concat(groupedFields.slice(firstIndexInGroup.column, firstIndexInGroup.row))\n                .concat(onlyFilteredByArea.rows)\n                .concat(groupedFields.slice(firstIndexInGroup.row));\n        }\n        else {\n            fields = onlyFilteredByArea.rows\n                .concat(groupedFields.slice(firstIndexInGroup.row, firstIndexInGroup.column))\n                .concat(onlyFilteredByArea.columns)\n                .concat(groupedFields.slice(firstIndexInGroup.column));\n        }\n        var columnRoot = _pivot_grid_item_helper_1.pivotHelper.getColumnAxis(this._multiData).getRootPoint();\n        var rowRoot = _pivot_grid_item_helper_1.pivotHelper.getRowAxis(this._multiData).getRootPoint();\n        var getItems = function (index, isColumn, point, oppositePoint, dimensionValues) {\n            var isLastGrouping = index + 1 >= fields.length;\n            var items = [];\n            var children = point.getChildren();\n            var nextLevelIsColumn;\n            var changeAreas;\n            var name = fields[index];\n            var onlyFiltered = isColumn ? onlyFilteredByArea.columns : onlyFilteredByArea.rows;\n            var isOnlyFiltered = onlyFiltered.filter(function (f) { return f === name; })[0] !== undefined;\n            if (!isLastGrouping) {\n                nextLevelIsColumn = availableByArea.columns.filter(function (c) { return c === fields[index + 1]; })[0] !== undefined;\n                changeAreas = isColumn && !nextLevelIsColumn || !isColumn && nextLevelIsColumn;\n            }\n            var areaCache = isColumn ? _this._pointsCache.columns : _this._pointsCache.rows;\n            var _loop_1 = function (i) {\n                var _a;\n                var child = children[i];\n                areaCache[child.getUniquePath().toString()] = child;\n                var value = child.getUniqueValue();\n                var dimVals = __assign(__assign({}, dimensionValues), (_a = {}, _a[name] = value, _a));\n                if (filter && !_pivot_grid_item_helper_1.FilterChecker.fits(dimVals, filter))\n                    return \"continue\";\n                var subItems = void 0;\n                if (!isLastGrouping) {\n                    var nextLevelPoint = child;\n                    var nextLevelOppositePoint = oppositePoint;\n                    if (changeAreas) {\n                        nextLevelPoint = oppositePoint;\n                        nextLevelOppositePoint = child;\n                    }\n                    subItems = getItems(index + 1, nextLevelIsColumn, nextLevelPoint, nextLevelOppositePoint, dimVals);\n                }\n                else {\n                    subItems = null;\n                }\n                if (isOnlyFiltered) {\n                    if (subItems && subItems.length > 0)\n                        items = items.concat(subItems);\n                }\n                else {\n                    items.push({\n                        key: value,\n                        displayText: value === special_values_1.specialValues.olapNullValueGuid ? _localizer_1.localizer.getString(_localization_ids_1.localizationId.OlapRaggedHierarchyNoneItemCaption) : child.getDisplayText(),\n                        items: subItems,\n                        summary: groupSummary.map(function (s) {\n                            return _this._multiData.getMeasureValueByAxisPoints(s.selector, [child, oppositePoint]).getDisplayText();\n                        })\n                    });\n                }\n            };\n            for (var i = 0; i < children.length; i++) {\n                _loop_1(i);\n            }\n            return items.length !== 0 ? items : null;\n        };\n        var res = {};\n        if (groupedFields && groupedFields.length > 0) {\n            var isColumn = !!availableByArea.columns.filter(function (c) { return c === fields[0]; })[0];\n            res.data = getItems(0, isColumn, isColumn ? columnRoot : rowRoot, isColumn ? rowRoot : columnRoot, {}) || [];\n        }\n        else {\n            res.data = [_pivot_grid_item_helper_1.pivotHelper.getSchemaRow(this._getFields())];\n        }\n        if (totalSummary)\n            res.summary = totalSummary.map(function (s) {\n                return _this._multiData.getMeasureValueByAxisPoints(s.selector, [columnRoot, rowRoot]).getDisplayText();\n            });\n        return res;\n    };\n    return pivotGridItem;\n}(_base_item_1.baseItem));\nexports.pivotGridItem = pivotGridItem;\n"]},"metadata":{},"sourceType":"script"}