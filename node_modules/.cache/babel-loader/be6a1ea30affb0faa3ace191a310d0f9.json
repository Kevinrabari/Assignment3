{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_card-item-format-rule-properties-composer.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.cardItemConditionTypeFilters = exports.createCardItemDeltaFormatRulePropertiesComposer = exports.isDeltaFormatRuleAvaliable = exports.createCardItemFormatRulePropertiesComposer = exports.isDataItemFormatRuleAvaliable = void 0;\n\nvar ko = require(\"knockout\");\n\nvar _default_1 = require(\"../../../../data/localization/_default\");\n\nvar model_1 = require(\"../../../../model\");\n\nvar card_item_delta_format_rule_1 = require(\"../../../../model/format-rules/card-item-delta-format-rule\");\n\nvar card_item_format_rule_1 = require(\"../../../../model/format-rules/card-item-format-rule\");\n\nvar _card_format_rule_row_element_1 = require(\"../../../../model/format-rules/metadata/_card-format-rule-row-element\");\n\nvar _card_item_delta_format_rule_1 = require(\"../../../../model/format-rules/metadata/_card-item-delta-format-rule\");\n\nvar _card_item_format_rule_1 = require(\"../../../../model/format-rules/metadata/_card-item-format-rule\");\n\nvar _card_item_format_rule_base_1 = require(\"../../../../model/format-rules/metadata/_card-item-format-rule-base\");\n\nvar _card_layout_template_element_1 = require(\"../../../../model/items/card/metadata/_card-layout-template-element\");\n\nvar _delta_options_1 = require(\"../../../../model/items/options/metadata/_delta-options\");\n\nvar _base_metadata_1 = require(\"../../../../model/metadata/_base-metadata\");\n\nvar _form_adapter_editors_1 = require(\"../../../form-adapter/_form-adapter-editors\");\n\nvar _display_name_provider_1 = require(\"../../../_display-name-provider\");\n\nvar _shared_format_rule_properties_composer_1 = require(\"./_shared-format-rule-properties-composer\");\n\nfunction getCardItemFormatRuleDataItems(dashboardItem) {\n  return dashboardItem.seriesDimensions().concat(dashboardItem.hiddenMeasures());\n}\n\nfunction isDataItemFormatRuleAvaliable(dashboardItem) {\n  return getCardItemFormatRuleDataItems(dashboardItem).length > 0;\n}\n\nexports.isDataItemFormatRuleAvaliable = isDataItemFormatRuleAvaliable;\n\nfunction createCardItemFormatRulePropertiesComposer(selectedRuleContainer) {\n  return new _shared_format_rule_properties_composer_1.FormatRulePropertiesComposer({\n    createDataTypeObservable: _shared_format_rule_properties_composer_1.createDataTypeObservable,\n    getCommonFormatRuleProperties: function (formatRule, dashboardItem, dataSourceBrowser) {\n      var propertiesInfo = {\n        properties: [],\n        disabledFilterRules: {},\n        dynamicEditorRules: {},\n        visibilityFilterRules: {}\n      };\n      var dataItems = getCardItemFormatRuleDataItems(dashboardItem);\n      var dataItemsDisplayText = ko.pureComputed(function () {\n        return dataItems.map(function (dataItem) {\n          return {\n            value: dataItem.uniqueName(),\n            displayValueId: _display_name_provider_1.getDataItemDisplayName(dataSourceBrowser, dashboardItem, dataItem)\n          };\n        });\n      });\n\n      if (!formatRule.dataItemName() && dataItems.length) {\n        formatRule.dataItemName(dataItems[0].uniqueName());\n      }\n\n      propertiesInfo.properties.push(__assign(__assign({}, _card_item_format_rule_1.cardItemformatRuleDataItem), {\n        formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({\n          values: dataItemsDisplayText\n        })\n      }));\n      return getCommonCardFormatRuleProperties(formatRule, dashboardItem, propertiesInfo, selectedRuleContainer);\n    },\n    getMiscFormatRuleProperties: function () {\n      return {\n        properties: []\n      };\n    },\n    conditionTypeFilter: exports.cardItemConditionTypeFilters,\n    getConditionFormatRuleProperties: getConditionFormatRuleProperties\n  });\n}\n\nexports.createCardItemFormatRulePropertiesComposer = createCardItemFormatRulePropertiesComposer;\n\nfunction cardItemDeltaFormatRuleCards(dashboardItem) {\n  return dashboardItem.cards();\n}\n\nfunction isDeltaFormatRuleAvaliable(dashboardItem) {\n  return cardItemDeltaFormatRuleCards(dashboardItem).length > 0;\n}\n\nexports.isDeltaFormatRuleAvaliable = isDeltaFormatRuleAvaliable;\n\nfunction createCardItemDeltaFormatRulePropertiesComposer(selectedRuleContainer) {\n  return new _shared_format_rule_properties_composer_1.FormatRulePropertiesComposer({\n    createDataTypeObservable: _shared_format_rule_properties_composer_1.createDeltaDataTypeObservable,\n    getCommonFormatRuleProperties: function (formatRule, dashboardItem, dataSourceBrowser, requestRecalculation) {\n      var propertiesInfo = {\n        properties: [],\n        disabledFilterRules: {},\n        dynamicEditorRules: {},\n        visibilityFilterRules: {}\n      };\n      var card = cardItemDeltaFormatRuleCards(dashboardItem);\n      var cardsDisplayText = ko.pureComputed(function () {\n        return card.map(function (card) {\n          return {\n            value: card._getDataId(),\n            displayValueId: _display_name_provider_1.getDataItemContainerDisplayName(dataSourceBrowser, dashboardItem, card)\n          };\n        });\n      });\n\n      if (!formatRule.cardId() && cardsDisplayText().length) {\n        formatRule.cardId(cardsDisplayText()[0].value);\n      }\n\n      propertiesInfo.disabledFilterRules[_card_item_delta_format_rule_1.cardId.propertyName] = function (_) {\n        return !!formatRule.condition();\n      };\n\n      propertiesInfo.disabledFilterRules[_card_item_delta_format_rule_1.deltaValueType.propertyName] = function (_) {\n        return !!formatRule.condition();\n      };\n\n      propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.cardId), {\n        formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({\n          values: cardsDisplayText\n        })\n      }));\n      propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.deltaValueType), {\n        simpleFormAdapterItem: 'selectBoxEditor',\n        values: _delta_options_1.deltaValueTypeMap\n      }));\n      propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.deltaValueType), {\n        replacementPropertyName: 'fakeDeltaValueTypeActual',\n        sourceObject: ko.observable('ActualValue'),\n        simpleFormAdapterItem: 'selectBoxEditor',\n        values: {\n          'ActualValue': 'DashboardStringId.DeltaValueTypeActualValueCaption'\n        }\n      }));\n      propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.deltaValueType), {\n        sourceObject: ko.observable('TargetValue'),\n        replacementPropertyName: 'fakeDeltaValueTypeTarget',\n        simpleFormAdapterItem: 'selectBoxEditor',\n        values: {\n          'TargetValue': 'DashboardStringId.DeltaValueTypeTargetValueCaption'\n        }\n      }));\n\n      var getActualCard = function () {\n        return dashboardItem.cards().filter(function (card) {\n          return card._getDataId() === formatRule.cardId();\n        })[0];\n      };\n\n      var hasActualDataItem = function () {\n        return !!getActualCard().actualValue();\n      };\n\n      var hasTargetDataItem = function () {\n        return !!getActualCard().targetValue();\n      };\n\n      requestRecalculation.add(function (_) {\n        if (dashboardItem.formatRules.indexOf(formatRule) === -1) {\n          if (hasActualDataItem() && !hasTargetDataItem()) formatRule.deltaValueType('ActualValue');else if (!hasActualDataItem() && hasTargetDataItem()) {\n            formatRule.deltaValueType('TargetValue');\n          }\n        }\n      });\n\n      propertiesInfo.visibilityFilterRules[_card_item_delta_format_rule_1.deltaValueType.propertyName] = function (_) {\n        return hasActualDataItem() && hasTargetDataItem();\n      };\n\n      propertiesInfo.visibilityFilterRules['fakeDeltaValueTypeActual'] = function (_) {\n        return hasActualDataItem() && !hasTargetDataItem();\n      };\n\n      propertiesInfo.visibilityFilterRules['fakeDeltaValueTypeTarget'] = function (_) {\n        return !hasActualDataItem() && hasTargetDataItem();\n      };\n\n      propertiesInfo.disabledFilterRules['fakeDeltaValueTypeActual'] = function (_) {\n        return true;\n      };\n\n      propertiesInfo.disabledFilterRules['fakeDeltaValueTypeTarget'] = function (_) {\n        return true;\n      };\n\n      return getCommonCardFormatRuleProperties(formatRule, dashboardItem, propertiesInfo, selectedRuleContainer);\n    },\n    getConditionFormatRuleProperties: getConditionFormatRuleProperties,\n    getMiscFormatRuleProperties: function () {\n      return {\n        properties: []\n      };\n    },\n    conditionTypeFilter: exports.cardItemConditionTypeFilters\n  });\n}\n\nexports.createCardItemDeltaFormatRulePropertiesComposer = createCardItemDeltaFormatRulePropertiesComposer;\n\nfunction getConditionFormatRuleProperties(formatRule, dashboardItem, dataSourceBrowser) {\n  var layoutElementTypeValues = Object.keys(_card_layout_template_element_1.сardFormatRuleLayoutElementValuesMap).map(function (key) {\n    return {\n      value: key,\n      displayValue: _default_1.getLocalizationById(_card_layout_template_element_1.сardFormatRuleLayoutElementValuesMap[key])\n    };\n  });\n  layoutElementTypeValues.push({\n    value: 'Dimension',\n    displayValue: _default_1.getLocalizationById('DashboardWebStringId.FormatRuleApplyToDimensionElement')\n  });\n  layoutElementTypeValues.push({\n    value: 'Text',\n    displayValue: _default_1.getLocalizationById('DashboardWebStringId.FormatRuleApplyToTextElement')\n  });\n  var textEditorValues = getAllApplyToTextElements(formatRule, dashboardItem);\n  var dimensionEditorValues = dashboardItem.seriesDimensions().map(function (dimension) {\n    return {\n      value: dimension.uniqueName(),\n      displayValue: _display_name_provider_1.getDataItemDisplayName(dataSourceBrowser, dashboardItem, dimension)\n    };\n  });\n  var visibilityFilterRules = {};\n\n  visibilityFilterRules[_card_format_rule_row_element_1.dimensionId.propertyName] = function (model) {\n    return model.elementTypeApplyTo() === 'Dimension';\n  };\n\n  visibilityFilterRules[_card_format_rule_row_element_1.textId.propertyName] = function (model) {\n    return model.elementTypeApplyTo() === 'Text';\n  };\n\n  var properties = [{\n    container: _card_item_format_rule_base_1.cardLayoutElement,\n    properties: [__assign(__assign({}, _card_format_rule_row_element_1.elementTypeApplyTo), {\n      valuesArray: layoutElementTypeValues\n    }), __assign(__assign({}, _card_format_rule_row_element_1.dimensionId), {\n      valuesArray: dimensionEditorValues\n    }), __assign(__assign({}, _card_format_rule_row_element_1.textId), {\n      valuesArray: textEditorValues\n    })]\n  }];\n  return {\n    properties: properties,\n    disabledFilterRules: {},\n    dynamicEditorRules: {},\n    visibilityFilterRules: visibilityFilterRules\n  };\n}\n\nfunction getAllApplyToTextElements(formatRule, dashboardItem) {\n  var isExpressionRule = formatRule.condition() instanceof model_1.FormatConditionExpression;\n  var isHiddenMeasureRule = formatRule instanceof card_item_format_rule_1.CardItemFormatRule && dashboardItem.hiddenMeasures().filter(function (measure) {\n    return measure.uniqueName() === formatRule.dataItemName();\n  }).length > 0;\n  var affectedCards = isExpressionRule || isHiddenMeasureRule ? dashboardItem.cards() : [dashboardItem.cards()[dashboardItem._selectedElementIndex() || 0]];\n  return affectedCards.map(function (card) {\n    return getCardApplyToTextElements(card);\n  }).reduce(function (prev, curr) {\n    return __spreadArray(__spreadArray([], prev), curr);\n  });\n}\n\nfunction getCardApplyToTextElements(card) {\n  var textElements = getCardRows(card).map(function (row) {\n    return row.elements().filter(function (element) {\n      return element instanceof model_1.CardRowTextElement;\n    });\n  });\n\n  if (textElements.length > 0) {\n    return textElements.reduce(function (prev, current) {\n      return __spreadArray(__spreadArray([], prev), current);\n    }).map(function (textElement) {\n      return {\n        value: textElement.text(),\n        displayValue: textElement.text()\n      };\n    });\n  } else return [];\n}\n\nfunction getCardRows(card) {\n  var layoutTemplate = card.layoutTemplate();\n  var layout = layoutTemplate ? layoutTemplate.layout : null;\n  return layout ? layout.rows().filter(function (element) {\n    return element instanceof model_1.CardRow;\n  }) : [];\n}\n\nexports.cardItemConditionTypeFilters = {\n  conditionTypeFilter: function (conditionTypePropertyName) {\n    return ['conditionBar', 'conditionColorRangeBar', 'conditionGradientRangeBar'].indexOf(conditionTypePropertyName) === -1;\n  }\n};\n\nfunction getCommonCardFormatRuleProperties(formatRule, dashboardItem, calculatedByProperties, selectedRuleContainer) {\n  var _a;\n\n  var propertiesInfo = {\n    properties: [],\n    disabledFilterRules: {},\n    dynamicEditorRules: {},\n    visibilityFilterRules: {}\n  };\n  var selectedRuleType = ko.observable(formatRule.itemType());\n  selectedRuleType.subscribe(function (newSelectedContainer) {\n    if (newSelectedContainer === 'CardItemFormatRule') {\n      selectedRuleContainer(new card_item_format_rule_1.CardItemFormatRule());\n    } else if (newSelectedContainer === 'CardItemDeltaFormatRule') {\n      selectedRuleContainer(new card_item_delta_format_rule_1.CardItemDeltaFormatRule());\n    }\n  });\n  propertiesInfo.properties.push(__assign(__assign({}, _base_metadata_1.itemType), {\n    sourceObject: selectedRuleType,\n    replacementPropertyName: 'selectedContainer',\n    displayName: 'DashboardWebStringId.ConditionalFormatting.CalculatedBy',\n    formAdapterItem: _form_adapter_editors_1.buttonGroupEditor([{\n      displayValueId: 'DashboardWebStringId.ConditionalFormatting.CardRuleTypeCard',\n      value: 'CardItemDeltaFormatRule'\n    }, {\n      displayValueId: 'DashboardWebStringId.ConditionalFormatting.CardRuleTypeDataItem',\n      value: 'CardItemFormatRule'\n    }])\n  }));\n\n  propertiesInfo.disabledFilterRules['selectedContainer'] = function (m) {\n    return !!formatRule.condition() || !isDeltaFormatRuleAvaliable(dashboardItem) || !isDataItemFormatRuleAvaliable(dashboardItem);\n  };\n\n  (_a = propertiesInfo.properties).push.apply(_a, calculatedByProperties.properties);\n\n  propertiesInfo.disabledFilterRules = __assign(__assign({}, propertiesInfo.disabledFilterRules), calculatedByProperties.disabledFilterRules);\n  propertiesInfo.dynamicEditorRules = __assign(__assign({}, propertiesInfo.dynamicEditorRules), calculatedByProperties.dynamicEditorRules);\n  propertiesInfo.visibilityFilterRules = __assign(__assign({}, propertiesInfo.visibilityFilterRules), calculatedByProperties.visibilityFilterRules);\n  return propertiesInfo;\n}","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/conditional-formatting/items/properties-composers/_card-item-format-rule-properties-composer.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","il","j","defineProperty","exports","value","cardItemConditionTypeFilters","createCardItemDeltaFormatRulePropertiesComposer","isDeltaFormatRuleAvaliable","createCardItemFormatRulePropertiesComposer","isDataItemFormatRuleAvaliable","ko","require","_default_1","model_1","card_item_delta_format_rule_1","card_item_format_rule_1","_card_format_rule_row_element_1","_card_item_delta_format_rule_1","_card_item_format_rule_1","_card_item_format_rule_base_1","_card_layout_template_element_1","_delta_options_1","_base_metadata_1","_form_adapter_editors_1","_display_name_provider_1","_shared_format_rule_properties_composer_1","getCardItemFormatRuleDataItems","dashboardItem","seriesDimensions","concat","hiddenMeasures","selectedRuleContainer","FormatRulePropertiesComposer","createDataTypeObservable","getCommonFormatRuleProperties","formatRule","dataSourceBrowser","propertiesInfo","properties","disabledFilterRules","dynamicEditorRules","visibilityFilterRules","dataItems","dataItemsDisplayText","pureComputed","map","dataItem","uniqueName","displayValueId","getDataItemDisplayName","dataItemName","push","cardItemformatRuleDataItem","formAdapterItem","dynamicSelectBoxEditor","values","getCommonCardFormatRuleProperties","getMiscFormatRuleProperties","conditionTypeFilter","getConditionFormatRuleProperties","cardItemDeltaFormatRuleCards","cards","createDeltaDataTypeObservable","requestRecalculation","card","cardsDisplayText","_getDataId","getDataItemContainerDisplayName","cardId","propertyName","_","condition","deltaValueType","simpleFormAdapterItem","deltaValueTypeMap","replacementPropertyName","sourceObject","observable","getActualCard","filter","hasActualDataItem","actualValue","hasTargetDataItem","targetValue","add","formatRules","indexOf","layoutElementTypeValues","keys","сardFormatRuleLayoutElementValuesMap","key","displayValue","getLocalizationById","textEditorValues","getAllApplyToTextElements","dimensionEditorValues","dimension","dimensionId","model","elementTypeApplyTo","textId","container","cardLayoutElement","valuesArray","isExpressionRule","FormatConditionExpression","isHiddenMeasureRule","CardItemFormatRule","measure","affectedCards","_selectedElementIndex","getCardApplyToTextElements","reduce","prev","curr","textElements","getCardRows","row","elements","element","CardRowTextElement","current","textElement","text","layoutTemplate","layout","rows","CardRow","conditionTypePropertyName","calculatedByProperties","_a","selectedRuleType","itemType","subscribe","newSelectedContainer","CardItemDeltaFormatRule","displayName","buttonGroupEditor","m"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_card-item-format-rule-properties-composer.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.cardItemConditionTypeFilters = exports.createCardItemDeltaFormatRulePropertiesComposer = exports.isDeltaFormatRuleAvaliable = exports.createCardItemFormatRulePropertiesComposer = exports.isDataItemFormatRuleAvaliable = void 0;\nvar ko = require(\"knockout\");\nvar _default_1 = require(\"../../../../data/localization/_default\");\nvar model_1 = require(\"../../../../model\");\nvar card_item_delta_format_rule_1 = require(\"../../../../model/format-rules/card-item-delta-format-rule\");\nvar card_item_format_rule_1 = require(\"../../../../model/format-rules/card-item-format-rule\");\nvar _card_format_rule_row_element_1 = require(\"../../../../model/format-rules/metadata/_card-format-rule-row-element\");\nvar _card_item_delta_format_rule_1 = require(\"../../../../model/format-rules/metadata/_card-item-delta-format-rule\");\nvar _card_item_format_rule_1 = require(\"../../../../model/format-rules/metadata/_card-item-format-rule\");\nvar _card_item_format_rule_base_1 = require(\"../../../../model/format-rules/metadata/_card-item-format-rule-base\");\nvar _card_layout_template_element_1 = require(\"../../../../model/items/card/metadata/_card-layout-template-element\");\nvar _delta_options_1 = require(\"../../../../model/items/options/metadata/_delta-options\");\nvar _base_metadata_1 = require(\"../../../../model/metadata/_base-metadata\");\nvar _form_adapter_editors_1 = require(\"../../../form-adapter/_form-adapter-editors\");\nvar _display_name_provider_1 = require(\"../../../_display-name-provider\");\nvar _shared_format_rule_properties_composer_1 = require(\"./_shared-format-rule-properties-composer\");\nfunction getCardItemFormatRuleDataItems(dashboardItem) {\n    return dashboardItem.seriesDimensions().concat(dashboardItem.hiddenMeasures());\n}\nfunction isDataItemFormatRuleAvaliable(dashboardItem) {\n    return getCardItemFormatRuleDataItems(dashboardItem).length > 0;\n}\nexports.isDataItemFormatRuleAvaliable = isDataItemFormatRuleAvaliable;\nfunction createCardItemFormatRulePropertiesComposer(selectedRuleContainer) {\n    return new _shared_format_rule_properties_composer_1.FormatRulePropertiesComposer({\n        createDataTypeObservable: _shared_format_rule_properties_composer_1.createDataTypeObservable,\n        getCommonFormatRuleProperties: function (formatRule, dashboardItem, dataSourceBrowser) {\n            var propertiesInfo = {\n                properties: [],\n                disabledFilterRules: {},\n                dynamicEditorRules: {},\n                visibilityFilterRules: {}\n            };\n            var dataItems = getCardItemFormatRuleDataItems(dashboardItem);\n            var dataItemsDisplayText = ko.pureComputed(function () {\n                return dataItems.map(function (dataItem) {\n                    return {\n                        value: dataItem.uniqueName(),\n                        displayValueId: _display_name_provider_1.getDataItemDisplayName(dataSourceBrowser, dashboardItem, dataItem)\n                    };\n                });\n            });\n            if (!formatRule.dataItemName() && dataItems.length) {\n                formatRule.dataItemName(dataItems[0].uniqueName());\n            }\n            propertiesInfo.properties.push(__assign(__assign({}, _card_item_format_rule_1.cardItemformatRuleDataItem), { formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({ values: dataItemsDisplayText }) }));\n            return getCommonCardFormatRuleProperties(formatRule, dashboardItem, propertiesInfo, selectedRuleContainer);\n        },\n        getMiscFormatRuleProperties: function () { return ({ properties: [] }); },\n        conditionTypeFilter: exports.cardItemConditionTypeFilters,\n        getConditionFormatRuleProperties: getConditionFormatRuleProperties,\n    });\n}\nexports.createCardItemFormatRulePropertiesComposer = createCardItemFormatRulePropertiesComposer;\nfunction cardItemDeltaFormatRuleCards(dashboardItem) {\n    return dashboardItem.cards();\n}\nfunction isDeltaFormatRuleAvaliable(dashboardItem) {\n    return cardItemDeltaFormatRuleCards(dashboardItem).length > 0;\n}\nexports.isDeltaFormatRuleAvaliable = isDeltaFormatRuleAvaliable;\nfunction createCardItemDeltaFormatRulePropertiesComposer(selectedRuleContainer) {\n    return new _shared_format_rule_properties_composer_1.FormatRulePropertiesComposer({\n        createDataTypeObservable: _shared_format_rule_properties_composer_1.createDeltaDataTypeObservable,\n        getCommonFormatRuleProperties: function (formatRule, dashboardItem, dataSourceBrowser, requestRecalculation) {\n            var propertiesInfo = {\n                properties: [],\n                disabledFilterRules: {},\n                dynamicEditorRules: {},\n                visibilityFilterRules: {}\n            };\n            var card = cardItemDeltaFormatRuleCards(dashboardItem);\n            var cardsDisplayText = ko.pureComputed(function () {\n                return card.map(function (card) {\n                    return {\n                        value: card._getDataId(),\n                        displayValueId: _display_name_provider_1.getDataItemContainerDisplayName(dataSourceBrowser, dashboardItem, card)\n                    };\n                });\n            });\n            if (!formatRule.cardId() && cardsDisplayText().length) {\n                formatRule.cardId(cardsDisplayText()[0].value);\n            }\n            propertiesInfo.disabledFilterRules[_card_item_delta_format_rule_1.cardId.propertyName] = function (_) { return !!formatRule.condition(); };\n            propertiesInfo.disabledFilterRules[_card_item_delta_format_rule_1.deltaValueType.propertyName] = function (_) { return !!formatRule.condition(); };\n            propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.cardId), { formAdapterItem: _form_adapter_editors_1.dynamicSelectBoxEditor({ values: cardsDisplayText }) }));\n            propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.deltaValueType), { simpleFormAdapterItem: 'selectBoxEditor', values: _delta_options_1.deltaValueTypeMap }));\n            propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.deltaValueType), { replacementPropertyName: 'fakeDeltaValueTypeActual', sourceObject: ko.observable('ActualValue'), simpleFormAdapterItem: 'selectBoxEditor', values: { 'ActualValue': 'DashboardStringId.DeltaValueTypeActualValueCaption' } }));\n            propertiesInfo.properties.push(__assign(__assign({}, _card_item_delta_format_rule_1.deltaValueType), { sourceObject: ko.observable('TargetValue'), replacementPropertyName: 'fakeDeltaValueTypeTarget', simpleFormAdapterItem: 'selectBoxEditor', values: { 'TargetValue': 'DashboardStringId.DeltaValueTypeTargetValueCaption' } }));\n            var getActualCard = function () { return dashboardItem.cards().filter(function (card) { return card._getDataId() === formatRule.cardId(); })[0]; };\n            var hasActualDataItem = function () { return !!getActualCard().actualValue(); };\n            var hasTargetDataItem = function () { return !!getActualCard().targetValue(); };\n            requestRecalculation.add(function (_) {\n                if (dashboardItem.formatRules.indexOf(formatRule) === -1) {\n                    if (hasActualDataItem() && !hasTargetDataItem())\n                        formatRule.deltaValueType('ActualValue');\n                    else if (!hasActualDataItem() && hasTargetDataItem()) {\n                        formatRule.deltaValueType('TargetValue');\n                    }\n                }\n            });\n            propertiesInfo.visibilityFilterRules[_card_item_delta_format_rule_1.deltaValueType.propertyName] = function (_) { return hasActualDataItem() && hasTargetDataItem(); };\n            propertiesInfo.visibilityFilterRules['fakeDeltaValueTypeActual'] = function (_) { return hasActualDataItem() && !hasTargetDataItem(); };\n            propertiesInfo.visibilityFilterRules['fakeDeltaValueTypeTarget'] = function (_) { return !hasActualDataItem() && hasTargetDataItem(); };\n            propertiesInfo.disabledFilterRules['fakeDeltaValueTypeActual'] = function (_) { return true; };\n            propertiesInfo.disabledFilterRules['fakeDeltaValueTypeTarget'] = function (_) { return true; };\n            return getCommonCardFormatRuleProperties(formatRule, dashboardItem, propertiesInfo, selectedRuleContainer);\n        },\n        getConditionFormatRuleProperties: getConditionFormatRuleProperties,\n        getMiscFormatRuleProperties: function () { return ({ properties: [] }); },\n        conditionTypeFilter: exports.cardItemConditionTypeFilters\n    });\n}\nexports.createCardItemDeltaFormatRulePropertiesComposer = createCardItemDeltaFormatRulePropertiesComposer;\nfunction getConditionFormatRuleProperties(formatRule, dashboardItem, dataSourceBrowser) {\n    var layoutElementTypeValues = Object.keys(_card_layout_template_element_1.сardFormatRuleLayoutElementValuesMap).map(function (key) {\n        return { value: key, displayValue: _default_1.getLocalizationById(_card_layout_template_element_1.сardFormatRuleLayoutElementValuesMap[key]) };\n    });\n    layoutElementTypeValues.push({ value: 'Dimension', displayValue: _default_1.getLocalizationById('DashboardWebStringId.FormatRuleApplyToDimensionElement') });\n    layoutElementTypeValues.push({ value: 'Text', displayValue: _default_1.getLocalizationById('DashboardWebStringId.FormatRuleApplyToTextElement') });\n    var textEditorValues = getAllApplyToTextElements(formatRule, dashboardItem);\n    var dimensionEditorValues = dashboardItem.seriesDimensions().map(function (dimension) {\n        return { value: dimension.uniqueName(), displayValue: _display_name_provider_1.getDataItemDisplayName(dataSourceBrowser, dashboardItem, dimension) };\n    });\n    var visibilityFilterRules = {};\n    visibilityFilterRules[_card_format_rule_row_element_1.dimensionId.propertyName] = function (model) { return model.elementTypeApplyTo() === 'Dimension'; };\n    visibilityFilterRules[_card_format_rule_row_element_1.textId.propertyName] = function (model) { return model.elementTypeApplyTo() === 'Text'; };\n    var properties = [{\n            container: _card_item_format_rule_base_1.cardLayoutElement,\n            properties: [\n                __assign(__assign({}, _card_format_rule_row_element_1.elementTypeApplyTo), { valuesArray: layoutElementTypeValues }),\n                __assign(__assign({}, _card_format_rule_row_element_1.dimensionId), { valuesArray: dimensionEditorValues }),\n                __assign(__assign({}, _card_format_rule_row_element_1.textId), { valuesArray: textEditorValues })\n            ]\n        }];\n    return {\n        properties: properties,\n        disabledFilterRules: {},\n        dynamicEditorRules: {},\n        visibilityFilterRules: visibilityFilterRules\n    };\n}\nfunction getAllApplyToTextElements(formatRule, dashboardItem) {\n    var isExpressionRule = formatRule.condition() instanceof model_1.FormatConditionExpression;\n    var isHiddenMeasureRule = formatRule instanceof card_item_format_rule_1.CardItemFormatRule && dashboardItem.hiddenMeasures().filter(function (measure) { return measure.uniqueName() === formatRule.dataItemName(); }).length > 0;\n    var affectedCards = isExpressionRule || isHiddenMeasureRule ? dashboardItem.cards() : [(dashboardItem.cards()[dashboardItem._selectedElementIndex() || 0])];\n    return affectedCards.map(function (card) { return getCardApplyToTextElements(card); }).reduce(function (prev, curr) { return __spreadArray(__spreadArray([], prev), curr); });\n}\nfunction getCardApplyToTextElements(card) {\n    var textElements = getCardRows(card).map(function (row) { return row.elements().filter(function (element) { return element instanceof model_1.CardRowTextElement; }); });\n    if (textElements.length > 0) {\n        return textElements.reduce(function (prev, current) { return __spreadArray(__spreadArray([], prev), current); })\n            .map(function (textElement) {\n            return { value: textElement.text(), displayValue: textElement.text() };\n        });\n    }\n    else\n        return [];\n}\nfunction getCardRows(card) {\n    var layoutTemplate = card.layoutTemplate();\n    var layout = layoutTemplate ? layoutTemplate.layout : null;\n    return layout ? layout.rows().filter(function (element) { return element instanceof model_1.CardRow; }) : [];\n}\nexports.cardItemConditionTypeFilters = {\n    conditionTypeFilter: function (conditionTypePropertyName) {\n        return ['conditionBar', 'conditionColorRangeBar', 'conditionGradientRangeBar'].indexOf(conditionTypePropertyName) === -1;\n    }\n};\nfunction getCommonCardFormatRuleProperties(formatRule, dashboardItem, calculatedByProperties, selectedRuleContainer) {\n    var _a;\n    var propertiesInfo = {\n        properties: [],\n        disabledFilterRules: {},\n        dynamicEditorRules: {},\n        visibilityFilterRules: {}\n    };\n    var selectedRuleType = ko.observable(formatRule.itemType());\n    selectedRuleType.subscribe(function (newSelectedContainer) {\n        if (newSelectedContainer === 'CardItemFormatRule') {\n            selectedRuleContainer(new card_item_format_rule_1.CardItemFormatRule());\n        }\n        else if (newSelectedContainer === 'CardItemDeltaFormatRule') {\n            selectedRuleContainer(new card_item_delta_format_rule_1.CardItemDeltaFormatRule());\n        }\n    });\n    propertiesInfo.properties.push(__assign(__assign({}, _base_metadata_1.itemType), { sourceObject: selectedRuleType, replacementPropertyName: 'selectedContainer', displayName: 'DashboardWebStringId.ConditionalFormatting.CalculatedBy', formAdapterItem: _form_adapter_editors_1.buttonGroupEditor([\n            {\n                displayValueId: 'DashboardWebStringId.ConditionalFormatting.CardRuleTypeCard',\n                value: 'CardItemDeltaFormatRule'\n            },\n            {\n                displayValueId: 'DashboardWebStringId.ConditionalFormatting.CardRuleTypeDataItem',\n                value: 'CardItemFormatRule'\n            }\n        ]) }));\n    propertiesInfo.disabledFilterRules['selectedContainer'] = function (m) { return !!formatRule.condition() || !isDeltaFormatRuleAvaliable(dashboardItem) || !isDataItemFormatRuleAvaliable(dashboardItem); };\n    (_a = propertiesInfo.properties).push.apply(_a, calculatedByProperties.properties);\n    propertiesInfo.disabledFilterRules = __assign(__assign({}, propertiesInfo.disabledFilterRules), calculatedByProperties.disabledFilterRules);\n    propertiesInfo.dynamicEditorRules = __assign(__assign({}, propertiesInfo.dynamicEditorRules), calculatedByProperties.dynamicEditorRules);\n    propertiesInfo.visibilityFilterRules = __assign(__assign({}, propertiesInfo.visibilityFilterRules), calculatedByProperties.visibilityFilterRules);\n    return propertiesInfo;\n}\n"]},"metadata":{},"sourceType":"script"}