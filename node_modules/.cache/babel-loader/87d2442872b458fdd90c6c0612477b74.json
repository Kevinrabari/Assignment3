{"ast":null,"code":"/**\n* DevExpress Analytics (core\\dragDrop\\_selectionDragDropHandler.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SelectionDragDropHandler = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nrequire(\"jquery-ui/ui/widgets/draggable\");\n\nrequire(\"jquery-ui/ui/widgets/resizable\");\n\nrequire(\"jquery-ui/ui/widgets/selectable\");\n\nrequire(\"jquery-ui/ui/widgets/mouse\");\n\nvar _dragDropHandler_1 = require(\"./_dragDropHandler\");\n\nvar _surfaceHelpers_1 = require(\"../internal/_surfaceHelpers\");\n\nvar SelectionDragDropHandler = function (_super) {\n  __extends(SelectionDragDropHandler, _super);\n\n  function SelectionDragDropHandler(surface, selection, undoEngine, snapHelper, dragHelperContent) {\n    var _this = _super.call(this, surface, selection, undoEngine, snapHelper, dragHelperContent) || this;\n\n    _this.cursor = 'move';\n    _this.containment = '.dxrd-ghost-container';\n\n    _this['helper'] = function (draggable) {\n      _super.prototype.helper.call(_this, draggable);\n\n      if (_this.selection.selectedItems.indexOf(draggable) === -1) {\n        _this.selection.updateSelection(draggable);\n      }\n\n      dragHelperContent.update(draggable);\n\n      _this._size.width(dragHelperContent.width());\n\n      _this._size.height(dragHelperContent.height());\n    };\n\n    return _this;\n  }\n\n  SelectionDragDropHandler.prototype.adjustDropTarget = function (dropTargetSurface) {\n    var selectedItemInTree = dropTargetSurface;\n\n    while (selectedItemInTree != null) {\n      if (selectedItemInTree.selected && selectedItemInTree.selected()) {\n        dropTargetSurface = selectedItemInTree.parent;\n        break;\n      }\n\n      selectedItemInTree = selectedItemInTree.parent;\n    }\n\n    return dropTargetSurface;\n  };\n\n  SelectionDragDropHandler.prototype.startDrag = function (control) {\n    this.selection.swapFocusedItem(control);\n    var focusedSurface = this.selection.focused();\n    var baseOffsetX = focusedSurface.rect().left + focusedSurface.underCursor().x;\n    var baseOffsetY = focusedSurface.rect().top + focusedSurface.underCursor().y;\n    this.selection.selectedItems.filter(function (item) {\n      return !item.locked;\n    }).forEach(function (item) {\n      if (item.parent === focusedSurface.parent) {\n        item.underCursor().offsetX = item.rect().left - baseOffsetX;\n        item.underCursor().offsetY = item.rect().top - baseOffsetY;\n      }\n    });\n  };\n\n  SelectionDragDropHandler.prototype.drag = function (event, ui) {\n    ui.position.left += ui['scroll'].left;\n    ui.position.top += ui['scroll'].top;\n\n    _super.prototype.drag.call(this, event, ui);\n  };\n\n  SelectionDragDropHandler.prototype.getLocation = function (adjustedTarget, item) {\n    var left = adjustedTarget.underCursor().x + item.underCursor().offsetX,\n        top = adjustedTarget.underCursor().y + item.underCursor().offsetY;\n    return {\n      left: left > 0 ? left : 0,\n      top: top > 0 ? top : 0\n    };\n  };\n\n  SelectionDragDropHandler.prototype.ajustLocation = function (adjustedTarget, item) {\n    item.rect(this.getLocation(adjustedTarget, item));\n  };\n\n  SelectionDragDropHandler.prototype.doStopDrag = function (ui, _) {\n    this.dragHelperContent.reset();\n    if (this.dragHelperContent.isLocked()) return;\n\n    if (this.selection.dropTarget) {\n      var dropTarget = this.selection.dropTarget.getControlModel(),\n          dropTargetSurface = dropTarget.getNearestParent(dropTarget)['surface'];\n      var focusedSurface = this.selection.focused();\n\n      var adjustedTarget = this.adjustDropTarget(dropTargetSurface),\n          focusedModel = focusedSurface.getControlModel(),\n          parent = focusedModel.getNearestParent(adjustedTarget.getControlModel()),\n          adjustedTarget = parent && _surfaceHelpers_1.findSurface(parent),\n          changeParent = adjustedTarget !== focusedSurface.parent;\n\n      if (!adjustedTarget || !adjustedTarget.canDrop()) {\n        return;\n      }\n\n      var position = this._getAbsoluteSurfacePosition(ui);\n\n      adjustedTarget.underCursor().x = position.left - (adjustedTarget['absolutePosition'] && adjustedTarget['absolutePosition'].x() || 0) - focusedSurface.underCursor().offsetX;\n      adjustedTarget.underCursor().y = position.top - (adjustedTarget['absolutePosition'] && adjustedTarget['absolutePosition'].y() || 0) - focusedSurface.underCursor().offsetY;\n      var dropPointRelativeX = ui.position.left;\n      var dropPointRelativeY = ui.position.top;\n      var itemsToDrop = this.selection.selectedItems.filter(function (item) {\n        return !item.locked && item.parent === focusedSurface.parent;\n      }).map(function (item) {\n        return item.getControlModel();\n      }).filter(function (item) {\n        return item.getMetaData().canDrop(adjustedTarget, item);\n      });\n\n      if (changeParent) {\n        for (var i = 0; i < itemsToDrop.length; i++) {\n          itemsToDrop[i].surface.rect({\n            top: 0,\n            left: 0\n          });\n        }\n\n        focusedModel.parentModel().removeChilds(itemsToDrop);\n        parent['addChilds'](itemsToDrop);\n\n        for (var i = 0; i < itemsToDrop.length; i++) {\n          this.ajustLocation(adjustedTarget, itemsToDrop[i].surface);\n        }\n\n        this.selection.focused(focusedSurface);\n        this.selection.selectItems(itemsToDrop.map(function (item) {\n          return item.surface;\n        }));\n      } else {\n        for (var i = 0; i < itemsToDrop.length; i++) {\n          this.ajustLocation(adjustedTarget, itemsToDrop[i].surface);\n        }\n\n        this.selection.expectClick = true;\n      }\n    }\n  };\n\n  SelectionDragDropHandler.prototype.create = function (event, ui) {\n    if (ko.dataFor(event.target).locked) {\n      $(this)['draggable']('disable');\n    }\n  };\n\n  return SelectionDragDropHandler;\n}(_dragDropHandler_1.DragDropHandler);\n\nexports.SelectionDragDropHandler = SelectionDragDropHandler;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/core/dragDrop/_selectionDragDropHandler.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","SelectionDragDropHandler","ko","require","$","_dragDropHandler_1","_surfaceHelpers_1","_super","surface","selection","undoEngine","snapHelper","dragHelperContent","_this","cursor","containment","draggable","helper","selectedItems","indexOf","updateSelection","update","_size","width","height","adjustDropTarget","dropTargetSurface","selectedItemInTree","selected","parent","startDrag","control","swapFocusedItem","focusedSurface","focused","baseOffsetX","rect","left","underCursor","x","baseOffsetY","top","y","filter","item","locked","forEach","offsetX","offsetY","drag","event","ui","position","getLocation","adjustedTarget","ajustLocation","doStopDrag","_","reset","isLocked","dropTarget","getControlModel","getNearestParent","focusedModel","findSurface","changeParent","canDrop","_getAbsoluteSurfacePosition","dropPointRelativeX","dropPointRelativeY","itemsToDrop","map","getMetaData","i","length","parentModel","removeChilds","selectItems","expectClick","dataFor","target","DragDropHandler"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (core\\dragDrop\\_selectionDragDropHandler.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SelectionDragDropHandler = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nrequire(\"jquery-ui/ui/widgets/draggable\");\nrequire(\"jquery-ui/ui/widgets/resizable\");\nrequire(\"jquery-ui/ui/widgets/selectable\");\nrequire(\"jquery-ui/ui/widgets/mouse\");\nvar _dragDropHandler_1 = require(\"./_dragDropHandler\");\nvar _surfaceHelpers_1 = require(\"../internal/_surfaceHelpers\");\nvar SelectionDragDropHandler = (function (_super) {\n    __extends(SelectionDragDropHandler, _super);\n    function SelectionDragDropHandler(surface, selection, undoEngine, snapHelper, dragHelperContent) {\n        var _this = _super.call(this, surface, selection, undoEngine, snapHelper, dragHelperContent) || this;\n        _this.cursor = 'move';\n        _this.containment = '.dxrd-ghost-container';\n        _this['helper'] = function (draggable) {\n            _super.prototype.helper.call(_this, draggable);\n            if (_this.selection.selectedItems.indexOf(draggable) === -1) {\n                _this.selection.updateSelection(draggable);\n            }\n            dragHelperContent.update(draggable);\n            _this._size.width(dragHelperContent.width());\n            _this._size.height(dragHelperContent.height());\n        };\n        return _this;\n    }\n    SelectionDragDropHandler.prototype.adjustDropTarget = function (dropTargetSurface) {\n        var selectedItemInTree = dropTargetSurface;\n        while (selectedItemInTree != null) {\n            if (selectedItemInTree.selected && selectedItemInTree.selected()) {\n                dropTargetSurface = selectedItemInTree.parent;\n                break;\n            }\n            selectedItemInTree = selectedItemInTree.parent;\n        }\n        return dropTargetSurface;\n    };\n    SelectionDragDropHandler.prototype.startDrag = function (control) {\n        this.selection.swapFocusedItem(control);\n        var focusedSurface = this.selection.focused();\n        var baseOffsetX = focusedSurface.rect().left + focusedSurface.underCursor().x;\n        var baseOffsetY = focusedSurface.rect().top + focusedSurface.underCursor().y;\n        this.selection.selectedItems.filter(function (item) { return !item.locked; }).forEach(function (item) {\n            if (item.parent === focusedSurface.parent) {\n                item.underCursor().offsetX = item.rect().left - baseOffsetX;\n                item.underCursor().offsetY = item.rect().top - baseOffsetY;\n            }\n        });\n    };\n    SelectionDragDropHandler.prototype.drag = function (event, ui) {\n        ui.position.left += ui['scroll'].left;\n        ui.position.top += ui['scroll'].top;\n        _super.prototype.drag.call(this, event, ui);\n    };\n    SelectionDragDropHandler.prototype.getLocation = function (adjustedTarget, item) {\n        var left = adjustedTarget.underCursor().x + item.underCursor().offsetX, top = adjustedTarget.underCursor().y + item.underCursor().offsetY;\n        return { left: left > 0 ? left : 0, top: top > 0 ? top : 0 };\n    };\n    SelectionDragDropHandler.prototype.ajustLocation = function (adjustedTarget, item) {\n        item.rect(this.getLocation(adjustedTarget, item));\n    };\n    SelectionDragDropHandler.prototype.doStopDrag = function (ui, _) {\n        this.dragHelperContent.reset();\n        if (this.dragHelperContent.isLocked())\n            return;\n        if (this.selection.dropTarget) {\n            var dropTarget = this.selection.dropTarget.getControlModel(), dropTargetSurface = dropTarget.getNearestParent(dropTarget)['surface'];\n            var focusedSurface = this.selection.focused();\n            var adjustedTarget = this.adjustDropTarget(dropTargetSurface), focusedModel = focusedSurface.getControlModel(), parent = focusedModel.getNearestParent(adjustedTarget.getControlModel()), adjustedTarget = parent && _surfaceHelpers_1.findSurface(parent), changeParent = adjustedTarget !== focusedSurface.parent;\n            if (!adjustedTarget || !adjustedTarget.canDrop()) {\n                return;\n            }\n            var position = this._getAbsoluteSurfacePosition(ui);\n            adjustedTarget.underCursor().x = position.left - (adjustedTarget['absolutePosition'] && adjustedTarget['absolutePosition'].x() || 0) - focusedSurface.underCursor().offsetX;\n            adjustedTarget.underCursor().y = position.top - (adjustedTarget['absolutePosition'] && adjustedTarget['absolutePosition'].y() || 0) - focusedSurface.underCursor().offsetY;\n            var dropPointRelativeX = ui.position.left;\n            var dropPointRelativeY = ui.position.top;\n            var itemsToDrop = this.selection.selectedItems\n                .filter(function (item) { return !item.locked && item.parent === focusedSurface.parent; })\n                .map(function (item) {\n                return item.getControlModel();\n            })\n                .filter(function (item) {\n                return item.getMetaData().canDrop(adjustedTarget, item);\n            });\n            if (changeParent) {\n                for (var i = 0; i < itemsToDrop.length; i++) {\n                    itemsToDrop[i].surface.rect({ top: 0, left: 0 });\n                }\n                focusedModel.parentModel().removeChilds(itemsToDrop);\n                parent['addChilds'](itemsToDrop);\n                for (var i = 0; i < itemsToDrop.length; i++) {\n                    this.ajustLocation(adjustedTarget, itemsToDrop[i].surface);\n                }\n                this.selection.focused(focusedSurface);\n                this.selection.selectItems(itemsToDrop.map(function (item) { return item.surface; }));\n            }\n            else {\n                for (var i = 0; i < itemsToDrop.length; i++) {\n                    this.ajustLocation(adjustedTarget, itemsToDrop[i].surface);\n                }\n                this.selection.expectClick = true;\n            }\n        }\n    };\n    SelectionDragDropHandler.prototype.create = function (event, ui) {\n        if (ko.dataFor(event.target).locked) {\n            $(this)['draggable']('disable');\n        }\n    };\n    return SelectionDragDropHandler;\n}(_dragDropHandler_1.DragDropHandler));\nexports.SelectionDragDropHandler = SelectionDragDropHandler;\n"]},"metadata":{},"sourceType":"script"}