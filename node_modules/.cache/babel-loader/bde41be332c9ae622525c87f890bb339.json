{"ast":null,"code":"/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\federationDataSource\\_federationSelectQueryBuilderPopup.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FederationSelectQueryBuilderPopup = void 0;\n\nvar ko = require(\"knockout\");\n\nvar $ = require(\"jquery\");\n\nvar _federationQueryBuilderPopupBase_1 = require(\"./_federationQueryBuilderPopupBase\");\n\nvar serializer_1 = require(\"../../../../serializer/serializer\");\n\nvar _federationQueryModel_1 = require(\"../../../elements/_federationQueryModel\");\n\nvar _utils_1 = require(\"../../../../serializer/_utils\");\n\nvar controlsFactory_1 = require(\"../../../utils/controlsFactory\");\n\nvar _surfaceHelpers_1 = require(\"../../../../core/internal/_surfaceHelpers\");\n\nvar templateUtils_1 = require(\"../../../../property-grid/widgets/templateUtils\");\n\nvar _columnExpressionCollectionHelper_1 = require(\"../../../utils/_columnExpressionCollectionHelper\");\n\nvar _localization_1 = require(\"../../../../property-grid/localization/_localization\");\n\nvar allColumnsModel_1 = require(\"../../../elements/allColumnsModel\");\n\nvar columnExpression_1 = require(\"../../../elements/columnExpression\");\n\nvar columnExpressionMeta_1 = require(\"../../../elements/columnExpressionMeta\");\n\nvar _federationTablesExpressionFieldListProvider_1 = require(\"./_federationTablesExpressionFieldListProvider\");\n\nvar federatedQueryExpression_1 = require(\"../../../dataSource/federation/federatedQueryExpression\");\n\nvar _internal_1 = require(\"../../../../serializer/_internal\");\n\nvar _resizeHelper_1 = require(\"../../../../widgets/internal/_resizeHelper\");\n\nvar _functions_1 = require(\"../../../../widgets/expressioneditor/tools/_functions\");\n\nvar FederationSelectQueryBuilderPopup = function (_super) {\n  __extends(FederationSelectQueryBuilderPopup, _super);\n\n  function FederationSelectQueryBuilderPopup(onSaveCallback, dataSource, rtl) {\n    if (rtl === void 0) {\n      rtl = false;\n    }\n\n    var _this = _super.call(this, onSaveCallback, dataSource, rtl) || this;\n\n    _this.popupContentTemplate = 'dxrd-querybuilder-select-popup-content';\n    _this._querySource = ko.observable(null);\n    _this.designer = ko.observable(null);\n    _this.joinResultCollapsed = ko.observable(false);\n    _this.width = '90%';\n    _this.height = '90%';\n    _this.cssClass = 'dxrd-querybuilder-federation-popup-wrapper dxrd-querybuilder-select-federation-popup';\n    _this._qbOptions = {\n      queryBuilderModel: _this.designer,\n      dataSource: dataSource,\n      dbSchemaProvider: ko.observable(dataSource.dbSchemaProvider),\n      showPropertyGridCondition: function (model) {\n        return model.controlType === 'JoinCondition' || model.controlType === 'FTable' || model.controlType === 'Column';\n      },\n      querySource: _this._querySource\n    };\n    _this.queryBuilderSurfaceCreator = {\n      options: _this._qbOptions,\n      creator: function (options) {\n        return new _federationQueryModel_1.FederationQueryViewModel(options.querySource(), options.dataSource, options.dbSchemaProvider(), options.parametersMode, new serializer_1.ModelSerializer());\n      }\n    };\n    var rootItems = [{\n      name: 'DataSource',\n      needPrefix: false,\n      rootPath: 'Root'\n    }];\n    _this.allColumns = ko.pureComputed(function () {\n      var columns = [];\n\n      if (_this._getQuery()) {\n        var tableName = '';\n        columns.push({\n          column: allColumnsModel_1.AllColumnsViewModel.DisplayName(),\n          table: tableName,\n          key: federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllColumnsExpression]\n        });\n\n        var allColumns = _this._getQuery().getAllColumns().map(function (x) {\n          var tableModel = x.parentModel();\n          return {\n            column: x.name(),\n            table: tableModel.actualName(),\n            key: _this._generateKey(tableModel.actualName(), x.name(), x.actualName(), x.alias())\n          };\n        });\n\n        allColumns.forEach(function (column) {\n          if (column.table && tableName !== column.table) {\n            columns.push({\n              column: allColumnsModel_1.AllColumnsViewModel.DisplayName(),\n              table: column.table,\n              key: column.table + '_' + federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllNodeColumnsExpression]\n            });\n          }\n\n          tableName = column.table;\n          columns.push(column);\n        });\n      }\n\n      return columns;\n    });\n    _this.columnsExpressions = ko.pureComputed(function () {\n      return _this._getQuery() && _this._getQuery().columns().map(function (x, index) {\n        var key;\n        var column;\n\n        if (x.actualName()) {\n          key = _this._generateKey(x.table(), x.column(), x.actualName(), x.alias());\n        }\n\n        if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Column]) {\n          column = x.column();\n        } else if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Expression]) {\n          column = x.expression();\n        } else if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumns]) {\n          key = x.table() + '_' + federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllNodeColumnsExpression];\n          column = allColumnsModel_1.AllColumnsViewModel.DisplayName();\n        } else if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumnsQuery]) {\n          key = federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllColumnsExpression];\n          column = allColumnsModel_1.AllColumnsViewModel.DisplayName();\n        }\n\n        return {\n          alias: x.alias(),\n          key: key,\n          index: index,\n          column: column,\n          table: x.table(),\n          isExpression: ko.observable(x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Expression] ? true : false),\n          expression: x.expression\n        };\n      });\n    });\n\n    _this._disposables.push(_this.columnsExpressions, _this.allColumns);\n\n    var cellTemplateMask = function (container, options) {\n      if (options.data.key && _this._isSelectAllItemByKey(options.data.key)) {\n        return cellTemplate(container, options);\n      }\n\n      var templateHtml = templateUtils_1.getTemplate('dxrd-querybuilder-column-combobox-masked'),\n          $element = $(container).append(templateHtml);\n      var model = {\n        cellInfo: options.data,\n        isExpression: options.data.isExpression || ko.observable(false),\n        switchEditors: function () {\n          return null;\n        }\n      };\n      ko.applyBindings(model, $element[0]);\n    };\n\n    var cellTemplate = function (container, options) {\n      var $container = $(container);\n\n      var childContext = _this._bindingContext.createChildContext({\n        allColumns: _this.allColumns,\n        itemsProvider: new _federationTablesExpressionFieldListProvider_1.FederationTablesExpressionFieldListProvider(_this._dataSource.dbSchemaProvider, _this._getQuery().tables),\n        cellInfo: options.data,\n        expression: {\n          value: options.data.expression,\n          onContentReady: _this._onContentReady,\n          path: ko.observable(rootItems[0].name),\n          customizeCategories: function () {},\n          rootItems: rootItems,\n          functions: _functions_1.functionDisplay().filter(function (cat) {\n            return cat.category != 'Aggregate';\n          })\n        },\n        isExpression: options.data.isExpression || ko.observable(false),\n        changeColumn: function (selectionChangedArgs) {\n          _this._changeColumn(selectionChangedArgs.selectedRowsData[0], selectionChangedArgs.model.cellInfo.index);\n        },\n        switchEditors: function (e) {\n          _this._switchEditors(e.model.cellInfo);\n        }\n      });\n\n      var child = document.createElement('div'),\n          $container = $container.append(child);\n      ko.renderTemplate('dxrd-querybuilder-column-combobox', childContext, {}, child, 'replaceNode');\n\n      _internal_1.addDisposeCallback(container, function () {\n        $container = null;\n        child = null;\n        childContext = null;\n      });\n    };\n\n    _this._disposables.push(_this.addRowDisabled = ko.pureComputed(function () {\n      return !_this._getQuery() || _this._getQuery().tables().length === 0;\n    }));\n\n    _this.columnsGrid = {\n      rtlEnabled: rtl,\n      dataSource: _this.columnsExpressions,\n      disabled: _this.addRowDisabled,\n      showRowLines: true,\n      height: '100%',\n      showBorders: true,\n      editing: {\n        allowUpdating: function (grid) {\n          return !(grid.row && grid.row.data.key && _this._isSelectAllItemByKey(grid.row.data.key));\n        },\n        newRowPosition: 'last',\n        mode: 'cell',\n        texts: {\n          confirmDeleteMessage: ''\n        }\n      },\n      paging: {\n        enabled: false\n      },\n      columns: [{\n        dataField: 'column',\n\n        get caption() {\n          return _localization_1.getLocalization('Column Name', 'DataAccessUIStringId.QueryBuilderColumns_ColumnName');\n        },\n\n        cssClass: 'dx-editor-cell',\n        editCellTemplate: cellTemplate,\n        cellTemplate: cellTemplateMask\n      }, {\n        dataField: 'table',\n\n        get caption() {\n          return _localization_1.getLocalization('Table Name', 'DataAccessUIStringId.QueryBuilderColumns_TableName');\n        },\n\n        allowEditing: false\n      }, {\n        dataField: 'alias',\n\n        get caption() {\n          return _localization_1.getLocalization('Alias', 'DataAccessUIStringId.QueryBuilderColumns_Alias');\n        },\n\n        disabled: true,\n        validationRules: [_this._aliasValidationRule, {\n          type: 'custom',\n          validationCallback: function (options) {\n            if (options.value === '' && options.data && options.data.key) {\n              var existedColumn = _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.findByName(_this._getQuery().columns, options.data.key);\n\n              if (existedColumn && existedColumn.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Expression]) return false;\n            }\n\n            return true;\n          },\n\n          get message() {\n            return _localization_1.getLocalization('The column name is not specified.', 'DataAccessStringId.UnnamedColumnValidationException');\n          }\n\n        }]\n      }, {\n        type: 'buttons',\n        width: 50,\n        buttons: [{\n          icon: 'delete',\n          onClick: function (e) {\n            _this._deleteRow(e.row.data.index != null ? e.row.data.index : _this._getQuery().columns().length);\n          },\n          cssClass: 'dxrd-querybuilder-grid-actions dxd-icon-highlighted dxrd-image-recycle-bin',\n          template: templateUtils_1.getTemplate('dxrd-svg-operations-recycle_bin')\n        }]\n      }],\n      onInitialized: function (e) {\n        _this._bindingContext = ko.contextFor($(e.element)[0]);\n        _this._gridComponent = e.component;\n      },\n      onRowUpdating: function (event) {\n        _this._onRowUpdating(event.oldData, event.newData);\n      }\n    };\n    _this.gridResizeHelper = new _resizeHelper_1.ResizeHelper(_this.resultGridHeight, _this.joinResultCollapsed);\n    return _this;\n  }\n\n  FederationSelectQueryBuilderPopup.prototype._onContentReady = function (e) {\n    if (!e.component._isFirstLoad) {\n      e.component._isFirstLoad = true;\n      var element = $(e.component.content())[0];\n      var contentEl = element.parentElement;\n      contentEl.className += '  dx-dropdowneditor-overlay';\n    }\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._getQuery = function () {\n    return this.designer() && this.designer().model();\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._afterChangeColumn = function (colIndex, notifyCallback) {\n    var _this = this;\n\n    this._gridComponent.saveEditData().then(function () {\n      _this._gridComponent.cancelEditData();\n\n      var event = function () {\n        var rows = _this._gridComponent.getVisibleRows();\n\n        var index = colIndex != null ? colIndex : rows.length - 1;\n\n        _this._gridComponent.editCell(index, 0);\n\n        _this._gridComponent.navigateToRow(_this.columnsExpressions()[index]);\n\n        _this._gridComponent.off('contentReady', event);\n      };\n\n      _this._gridComponent.on('contentReady', event);\n\n      notifyCallback();\n    });\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._changeColumn = function (columnData, insertIndex) {\n    var _this = this;\n\n    if (columnData) {\n      var query = _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.createNew(this._getQuery(), this._getQuery().columns, columnData.table, columnData.column);\n\n      if (this._isSelectAllItemByKey(columnData.key)) {\n        query = columnData.table ? new columnExpression_1.ColumnExpression({\n          '@Table': columnData.table,\n          '@ItemType': columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumns]\n        }, this._getQuery()) : new columnExpression_1.ColumnExpression({\n          '@ItemType': columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumnsQuery]\n        }, this._getQuery());\n      }\n\n      var callback = function () {\n        return insertIndex != null ? _this._getQuery().columns.splice(insertIndex, 1, query) : _this._getQuery().columns.push(query);\n      };\n\n      this._afterChangeColumn(insertIndex, callback);\n    }\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._switchEditors = function (model) {\n    var _this = this;\n\n    var column;\n\n    var callback = function () {\n      return _this._getQuery().columns.notifySubscribers();\n    };\n\n    if (model.index != null) {\n      column = this._getQuery().columns()[model.index];\n\n      if (model.isExpression()) {\n        column.toTable();\n      } else if (column.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumns] || column.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumnsQuery]) {\n        column = new columnExpression_1.ColumnExpression({}, this._getQuery());\n\n        _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.toExpresson(column, this._getQuery().columns, '');\n\n        this._getQuery().columns.splice(model.index, 1, column);\n      } else {\n        var epressionValue = column.column() ? '[' + column.table() + '.' + column.column() + ']' : '';\n\n        _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.toExpresson(column, this._getQuery().columns, epressionValue);\n      }\n    } else {\n      column = new columnExpression_1.ColumnExpression({}, this._getQuery());\n\n      _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.toExpresson(column, this._getQuery().columns, '');\n\n      callback = function () {\n        return _this._getQuery().columns.push(column);\n      };\n    }\n\n    this._afterChangeColumn(model.index, callback);\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._deleteRow = function (deleteIndex) {\n    this._gridComponent.deleteRow(deleteIndex);\n\n    this._gridComponent.deselectAll();\n\n    this._getQuery().columns.splice(deleteIndex, 1);\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._onRowUpdating = function (oldData, newData) {\n    var column = this._getQuery().columns()[oldData.index];\n\n    if (column) {\n      column.alias(newData.alias);\n    }\n\n    oldData.alias = newData.alias;\n\n    this._gridComponent.saveEditData();\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._aliasValidationCallback = function (alias, data) {\n    if (alias === data.alias && alias === data.key) return true;\n    return !_columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.findByName(this._getQuery().columns, alias);\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this._bindingContext = null;\n    this._gridComponent = null;\n    this._qbOptions = null;\n    this.queryBuilderSurfaceCreator = null;\n    this.columnsGrid = null;\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._generateKey = function (tableName, columnName, actualName, alias) {\n    return alias === actualName ? actualName : tableName + '_' + columnName;\n  };\n\n  FederationSelectQueryBuilderPopup.prototype._isSelectAllItemByKey = function (key) {\n    return key === federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllColumnsExpression] || key.indexOf(federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllNodeColumnsExpression]) !== -1;\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.save = function () {\n    this.selectQuery.init(this._getQuery().serialize());\n    this.onSaveCallback(this.selectQuery);\n    this.close();\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.addRow = function () {\n    this._gridComponent.addRow();\n\n    this._gridComponent.deselectAll();\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.canSave = function () {\n    return this._getQuery() && this._getQuery().isValid();\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.addDataMember = function (item, position) {\n    var query = this._getQuery();\n\n    var name = item.data.displayName || item.data.name;\n    var newControl = query.createChild(_utils_1.extend({\n      '@ControlType': 'FTable',\n      '@Name': name\n    }, controlsFactory_1.controlsFactory.controlsMap['FTable'].defaultVal), undefined, item.path);\n    var controlSurface = ko.unwrap(_surfaceHelpers_1.findSurface(newControl));\n\n    if (!position) {\n      var posX = Math.max.apply(null, query.tables.peek().filter(function (t) {\n        return t !== newControl;\n      }).map(function (t) {\n        return t.location.x.peek() + t.size.width.peek() * 1.25;\n      }).concat([30]));\n      newControl.location.x(posX);\n      newControl.location.y(20);\n    } else {\n      var _querySurface = ko.unwrap(_surfaceHelpers_1.findSurface(this.designer()));\n\n      _querySurface.underCursor().x = position.left - _querySurface['absolutePosition'].x();\n      _querySurface.underCursor().y = position.top - _querySurface['absolutePosition'].y();\n      controlSurface.rect({\n        left: _querySurface.underCursor().x,\n        top: _querySurface.underCursor().y,\n        width: 199\n      });\n    }\n\n    this.designer().selection.initialize(controlSurface);\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.close = function () {\n    this.popupVisible(false);\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.show = function (query) {\n    this.selectQuery = query;\n\n    this._querySource(new serializer_1.ModelSerializer().serialize(query));\n\n    this.popupVisible(true);\n  };\n\n  FederationSelectQueryBuilderPopup.prototype.popupTarget = function () {\n    return '.dxrd-select-querybuilder-surface .dxqb-main';\n  };\n\n  return FederationSelectQueryBuilderPopup;\n}(_federationQueryBuilderPopupBase_1.FederationQueryBuilderPopupBase);\n\nexports.FederationSelectQueryBuilderPopup = FederationSelectQueryBuilderPopup;","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/@devexpress/analytics-core/query-builder/wizard/internal/federationDataSource/_federationSelectQueryBuilderPopup.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","FederationSelectQueryBuilderPopup","ko","require","$","_federationQueryBuilderPopupBase_1","serializer_1","_federationQueryModel_1","_utils_1","controlsFactory_1","_surfaceHelpers_1","templateUtils_1","_columnExpressionCollectionHelper_1","_localization_1","allColumnsModel_1","columnExpression_1","columnExpressionMeta_1","_federationTablesExpressionFieldListProvider_1","federatedQueryExpression_1","_internal_1","_resizeHelper_1","_functions_1","_super","onSaveCallback","dataSource","rtl","_this","popupContentTemplate","_querySource","observable","designer","joinResultCollapsed","width","height","cssClass","_qbOptions","queryBuilderModel","dbSchemaProvider","showPropertyGridCondition","model","controlType","querySource","queryBuilderSurfaceCreator","options","creator","FederationQueryViewModel","parametersMode","ModelSerializer","rootItems","name","needPrefix","rootPath","allColumns","pureComputed","columns","_getQuery","tableName","push","column","AllColumnsViewModel","DisplayName","table","key","FederatedQueryExpressionType","SelectAllColumnsExpression","getAllColumns","map","x","tableModel","parentModel","actualName","_generateKey","alias","forEach","SelectAllNodeColumnsExpression","columnsExpressions","index","itemType","ColumnType","Column","Expression","expression","AllColumns","AllColumnsQuery","isExpression","_disposables","cellTemplateMask","container","data","_isSelectAllItemByKey","cellTemplate","templateHtml","getTemplate","$element","append","cellInfo","switchEditors","applyBindings","$container","childContext","_bindingContext","createChildContext","itemsProvider","FederationTablesExpressionFieldListProvider","_dataSource","tables","onContentReady","_onContentReady","path","customizeCategories","functions","functionDisplay","filter","cat","category","changeColumn","selectionChangedArgs","_changeColumn","selectedRowsData","e","_switchEditors","child","document","createElement","renderTemplate","addDisposeCallback","addRowDisabled","length","columnsGrid","rtlEnabled","disabled","showRowLines","showBorders","editing","allowUpdating","grid","row","newRowPosition","mode","texts","confirmDeleteMessage","paging","enabled","dataField","caption","getLocalization","editCellTemplate","allowEditing","validationRules","_aliasValidationRule","type","validationCallback","existedColumn","ColumnExpressionCollectionHelper","findByName","message","buttons","icon","onClick","_deleteRow","template","onInitialized","contextFor","element","_gridComponent","component","onRowUpdating","event","_onRowUpdating","oldData","newData","gridResizeHelper","ResizeHelper","resultGridHeight","_isFirstLoad","content","contentEl","parentElement","className","_afterChangeColumn","colIndex","notifyCallback","saveEditData","then","cancelEditData","rows","getVisibleRows","editCell","navigateToRow","off","on","columnData","insertIndex","query","createNew","ColumnExpression","callback","splice","notifySubscribers","toTable","toExpresson","epressionValue","deleteIndex","deleteRow","deselectAll","_aliasValidationCallback","dispose","columnName","indexOf","save","selectQuery","init","serialize","close","addRow","canSave","isValid","addDataMember","item","position","displayName","newControl","createChild","extend","controlsFactory","controlsMap","defaultVal","undefined","controlSurface","unwrap","findSurface","posX","Math","max","apply","peek","t","location","size","concat","y","_querySurface","underCursor","left","top","rect","selection","initialize","popupVisible","show","popupTarget","FederationQueryBuilderPopupBase"],"mappings":"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","sourcesContent":["/**\n* DevExpress Analytics (query-builder\\wizard\\internal\\federationDataSource\\_federationSelectQueryBuilderPopup.js)\n* Version:  22.1.3\n* Build date: Jun 14, 2022\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\n*/\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FederationSelectQueryBuilderPopup = void 0;\nvar ko = require(\"knockout\");\nvar $ = require(\"jquery\");\nvar _federationQueryBuilderPopupBase_1 = require(\"./_federationQueryBuilderPopupBase\");\nvar serializer_1 = require(\"../../../../serializer/serializer\");\nvar _federationQueryModel_1 = require(\"../../../elements/_federationQueryModel\");\nvar _utils_1 = require(\"../../../../serializer/_utils\");\nvar controlsFactory_1 = require(\"../../../utils/controlsFactory\");\nvar _surfaceHelpers_1 = require(\"../../../../core/internal/_surfaceHelpers\");\nvar templateUtils_1 = require(\"../../../../property-grid/widgets/templateUtils\");\nvar _columnExpressionCollectionHelper_1 = require(\"../../../utils/_columnExpressionCollectionHelper\");\nvar _localization_1 = require(\"../../../../property-grid/localization/_localization\");\nvar allColumnsModel_1 = require(\"../../../elements/allColumnsModel\");\nvar columnExpression_1 = require(\"../../../elements/columnExpression\");\nvar columnExpressionMeta_1 = require(\"../../../elements/columnExpressionMeta\");\nvar _federationTablesExpressionFieldListProvider_1 = require(\"./_federationTablesExpressionFieldListProvider\");\nvar federatedQueryExpression_1 = require(\"../../../dataSource/federation/federatedQueryExpression\");\nvar _internal_1 = require(\"../../../../serializer/_internal\");\nvar _resizeHelper_1 = require(\"../../../../widgets/internal/_resizeHelper\");\nvar _functions_1 = require(\"../../../../widgets/expressioneditor/tools/_functions\");\nvar FederationSelectQueryBuilderPopup = (function (_super) {\n    __extends(FederationSelectQueryBuilderPopup, _super);\n    function FederationSelectQueryBuilderPopup(onSaveCallback, dataSource, rtl) {\n        if (rtl === void 0) { rtl = false; }\n        var _this = _super.call(this, onSaveCallback, dataSource, rtl) || this;\n        _this.popupContentTemplate = 'dxrd-querybuilder-select-popup-content';\n        _this._querySource = ko.observable(null);\n        _this.designer = ko.observable(null);\n        _this.joinResultCollapsed = ko.observable(false);\n        _this.width = '90%';\n        _this.height = '90%';\n        _this.cssClass = 'dxrd-querybuilder-federation-popup-wrapper dxrd-querybuilder-select-federation-popup';\n        _this._qbOptions = {\n            queryBuilderModel: _this.designer,\n            dataSource: dataSource,\n            dbSchemaProvider: ko.observable(dataSource.dbSchemaProvider),\n            showPropertyGridCondition: function (model) { return model.controlType === 'JoinCondition' || model.controlType === 'FTable' || model.controlType === 'Column'; },\n            querySource: _this._querySource,\n        };\n        _this.queryBuilderSurfaceCreator = {\n            options: _this._qbOptions,\n            creator: function (options) {\n                return new _federationQueryModel_1.FederationQueryViewModel(options.querySource(), options.dataSource, options.dbSchemaProvider(), options.parametersMode, new serializer_1.ModelSerializer());\n            }\n        };\n        var rootItems = [{ name: 'DataSource', needPrefix: false, rootPath: 'Root' }];\n        _this.allColumns = ko.pureComputed(function () {\n            var columns = [];\n            if (_this._getQuery()) {\n                var tableName = '';\n                columns.push({ column: allColumnsModel_1.AllColumnsViewModel.DisplayName(), table: tableName, key: federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllColumnsExpression] });\n                var allColumns = _this._getQuery().getAllColumns().map(function (x) {\n                    var tableModel = x.parentModel();\n                    return {\n                        column: x.name(),\n                        table: tableModel.actualName(),\n                        key: _this._generateKey(tableModel.actualName(), x.name(), x.actualName(), x.alias())\n                    };\n                });\n                allColumns.forEach(function (column) {\n                    if (column.table && tableName !== column.table) {\n                        columns.push({ column: allColumnsModel_1.AllColumnsViewModel.DisplayName(), table: column.table, key: column.table + '_' + federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllNodeColumnsExpression] });\n                    }\n                    tableName = column.table;\n                    columns.push(column);\n                });\n            }\n            return columns;\n        });\n        _this.columnsExpressions = ko.pureComputed(function () { return _this._getQuery() && _this._getQuery().columns().map(function (x, index) {\n            var key;\n            var column;\n            if (x.actualName()) {\n                key = _this._generateKey(x.table(), x.column(), x.actualName(), x.alias());\n            }\n            if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Column]) {\n                column = x.column();\n            }\n            else if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Expression]) {\n                column = x.expression();\n            }\n            else if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumns]) {\n                key = x.table() + '_' + federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllNodeColumnsExpression];\n                column = allColumnsModel_1.AllColumnsViewModel.DisplayName();\n            }\n            else if (x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumnsQuery]) {\n                key = federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllColumnsExpression];\n                column = allColumnsModel_1.AllColumnsViewModel.DisplayName();\n            }\n            return {\n                alias: x.alias(),\n                key: key,\n                index: index,\n                column: column,\n                table: x.table(),\n                isExpression: ko.observable(x.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Expression] ? true : false),\n                expression: x.expression\n            };\n        }); });\n        _this._disposables.push(_this.columnsExpressions, _this.allColumns);\n        var cellTemplateMask = function (container, options) {\n            if (options.data.key && _this._isSelectAllItemByKey(options.data.key)) {\n                return cellTemplate(container, options);\n            }\n            var templateHtml = templateUtils_1.getTemplate('dxrd-querybuilder-column-combobox-masked'), $element = $(container).append(templateHtml);\n            var model = {\n                cellInfo: options.data,\n                isExpression: options.data.isExpression || ko.observable(false),\n                switchEditors: function () { return null; }\n            };\n            ko.applyBindings(model, $element[0]);\n        };\n        var cellTemplate = function (container, options) {\n            var $container = $(container);\n            var childContext = _this._bindingContext.createChildContext({\n                allColumns: _this.allColumns,\n                itemsProvider: new _federationTablesExpressionFieldListProvider_1.FederationTablesExpressionFieldListProvider(_this._dataSource.dbSchemaProvider, _this._getQuery().tables),\n                cellInfo: options.data,\n                expression: { value: options.data.expression, onContentReady: _this._onContentReady, path: ko.observable(rootItems[0].name), customizeCategories: function () { }, rootItems: rootItems, functions: _functions_1.functionDisplay().filter(function (cat) { return cat.category != 'Aggregate'; }) },\n                isExpression: options.data.isExpression || ko.observable(false),\n                changeColumn: function (selectionChangedArgs) {\n                    _this._changeColumn(selectionChangedArgs.selectedRowsData[0], selectionChangedArgs.model.cellInfo.index);\n                },\n                switchEditors: function (e) {\n                    _this._switchEditors(e.model.cellInfo);\n                }\n            });\n            var child = document.createElement('div'), $container = $container.append(child);\n            ko.renderTemplate('dxrd-querybuilder-column-combobox', childContext, {}, child, 'replaceNode');\n            _internal_1.addDisposeCallback(container, function () {\n                $container = null;\n                child = null;\n                childContext = null;\n            });\n        };\n        _this._disposables.push(_this.addRowDisabled = ko.pureComputed(function () {\n            return !_this._getQuery() || _this._getQuery().tables().length === 0;\n        }));\n        _this.columnsGrid = {\n            rtlEnabled: rtl,\n            dataSource: _this.columnsExpressions,\n            disabled: _this.addRowDisabled,\n            showRowLines: true,\n            height: '100%',\n            showBorders: true,\n            editing: {\n                allowUpdating: function (grid) {\n                    return !(grid.row && grid.row.data.key &&\n                        _this._isSelectAllItemByKey(grid.row.data.key));\n                },\n                newRowPosition: 'last',\n                mode: 'cell',\n                texts: {\n                    confirmDeleteMessage: '',\n                }\n            },\n            paging: { enabled: false },\n            columns: [{\n                    dataField: 'column',\n                    get caption() {\n                        return _localization_1.getLocalization('Column Name', 'DataAccessUIStringId.QueryBuilderColumns_ColumnName');\n                    },\n                    cssClass: 'dx-editor-cell',\n                    editCellTemplate: cellTemplate,\n                    cellTemplate: cellTemplateMask\n                }, {\n                    dataField: 'table',\n                    get caption() {\n                        return _localization_1.getLocalization('Table Name', 'DataAccessUIStringId.QueryBuilderColumns_TableName');\n                    },\n                    allowEditing: false\n                }, {\n                    dataField: 'alias',\n                    get caption() {\n                        return _localization_1.getLocalization('Alias', 'DataAccessUIStringId.QueryBuilderColumns_Alias');\n                    },\n                    disabled: true,\n                    validationRules: [_this._aliasValidationRule, {\n                            type: 'custom',\n                            validationCallback: function (options) {\n                                if (options.value === '' && options.data && options.data.key) {\n                                    var existedColumn = _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.findByName(_this._getQuery().columns, options.data.key);\n                                    if (existedColumn && existedColumn.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.Expression])\n                                        return false;\n                                }\n                                return true;\n                            },\n                            get message() { return _localization_1.getLocalization('The column name is not specified.', 'DataAccessStringId.UnnamedColumnValidationException'); }\n                        }]\n                },\n                {\n                    type: 'buttons',\n                    width: 50,\n                    buttons: [\n                        {\n                            icon: 'delete',\n                            onClick: function (e) {\n                                _this._deleteRow(e.row.data.index != null ? e.row.data.index : _this._getQuery().columns().length);\n                            },\n                            cssClass: 'dxrd-querybuilder-grid-actions dxd-icon-highlighted dxrd-image-recycle-bin',\n                            template: templateUtils_1.getTemplate('dxrd-svg-operations-recycle_bin'),\n                        }\n                    ]\n                }\n            ],\n            onInitialized: function (e) {\n                _this._bindingContext = ko.contextFor($(e.element)[0]);\n                _this._gridComponent = e.component;\n            },\n            onRowUpdating: function (event) {\n                _this._onRowUpdating(event.oldData, event.newData);\n            }\n        };\n        _this.gridResizeHelper = new _resizeHelper_1.ResizeHelper(_this.resultGridHeight, _this.joinResultCollapsed);\n        return _this;\n    }\n    FederationSelectQueryBuilderPopup.prototype._onContentReady = function (e) {\n        if (!e.component._isFirstLoad) {\n            e.component._isFirstLoad = true;\n            var element = $(e.component.content())[0];\n            var contentEl = element.parentElement;\n            contentEl.className += '  dx-dropdowneditor-overlay';\n        }\n    };\n    FederationSelectQueryBuilderPopup.prototype._getQuery = function () {\n        return this.designer() && this.designer().model();\n    };\n    FederationSelectQueryBuilderPopup.prototype._afterChangeColumn = function (colIndex, notifyCallback) {\n        var _this = this;\n        this._gridComponent.saveEditData().then(function () {\n            _this._gridComponent.cancelEditData();\n            var event = function () {\n                var rows = _this._gridComponent.getVisibleRows();\n                var index = colIndex != null ? colIndex : rows.length - 1;\n                _this._gridComponent.editCell(index, 0);\n                _this._gridComponent.navigateToRow(_this.columnsExpressions()[index]);\n                _this._gridComponent.off('contentReady', event);\n            };\n            _this._gridComponent.on('contentReady', event);\n            notifyCallback();\n        });\n    };\n    FederationSelectQueryBuilderPopup.prototype._changeColumn = function (columnData, insertIndex) {\n        var _this = this;\n        if (columnData) {\n            var query = _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.createNew(this._getQuery(), this._getQuery().columns, columnData.table, columnData.column);\n            if (this._isSelectAllItemByKey(columnData.key)) {\n                query = columnData.table ?\n                    new columnExpression_1.ColumnExpression({ '@Table': columnData.table, '@ItemType': columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumns] }, this._getQuery()) :\n                    new columnExpression_1.ColumnExpression({ '@ItemType': columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumnsQuery] }, this._getQuery());\n            }\n            var callback = function () { return insertIndex != null ? _this._getQuery().columns.splice(insertIndex, 1, query) : _this._getQuery().columns.push(query); };\n            this._afterChangeColumn(insertIndex, callback);\n        }\n    };\n    FederationSelectQueryBuilderPopup.prototype._switchEditors = function (model) {\n        var _this = this;\n        var column;\n        var callback = function () { return _this._getQuery().columns.notifySubscribers(); };\n        if (model.index != null) {\n            column = this._getQuery().columns()[model.index];\n            if (model.isExpression()) {\n                column.toTable();\n            }\n            else if (column.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumns] || column.itemType() === columnExpressionMeta_1.ColumnType[columnExpressionMeta_1.ColumnType.AllColumnsQuery]) {\n                column = new columnExpression_1.ColumnExpression({}, this._getQuery());\n                _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.toExpresson(column, this._getQuery().columns, '');\n                this._getQuery().columns.splice(model.index, 1, column);\n            }\n            else {\n                var epressionValue = column.column() ? '[' + column.table() + '.' + column.column() + ']' : '';\n                _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.toExpresson(column, this._getQuery().columns, epressionValue);\n            }\n        }\n        else {\n            column = new columnExpression_1.ColumnExpression({}, this._getQuery());\n            _columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.toExpresson(column, this._getQuery().columns, '');\n            callback = function () { return _this._getQuery().columns.push(column); };\n        }\n        this._afterChangeColumn(model.index, callback);\n    };\n    FederationSelectQueryBuilderPopup.prototype._deleteRow = function (deleteIndex) {\n        this._gridComponent.deleteRow(deleteIndex);\n        this._gridComponent.deselectAll();\n        this._getQuery().columns.splice(deleteIndex, 1);\n    };\n    FederationSelectQueryBuilderPopup.prototype._onRowUpdating = function (oldData, newData) {\n        var column = this._getQuery().columns()[oldData.index];\n        if (column) {\n            column.alias(newData.alias);\n        }\n        oldData.alias = newData.alias;\n        this._gridComponent.saveEditData();\n    };\n    FederationSelectQueryBuilderPopup.prototype._aliasValidationCallback = function (alias, data) {\n        if (alias === data.alias && alias === data.key)\n            return true;\n        return !_columnExpressionCollectionHelper_1.ColumnExpressionCollectionHelper.findByName(this._getQuery().columns, alias);\n    };\n    FederationSelectQueryBuilderPopup.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._bindingContext = null;\n        this._gridComponent = null;\n        this._qbOptions = null;\n        this.queryBuilderSurfaceCreator = null;\n        this.columnsGrid = null;\n    };\n    FederationSelectQueryBuilderPopup.prototype._generateKey = function (tableName, columnName, actualName, alias) {\n        return alias === actualName ? actualName : tableName + '_' + columnName;\n    };\n    FederationSelectQueryBuilderPopup.prototype._isSelectAllItemByKey = function (key) {\n        return key === federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllColumnsExpression] ||\n            key.indexOf(federatedQueryExpression_1.FederatedQueryExpressionType[federatedQueryExpression_1.FederatedQueryExpressionType.SelectAllNodeColumnsExpression]) !== -1;\n    };\n    FederationSelectQueryBuilderPopup.prototype.save = function () {\n        this.selectQuery.init(this._getQuery().serialize());\n        this.onSaveCallback(this.selectQuery);\n        this.close();\n    };\n    FederationSelectQueryBuilderPopup.prototype.addRow = function () {\n        this._gridComponent.addRow();\n        this._gridComponent.deselectAll();\n    };\n    FederationSelectQueryBuilderPopup.prototype.canSave = function () {\n        return this._getQuery() && this._getQuery().isValid();\n    };\n    FederationSelectQueryBuilderPopup.prototype.addDataMember = function (item, position) {\n        var query = this._getQuery();\n        var name = item.data.displayName || item.data.name;\n        var newControl = query.createChild(_utils_1.extend({\n            '@ControlType': 'FTable',\n            '@Name': name\n        }, controlsFactory_1.controlsFactory.controlsMap['FTable'].defaultVal), undefined, item.path);\n        var controlSurface = ko.unwrap(_surfaceHelpers_1.findSurface(newControl));\n        if (!position) {\n            var posX = Math.max.apply(null, query.tables.peek()\n                .filter(function (t) { return t !== newControl; })\n                .map(function (t) { return t.location.x.peek() + t.size.width.peek() * 1.25; })\n                .concat([30]));\n            newControl.location.x(posX);\n            newControl.location.y(20);\n        }\n        else {\n            var _querySurface = ko.unwrap(_surfaceHelpers_1.findSurface(this.designer()));\n            _querySurface.underCursor().x = position.left - _querySurface['absolutePosition'].x();\n            _querySurface.underCursor().y = position.top - _querySurface['absolutePosition'].y();\n            controlSurface.rect({ left: _querySurface.underCursor().x, top: _querySurface.underCursor().y, width: 199 });\n        }\n        this.designer().selection.initialize(controlSurface);\n    };\n    FederationSelectQueryBuilderPopup.prototype.close = function () {\n        this.popupVisible(false);\n    };\n    FederationSelectQueryBuilderPopup.prototype.show = function (query) {\n        this.selectQuery = query;\n        this._querySource(new serializer_1.ModelSerializer().serialize(query));\n        this.popupVisible(true);\n    };\n    FederationSelectQueryBuilderPopup.prototype.popupTarget = function () {\n        return '.dxrd-select-querybuilder-surface .dxqb-main';\n    };\n    return FederationSelectQueryBuilderPopup;\n}(_federationQueryBuilderPopupBase_1.FederationQueryBuilderPopupBase));\nexports.FederationSelectQueryBuilderPopup = FederationSelectQueryBuilderPopup;\n"]},"metadata":{},"sourceType":"script"}