{"ast":null,"code":"/**\r\n* DevExpress Dashboard (_field-chooser-surface.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FieldChooserController = exports.SliderController = exports.FieldChooserList = exports.TreeViewFieldChooserItem = exports.FieldChooserItem = void 0;\n\nrequire(\"devextreme/ui/scroll_view\");\n\nrequire(\"devextreme/ui/text_box\");\n\nvar text_box_1 = require(\"devextreme/ui/text_box\");\n\nvar ko = require(\"knockout\");\n\nvar _data_source_browser_1 = require(\"../../../common/_data-source-browser\");\n\nvar _default_1 = require(\"../../../data/localization/_default\");\n\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\n\nvar _utils_1 = require(\"../../../data/_utils\");\n\nvar _data_field_1 = require(\"../../../model/data-sources/_data-field\");\n\nvar _calc_field_editor_1 = require(\"../../calc-field-editor/_calc-field-editor\");\n\nvar _confirm_dialog_1 = require(\"../../confirm-dialog/_confirm-dialog\");\n\nvar commonSelectedFieldName;\nvar isListMode = ko.observable(_utils_1.LocalStorageHelper.getItem('dx-dashboard-field-chooser-is-list-mode') === 'true');\n\nvar FieldChooserItem = function () {\n  function FieldChooserItem(data) {\n    this.data = data;\n  }\n\n  FieldChooserItem.getName = function (data) {\n    return data.nodeType && data.nodeType() && data.nodeType().toLowerCase().indexOf('olap') !== -1 ? data.dataMember() : data.name();\n  };\n\n  Object.defineProperty(FieldChooserItem.prototype, \"displayName\", {\n    get: function () {\n      return this.data.displayName();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"name\", {\n    get: function () {\n      return FieldChooserItem.getName(this.data);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isHierarchy\", {\n    get: function () {\n      return this.data.nodeType && this.data.nodeType() === 'OlapHierarchy';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isLeaf\", {\n    get: function () {\n      return this.data.isDataFieldNode();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isGroup\", {\n    get: function () {\n      return !this.isLeaf && !this.isList;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"type\", {\n    get: function () {\n      return this.data.isDataFieldNode() ? this.data.fieldType() : '';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"normalizedType\", {\n    get: function () {\n      if (this.isList) return 'list';\n\n      if (!this.isLeaf || this.type === undefined || this.data.nodeType && this.data.nodeType() === 'DataSource') {\n        return '';\n      }\n\n      switch (this.type) {\n        case 'Text':\n          return 'string';\n\n        case 'Integer':\n          return 'integer';\n\n        case 'Float':\n        case 'Double':\n        case 'Decimal':\n          return 'float';\n\n        case 'DateTime':\n          return 'datetime';\n\n        case 'Bool':\n        case 'Boolean':\n          return 'boolean';\n      }\n\n      return 'custom';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isCalcField\", {\n    get: function () {\n      return this.data.nodeType && this.data.nodeType() === 'CalculatedDataField';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isCorruptedCalcField\", {\n    get: function () {\n      return this.isCalcField && this.data.isCorruptedCalcField();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isOlap\", {\n    get: function () {\n      return _data_field_1.DataField.isOlap(this.data.dataMember());\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isOlapDimension\", {\n    get: function () {\n      return this.data.nodeType && this.data.nodeType() === 'OlapDimension';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isOlapDimensionHierarchy\", {\n    get: function () {\n      return this.data.nodeType && this.data.nodeType() === 'OlapHierarchy';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isOlapMeasure\", {\n    get: function () {\n      return this.data.nodeType && (this.data.nodeType() === 'OlapMeasure' || this.data.nodeType() === 'OlapMeasureFolder');\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isAggregate\", {\n    get: function () {\n      return this.data.isAggregate && this.data.isAggregate();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"isList\", {\n    get: function () {\n      return !_data_source_browser_1.isNonCollectionDataField(this.data);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"disabled\", {\n    get: function () {\n      return this.isList;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserItem.prototype, \"typeTooltip\", {\n    get: function () {\n      if (this.isList) return _default_1.getLocalizationById('DashboardStringId.MessageCollectionTypesNotSupported');\n      if (this.isCorruptedCalcField) return _default_1.getLocalizationById('DashboardWebStringId.DataSources.CalculatedField.Corrupted');\n      return this.data.fieldType();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return FieldChooserItem;\n}();\n\nexports.FieldChooserItem = FieldChooserItem;\n\nvar TreeViewFieldChooserItem = function (_super) {\n  __extends(TreeViewFieldChooserItem, _super);\n\n  function TreeViewFieldChooserItem(data, id, parentId) {\n    var _this = _super.call(this, data) || this;\n\n    _this.data = data;\n    _this.id = id;\n    _this.parentId = parentId;\n    _this.selected = undefined;\n    return _this;\n  }\n\n  return TreeViewFieldChooserItem;\n}(FieldChooserItem);\n\nexports.TreeViewFieldChooserItem = TreeViewFieldChooserItem;\n\nvar FieldChooserList = function () {\n  function FieldChooserList(owner, path, pathParts, _selectedField) {\n    var _this = this;\n\n    if (path === void 0) {\n      path = '';\n    }\n\n    this.owner = owner;\n    this.path = path;\n    this.pathParts = pathParts;\n    this._selectedField = _selectedField;\n\n    this.itemClick = function (args) {\n      var item = args.itemData;\n\n      if (!item.isLeaf) {\n        _this.owner.slide(_this, item);\n      } else {\n        commonSelectedFieldName = item.data && item.data.dataMember();\n\n        if (!_this._selectedField() || _this._selectedField().dataMember() !== item.data.dataMember() || item.data['dataSourceName']) {\n          _this._selectedField(item.data);\n        }\n      }\n    };\n\n    this.onContentReady = function (e) {\n      var allItems = e.component.option('items');\n      var selectedItem = e.component.option('selectedItems')[0];\n      e.component.scrollToItem(allItems.indexOf(selectedItem));\n    };\n\n    this.items = ko.observable();\n    this.index = ko.observable(0);\n    this.ready = ko.observable(false);\n    this.selectedItemName = ko.observable();\n    this.loading = ko.observable(true);\n\n    var fieldSelector = function (field) {\n      if (field && (field.dataMember() !== _this.selectedItemName() || field['dataSourceName'])) {\n        _this.selectedItemName(field.dataMember());\n      }\n    };\n\n    _selectedField.subscribe(fieldSelector);\n\n    fieldSelector(_selectedField());\n    this.reload();\n    this.ancestors = pathParts && pathParts.length ? ['â€¦'].concat(pathParts) : null;\n  }\n\n  FieldChooserList.prototype.reload = function () {\n    var _this = this;\n\n    this.items([]);\n    var loadingTimeout = setTimeout(function () {\n      return _this.loading(true);\n    }, 25);\n\n    var _a = this.owner.dataSourceBrowser.splitFullPath(this.path),\n        dataSource = _a.dataSource,\n        dataMember = _a.dataMember,\n        fieldPath = _a.fieldPath;\n\n    this.owner.dataSourceBrowser.getDataFieldsArray(dataSource, dataMember, fieldPath, function () {\n      return true;\n    }).done(function (fields) {\n      clearTimeout(loadingTimeout);\n\n      _this.items(fields.filter(function (field) {\n        return !_this.owner.filter || _this.owner.filter(field);\n      }).map(function (field) {\n        return new FieldChooserItem(field);\n      }));\n\n      _this.loading(false);\n    });\n  };\n\n  return FieldChooserList;\n}();\n\nexports.FieldChooserList = FieldChooserList;\n\nvar SliderController = function () {\n  function SliderController(params) {\n    var _this = this;\n\n    this.lists = ko.observableArray();\n    this.isSliding = false;\n\n    this.backClick = function (pathItem, ancestors) {\n      if (!_this.isSliding) {\n        _this.isSliding = true;\n        var pathIndex = ancestors.length - 1 - ancestors.indexOf(pathItem);\n\n        _this.lists().forEach(function (list) {\n          return list.index(list.index() + pathIndex);\n        });\n\n        setTimeout(function () {\n          _this.lists.splice(_this.lists().length - pathIndex);\n\n          _this.isSliding = false;\n        }, FieldChooserController.TRANSITION_TIME);\n      }\n    };\n\n    this.rootPath = params.startPath;\n    this.dataSourceBrowser = params.dataSourceBrowser;\n    this.filter = params.filter;\n    this.selectedField = params.selectedField;\n    this.lists([new FieldChooserList(this, this.rootPath(), [], this.selectedField)]);\n    this.lists()[0].ready(true);\n  }\n\n  SliderController.prototype.slide = function (list, item) {\n    var _this = this;\n\n    if (!this.isSliding) {\n      this.isSliding = true;\n      var newList = new FieldChooserList(this, list.path === '' ? item.name : list.path + '.' + item.name, list.pathParts.concat([item.name]), this.selectedField);\n      newList.index(1);\n      this.lists.push(newList);\n      setTimeout(function () {\n        newList.ready(true);\n\n        _this.lists().forEach(function (list) {\n          return list.index(list.index() - 1);\n        });\n\n        setTimeout(function () {\n          _this.isSliding = false;\n        }, FieldChooserController.TRANSITION_TIME);\n      }, 1);\n    }\n  };\n\n  SliderController.TRANSITION_TIME = 310;\n  return SliderController;\n}();\n\nexports.SliderController = SliderController;\n\nvar FieldChooserController = function (_super) {\n  __extends(FieldChooserController, _super);\n\n  function FieldChooserController(params) {\n    var _this = _super.call(this, params) || this;\n\n    _this.addCalcField = function () {\n      var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()),\n          dataSource = _a.dataSource,\n          dataMember = _a.dataMember,\n          fieldPath = _a.fieldPath;\n\n      _this.calcFieldEditor.showAddDialog(dataSource, dataMember).then(function (cf) {\n        return _this.onCalcFieldSaveHandler(cf);\n      });\n    };\n\n    _this.editCalcField = function () {\n      var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()),\n          dataSource = _a.dataSource,\n          dataMember = _a.dataMember,\n          fieldPath = _a.fieldPath;\n\n      var calcField = _this.getCurrentCalcField();\n\n      _this.calcFieldEditor.showEditDialog(calcField, dataSource, dataMember).then(function (cf) {\n        return _this.onCalcFieldSaveHandler(cf);\n      });\n    };\n\n    _this.removeCalcField = function () {\n      var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()),\n          dataSource = _a.dataSource,\n          dataMember = _a.dataMember,\n          fieldPath = _a.fieldPath;\n\n      var calcField = _this.getCurrentCalcField();\n\n      _this.calcFieldEditor.removeCalcField(calcField, dataSource).then(function (cf) {\n        return _this.onCalcFieldSaveHandler(cf);\n      });\n    };\n\n    _this._inappropriateCalcFieldConfirmation = new _confirm_dialog_1.ConfirmDialogViewModel();\n\n    _this.onCalcFieldSaveHandler = function (calcField) {\n      var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()),\n          dataSource = _a.dataSource,\n          dataMember = _a.dataMember,\n          fieldPath = _a.fieldPath;\n\n      var updateUI = function () {\n        if (_this.isListMode.peek()) {\n          var list = _this.lists()[0];\n\n          list.reload();\n        } else {\n          _this.treeViewInstanceResolver.then(function (treeViewInstance) {\n            return treeViewInstance.option('dataSource', treeViewInstance.option('dataSource'));\n          });\n        }\n      };\n\n      updateUI();\n      return _this.dataSourceBrowser.findDataField(dataSource, dataMember, calcField.name()).then(function (field) {\n        var deferred = _jquery_helpers_1.createJQueryDeferred();\n\n        if (!_this.filter || _this.filter(field)) {\n          _this.selectedField(field);\n\n          _this._navigateToSelection(field.dataMember());\n\n          deferred.resolve();\n        } else {\n          _this._inappropriateCalcFieldConfirmation.confirm(_default_1.getLocalizationById('DashboardWebStringId.Dialog.Warning'), _default_1.getLocalizationById('DashboardWebStringId.Dialog.UnsupportedCalculatedField'), _default_1.getLocalizationById('DashboardStringId.ButtonOK')).done(function () {\n            return deferred.resolve({});\n          }).fail(function () {\n            return deferred.reject();\n          });\n        }\n\n        return deferred.promise();\n      }).then(updateUI);\n    };\n\n    _this.getCurrentCalcField = function () {\n      if (!_this.selectedField()) return null;\n\n      var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()),\n          dataSource = _a.dataSource,\n          dataMember = _a.dataMember,\n          fieldPath = _a.fieldPath;\n\n      var dataSourceInstance = _this.dataSourceBrowser.findDataSource(dataSource);\n\n      if (!dataSourceInstance.hasCalculatedFields) return null;\n      return dataSourceInstance.calculatedFields().filter(function (cf) {\n        return cf.name() == _this.selectedField().name();\n      })[0];\n    };\n\n    _this.isCalcFieldSelected = ko.pureComputed(function () {\n      return _this.selectedField() && _this.selectedField().nodeType && _this.selectedField().nodeType() === 'CalculatedDataField';\n    });\n    _this.isSearchMode = ko.observable(false);\n    _this.searchString = ko.observable().extend({\n      throttle: 300\n    });\n    _this.searchResults = ko.observableArray();\n    _this.hasSearchResults = ko.observable(false);\n\n    _this.searchButtonClick = function (_, ev) {\n      var newValue = !_this.isSearchMode();\n\n      _this.isSearchMode(newValue);\n\n      if (newValue) {\n        var textBoxContainer = ev.currentTarget.parentElement.parentElement.querySelector('.dx-textbox');\n        var textBox_1 = text_box_1.default.getInstance(textBoxContainer);\n        setTimeout(function () {\n          textBox_1.focus();\n          textBox_1.reset();\n        }, 100);\n      } else {\n        _this.searchString(null);\n      }\n    };\n\n    _this.selectViaSearchResults = function (data) {\n      var searchResultItem = data.itemData;\n\n      if (searchResultItem.item.data.dataMember != null && (!_this.selectedField() || searchResultItem.item.data.dataMember() !== _this.selectedField().dataMember())) {\n        _this.selectedField(searchResultItem.item.data);\n      }\n    };\n\n    _this.selectedSearchResult = ko.computed(function () {\n      return _this.searchResults().filter(function (res) {\n        return res.item.data.dataMember && _this.selectedField() && res.item.data.dataMember() === _this.selectedField().dataMember();\n      })[0];\n    });\n    _this.isListMode = isListMode;\n\n    _this.setListMode = function () {\n      isListMode(true);\n\n      _utils_1.LocalStorageHelper.setItem('dx-dashboard-field-chooser-is-list-mode', 'true');\n\n      _this.lists().forEach(function (list, index) {\n        return list.index.notifySubscribers();\n      });\n    };\n\n    _this.setTreeMode = function () {\n      isListMode(false);\n\n      _utils_1.LocalStorageHelper.setItem('dx-dashboard-field-chooser-is-list-mode', 'false');\n    };\n\n    _this.hasGroups = ko.computed(function () {\n      return !_this.lists()[0].items().every(function (item) {\n        return item.isLeaf;\n      });\n    });\n    _this.treeViewInstanceResolver = _jquery_helpers_1.createJQueryDeferred();\n    var selectedFieldName = _this.selectedField() && _this.selectedField().dataMember() || commonSelectedFieldName;\n\n    _this._navigateToSelection(selectedFieldName);\n\n    if (!_this.selectedField()) {\n      var navigationSubscription = _this.selectedField.subscribe(function (newSelection) {\n        if (newSelection) {\n          _this._navigateToSelection(newSelection.dataMember());\n\n          navigationSubscription.dispose();\n        }\n      });\n    }\n\n    _this.searchString.subscribe(function (searchFor) {\n      _this.searchResults([]);\n\n      _this.hasSearchResults(false);\n\n      if (!!searchFor) {\n        _this.dataSourceBrowser.fuzzyFindFields(_this.rootPath(), searchFor).done(function (res) {\n          _this.searchResults(res.filter(function (item) {\n            return item.field.isDataFieldNode() && (!_this.filter || _this.filter(item.field));\n          }).map(function (item) {\n            return {\n              path: _this.dataSourceBrowser.splitFullPath(item.path).fieldPath,\n              item: new FieldChooserItem(item.field)\n            };\n          }));\n\n          _this.hasSearchResults(true);\n        });\n      }\n    });\n\n    ko.computed(function () {\n      if (!_this.hasGroups() && !_this.isListMode.peek()) {\n        _this.isListMode(true);\n      }\n    });\n    _this.calcFieldEditor = new _calc_field_editor_1.CalcFieldEditor(_this.dataSourceBrowser);\n    return _this;\n  }\n\n  Object.defineProperty(FieldChooserController.prototype, \"dataSourceName\", {\n    get: function () {\n      var _a = this.dataSourceBrowser.splitFullPath(this.rootPath()),\n          dataSource = _a.dataSource,\n          dataMember = _a.dataMember,\n          fieldPath = _a.fieldPath;\n\n      return dataSource;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(FieldChooserController.prototype, \"canAddCalculatedField\", {\n    get: function () {\n      return this.calcFieldEditor.canAddCalculatedField(this.dataSourceName);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  FieldChooserController.prototype._navigateToSelection = function (selectedFieldName) {\n    var _this = this;\n\n    if (!selectedFieldName) {\n      return;\n    }\n\n    var pathComponents = (this.rootPath() || '').split('.');\n\n    var fieldChooserConstraint = function (field) {\n      return !_this.filter || _this.filter(field);\n    };\n\n    this.dataSourceBrowser.findPathToFieldInTree(pathComponents.shift(), pathComponents.join('.'), selectedFieldName, fieldChooserConstraint).done(function (fieldPath) {\n      if (_this.isListMode()) {\n        if (fieldPath) {\n          if (_this.lists().length === 1) {\n            _this.lists()[0].ready(false);\n\n            var selectionList = fieldPath.split('.');\n\n            var currentPath = _this.rootPath(),\n                currentPathParts = [];\n\n            selectionList.forEach(function (pathItem, index) {\n              currentPath = currentPath + '.' + pathItem;\n\n              if (_this.dataSourceBrowser.isFolder(currentPath)) {\n                currentPathParts = currentPathParts.concat(pathItem);\n                var newList = new FieldChooserList(_this, currentPath, currentPathParts, _this.selectedField);\n                newList.index(index + 1);\n\n                _this.lists.push(newList);\n              }\n            });\n          }\n\n          _this.isSliding = true;\n\n          _this.lists().forEach(function (list, index) {\n            return list.index(index - _this.lists().length + 1);\n          });\n\n          setTimeout(function () {\n            _this.lists().forEach(function (list) {\n              return list.ready(true);\n            });\n\n            _this.isSliding = false;\n          }, 1);\n        } else {\n          _this.isSliding = true;\n\n          _this.lists().forEach(function (list, index) {\n            return list.index(index);\n          });\n\n          setTimeout(function () {\n            _this.isSliding = false;\n\n            _this.lists([_this.lists()[0]]);\n\n            _this.lists().forEach(function (list) {\n              return list.ready(true);\n            });\n          }, SliderController.TRANSITION_TIME);\n        }\n      } else {\n        _this.treeViewInstanceResolver.then(function (treeViewInstance) {\n          if (fieldPath) {\n            var keys = fieldPath.split('.');\n\n            var nextNodeKey = _this.rootPath(),\n                num = 1;\n\n            while (keys.length) {\n              var keyparts = keys.splice(0, num);\n              var key = keyparts.join('.');\n              num++;\n              nextNodeKey = nextNodeKey + '.' + key;\n              treeViewInstance.expandItem(nextNodeKey);\n            }\n          }\n        });\n      }\n    });\n  };\n\n  Object.defineProperty(FieldChooserController.prototype, \"dataSourceTreeOptions\", {\n    get: function () {\n      var _this = this;\n\n      return {\n        dataSource: {\n          load: function (options) {\n            var parentId = options.filter && options.filter[1] || _this.rootPath();\n\n            var result = _jquery_helpers_1.createJQueryDeferred();\n\n            var _a = _this.dataSourceBrowser.splitFullPath(parentId),\n                dataSource = _a.dataSource,\n                dataMember = _a.dataMember,\n                fieldPath = _a.fieldPath;\n\n            _this.dataSourceBrowser.getDataFieldsArray(dataSource, dataMember, fieldPath, function () {\n              return true;\n            }).done(function (fields) {\n              var data = fields.filter(function (field) {\n                return !_this.filter || _this.filter(field);\n              }).map(function (field) {\n                var name = FieldChooserItem.getName(field);\n                var item = new TreeViewFieldChooserItem(field, parentId + '.' + name, parentId === _this.rootPath ? undefined : parentId);\n                item.selected = _this.selectedField() && field.dataMember() === _this.selectedField().dataMember();\n                return item;\n              });\n              result.resolve(data);\n            });\n\n            return result.promise();\n          }\n        },\n        rootValue: this.rootPath(),\n        dataStructure: 'plain',\n        keyExpr: 'id',\n        parentIdExpr: 'parentId',\n        hasItemsExpr: 'isGroup',\n        showCheckBoxesMode: 'none',\n        selectNodesRecursive: false,\n        selectionMode: 'single',\n        onItemClick: function (args) {\n          var fieldChooserItem = args.itemData;\n          var field = fieldChooserItem.data;\n\n          if (field.isDataFieldNode()) {\n            args.component.selectItem(args.itemData);\n          }\n        },\n        onItemSelectionChanged: function (args) {\n          var fieldChooserItem = args.itemData;\n          var field = fieldChooserItem.data;\n          commonSelectedFieldName = field && field.dataMember();\n\n          if (!_this.selectedField() || _this.selectedField().dataMember() !== field.dataMember()) {\n            _this.selectedField(field);\n          }\n        },\n        virtualModeEnabled: true,\n        onInitialized: function (e) {\n          return _this.treeViewInstanceResolver.resolve(e.component);\n        }\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return FieldChooserController;\n}(SliderController);\n\nexports.FieldChooserController = FieldChooserController;\nko.components.register('dx-field-chooser', {\n  viewModel: {\n    createViewModel: function (params) {\n      return new FieldChooserController(params);\n    }\n  },\n  template: {\n    element: 'dx-field-chooser-slider'\n  }\n});","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/designer/ui-widgets/field-chooser/_field-chooser-surface.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","defineProperty","exports","value","FieldChooserController","SliderController","FieldChooserList","TreeViewFieldChooserItem","FieldChooserItem","require","text_box_1","ko","_data_source_browser_1","_default_1","_jquery_helpers_1","_utils_1","_data_field_1","_calc_field_editor_1","_confirm_dialog_1","commonSelectedFieldName","isListMode","observable","LocalStorageHelper","getItem","data","getName","nodeType","toLowerCase","indexOf","dataMember","name","get","displayName","enumerable","configurable","isDataFieldNode","isLeaf","isList","fieldType","type","undefined","isCalcField","isCorruptedCalcField","DataField","isOlap","isAggregate","isNonCollectionDataField","getLocalizationById","_super","id","parentId","_this","selected","owner","path","pathParts","_selectedField","itemClick","args","item","itemData","slide","onContentReady","e","allItems","component","option","selectedItem","scrollToItem","items","index","ready","selectedItemName","loading","fieldSelector","field","subscribe","reload","ancestors","length","concat","loadingTimeout","setTimeout","_a","dataSourceBrowser","splitFullPath","dataSource","fieldPath","getDataFieldsArray","done","fields","clearTimeout","filter","map","params","lists","observableArray","isSliding","backClick","pathItem","pathIndex","forEach","list","splice","TRANSITION_TIME","rootPath","startPath","selectedField","newList","push","addCalcField","calcFieldEditor","showAddDialog","then","cf","onCalcFieldSaveHandler","editCalcField","calcField","getCurrentCalcField","showEditDialog","removeCalcField","_inappropriateCalcFieldConfirmation","ConfirmDialogViewModel","updateUI","peek","treeViewInstanceResolver","treeViewInstance","findDataField","deferred","createJQueryDeferred","_navigateToSelection","resolve","confirm","fail","reject","promise","dataSourceInstance","findDataSource","hasCalculatedFields","calculatedFields","isCalcFieldSelected","pureComputed","isSearchMode","searchString","extend","throttle","searchResults","hasSearchResults","searchButtonClick","_","ev","newValue","textBoxContainer","currentTarget","parentElement","querySelector","textBox_1","default","getInstance","focus","reset","selectViaSearchResults","searchResultItem","selectedSearchResult","computed","res","setListMode","setItem","notifySubscribers","setTreeMode","hasGroups","every","selectedFieldName","navigationSubscription","newSelection","dispose","searchFor","fuzzyFindFields","CalcFieldEditor","canAddCalculatedField","dataSourceName","pathComponents","split","fieldChooserConstraint","findPathToFieldInTree","shift","join","selectionList","currentPath","currentPathParts","isFolder","keys","nextNodeKey","num","keyparts","key","expandItem","load","options","result","rootValue","dataStructure","keyExpr","parentIdExpr","hasItemsExpr","showCheckBoxesMode","selectNodesRecursive","selectionMode","onItemClick","fieldChooserItem","selectItem","onItemSelectionChanged","virtualModeEnabled","onInitialized","components","register","viewModel","createViewModel","template","element"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (_field-chooser-surface.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FieldChooserController = exports.SliderController = exports.FieldChooserList = exports.TreeViewFieldChooserItem = exports.FieldChooserItem = void 0;\nrequire(\"devextreme/ui/scroll_view\");\nrequire(\"devextreme/ui/text_box\");\nvar text_box_1 = require(\"devextreme/ui/text_box\");\nvar ko = require(\"knockout\");\nvar _data_source_browser_1 = require(\"../../../common/_data-source-browser\");\nvar _default_1 = require(\"../../../data/localization/_default\");\nvar _jquery_helpers_1 = require(\"../../../data/_jquery-helpers\");\nvar _utils_1 = require(\"../../../data/_utils\");\nvar _data_field_1 = require(\"../../../model/data-sources/_data-field\");\nvar _calc_field_editor_1 = require(\"../../calc-field-editor/_calc-field-editor\");\nvar _confirm_dialog_1 = require(\"../../confirm-dialog/_confirm-dialog\");\nvar commonSelectedFieldName;\nvar isListMode = ko.observable(_utils_1.LocalStorageHelper.getItem('dx-dashboard-field-chooser-is-list-mode') === 'true');\nvar FieldChooserItem = (function () {\n    function FieldChooserItem(data) {\n        this.data = data;\n    }\n    FieldChooserItem.getName = function (data) {\n        return data.nodeType && data.nodeType() && data.nodeType().toLowerCase().indexOf('olap') !== -1 ? data.dataMember() : data.name();\n    };\n    Object.defineProperty(FieldChooserItem.prototype, \"displayName\", {\n        get: function () {\n            return this.data.displayName();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"name\", {\n        get: function () {\n            return FieldChooserItem.getName(this.data);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isHierarchy\", {\n        get: function () {\n            return this.data.nodeType && this.data.nodeType() === 'OlapHierarchy';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isLeaf\", {\n        get: function () {\n            return this.data.isDataFieldNode();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isGroup\", {\n        get: function () {\n            return !this.isLeaf && !this.isList;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"type\", {\n        get: function () {\n            return this.data.isDataFieldNode() ? this.data.fieldType() : '';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"normalizedType\", {\n        get: function () {\n            if (this.isList)\n                return 'list';\n            if (!this.isLeaf || this.type === undefined || this.data.nodeType && this.data.nodeType() === 'DataSource') {\n                return '';\n            }\n            switch (this.type) {\n                case 'Text':\n                    return 'string';\n                case 'Integer':\n                    return 'integer';\n                case 'Float':\n                case 'Double':\n                case 'Decimal':\n                    return 'float';\n                case 'DateTime':\n                    return 'datetime';\n                case 'Bool':\n                case 'Boolean':\n                    return 'boolean';\n            }\n            return 'custom';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isCalcField\", {\n        get: function () {\n            return this.data.nodeType && this.data.nodeType() === 'CalculatedDataField';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isCorruptedCalcField\", {\n        get: function () {\n            return this.isCalcField && this.data.isCorruptedCalcField();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isOlap\", {\n        get: function () {\n            return _data_field_1.DataField.isOlap(this.data.dataMember());\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isOlapDimension\", {\n        get: function () {\n            return this.data.nodeType && this.data.nodeType() === 'OlapDimension';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isOlapDimensionHierarchy\", {\n        get: function () {\n            return this.data.nodeType && this.data.nodeType() === 'OlapHierarchy';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isOlapMeasure\", {\n        get: function () {\n            return this.data.nodeType && (this.data.nodeType() === 'OlapMeasure' || this.data.nodeType() === 'OlapMeasureFolder');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isAggregate\", {\n        get: function () {\n            return this.data.isAggregate && this.data.isAggregate();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"isList\", {\n        get: function () {\n            return !_data_source_browser_1.isNonCollectionDataField(this.data);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"disabled\", {\n        get: function () {\n            return this.isList;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserItem.prototype, \"typeTooltip\", {\n        get: function () {\n            if (this.isList)\n                return _default_1.getLocalizationById('DashboardStringId.MessageCollectionTypesNotSupported');\n            if (this.isCorruptedCalcField)\n                return _default_1.getLocalizationById('DashboardWebStringId.DataSources.CalculatedField.Corrupted');\n            return this.data.fieldType();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FieldChooserItem;\n}());\nexports.FieldChooserItem = FieldChooserItem;\nvar TreeViewFieldChooserItem = (function (_super) {\n    __extends(TreeViewFieldChooserItem, _super);\n    function TreeViewFieldChooserItem(data, id, parentId) {\n        var _this = _super.call(this, data) || this;\n        _this.data = data;\n        _this.id = id;\n        _this.parentId = parentId;\n        _this.selected = undefined;\n        return _this;\n    }\n    return TreeViewFieldChooserItem;\n}(FieldChooserItem));\nexports.TreeViewFieldChooserItem = TreeViewFieldChooserItem;\nvar FieldChooserList = (function () {\n    function FieldChooserList(owner, path, pathParts, _selectedField) {\n        var _this = this;\n        if (path === void 0) { path = ''; }\n        this.owner = owner;\n        this.path = path;\n        this.pathParts = pathParts;\n        this._selectedField = _selectedField;\n        this.itemClick = function (args) {\n            var item = args.itemData;\n            if (!item.isLeaf) {\n                _this.owner.slide(_this, item);\n            }\n            else {\n                commonSelectedFieldName = item.data && item.data.dataMember();\n                if (!_this._selectedField() || (_this._selectedField().dataMember() !== item.data.dataMember()) || ((item.data['dataSourceName']))) {\n                    _this._selectedField(item.data);\n                }\n            }\n        };\n        this.onContentReady = function (e) {\n            var allItems = e.component.option('items');\n            var selectedItem = e.component.option('selectedItems')[0];\n            e.component.scrollToItem(allItems.indexOf(selectedItem));\n        };\n        this.items = ko.observable();\n        this.index = ko.observable(0);\n        this.ready = ko.observable(false);\n        this.selectedItemName = ko.observable();\n        this.loading = ko.observable(true);\n        var fieldSelector = function (field) {\n            if (field && ((field.dataMember() !== _this.selectedItemName()) || field['dataSourceName'])) {\n                _this.selectedItemName(field.dataMember());\n            }\n        };\n        _selectedField.subscribe(fieldSelector);\n        fieldSelector(_selectedField());\n        this.reload();\n        this.ancestors = pathParts && pathParts.length ? ['â€¦'].concat(pathParts) : null;\n    }\n    FieldChooserList.prototype.reload = function () {\n        var _this = this;\n        this.items([]);\n        var loadingTimeout = setTimeout(function () { return _this.loading(true); }, 25);\n        var _a = this.owner.dataSourceBrowser.splitFullPath(this.path), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n        this.owner.dataSourceBrowser.getDataFieldsArray(dataSource, dataMember, fieldPath, function () { return true; }).done(function (fields) {\n            clearTimeout(loadingTimeout);\n            _this.items(fields\n                .filter(function (field) { return !_this.owner.filter || _this.owner.filter(field); })\n                .map(function (field) { return new FieldChooserItem(field); }));\n            _this.loading(false);\n        });\n    };\n    return FieldChooserList;\n}());\nexports.FieldChooserList = FieldChooserList;\nvar SliderController = (function () {\n    function SliderController(params) {\n        var _this = this;\n        this.lists = ko.observableArray();\n        this.isSliding = false;\n        this.backClick = function (pathItem, ancestors) {\n            if (!_this.isSliding) {\n                _this.isSliding = true;\n                var pathIndex = ancestors.length - 1 - ancestors.indexOf(pathItem);\n                _this.lists().forEach(function (list) { return list.index(list.index() + pathIndex); });\n                setTimeout(function () {\n                    _this.lists.splice(_this.lists().length - pathIndex);\n                    _this.isSliding = false;\n                }, FieldChooserController.TRANSITION_TIME);\n            }\n        };\n        this.rootPath = params.startPath;\n        this.dataSourceBrowser = params.dataSourceBrowser;\n        this.filter = params.filter;\n        this.selectedField = params.selectedField;\n        this.lists([new FieldChooserList(this, this.rootPath(), [], this.selectedField)]);\n        this.lists()[0].ready(true);\n    }\n    SliderController.prototype.slide = function (list, item) {\n        var _this = this;\n        if (!this.isSliding) {\n            this.isSliding = true;\n            var newList = new FieldChooserList(this, list.path === '' ? item.name : list.path + '.' + item.name, list.pathParts.concat([item.name]), this.selectedField);\n            newList.index(1);\n            this.lists.push(newList);\n            setTimeout(function () {\n                newList.ready(true);\n                _this.lists().forEach(function (list) { return list.index(list.index() - 1); });\n                setTimeout(function () {\n                    _this.isSliding = false;\n                }, FieldChooserController.TRANSITION_TIME);\n            }, 1);\n        }\n    };\n    SliderController.TRANSITION_TIME = 310;\n    return SliderController;\n}());\nexports.SliderController = SliderController;\nvar FieldChooserController = (function (_super) {\n    __extends(FieldChooserController, _super);\n    function FieldChooserController(params) {\n        var _this = _super.call(this, params) || this;\n        _this.addCalcField = function () {\n            var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n            _this.calcFieldEditor\n                .showAddDialog(dataSource, dataMember)\n                .then(function (cf) { return _this.onCalcFieldSaveHandler(cf); });\n        };\n        _this.editCalcField = function () {\n            var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n            var calcField = _this.getCurrentCalcField();\n            _this.calcFieldEditor\n                .showEditDialog(calcField, dataSource, dataMember)\n                .then(function (cf) { return _this.onCalcFieldSaveHandler(cf); });\n        };\n        _this.removeCalcField = function () {\n            var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n            var calcField = _this.getCurrentCalcField();\n            _this.calcFieldEditor\n                .removeCalcField(calcField, dataSource)\n                .then(function (cf) { return _this.onCalcFieldSaveHandler(cf); });\n        };\n        _this._inappropriateCalcFieldConfirmation = new _confirm_dialog_1.ConfirmDialogViewModel();\n        _this.onCalcFieldSaveHandler = function (calcField) {\n            var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n            var updateUI = function () {\n                if (_this.isListMode.peek()) {\n                    var list = _this.lists()[0];\n                    list.reload();\n                }\n                else {\n                    _this.treeViewInstanceResolver.then(function (treeViewInstance) { return treeViewInstance.option('dataSource', treeViewInstance.option('dataSource')); });\n                }\n            };\n            updateUI();\n            return _this.dataSourceBrowser\n                .findDataField(dataSource, dataMember, calcField.name())\n                .then(function (field) {\n                var deferred = _jquery_helpers_1.createJQueryDeferred();\n                if (!_this.filter || _this.filter(field)) {\n                    _this.selectedField(field);\n                    _this._navigateToSelection(field.dataMember());\n                    deferred.resolve();\n                }\n                else {\n                    _this._inappropriateCalcFieldConfirmation\n                        .confirm(_default_1.getLocalizationById('DashboardWebStringId.Dialog.Warning'), _default_1.getLocalizationById('DashboardWebStringId.Dialog.UnsupportedCalculatedField'), _default_1.getLocalizationById('DashboardStringId.ButtonOK'))\n                        .done(function () { return deferred.resolve({}); })\n                        .fail(function () { return deferred.reject(); });\n                }\n                return deferred.promise();\n            })\n                .then(updateUI);\n        };\n        _this.getCurrentCalcField = function () {\n            if (!_this.selectedField())\n                return null;\n            var _a = _this.dataSourceBrowser.splitFullPath(_this.rootPath()), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n            var dataSourceInstance = _this.dataSourceBrowser.findDataSource(dataSource);\n            if (!dataSourceInstance.hasCalculatedFields)\n                return null;\n            return dataSourceInstance.calculatedFields().filter(function (cf) { return cf.name() == _this.selectedField().name(); })[0];\n        };\n        _this.isCalcFieldSelected = ko.pureComputed(function () {\n            return _this.selectedField() && _this.selectedField().nodeType && _this.selectedField().nodeType() === 'CalculatedDataField';\n        });\n        _this.isSearchMode = ko.observable(false);\n        _this.searchString = ko.observable().extend({ throttle: 300 });\n        _this.searchResults = ko.observableArray();\n        _this.hasSearchResults = ko.observable(false);\n        _this.searchButtonClick = function (_, ev) {\n            var newValue = !_this.isSearchMode();\n            _this.isSearchMode(newValue);\n            if (newValue) {\n                var textBoxContainer = ev.currentTarget.parentElement.parentElement.querySelector('.dx-textbox');\n                var textBox_1 = text_box_1.default.getInstance(textBoxContainer);\n                setTimeout(function () {\n                    textBox_1.focus();\n                    textBox_1.reset();\n                }, 100);\n            }\n            else {\n                _this.searchString(null);\n            }\n        };\n        _this.selectViaSearchResults = function (data) {\n            var searchResultItem = data.itemData;\n            if ((searchResultItem.item.data.dataMember != null) &&\n                (!_this.selectedField() || (searchResultItem.item.data.dataMember() !== _this.selectedField().dataMember()))) {\n                _this.selectedField(searchResultItem.item.data);\n            }\n        };\n        _this.selectedSearchResult = ko.computed(function () {\n            return _this.searchResults().filter(function (res) { return res.item.data.dataMember && _this.selectedField() && res.item.data.dataMember() === _this.selectedField().dataMember(); })[0];\n        });\n        _this.isListMode = isListMode;\n        _this.setListMode = function () {\n            isListMode(true);\n            _utils_1.LocalStorageHelper.setItem('dx-dashboard-field-chooser-is-list-mode', 'true');\n            _this.lists().forEach(function (list, index) { return list.index.notifySubscribers(); });\n        };\n        _this.setTreeMode = function () {\n            isListMode(false);\n            _utils_1.LocalStorageHelper.setItem('dx-dashboard-field-chooser-is-list-mode', 'false');\n        };\n        _this.hasGroups = ko.computed(function () { return !_this.lists()[0].items().every(function (item) { return item.isLeaf; }); });\n        _this.treeViewInstanceResolver = _jquery_helpers_1.createJQueryDeferred();\n        var selectedFieldName = _this.selectedField() && _this.selectedField().dataMember() || commonSelectedFieldName;\n        _this._navigateToSelection(selectedFieldName);\n        if (!_this.selectedField()) {\n            var navigationSubscription = _this.selectedField.subscribe(function (newSelection) {\n                if (newSelection) {\n                    _this._navigateToSelection(newSelection.dataMember());\n                    navigationSubscription.dispose();\n                }\n            });\n        }\n        _this.searchString.subscribe(function (searchFor) {\n            _this.searchResults([]);\n            _this.hasSearchResults(false);\n            if (!!searchFor) {\n                _this.dataSourceBrowser.fuzzyFindFields(_this.rootPath(), searchFor).done(function (res) {\n                    _this.searchResults(res\n                        .filter(function (item) { return item.field.isDataFieldNode() && (!_this.filter || _this.filter(item.field)); })\n                        .map(function (item) { return ({\n                        path: _this.dataSourceBrowser.splitFullPath(item.path).fieldPath,\n                        item: new FieldChooserItem(item.field)\n                    }); }));\n                    _this.hasSearchResults(true);\n                });\n            }\n        });\n        ko.computed(function () {\n            if (!_this.hasGroups() && !_this.isListMode.peek()) {\n                _this.isListMode(true);\n            }\n        });\n        _this.calcFieldEditor = new _calc_field_editor_1.CalcFieldEditor(_this.dataSourceBrowser);\n        return _this;\n    }\n    Object.defineProperty(FieldChooserController.prototype, \"dataSourceName\", {\n        get: function () {\n            var _a = this.dataSourceBrowser.splitFullPath(this.rootPath()), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n            return dataSource;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FieldChooserController.prototype, \"canAddCalculatedField\", {\n        get: function () {\n            return this.calcFieldEditor.canAddCalculatedField(this.dataSourceName);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FieldChooserController.prototype._navigateToSelection = function (selectedFieldName) {\n        var _this = this;\n        if (!selectedFieldName) {\n            return;\n        }\n        var pathComponents = (this.rootPath() || '').split('.');\n        var fieldChooserConstraint = function (field) { return !_this.filter || _this.filter(field); };\n        this.dataSourceBrowser.findPathToFieldInTree(pathComponents.shift(), pathComponents.join('.'), selectedFieldName, fieldChooserConstraint)\n            .done(function (fieldPath) {\n            if (_this.isListMode()) {\n                if (fieldPath) {\n                    if (_this.lists().length === 1) {\n                        _this.lists()[0].ready(false);\n                        var selectionList = fieldPath.split('.');\n                        var currentPath = _this.rootPath(), currentPathParts = [];\n                        selectionList.forEach(function (pathItem, index) {\n                            currentPath = currentPath + '.' + pathItem;\n                            if (_this.dataSourceBrowser.isFolder(currentPath)) {\n                                currentPathParts = currentPathParts.concat(pathItem);\n                                var newList = new FieldChooserList(_this, currentPath, currentPathParts, _this.selectedField);\n                                newList.index(index + 1);\n                                _this.lists.push(newList);\n                            }\n                        });\n                    }\n                    _this.isSliding = true;\n                    _this.lists().forEach(function (list, index) { return list.index(index - _this.lists().length + 1); });\n                    setTimeout(function () {\n                        _this.lists().forEach(function (list) { return list.ready(true); });\n                        _this.isSliding = false;\n                    }, 1);\n                }\n                else {\n                    _this.isSliding = true;\n                    _this.lists().forEach(function (list, index) { return list.index(index); });\n                    setTimeout(function () {\n                        _this.isSliding = false;\n                        _this.lists([_this.lists()[0]]);\n                        _this.lists().forEach(function (list) { return list.ready(true); });\n                    }, SliderController.TRANSITION_TIME);\n                }\n            }\n            else {\n                _this.treeViewInstanceResolver.then(function (treeViewInstance) {\n                    if (fieldPath) {\n                        var keys = fieldPath.split('.');\n                        var nextNodeKey = _this.rootPath(), num = 1;\n                        while (keys.length) {\n                            var keyparts = keys.splice(0, num);\n                            var key = keyparts.join('.');\n                            num++;\n                            nextNodeKey = nextNodeKey + '.' + key;\n                            treeViewInstance.expandItem(nextNodeKey);\n                        }\n                    }\n                });\n            }\n        });\n    };\n    Object.defineProperty(FieldChooserController.prototype, \"dataSourceTreeOptions\", {\n        get: function () {\n            var _this = this;\n            return {\n                dataSource: {\n                    load: function (options) {\n                        var parentId = options.filter && options.filter[1] || _this.rootPath();\n                        var result = _jquery_helpers_1.createJQueryDeferred();\n                        var _a = _this.dataSourceBrowser.splitFullPath(parentId), dataSource = _a.dataSource, dataMember = _a.dataMember, fieldPath = _a.fieldPath;\n                        _this.dataSourceBrowser.getDataFieldsArray(dataSource, dataMember, fieldPath, function () { return true; }).done(function (fields) {\n                            var data = fields\n                                .filter(function (field) { return !_this.filter || _this.filter(field); })\n                                .map(function (field) {\n                                var name = FieldChooserItem.getName(field);\n                                var item = new TreeViewFieldChooserItem(field, parentId + '.' + name, parentId === _this.rootPath ? undefined : parentId);\n                                item.selected = _this.selectedField() && (field.dataMember() === _this.selectedField().dataMember());\n                                return item;\n                            });\n                            result.resolve(data);\n                        });\n                        return result.promise();\n                    },\n                },\n                rootValue: this.rootPath(),\n                dataStructure: 'plain',\n                keyExpr: 'id',\n                parentIdExpr: 'parentId',\n                hasItemsExpr: 'isGroup',\n                showCheckBoxesMode: 'none',\n                selectNodesRecursive: false,\n                selectionMode: 'single',\n                onItemClick: function (args) {\n                    var fieldChooserItem = args.itemData;\n                    var field = fieldChooserItem.data;\n                    if (field.isDataFieldNode()) {\n                        args.component.selectItem(args.itemData);\n                    }\n                },\n                onItemSelectionChanged: function (args) {\n                    var fieldChooserItem = args.itemData;\n                    var field = fieldChooserItem.data;\n                    commonSelectedFieldName = field && field.dataMember();\n                    if (!_this.selectedField() || (_this.selectedField().dataMember() !== field.dataMember())) {\n                        _this.selectedField(field);\n                    }\n                },\n                virtualModeEnabled: true,\n                onInitialized: function (e) { return _this.treeViewInstanceResolver.resolve(e.component); }\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FieldChooserController;\n}(SliderController));\nexports.FieldChooserController = FieldChooserController;\nko.components.register('dx-field-chooser', {\n    viewModel: {\n        createViewModel: function (params) {\n            return new FieldChooserController(params);\n        }\n    },\n    template: { element: 'dx-field-chooser-slider' }\n});\n"]},"metadata":{},"sourceType":"script"}