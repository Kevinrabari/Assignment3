{"ast":null,"code":"/**\r\n* DevExpress Dashboard (data-dashboard-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataDashboardItem = void 0;\n\nvar analytics_criteria_1 = require(\"@devexpress/analytics-core/analytics-criteria\");\n\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\n\nvar analytics_widgets_internal_1 = require(\"@devexpress/analytics-core/analytics-widgets-internal\");\n\nvar ko = require(\"knockout\");\n\nvar _item_data_axis_builder_1 = require(\"../../data/item-data/internal/_item-data-axis-builder\");\n\nvar _item_data_axis_helper_1 = require(\"../../data/item-data/internal/_item-data-axis-helper\");\n\nvar _item_data_manager_1 = require(\"../../data/item-data/internal/_item-data-manager\");\n\nvar item_data_axis_names_1 = require(\"../../data/item-data/item-data-axis-names\");\n\nvar _item_data_tuple_1 = require(\"../../data/item-data/_item-data-tuple\");\n\nvar _default_1 = require(\"../../data/localization/_default\");\n\nvar special_values_1 = require(\"../../data/special-values\");\n\nvar _common_1 = require(\"../../data/_common\");\n\nvar _jquery_helpers_1 = require(\"../../data/_jquery-helpers\");\n\nvar _utils_1 = require(\"../../data/_utils\");\n\nvar color_scheme_definition_1 = require(\"../colorization/color-scheme-definition\");\n\nvar color_scheme_entry_1 = require(\"../colorization/color-scheme-entry\");\n\nvar dashboard_state_1 = require(\"../dashboard-state\");\n\nvar data_item_1 = require(\"../data-item/data-item\");\n\nvar dimension_1 = require(\"../data-item/dimension\");\n\nvar measure_1 = require(\"../data-item/measure\");\n\nvar _dimension_1 = require(\"../data-item/metadata/_dimension\");\n\nvar _measure_1 = require(\"../data-item/metadata/_measure\");\n\nvar specific_calc_window_definition_1 = require(\"../data-item/window-definition/specific-calc-window-definition\");\n\nvar _dimension_filter_values_1 = require(\"../data-item/_dimension-filter-values\");\n\nvar _data_field_1 = require(\"../data-sources/_data-field\");\n\nvar card_item_delta_format_rule_1 = require(\"../format-rules/card-item-delta-format-rule\");\n\nvar card_item_format_rule_1 = require(\"../format-rules/card-item-format-rule\");\n\nvar chart_item_format_rule_1 = require(\"../format-rules/chart-item-format-rule\");\n\nvar grid_item_format_rule_1 = require(\"../format-rules/grid-item-format-rule\");\n\nvar pivot_item_format_rule_1 = require(\"../format-rules/pivot-item-format-rule\");\n\nvar scatter_chart_item_format_rule_1 = require(\"../format-rules/scatter-chart-item-format-rule\");\n\nvar _array_utils_1 = require(\"../internal/_array-utils\");\n\nvar _dashboard_component_name_generator_1 = require(\"../internal/_dashboard-component-name-generator\");\n\nvar _date_utils_1 = require(\"../internal/_date-utils\");\n\nvar _expanding_manager_1 = require(\"../internal/_expanding-manager\");\n\nvar _helper_classes_1 = require(\"../internal/_helper-classes\");\n\nvar _knockout_utils_1 = require(\"../internal/_knockout-utils\");\n\nvar _obsolete_dashboard_state_1 = require(\"../internal/_obsolete-dashboard-state\");\n\nvar _utils_2 = require(\"../internal/_utils\");\n\nvar dashboard_item_1 = require(\"./dashboard-item\");\n\nvar _data_dashboard_item_1 = require(\"./metadata/_data-dashboard-item\");\n\nvar _limit_data_state_1 = require(\"./_limit-data-state\");\n\nvar DataDashboardItem = function (_super) {\n  __extends(DataDashboardItem, _super);\n\n  function DataDashboardItem(dashboardItemJSON, serializer, info) {\n    if (dashboardItemJSON === void 0) {\n      dashboardItemJSON = {};\n    }\n\n    if (serializer === void 0) {\n      serializer = new analytics_utils_1.ModelSerializer();\n    }\n\n    if (info === void 0) {\n      info = undefined;\n    }\n\n    var _this = _super.call(this, dashboardItemJSON, serializer, info) || this;\n\n    _this.hiddenDimensions = ko.observableArray([]);\n    _this.hiddenMeasures = ko.observableArray([]);\n    _this.colorScheme = ko.observableArray();\n    _this._masterFilterMode = ko.computed(function () {\n      return _this._getMasterFilterMode();\n    });\n    _this._isSingleMasterFilter = ko.computed(function () {\n      return _this._masterFilterMode() === 'Single';\n    });\n    _this._isMultipleMasterFilter = ko.computed(function () {\n      return _this._masterFilterMode() === 'Multiple';\n    });\n    _this._isDrillDownEnabled = ko.computed(function () {\n      return _this._getDrillDownEnabled();\n    });\n    _this._isIgnoreMasterFilter = ko.computed(function () {\n      return _this._getIgnoreMasterFilter();\n    });\n    _this._isMasterFilter = ko.computed(function () {\n      return _this._getIsMasterFilter();\n    });\n    _this._clearMasterFilterSupported = ko.computed(function () {\n      return _this._getClearMasterFilterSupported();\n    });\n    _this._fullRange = ko.observable();\n    _this._selectedElementIndex = ko.observable();\n    _this._beforeMasterFilterSetByUserInteraction = null;\n    _this._afterMasterFilterSetByUserInteraction = null;\n    _this._drillDownChangedByUserInteraction = null;\n    _this._masterFilterItems = ko.observable([]);\n    _this._dataManager = ko.observable();\n    _this._drillDownValues = ko.observableArray([]);\n    _this._clientState = ko.observable();\n    _this._dataRequestArgs = ko.observable();\n    _this._expandingManager = new _expanding_manager_1.ExpandingManager();\n    _this._selectionValues = ko.observable();\n    _this._supportedUIStates = ko.observable(['error', 'empty', 'loading']);\n    _this._limitDataState = new _limit_data_state_1.LimitDataState();\n    _this._isExcludingAllFilter = ko.computed(function () {\n      return false;\n    });\n\n    _this._processItemSelectionChange = function (itemElement, mode, selection) {\n      if (mode === _common_1.viewerActions.setMasterFilter || mode === _common_1.viewerActions.setMultipleValuesMasterFilter) {\n        _this._beforeMasterFilterSetByUserInteraction && _this._beforeMasterFilterSetByUserInteraction();\n\n        var itemState = _jquery_helpers_1.deepExtend({}, _this._state());\n\n        itemState = _this._removeSelectionFromState(itemState);\n        itemState = _this._setSelectionToState(itemState, selection);\n\n        _this._setState(itemState);\n\n        _this._afterMasterFilterSetByUserInteraction && _this._afterMasterFilterSetByUserInteraction();\n      } else if (mode === _common_1.viewerActions.drillDown) {\n        _this._drillDownChangedByUserInteraction && _this._drillDownChangedByUserInteraction();\n\n        _this._drillDownValues.push(selection[0]);\n\n        _this._setSelectionData(null);\n      }\n    };\n\n    _this._processItemDrillUp = function () {\n      _this._drillDownChangedByUserInteraction && _this._drillDownChangedByUserInteraction();\n\n      var drillValue = _this._drillDownValues.pop();\n\n      _this._selectionValues(_this._isMasterFilter() ? [[drillValue]] : null);\n    };\n\n    _this._processItemClearMasterFilter = function (itemElement) {\n      _this._beforeMasterFilterSetByUserInteraction && _this._beforeMasterFilterSetByUserInteraction();\n\n      var itemState = _jquery_helpers_1.deepExtend({}, _this._state());\n\n      itemState = _this._removeSelectionFromState(itemState);\n\n      _this._setState(itemState);\n\n      _this._afterMasterFilterSetByUserInteraction && _this._afterMasterFilterSetByUserInteraction();\n    };\n\n    _this._processItemSetPredefinedPeriod = function (periodName) {\n      var itemState = _jquery_helpers_1.deepExtend({}, _this._state());\n\n      itemState = _this._removeSelectionFromState(itemState);\n      itemState = _this._setPredefinedPeriodToState(itemState, periodName);\n\n      _this._setState(itemState);\n    };\n\n    _this._processContentElementSelection = function (itemName, args) {\n      _this._selectedElementIndex(args.index);\n    };\n\n    _this._processDataRequest = function () {};\n\n    _this._processItemClientStateUpdate = function (itemName, clientState) {\n      _this._setClientState(clientState);\n    };\n\n    _this._processExpandingStateChanged = function (expandingParams, dxPivotState) {\n      _this._expandingManager.onViewStateChanged(expandingParams, dxPivotState);\n    };\n\n    _this._processItemExpandingChange = function (expandingParams) {\n      _this._expandingManager.setExpandingParams(expandingParams);\n\n      _this._dataQueryParams.notifySubscribers();\n    };\n\n    _this.dataItems = analytics_utils_1.deserializeArray(dashboardItemJSON.DataItems, function (dataItemJSON) {\n      return DataDashboardItem._createDataItem(dataItemJSON['@ItemType'], dataItemJSON, serializer);\n    });\n    _this.formatRules = analytics_utils_1.deserializeArray(dashboardItemJSON.FormatRules, function (rule) {\n      return DataDashboardItem._createFormatRule(_this, rule, serializer);\n    });\n    _this.__hiddenDimensions = analytics_utils_1.deserializeArray(dashboardItemJSON.HiddenDimensions, function (item) {\n      return new data_item_1.DataItemLink(_this, item, serializer);\n    });\n    _this.__hiddenMeasures = analytics_utils_1.deserializeArray(dashboardItemJSON.HiddenMeasures, function (item) {\n      return new data_item_1.DataItemLink(_this, item, serializer);\n    });\n\n    _this._subscribeDataItemLinkArrays(_data_dashboard_item_1.hiddenDimensions, _data_dashboard_item_1.hiddenMeasures);\n\n    _this.colorScheme(analytics_utils_1.deserializeArray(dashboardItemJSON.ColorScheme, function (item) {\n      return new color_scheme_entry_1.ColorSchemeEntry(item, serializer, _this.componentName(), _this.name());\n    })());\n\n    _this.__hiddenMeasures.subscribe(function (links) {\n      _this._setLinkCollectionAcceptableShapingType(links, data_item_1.AcceptableShapingType.Hidden);\n    });\n\n    _this._setLinkCollectionAcceptableShapingType(_this.__hiddenMeasures(), data_item_1.AcceptableShapingType.Hidden);\n\n    _this._componentNameGenerator = new _dashboard_component_name_generator_1.DashboardUniqueNameGenerator('uniqueName', 0, _this.dataItems);\n    _this._state = ko.computed(function () {\n      var state = new dashboard_state_1.ItemState();\n\n      if (_this._drillDownValues().length) {\n        state.DrillDownValues = _date_utils_1.toStringArray(_this._drillDownValues());\n      }\n\n      if (_this._selectionValues()) {\n        state.MasterFilterValues = _date_utils_1.toStringArray(_this._selectionValues());\n      }\n\n      if (_this._selectedElementIndex()) {\n        state.SelectedLayerIndex = _this._selectedElementIndex();\n      }\n\n      return state;\n    });\n    _this._actions = ko.computed({\n      read: function () {\n        var newValue = [];\n        var interactivityDimensionCount = _this._interactivityDimensions.length;\n\n        var drillDownValuesCount = _this._drillDownValues().length;\n\n        if (_this._isMasterFilter() && interactivityDimensionCount > 0) {\n          newValue.push(_common_1.viewerActions.setMasterFilter);\n        }\n\n        if (_this._isMultipleMasterFilter() && interactivityDimensionCount > 0) {\n          newValue.push(_common_1.viewerActions.setMultipleValuesMasterFilter);\n        }\n\n        if (_this._isDrillDownEnabled() && drillDownValuesCount < interactivityDimensionCount - 1) {\n          newValue.push(_common_1.viewerActions.drillDown);\n        }\n\n        var isPreviousLevelSelection = false;\n\n        if (drillDownValuesCount > 0) {\n          newValue.push(_common_1.viewerActions.drillUp);\n\n          if (_this._selectionValues() && _this._selectionValues()[0] && _this._selectionValues()[0][0] === _this._drillDownValues()[drillDownValuesCount - 1]) {\n            isPreviousLevelSelection = true;\n          }\n        }\n\n        if (_this._hasSelection() && !isPreviousLevelSelection) {\n          newValue.push(_common_1.viewerActions.clearMasterFilter);\n        }\n\n        return newValue;\n      },\n      deferEvaluation: true\n    });\n    _this._outputFilter = ko.computed(function () {\n      if (!_this._isMasterFilter()) return undefined;\n\n      var result = undefined,\n          serializer = new analytics_utils_1.ModelSerializer(),\n          selectionValues = _this._selectionValues(),\n          selectionValuesCount = selectionValues ? selectionValues.length : 0,\n          drillDownValuesCount = _this._drillDownValues.peek().length,\n          dimensionality = selectionValuesCount > 0 ? selectionValues[0].length : 0,\n          fullRange = _this._fullRange();\n\n      if (selectionValuesCount > 0 || drillDownValuesCount > 0) {\n        result = {\n          dimensions: _this._interactivityDimensions.slice(0, drillDownValuesCount + dimensionality).map(function (dimension) {\n            return serializer.serialize(dimension);\n          })\n        };\n\n        if (result.dimensions.length === 1 && selectionValuesCount === 1 && dimensionality === 2) {\n          result.range = selectionValues[0];\n        } else {\n          result.values = selectionValuesCount > 0 ? selectionValues.map(function (arr) {\n            return _this._drillDownValues.peek().concat(arr);\n          }) : [_this._drillDownValues.peek()];\n        }\n      }\n\n      if (!result) {\n        if (fullRange && fullRange.length && _this._interactivityDimensions.length) {\n          result = {\n            dimensions: _this._interactivityDimensions.map(function (dim) {\n              return serializer.serialize(dim);\n            }),\n            range: fullRange\n          };\n        }\n      }\n\n      if (_this._isExcludingAllFilter()) {\n        result = result || {};\n        result.isExcludingAllFilter = true;\n      }\n\n      result = _this._performOutputFilterOptimization(result);\n      return result;\n    });\n    _this._dataQueryParams = ko.computed(function () {\n      var result = {};\n\n      if (_this.dataItems().length > 0) {\n        var externalFilter = _this._masterFilterItems().filter(function (item) {\n          return !!item._outputFilter();\n        }).map(function (item) {\n          return item._outputFilter();\n        });\n\n        if (externalFilter.length) {\n          result.Filter = externalFilter.map(function (f) {\n            var v = {};\n\n            if (!!f.dimensions) {\n              v.dimensions = f.dimensions;\n            }\n\n            if (!!f.values) {\n              v.values = _date_utils_1.toStringArray(f.values);\n            }\n\n            if (!!f.range) {\n              v.range = _date_utils_1.toStringArray(f.range);\n            }\n\n            if (f.isExcludingAllFilter != undefined) {\n              v.isExcludingAllFilter = f.isExcludingAllFilter;\n            }\n\n            return v;\n          });\n        }\n\n        if (_this._drillDownValues().length) {\n          result.DrillDown = _date_utils_1.toStringArray(_this._drillDownValues());\n        }\n\n        if (_this._dataRequestArgs()) {\n          result.ClientState = _this._dataRequestArgs();\n        }\n\n        if (_this._selectedElementIndex()) {\n          result.SelectedElementIndex = _this._selectedElementIndex();\n        }\n      }\n\n      return result;\n    });\n    _this._colorableItems = ko.observable([_this]);\n    _this._uiState && _this._uiState['dispose'] && _this._uiState['dispose']();\n    _this._uiState = ko.computed({\n      read: function () {\n        var result = 'live',\n            errorState = _this._errorState(),\n            previousState = _this._uiState(),\n            paneValid = _this._paneContentHolder.valid(),\n            viewerItemCreated = _this._viewerItemCreated(),\n            hasDataItems = !!_this.dataSource.peek() && !!_this.dataItems.peek().length;\n\n        if (_this._stateSupported('error') && errorState) {\n          result = 'error';\n        } else if (_this._stateSupported('empty') && !hasDataItems) {\n          result = 'empty';\n        } else if (_this._stateSupported('loading') && !paneValid && (!viewerItemCreated || 'empty' === previousState || 'error' === previousState)) {\n          result = 'loading';\n        } else {\n          result = 'live';\n        }\n\n        return result;\n      },\n      deferEvaluation: true\n    });\n    ko.computed(function () {\n      if (_this._selectedElementIndex() >= _this._getLayersCount()) {\n        _this._selectedElementIndex(null);\n      }\n    });\n    ko.computed(function () {\n      _this.dataItems().map(function (d) {\n        return d instanceof measure_1.Measure ? d.windowDefinition.windowDefinition() : null;\n      }).filter(function (def) {\n        return def != null;\n      }).forEach(function (def) {\n        if (def instanceof specific_calc_window_definition_1.SpecificWindowDefinition) {\n          def.dimensions().forEach(function (link) {\n            return link._updateProvider(_this);\n          });\n        }\n      });\n    });\n    ko.computed(function () {\n      if (!_this.dataSource() || _this.dataItems().length === 0) {\n        _this._dataManager(null);\n      }\n    });\n\n    _knockout_utils_1.subscribeToArrayItemProperties(_this.dataItems, function (dataItem) {\n      if (dataItem instanceof dimension_1.Dimension) {\n        return dataItem.dateTimeGroupInterval.subscribe(function () {\n          _this._removeFromFilters(dataItem);\n        });\n      }\n\n      return null;\n    });\n\n    return _this;\n  }\n\n  DataDashboardItem._createDataItem = function (itemTypeName, dataItemJSON, serializer) {\n    var itemType = DataDashboardItem._itemTypesMap[itemTypeName];\n    return new itemType(dataItemJSON, serializer);\n  };\n\n  DataDashboardItem._updateDataItemByField = function (dataField, newDataItem, summaryInfo) {\n    newDataItem.dataMember(dataField.dataMember());\n\n    if (newDataItem instanceof measure_1.Measure) {\n      if (!_data_field_1.DataField.isOlap(dataField.dataMember())) {\n        if (!!summaryInfo && summaryInfo.oldDataItem instanceof measure_1.Measure) {\n          var avaliableSummaryTypes = DataDashboardItem._getAvaliableSummaryTypeInfo(dataField, summaryInfo.acceptableShapingType, newDataItem);\n\n          if (avaliableSummaryTypes) {\n            if (Object.keys(avaliableSummaryTypes.values).indexOf(summaryInfo.oldDataItem.summaryType()) !== -1) {\n              newDataItem.summaryType(summaryInfo.oldDataItem.summaryType());\n            } else {\n              newDataItem.summaryType(avaliableSummaryTypes.defaultVal);\n            }\n          }\n        } else {\n          newDataItem.summaryType(getSummaryType(dataField));\n        }\n      } else if (!!dataField['defaultNumericFormat']) {\n        var defaultNumericFormat = dataField['defaultNumericFormat'];\n        newDataItem.numericFormat.currencyCultureName(defaultNumericFormat.CurrencyCultureName);\n        newDataItem.numericFormat.formatType(defaultNumericFormat.FormatType);\n        newDataItem.numericFormat.includeGroupSeparator(defaultNumericFormat.IncludeGroupSeparator);\n        newDataItem.numericFormat.precision(defaultNumericFormat.Precision);\n        newDataItem.numericFormat.unit(defaultNumericFormat.Unit);\n      }\n    }\n  };\n\n  DataDashboardItem._createFormatRule = function (item, formatRuleJSON, serializer) {\n    var typeName = formatRuleJSON['@ItemType'];\n    var type = DataDashboardItem._formatRuleTypesMap[typeName];\n    return new type(formatRuleJSON, serializer);\n  };\n\n  DataDashboardItem._getAvaliableSummaryTypeInfo = function (dataField, acceptableShapingType, dataItem) {\n    if (!!dataItem && dataItem instanceof measure_1.Measure && !!dataItem.expression()) return null;\n\n    if (!_data_field_1.DataField.isOlap(dataField.dataMember()) && !(dataField.isAggregate && dataField.isAggregate())) {\n      if (_data_field_1.DataField.isNumeric(dataField)) {\n        return _measure_1.summaryTypeNumericToAny;\n      } else {\n        switch (acceptableShapingType) {\n          case data_item_1.AcceptableShapingType.Number:\n            return _measure_1.summaryTypeNonNumericToNumeric;\n\n          case data_item_1.AcceptableShapingType.Attribute:\n            return _measure_1.summaryTypeAttribute;\n\n          case data_item_1.AcceptableShapingType.String:\n          case data_item_1.AcceptableShapingType.Hidden:\n            return _measure_1.summaryTypeNonNumericToString;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  Object.defineProperty(DataDashboardItem.prototype, \"_actualSelectionValues\", {\n    get: function () {\n      return this._selectionValues;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_canColorByMeasures\", {\n    get: function () {\n      return this._getCanColorByMeasures();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_canColorByDimensions\", {\n    get: function () {\n      return this._getCanColorByDimensions();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_isLocallyColored\", {\n    get: function () {\n      return (this._getAreMeasuresColoredByDefault() || this._getCanColorByDimensions()) && !this._getUseGlobalColors();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_isGloballyColored\", {\n    get: function () {\n      return (this._getAreMeasuresColoredByDefault() || this._getCanColorByDimensions()) && this._getUseGlobalColors();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_interactivityDimensions\", {\n    get: function () {\n      return this._getInteractivityDimensionLinks().map(function (link) {\n        return link.dataItem();\n      }).filter(function (item) {\n        return !!item;\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_dimensions\", {\n    get: function () {\n      return this.dataItems && this.dataItems().filter(function (item) {\n        return item instanceof dimension_1.Dimension;\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_measures\", {\n    get: function () {\n      return this.dataItems && this.dataItems().filter(function (item) {\n        return item instanceof measure_1.Measure;\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_uniqueDataItems\", {\n    get: function () {\n      var uniqueDataItems = [];\n      this.dataItems.peek().forEach(function (dataItem) {\n        if (uniqueDataItems.filter(function (item) {\n          return item.isDefinitionEquals(dataItem);\n        }).length === 0) {\n          uniqueDataItems.push(dataItem);\n        }\n      });\n      return uniqueDataItems;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataDashboardItem.prototype, \"_multiData\", {\n    get: function () {\n      var dataManager = this._dataManager.peek();\n\n      return dataManager && dataManager.getItemData();\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DataDashboardItem.prototype._removeFromFilters = function (dataItem) {\n    this.filterString(removeDataItemFromCriteria(this.filterString(), dataItem.uniqueName()));\n    this.visibleDataFilterString(removeDataItemFromCriteria(this.visibleDataFilterString(), dataItem.uniqueName()));\n\n    this._measures.forEach(function (measure) {\n      measure.filterString(removeDataItemFromCriteria(measure.filterString(), dataItem.uniqueName()));\n    });\n  };\n\n  DataDashboardItem.prototype._clearBindings = function () {\n    this.dataSource(null);\n    this.dataMember(null);\n    this.dataItems.removeAll();\n\n    this.__hiddenDimensions.removeAll();\n\n    this.__hiddenMeasures.removeAll();\n\n    this.colorScheme.removeAll();\n  };\n\n  DataDashboardItem.prototype._clearInteractivityState = function () {\n    this._selectionValues(null);\n\n    this._drillDownValues([]);\n  };\n\n  DataDashboardItem.prototype._isCalculationSupported = function () {\n    return true;\n  };\n\n  DataDashboardItem.prototype._isSortingEnabled = function () {\n    return true;\n  };\n\n  DataDashboardItem.prototype._isTopNEnabled = function (dataItem) {\n    return this.hiddenDimensions().indexOf(dataItem) == -1;\n  };\n\n  DataDashboardItem.prototype._isColoringEnabled = function (dataItem) {\n    if (dataItem instanceof dimension_1.Dimension) {\n      if (this._canColorByDimensions) {\n        if (this._isHiddenDimension(dataItem) || dataItem.coloringMode() === 'None') {\n          return false;\n        }\n\n        if (dataItem.coloringMode() === 'Hue') {\n          return true;\n        }\n\n        return this._getIsDimensionColoredByDefault(dataItem);\n      }\n    } else if (dataItem instanceof measure_1.Measure) {\n      if (this._canColorByMeasures) {\n        if (this._isHiddenMeasure(dataItem)) {\n          return false;\n        }\n\n        return this._coloredByMeasures();\n      }\n\n      return false;\n    }\n  };\n\n  DataDashboardItem.prototype._getDataItem = function (uniqueName) {\n    return this.dataItems().filter(function (item) {\n      return item.uniqueName() === uniqueName;\n    })[0];\n  };\n\n  DataDashboardItem.prototype._getFinalDataType = function (dataItemId) {\n    var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n    return !!metaData ? metaData.getFinalDataType(dataItemId) : 'Unknown';\n  };\n\n  DataDashboardItem.prototype._createDataItem = function (dataField, binding) {\n    var itemTypeName = binding.dataItemType;\n\n    if (!itemTypeName) {\n      itemTypeName = _data_field_1.DataField.isMeasure(dataField) ? 'Measure' : 'Dimension';\n    }\n\n    var newDataItem = DataDashboardItem._createDataItem(itemTypeName);\n\n    DataDashboardItem._updateDataItemByField(dataField, newDataItem);\n\n    this.dataItems.push(newDataItem);\n    return newDataItem;\n  };\n\n  DataDashboardItem.prototype._updateDataItem = function (dataItem, binding, dataField, acceptableShapingType) {\n    _helper_classes_1.Guard.isNotFalsy(dataItem, 'dataItem');\n\n    var itemTypeName = binding.dataItemType || dataItem.itemType();\n    var newDataItem = binding.dataItemType === dataItem.itemType() ? dataItem : DataDashboardItem._createDataItem(itemTypeName);\n\n    DataDashboardItem._updateDataItemByField(dataField, newDataItem, {\n      oldDataItem: dataItem,\n      acceptableShapingType: acceptableShapingType\n    });\n\n    this._unassignDataItem(dataItem, false);\n\n    if (newDataItem !== dataItem) {\n      this._removeDataItemCore(dataItem);\n\n      newDataItem.uniqueName(dataItem.uniqueName());\n      this.dataItems.push(newDataItem);\n    }\n  };\n\n  DataDashboardItem.prototype._removeDataItem = function (dataItem, skipGroups) {\n    this._removeDataItemCore(dataItem);\n\n    this._unassignDataItem(dataItem, skipGroups);\n  };\n\n  DataDashboardItem.prototype._attachDataItem = function (target, propertyName, link) {\n    var _this = this;\n\n    var dataItemLink = !!link ? link : new data_item_1.DataItemLink(this, {\n      '@DefaultId': target[propertyName].uniqueName()\n    });\n    target[propertyName] = dataItemLink;\n    target[propertyName.substring(2)] = ko.computed({\n      read: function () {\n        return dataItemLink.dataItem();\n      },\n      write: function (value) {\n        if (!!value) {\n          if (_this._getDataItem(value.uniqueName())) {\n            throw Error(\"DataItemLink: DataItem \" + value.uniqueName() + \" already exists\");\n          } else {\n            _this.dataItems.push(value);\n\n            dataItemLink.dataItem(value);\n          }\n        } else {\n          if (dataItemLink.dataItem()) {\n            _this._removeDataItem(dataItemLink.dataItem());\n\n            dataItemLink.dataItem(null);\n          }\n        }\n      }\n    });\n  };\n\n  DataDashboardItem.prototype._subscribeDataItemLinkArrays = function () {\n    var _this = this;\n\n    var propertyInfos = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      propertyInfos[_i] = arguments[_i];\n    }\n\n    propertyInfos.forEach(function (propertyInfo) {\n      var property = _this[propertyInfo.propertyName];\n\n      var realProperty = _this[propertyInfo.propertyName.substring(2)];\n\n      ko.computed(function () {\n        property().filter(function (value) {\n          return !value.dataItem();\n        }).forEach(function (value) {\n          return property.remove(value);\n        });\n      });\n      ko.computed(function () {\n        var linkedDataItems = property().map(function (link) {\n          return link.dataItem();\n        }).filter(function (dataItem) {\n          return !!dataItem;\n        });\n        realProperty.peek().filter(function (dataItem) {\n          return linkedDataItems.indexOf(dataItem) === -1;\n        }).forEach(function (itemToRemove) {\n          return realProperty.remove(itemToRemove);\n        });\n        linkedDataItems.filter(function (dataItem) {\n          return realProperty.peek().indexOf(dataItem) === -1;\n        }).forEach(function (itemToAdd) {\n          return realProperty.splice(linkedDataItems.indexOf(itemToAdd), 0, itemToAdd);\n        });\n      });\n\n      _knockout_utils_1.subscribeArrayChange(realProperty, {\n        added: function (dimension, index) {\n          if (!property().some(function (link) {\n            return link.dataItem() === dimension;\n          })) {\n            _this.dataItems.push(dimension);\n\n            var link = new data_item_1.DataItemLink(_this);\n            link.dataItem(dimension);\n            property.splice(index, 0, link);\n          }\n        },\n        deleted: function (dimension) {\n          if (property().some(function (link) {\n            return link.dataItem() === dimension;\n          })) {\n            _this.dataItems.remove(dimension);\n\n            property.remove(function (link) {\n              return link.dataItem() === dimension;\n            });\n          }\n        }\n      });\n    });\n  };\n\n  DataDashboardItem.prototype._getMasterFilterMode = function () {\n    return 'None';\n  };\n\n  DataDashboardItem.prototype._getDrillDownEnabled = function () {\n    return false;\n  };\n\n  DataDashboardItem.prototype._getIgnoreMasterFilter = function () {\n    return false;\n  };\n\n  DataDashboardItem.prototype._getClearMasterFilterSupported = function () {\n    return this._isMultipleMasterFilter();\n  };\n\n  DataDashboardItem.prototype._getIsMasterFilter = function () {\n    return this._isSingleMasterFilter() || this._isMultipleMasterFilter();\n  };\n\n  DataDashboardItem.prototype._getInteractivityDimensionLinks = function () {\n    return [];\n  };\n\n  DataDashboardItem.prototype._getCanColorByMeasures = function () {\n    return false;\n  };\n\n  DataDashboardItem.prototype._getCanColorByDimensions = function () {\n    return false;\n  };\n\n  DataDashboardItem.prototype._getAreMeasuresColoredByDefault = function () {\n    return false;\n  };\n\n  DataDashboardItem.prototype._getIsDimensionColoredByDefault = function (dimension) {\n    return false;\n  };\n\n  DataDashboardItem.prototype._coloredDimensions = function () {\n    var _this = this;\n\n    return this._dimensions.filter(function (item) {\n      return _this._isColoringEnabled(item);\n    });\n  };\n\n  DataDashboardItem.prototype._coloredByMeasures = function () {\n    if (this.coloringOptions.measuresColoringMode() === 'Hue') {\n      return true;\n    }\n\n    if (this.coloringOptions.measuresColoringMode() === 'None') {\n      return false;\n    }\n\n    return this._getAreMeasuresColoredByDefault();\n  };\n\n  DataDashboardItem.prototype._getUseGlobalColors = function () {\n    return this.coloringOptions && this.coloringOptions.useGlobalColors();\n  };\n\n  DataDashboardItem.prototype._getValidatedSelection = function (selectionValues) {\n    return selectionValues ? selectionValues.map(function (value) {\n      return value.map(_date_utils_1.tryConvertToDateTime);\n    }) : selectionValues;\n  };\n\n  DataDashboardItem.prototype._getClearMasterFilterState = function () {\n    if (this._clearMasterFilterSupported()) {\n      if (this._useNeutralFilterMode() && this._isSingleMasterFilter() && !this._allowAllValue()) {\n        return 'Disabled';\n      }\n\n      return this._actions().indexOf(_common_1.viewerActions.clearMasterFilter) !== -1 ? 'Enabled' : 'Hidden';\n    }\n\n    return 'Hidden';\n  };\n\n  DataDashboardItem.prototype._allowAllValue = function () {\n    return false;\n  };\n\n  DataDashboardItem.prototype._validateSelectionByData = function (selection) {\n    var activeDimensions = this._interactivityDimensions.slice(this._drillDownValues().length).map(function (d) {\n      return d.uniqueName();\n    });\n\n    if (this._isSingleMasterFilter() && activeDimensions.length > 0) {\n      var allSelection = this._getAllSelectionValues(activeDimensions);\n\n      if (!selection || !this._useNeutralFilterMode() && !_utils_1.arrayContains(allSelection, selection[0])) {\n        this._setSelectionData(allSelection.length > 0 ? [allSelection[0]] : null);\n      }\n    }\n  };\n\n  DataDashboardItem.prototype._updateContentData = function (content) {\n    _super.prototype._updateContentData.call(this, content);\n\n    if (this.dataItems().length > 0 || !this._stateSupported('empty')) {\n      this._updateDataManager(content);\n    }\n\n    if (content.ItemData && content.ItemData.Reduced) {\n      this._limitDataState.setReduced();\n    }\n\n    this._validateSelectionByData(this._actualSelectionValues());\n\n    var drillDownValues = this._getDisplayDrillDownValues();\n\n    _jquery_helpers_1.deepExtend(content, {\n      multiData: this._multiData,\n      DrillDownValues: !!drillDownValues ? drillDownValues.map(function (fv) {\n        return fv.Values;\n      }).reduce(function (v1, v2) {\n        return v1.concat(v2);\n      }) : undefined,\n      DrillDownUniqueValues: this._drillDownValues.peek().length > 0 ? this._drillDownValues.peek() : undefined,\n      LimitDataState: this._limitDataState.getViewModel()\n    });\n  };\n\n  DataDashboardItem.prototype._extendContentState = function (content) {\n    _super.prototype._extendContentState.call(this, content);\n\n    content.SelectedValues = this._actualSelectionValues.peek();\n  };\n\n  DataDashboardItem.prototype._updateDataManager = function (content) {\n    var itemDataDTO = content.ItemData,\n        contentType = content.ContentType;\n\n    if (itemDataDTO) {\n      _date_utils_1.patchDateTime(itemDataDTO.DataStorageDTO);\n    }\n\n    if (contentType === _common_1.contentType.partialDataSource && this._dataManager() && itemDataDTO) {\n      this._updateDataManagerByPartialDataSource(content, itemDataDTO);\n    } else {\n      if ((contentType === _common_1.contentType.fullContent || contentType === _common_1.contentType.completeDataSource) && itemDataDTO && itemDataDTO.MetaData) {\n        var dataManager = new _item_data_manager_1.itemDataManager();\n        dataManager.initialize(itemDataDTO);\n\n        this._dataManager(dataManager);\n      }\n\n      if (contentType !== _common_1.contentType.completeDataSource) {}\n    }\n\n    this._expandingManager.resetExpandingParams();\n  };\n\n  DataDashboardItem.prototype._updateDataManagerByPartialDataSource = function (content, itemDataDTO) {\n    content.Parameters[0] = !!content.Parameters[0] && content.Parameters[0].map(function (value) {\n      return _date_utils_1.tryConvertToDateTime(value);\n    });\n\n    this._dataManager().updateExpandedData(itemDataDTO, {\n      values: content.Parameters[0],\n      pivotArea: content.Parameters[1] ? _item_data_axis_builder_1.pivotAreaNames.columns : _item_data_axis_builder_1.pivotAreaNames.rows\n    });\n  };\n\n  DataDashboardItem.prototype._getAllSelectionValues = function (activeDimensions) {\n    return !!this._multiData ? this._multiData.getAllSelectionValues(activeDimensions) : [];\n  };\n\n  DataDashboardItem.prototype._getPointsByDimension = function (dimensionId, axisName) {\n    if (this._multiData) {\n      var axis = this._multiData.getAxis(axisName);\n\n      return axis ? axis.getPointsByDimension(dimensionId) : [];\n    }\n  };\n\n  DataDashboardItem.prototype._getColorizableDataItemsInfo = function () {\n    return [];\n  };\n\n  DataDashboardItem.prototype._getDefaultCalculationWindowDefinition = function () {\n    return undefined;\n  };\n\n  DataDashboardItem.prototype._getExportingSelection = function () {\n    return this._selectionValues();\n  };\n\n  DataDashboardItem.prototype._getDisplayFilterValues = function (limitCount) {\n    var _this = this;\n\n    var selection = this._outputFilter(),\n        outFilterValues = [];\n\n    if (selection && selection.dimensions) {\n      selection.dimensions.forEach(function (dimensionDefinition, dimensionIndex) {\n        var dimension = _this._dimensions.filter(function (d) {\n          return d.uniqueName() === dimensionDefinition['@DefaultId'];\n        })[0];\n\n        var filterValues = new _dimension_filter_values_1.DimensionFilterValues(_this._getDimensionDisplayName(dimension.uniqueName()));\n        var uniqueValues = {};\n\n        for (var valueIndex = 0, valueCount = 0; valueIndex < selection.values.length; valueIndex++) {\n          if (!!limitCount && valueCount >= limitCount) {\n            filterValues.Truncated = true;\n            break;\n          }\n\n          var value = selection.values[valueIndex][dimensionIndex];\n\n          if (!uniqueValues[value]) {\n            uniqueValues[value] = value;\n            valueCount++;\n          }\n        }\n\n        filterValues.Values = Object.keys(uniqueValues).map(function (v) {\n          return _this._createFormattableValue(dimension, uniqueValues[v]);\n        });\n        outFilterValues.push(filterValues);\n      });\n    }\n\n    return outFilterValues;\n  };\n\n  DataDashboardItem.prototype._createFormattableValue = function (dimension, value) {\n    var isOlap = _data_field_1.DataField.isOlap(dimension.dataMember());\n\n    var dimensionId = dimension.uniqueName();\n\n    if (isOlap) {\n      return {\n        Type: 'Value',\n        Value: this._getOlapDimensionDisplayText(value, dimensionId),\n        Format: undefined\n      };\n    } else {\n      var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n      return {\n        Type: 'Value',\n        Value: value,\n        Format: metaData ? metaData.getDimensionFormat(dimensionId) : undefined\n      };\n    }\n  };\n\n  DataDashboardItem.prototype._getDisplayFilterValuesExternal = function () {\n    var externalFilter = this._masterFilterItems().filter(function (item) {\n      return !!item._outputFilter();\n    });\n\n    return externalFilter.map(function (item) {\n      return item._getDisplayFilterValues();\n    }).filter(function (arr) {\n      return arr.length > 0;\n    }).reduce(function (acc, items) {\n      return acc.concat(items);\n    }, []);\n  };\n\n  DataDashboardItem.prototype._getDisplayDrillDownValues = function () {\n    var _this = this;\n\n    var drillDownUniqueValues = this._drillDownValues.peek();\n\n    if (!drillDownUniqueValues || drillDownUniqueValues.length == 0) return undefined;\n    var values = new Array(),\n        metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n    drillDownUniqueValues.forEach(function (value, valueIndex) {\n      var dimension = _this._interactivityDimensions[valueIndex];\n      var filterValues = new _dimension_filter_values_1.DimensionFilterValues(_this._getDimensionDisplayName(dimension.uniqueName()));\n\n      var isOlap = _data_field_1.DataField.isOlap(dimension.dataMember());\n\n      filterValues.Values.push(_this._createFormattableValue(dimension, value));\n      values.push(filterValues);\n    });\n    return values;\n  };\n\n  DataDashboardItem.prototype._getColoringSignature = function () {\n    return this._getColoringSignatureBase(this._coloredDimensions());\n  };\n\n  DataDashboardItem.prototype._getColoringSignatureOnCurrentDrillDownLevel = function () {\n    if (this._isDrillDownEnabled()) {\n      var coloredDimensions = [];\n\n      var currentDrillDownDimension = this._interactivityDimensions[this._drillDownValues().length];\n\n      var currentColored = null;\n\n      for (var i = 0; i < this._dimensions.length; i++) {\n        var dimension = this._dimensions[i];\n        if (this._isColoringEnabled(dimension)) currentColored = dimension;\n\n        if (dimension === currentDrillDownDimension && currentColored !== null) {\n          coloredDimensions = [currentColored];\n          break;\n        }\n      }\n\n      return this._getColoringSignatureBase(coloredDimensions);\n    } else {\n      return this._getColoringSignature();\n    }\n  };\n\n  DataDashboardItem.prototype._getColoringSignatureBase = function (coloredDimension) {\n    return new color_scheme_definition_1.ColorSchemeDefinition(this.dataSource(), this.dataMember(), coloredDimension.map(function (dimension) {\n      return {\n        dataMember: ko.observable(dimension.dataMember()),\n        dateTimeGroupInterval: ko.observable(dimension.dateTimeGroupInterval())\n      };\n    }), this._coloredByMeasures(), this._isGloballyColored ? '' : this.componentName(), this._isGloballyColored ? '' : this.name());\n  };\n\n  DataDashboardItem.prototype._isAttribute = function (dataItem) {\n    return false;\n  };\n\n  DataDashboardItem.prototype._getItemDataAxis = function () {\n    return item_data_axis_names_1.itemDataAxisNames.defaultAxis;\n  };\n\n  DataDashboardItem.prototype._getDataItemContainerDisplayName = function (dataItemContainer, dataItemDisplayNameGetter) {\n    var _this = this;\n\n    if (dataItemDisplayNameGetter === void 0) {\n      dataItemDisplayNameGetter = null;\n    }\n\n    var name = dataItemContainer.name && dataItemContainer.name() || null;\n\n    if (name) {\n      return name;\n    }\n\n    var bindingModel = dataItemContainer._getBindingModel(),\n        separator = ' ' + (dataItemContainer._displayNameSeparator || '-') + ' ';\n\n    name = '';\n    bindingModel.forEach(function (binding) {\n      var dataItemLink = dataItemContainer[binding.propertyName];\n      var dataItem = dataItemLink.dataItem && dataItemLink.dataItem();\n\n      if (dataItem && dataItem.dataMember()) {\n        if (name) {\n          name = name + separator;\n        }\n\n        name = name + (!!dataItemDisplayNameGetter ? dataItemDisplayNameGetter(dataItem) : _this._getDataItemDisplayName(dataItem));\n      }\n    });\n    return name;\n  };\n\n  DataDashboardItem.prototype._getDataItemDisplayName = function (dataItem) {\n    var uniqueName = dataItem.uniqueName();\n    return dataItem instanceof dimension_1.Dimension ? this._getDimensionDisplayName(uniqueName) : this._getMeasureDisplayName(uniqueName);\n  };\n\n  DataDashboardItem.prototype._getMeasureDisplayName = function (uniqueName) {\n    var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n    var measure = metaData.getMeasures().filter(function (m) {\n      return m.id == uniqueName;\n    })[0];\n    return !!measure ? measure.name : uniqueName;\n  };\n\n  DataDashboardItem.prototype._getDimensionDisplayName = function (uniqueName) {\n    var dimension = undefined;\n    var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n    var axes = !!metaData && metaData.getAxisNames() || [];\n    axes.every(function (axisName) {\n      var dimensions = metaData.getDimensions(axisName) || [];\n      dimension = dimensions.filter(function (d) {\n        return d.id == uniqueName;\n      })[0];\n      return !dimension;\n    });\n    return !!dimension ? dimension.name : uniqueName;\n  };\n\n  DataDashboardItem.prototype._getOlapDimensionDisplayText = function (uniqueValue, dimensionId) {\n    var itemData = this._dataManager() ? this._dataManager().getItemData() : undefined;\n    var axes = !!itemData ? itemData.getAxisNames() : [];\n    var pt = undefined;\n    axes.every(function (axisName) {\n      var axis = itemData.getAxis(axisName);\n      pt = axis.getPointByUniqueValueAndDimension(uniqueValue, dimensionId);\n      return !pt;\n    });\n\n    if (!!pt) {\n      return pt.getUniqueValue() === special_values_1.specialValues.olapNullValueGuid ? _default_1.getLocalizationById('DashboardStringId.OlapRaggedHierarchyNoneItemCaption') : pt.getDisplayText();\n    } else {\n      return uniqueValue;\n    }\n  };\n\n  DataDashboardItem.prototype._cleanDataItemDependencies = function () {};\n\n  DataDashboardItem.prototype._setLinkCollectionAcceptableShapingType = function (links, type) {\n    links.forEach(function (l) {\n      l._specifics.acceptableShapingType = type;\n    });\n  };\n\n  DataDashboardItem.prototype._updateDataQueryParams = function (params) {\n    _super.prototype._updateDataQueryParams.call(this, params);\n\n    if (this._expandingManager.canProvideExpandingState()) {\n      params.ExpandingState = this._expandingManager.calculateExpandingState();\n    }\n  };\n\n  DataDashboardItem.prototype._stateSupported = function (state) {\n    return this._supportedUIStates().indexOf(state) !== -1;\n  };\n\n  DataDashboardItem.prototype._isHiddenDimension = function (dimension) {\n    return !!this.__hiddenDimensions().filter(function (link) {\n      return link.dataItem() === dimension;\n    })[0];\n  };\n\n  DataDashboardItem.prototype._isHiddenMeasure = function (measure) {\n    return !!this.__hiddenMeasures().filter(function (link) {\n      return link.dataItem() === measure;\n    })[0];\n  };\n\n  DataDashboardItem.prototype._setSelection = function (stateSelection) {\n    var validatedSelection = this._getValidatedSelection(stateSelection);\n\n    if (this._isSingleMasterFilter()) {\n      if ((!validatedSelection || validatedSelection.length === 0) && !this._clearMasterFilterSupported()) return;\n      if (validatedSelection && validatedSelection.length > 1) validatedSelection = [validatedSelection[0]];\n    }\n\n    this._setSelectionData(validatedSelection);\n  };\n\n  DataDashboardItem.prototype._hasSelection = function () {\n    return !!this._selectionValues() && !!this._selectionValues()[0];\n  };\n\n  DataDashboardItem.prototype._performOutputFilterOptimization = function (filter) {\n    return filter;\n  };\n\n  DataDashboardItem.prototype._setState = function (parameter) {\n    _super.prototype._setState.call(this, parameter);\n\n    var itemState = parameter;\n    var obsoleteItemState = parameter;\n    var drillDownState = itemState.DrillDownValues || _obsolete_dashboard_state_1.ObsoleteItemState.unwrapDilldownValues(obsoleteItemState.DrillLevels) || [];\n    drillDownState = drillDownState.map(function (value) {\n      return _date_utils_1.tryConvertToDateTime(value);\n    });\n    if (!_array_utils_1.arrayEquals(this._drillDownValues(), drillDownState)) this._drillDownValues(drillDownState);\n    var selectionState = itemState.MasterFilterValues || obsoleteItemState.Selection;\n\n    this._setSelection(selectionState);\n\n    var selectedElementIndexState = itemState.SelectedLayerIndex || obsoleteItemState.SelectedElementIndex;\n    if (this._selectedElementIndex() !== selectedElementIndexState) this._selectedElementIndex(selectedElementIndexState);\n  };\n\n  DataDashboardItem.prototype._setClientState = function (clientState) {\n    this._clientState(clientState);\n  };\n\n  DataDashboardItem.prototype._setSelectionData = function (selection, forceSetSelection) {\n    if (forceSetSelection === void 0) {\n      forceSetSelection = false;\n    }\n\n    if (!_array_utils_1.arrayEquals(this._selectionValues(), selection) || forceSetSelection) {\n      this._selectionValues(selection);\n    }\n  };\n\n  DataDashboardItem.prototype._itemInteractivityByColumnAxis = function () {\n    return true;\n  };\n\n  DataDashboardItem.prototype._getInteractivityAxisDimensionCount = function () {\n    return this._dimensions.length - this.hiddenDimensions().length;\n  };\n\n  DataDashboardItem.prototype._removeSelectionFromState = function (state) {\n    var itemState = _jquery_helpers_1.deepExtend({}, state);\n\n    itemState.MasterFilterValues = undefined;\n    return itemState;\n  };\n\n  DataDashboardItem.prototype._setSelectionToState = function (state, selection) {\n    var itemState = _jquery_helpers_1.deepExtend({}, state);\n\n    itemState.MasterFilterValues = selection;\n    return itemState;\n  };\n\n  DataDashboardItem.prototype._setPredefinedPeriodToState = function (itemState, periodName) {\n    return itemState;\n  };\n\n  DataDashboardItem.prototype._unassignDataItem = function (dataItem, skipGroups) {\n    this._clearInteractivityState();\n\n    this._removeFromFilters(dataItem);\n\n    if (!skipGroups && dataItem instanceof dimension_1.Dimension && _data_field_1.IsOlapHierarchyField(dataItem)) {\n      for (var i = this.dataItems().length - 1; i >= 0; i--) {\n        var item = this.dataItems()[i];\n\n        if (item instanceof dimension_1.Dimension && item.groupIndex() == dataItem.groupIndex() && item != dataItem) {\n          this.dataItems.remove(item);\n        }\n      }\n\n      this._cleanDataItemDependencies();\n    }\n  };\n\n  DataDashboardItem.prototype._removeDataItemCore = function (dataItem) {\n    if (dataItem instanceof measure_1.Measure) {\n      this._dimensions.forEach(function (dimensionDataItem) {\n        var dimension = dimensionDataItem;\n\n        if (dimension.sortMeasure() === dataItem.uniqueName()) {\n          dimension.sortMeasure(undefined);\n        }\n\n        if (dimension.topNOptionsMeasureName() === dataItem.uniqueName()) {\n          dimension.topNOptionsMeasureName(undefined);\n        }\n      });\n    }\n\n    this.dataItems.remove(dataItem);\n  };\n\n  DataDashboardItem.prototype._getActiveDimensions = function () {\n    var drillDownValuesCount = this._drillDownValues().length;\n\n    if (this._getDrillDownEnabled()) {\n      return [this._interactivityDimensions[drillDownValuesCount]];\n    } else {\n      return this._interactivityDimensions;\n    }\n  };\n\n  DataDashboardItem.prototype._getDimensionIdsByItemName = function () {\n    return this._getActiveDimensions().map(function (dim) {\n      return dim.uniqueName();\n    });\n  };\n\n  DataDashboardItem.prototype._getValues = function (tuples) {\n    return _item_data_axis_helper_1.itemDataAxisHelper.getValuesByTuples(tuples, this._getDimensionIdsByItemName());\n  };\n\n  DataDashboardItem.prototype._getAvailableTuples = function () {\n    var that = this,\n        data = that._getItemData(),\n        dimensionIds = that._getDimensionIdsByItemName(),\n        axisName = that._getCurrentAxisNameByItemName();\n\n    return data && data.getAvailableTuples(dimensionIds, axisName);\n  };\n\n  DataDashboardItem.prototype._getCurrentAxisNameByItemName = function () {\n    return this._getItemDataAxis();\n  };\n\n  DataDashboardItem.prototype._getSelectedValuesByItemName = function () {\n    return this._selectionValues();\n  };\n\n  DataDashboardItem.prototype._performSetMasterFilter = function (values) {\n    if (values) {\n      if (!Array.isArray(values) || !(values[0] instanceof _item_data_tuple_1.itemDataTuple) && !Array.isArray(values[0])) {\n        throw new Error('The type of the values parameter is not supported.');\n      }\n\n      var arrayValues = values[0] instanceof _item_data_tuple_1.itemDataTuple ? this._getValues(values) : values;\n\n      if (this._isSingleMasterFilter() && arrayValues.length !== 1) {\n        throw new Error('Only one filter value is allowed when the Master Filter mode is set to Single.');\n      }\n\n      this._processItemSelectionChange('', _common_1.viewerActions.setMasterFilter, arrayValues.map(function (selectionRow) {\n        return selectionRow.map(_utils_1.unwrapSpecialNullValue);\n      }));\n    } else {\n      throw Error();\n    }\n  };\n\n  DataDashboardItem.prototype._performClearMasterFilter = function () {\n    this._processItemClearMasterFilter();\n  };\n\n  DataDashboardItem.prototype._performDrillDown = function (values) {\n    var realValues = values instanceof _item_data_tuple_1.itemDataTuple ? this._getValues([values]) : [[_utils_1.unwrapSpecialNullValue(values)]];\n\n    this._processItemSelectionChange('', _common_1.viewerActions.drillDown, realValues[0]);\n  };\n\n  DataDashboardItem.prototype._performDrillUp = function () {\n    this._processItemDrillUp();\n  };\n\n  DataDashboardItem.prototype._getAvailableDrillDownValues = function (itemName) {\n    return this._getAvailableActions().indexOf(_common_1.viewerActions.drillDown) !== -1 ? this._getAvailableTuples() : null;\n  };\n\n  DataDashboardItem.prototype._getCurrentDrillDownValues = function () {\n    var data = this._getItemData(),\n        dimensionIds = this._getDimensionIdsByItemName(),\n        axisName = this._getCurrentAxisNameByItemName();\n\n    return data && data.getCurrentDrillDownValues(dimensionIds, axisName);\n  };\n\n  DataDashboardItem.prototype._getAvailableFilterValues = function (itemName) {\n    return this._getAvailableActions().indexOf(_common_1.viewerActions.setMasterFilter) !== -1 || this._getAvailableActions().indexOf(_common_1.viewerActions.setMultipleValuesMasterFilter) !== -1 ? this._getAvailableTuples() : null;\n  };\n\n  DataDashboardItem.prototype._getAvailableActions = function () {\n    return this._actions();\n  };\n\n  DataDashboardItem.prototype._getItemData = function () {\n    var dataManager = this._dataManager();\n\n    return dataManager && dataManager.getItemData();\n  };\n\n  DataDashboardItem.prototype._getCurrentFilterValues = function () {\n    var that = this,\n        data = that._getItemData(),\n        dimensionIds = that._getDimensionIdsByItemName(),\n        axisName = that._getCurrentAxisNameByItemName(),\n        selectedValues = that._getSelectedValuesByItemName();\n\n    return data && data.getCurrentFilterValues(dimensionIds, axisName, selectedValues);\n  };\n\n  DataDashboardItem.prototype._conditionFormattingExpressionEditorFilter = function (dataItem) {\n    return !this.hiddenDimensions().filter(function (hd) {\n      return hd.uniqueName() === dataItem.uniqueName();\n    })[0];\n  };\n\n  DataDashboardItem._itemTypesMap = {\n    Measure: measure_1.Measure,\n    Dimension: dimension_1.Dimension\n  };\n  DataDashboardItem._formatRuleTypesMap = {\n    GridItemFormatRule: grid_item_format_rule_1.GridItemFormatRule,\n    PivotItemFormatRule: pivot_item_format_rule_1.PivotItemFormatRule,\n    CardItemFormatRule: card_item_format_rule_1.CardItemFormatRule,\n    CardItemDeltaFormatRule: card_item_delta_format_rule_1.CardItemDeltaFormatRule,\n    ChartItemFormatRule: chart_item_format_rule_1.ChartItemFormatRule,\n    ScatterChartItemFormatRule: scatter_chart_item_format_rule_1.ScatterChartItemFormatRule\n  };\n\n  DataDashboardItem._addColoringMeta = function (links) {\n    links.forEach(function (link) {\n      if (!link._specifics.customDataShapingProperties.some(function (prop) {\n        return prop.serializationInfo.propertyName === _dimension_1.coloringMode.propertyName;\n      })) {\n        link._specifics.customDataShapingProperties = link._specifics.customDataShapingProperties.concat([{\n          serializationInfo: _dimension_1.coloringMode\n        }]);\n      }\n    });\n  };\n\n  __decorate([_utils_2.collectionItemType('Dimension')], DataDashboardItem.prototype, \"__hiddenDimensions\", void 0);\n\n  __decorate([_utils_2.collectionItemType('Measure')], DataDashboardItem.prototype, \"__hiddenMeasures\", void 0);\n\n  __decorate([_utils_2.collectionItemType('Entry')], DataDashboardItem.prototype, \"colorScheme\", void 0);\n\n  return DataDashboardItem;\n}(dashboard_item_1.DashboardItem);\n\nexports.DataDashboardItem = DataDashboardItem;\n\nfunction getSummaryType(dataField) {\n  if (dataField) {\n    switch (dataField.fieldType()) {\n      case 'Bool':\n      case 'Text':\n      case 'DateTime':\n        return 'Count';\n\n      case 'Custom':\n        if (!dataField.isConvertible()) {\n          return 'Count';\n        }\n\n    }\n  }\n\n  return _measure_1.summaryTypeNumericToAny.defaultVal;\n}\n\nfunction removePropertyFromCriteriaOperator(sourceCriteriaOperator, propertyName) {\n  if (sourceCriteriaOperator instanceof analytics_criteria_1.GroupOperator) {\n    sourceCriteriaOperator.operands = sourceCriteriaOperator.operands.map(function (operand) {\n      return removePropertyFromCriteriaOperator(operand, propertyName);\n    });\n    return sourceCriteriaOperator;\n  } else if (sourceCriteriaOperator instanceof analytics_criteria_1.UnaryOperator) {\n    sourceCriteriaOperator.operand = removePropertyFromCriteriaOperator(sourceCriteriaOperator.operand, propertyName);\n    return sourceCriteriaOperator;\n  } else if (!sourceCriteriaOperator.children().some(function (operand) {\n    return operand instanceof analytics_criteria_1.OperandProperty && operand.propertyName === propertyName;\n  })) {\n    return sourceCriteriaOperator;\n  }\n\n  return new analytics_criteria_1.GroupOperator(analytics_criteria_1.GroupOperatorType.And, []);\n}\n\nfunction removeDataItemFromCriteria(criteria, dataItemName) {\n  try {\n    if (!!criteria) {\n      var criteriaSerializer = new analytics_widgets_internal_1.FilterEditorSerializer();\n      var criteriaOperator = criteriaSerializer.deserialize(criteria);\n      var cleanedOperator = removePropertyFromCriteriaOperator(criteriaOperator, dataItemName);\n      return criteriaSerializer.serialize(cleanedOperator);\n    } else {\n      return criteria;\n    }\n  } catch (e) {\n    return '';\n  }\n}","map":{"version":3,"sources":["/Users/krunalpatel/Downloads/React-Firebase-Auth-master 3/node_modules/devexpress-dashboard/model/items/data-dashboard-item.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","exports","value","DataDashboardItem","analytics_criteria_1","require","analytics_utils_1","analytics_widgets_internal_1","ko","_item_data_axis_builder_1","_item_data_axis_helper_1","_item_data_manager_1","item_data_axis_names_1","_item_data_tuple_1","_default_1","special_values_1","_common_1","_jquery_helpers_1","_utils_1","color_scheme_definition_1","color_scheme_entry_1","dashboard_state_1","data_item_1","dimension_1","measure_1","_dimension_1","_measure_1","specific_calc_window_definition_1","_dimension_filter_values_1","_data_field_1","card_item_delta_format_rule_1","card_item_format_rule_1","chart_item_format_rule_1","grid_item_format_rule_1","pivot_item_format_rule_1","scatter_chart_item_format_rule_1","_array_utils_1","_dashboard_component_name_generator_1","_date_utils_1","_expanding_manager_1","_helper_classes_1","_knockout_utils_1","_obsolete_dashboard_state_1","_utils_2","dashboard_item_1","_data_dashboard_item_1","_limit_data_state_1","_super","dashboardItemJSON","serializer","info","ModelSerializer","undefined","_this","hiddenDimensions","observableArray","hiddenMeasures","colorScheme","_masterFilterMode","computed","_getMasterFilterMode","_isSingleMasterFilter","_isMultipleMasterFilter","_isDrillDownEnabled","_getDrillDownEnabled","_isIgnoreMasterFilter","_getIgnoreMasterFilter","_isMasterFilter","_getIsMasterFilter","_clearMasterFilterSupported","_getClearMasterFilterSupported","_fullRange","observable","_selectedElementIndex","_beforeMasterFilterSetByUserInteraction","_afterMasterFilterSetByUserInteraction","_drillDownChangedByUserInteraction","_masterFilterItems","_dataManager","_drillDownValues","_clientState","_dataRequestArgs","_expandingManager","ExpandingManager","_selectionValues","_supportedUIStates","_limitDataState","LimitDataState","_isExcludingAllFilter","_processItemSelectionChange","itemElement","mode","selection","viewerActions","setMasterFilter","setMultipleValuesMasterFilter","itemState","deepExtend","_state","_removeSelectionFromState","_setSelectionToState","_setState","drillDown","push","_setSelectionData","_processItemDrillUp","drillValue","pop","_processItemClearMasterFilter","_processItemSetPredefinedPeriod","periodName","_setPredefinedPeriodToState","_processContentElementSelection","itemName","args","index","_processDataRequest","_processItemClientStateUpdate","clientState","_setClientState","_processExpandingStateChanged","expandingParams","dxPivotState","onViewStateChanged","_processItemExpandingChange","setExpandingParams","_dataQueryParams","notifySubscribers","dataItems","deserializeArray","DataItems","dataItemJSON","_createDataItem","formatRules","FormatRules","rule","_createFormatRule","__hiddenDimensions","HiddenDimensions","item","DataItemLink","__hiddenMeasures","HiddenMeasures","_subscribeDataItemLinkArrays","ColorScheme","ColorSchemeEntry","componentName","name","subscribe","links","_setLinkCollectionAcceptableShapingType","AcceptableShapingType","Hidden","_componentNameGenerator","DashboardUniqueNameGenerator","state","ItemState","DrillDownValues","toStringArray","MasterFilterValues","SelectedLayerIndex","_actions","read","newValue","interactivityDimensionCount","_interactivityDimensions","drillDownValuesCount","isPreviousLevelSelection","drillUp","_hasSelection","clearMasterFilter","deferEvaluation","_outputFilter","result","selectionValues","selectionValuesCount","peek","dimensionality","fullRange","dimensions","slice","map","dimension","serialize","range","values","arr","concat","dim","isExcludingAllFilter","_performOutputFilterOptimization","externalFilter","filter","Filter","f","v","DrillDown","ClientState","SelectedElementIndex","_colorableItems","_uiState","errorState","_errorState","previousState","paneValid","_paneContentHolder","valid","viewerItemCreated","_viewerItemCreated","hasDataItems","dataSource","_stateSupported","_getLayersCount","Measure","windowDefinition","def","forEach","SpecificWindowDefinition","link","_updateProvider","subscribeToArrayItemProperties","dataItem","Dimension","dateTimeGroupInterval","_removeFromFilters","itemTypeName","itemType","_itemTypesMap","_updateDataItemByField","dataField","newDataItem","summaryInfo","dataMember","DataField","isOlap","oldDataItem","avaliableSummaryTypes","_getAvaliableSummaryTypeInfo","acceptableShapingType","keys","indexOf","summaryType","defaultVal","getSummaryType","defaultNumericFormat","numericFormat","currencyCultureName","CurrencyCultureName","formatType","FormatType","includeGroupSeparator","IncludeGroupSeparator","precision","Precision","unit","Unit","formatRuleJSON","typeName","type","_formatRuleTypesMap","expression","isAggregate","isNumeric","summaryTypeNumericToAny","Number","summaryTypeNonNumericToNumeric","Attribute","summaryTypeAttribute","summaryTypeNonNumericToString","get","enumerable","configurable","_getCanColorByMeasures","_getCanColorByDimensions","_getAreMeasuresColoredByDefault","_getUseGlobalColors","_getInteractivityDimensionLinks","uniqueDataItems","isDefinitionEquals","dataManager","getItemData","filterString","removeDataItemFromCriteria","uniqueName","visibleDataFilterString","_measures","measure","_clearBindings","removeAll","_clearInteractivityState","_isCalculationSupported","_isSortingEnabled","_isTopNEnabled","_isColoringEnabled","_canColorByDimensions","_isHiddenDimension","coloringMode","_getIsDimensionColoredByDefault","_canColorByMeasures","_isHiddenMeasure","_coloredByMeasures","_getDataItem","_getFinalDataType","dataItemId","metaData","getMetaData","getFinalDataType","binding","dataItemType","isMeasure","_updateDataItem","Guard","isNotFalsy","_unassignDataItem","_removeDataItemCore","_removeDataItem","skipGroups","_attachDataItem","propertyName","dataItemLink","substring","write","Error","propertyInfos","_i","propertyInfo","property","realProperty","remove","linkedDataItems","itemToRemove","itemToAdd","splice","subscribeArrayChange","added","some","deleted","_coloredDimensions","_dimensions","coloringOptions","measuresColoringMode","useGlobalColors","_getValidatedSelection","tryConvertToDateTime","_getClearMasterFilterState","_useNeutralFilterMode","_allowAllValue","_validateSelectionByData","activeDimensions","allSelection","_getAllSelectionValues","arrayContains","_updateContentData","content","_updateDataManager","ItemData","Reduced","setReduced","_actualSelectionValues","drillDownValues","_getDisplayDrillDownValues","multiData","_multiData","fv","Values","reduce","v1","v2","DrillDownUniqueValues","getViewModel","_extendContentState","SelectedValues","itemDataDTO","contentType","ContentType","patchDateTime","DataStorageDTO","partialDataSource","_updateDataManagerByPartialDataSource","fullContent","completeDataSource","MetaData","itemDataManager","initialize","resetExpandingParams","Parameters","updateExpandedData","pivotArea","pivotAreaNames","columns","rows","getAllSelectionValues","_getPointsByDimension","dimensionId","axisName","axis","getAxis","getPointsByDimension","_getColorizableDataItemsInfo","_getDefaultCalculationWindowDefinition","_getExportingSelection","_getDisplayFilterValues","limitCount","outFilterValues","dimensionDefinition","dimensionIndex","filterValues","DimensionFilterValues","_getDimensionDisplayName","uniqueValues","valueIndex","valueCount","Truncated","_createFormattableValue","Type","Value","_getOlapDimensionDisplayText","Format","getDimensionFormat","_getDisplayFilterValuesExternal","acc","items","drillDownUniqueValues","_getColoringSignature","_getColoringSignatureBase","_getColoringSignatureOnCurrentDrillDownLevel","coloredDimensions","currentDrillDownDimension","currentColored","coloredDimension","ColorSchemeDefinition","_isGloballyColored","_isAttribute","_getItemDataAxis","itemDataAxisNames","defaultAxis","_getDataItemContainerDisplayName","dataItemContainer","dataItemDisplayNameGetter","bindingModel","_getBindingModel","separator","_displayNameSeparator","_getDataItemDisplayName","_getMeasureDisplayName","getMeasures","m","id","axes","getAxisNames","every","getDimensions","uniqueValue","itemData","pt","getPointByUniqueValueAndDimension","getUniqueValue","specialValues","olapNullValueGuid","getLocalizationById","getDisplayText","_cleanDataItemDependencies","l","_specifics","_updateDataQueryParams","params","canProvideExpandingState","ExpandingState","calculateExpandingState","_setSelection","stateSelection","validatedSelection","parameter","obsoleteItemState","drillDownState","ObsoleteItemState","unwrapDilldownValues","DrillLevels","arrayEquals","selectionState","Selection","selectedElementIndexState","forceSetSelection","_itemInteractivityByColumnAxis","_getInteractivityAxisDimensionCount","IsOlapHierarchyField","groupIndex","dimensionDataItem","sortMeasure","topNOptionsMeasureName","_getActiveDimensions","_getDimensionIdsByItemName","_getValues","tuples","itemDataAxisHelper","getValuesByTuples","_getAvailableTuples","that","data","_getItemData","dimensionIds","_getCurrentAxisNameByItemName","getAvailableTuples","_getSelectedValuesByItemName","_performSetMasterFilter","isArray","itemDataTuple","arrayValues","selectionRow","unwrapSpecialNullValue","_performClearMasterFilter","_performDrillDown","realValues","_performDrillUp","_getAvailableDrillDownValues","_getAvailableActions","_getCurrentDrillDownValues","getCurrentDrillDownValues","_getAvailableFilterValues","_getCurrentFilterValues","selectedValues","getCurrentFilterValues","_conditionFormattingExpressionEditorFilter","hd","GridItemFormatRule","PivotItemFormatRule","CardItemFormatRule","CardItemDeltaFormatRule","ChartItemFormatRule","ScatterChartItemFormatRule","_addColoringMeta","customDataShapingProperties","prop","serializationInfo","collectionItemType","DashboardItem","fieldType","isConvertible","removePropertyFromCriteriaOperator","sourceCriteriaOperator","GroupOperator","operands","operand","UnaryOperator","children","OperandProperty","GroupOperatorType","And","criteria","dataItemName","criteriaSerializer","FilterEditorSerializer","criteriaOperator","deserialize","cleanedOperator","e"],"mappings":"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","sourcesContent":["/**\r\n* DevExpress Dashboard (data-dashboard-item.js)\r\n* Version:  22.1.3\r\n* Build date: Jun 13, 2022\r\n* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n* License: https://www.devexpress.com/Support/EULAs/universal.xml\r\n*/\r\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DataDashboardItem = void 0;\nvar analytics_criteria_1 = require(\"@devexpress/analytics-core/analytics-criteria\");\nvar analytics_utils_1 = require(\"@devexpress/analytics-core/analytics-utils\");\nvar analytics_widgets_internal_1 = require(\"@devexpress/analytics-core/analytics-widgets-internal\");\nvar ko = require(\"knockout\");\nvar _item_data_axis_builder_1 = require(\"../../data/item-data/internal/_item-data-axis-builder\");\nvar _item_data_axis_helper_1 = require(\"../../data/item-data/internal/_item-data-axis-helper\");\nvar _item_data_manager_1 = require(\"../../data/item-data/internal/_item-data-manager\");\nvar item_data_axis_names_1 = require(\"../../data/item-data/item-data-axis-names\");\nvar _item_data_tuple_1 = require(\"../../data/item-data/_item-data-tuple\");\nvar _default_1 = require(\"../../data/localization/_default\");\nvar special_values_1 = require(\"../../data/special-values\");\nvar _common_1 = require(\"../../data/_common\");\nvar _jquery_helpers_1 = require(\"../../data/_jquery-helpers\");\nvar _utils_1 = require(\"../../data/_utils\");\nvar color_scheme_definition_1 = require(\"../colorization/color-scheme-definition\");\nvar color_scheme_entry_1 = require(\"../colorization/color-scheme-entry\");\nvar dashboard_state_1 = require(\"../dashboard-state\");\nvar data_item_1 = require(\"../data-item/data-item\");\nvar dimension_1 = require(\"../data-item/dimension\");\nvar measure_1 = require(\"../data-item/measure\");\nvar _dimension_1 = require(\"../data-item/metadata/_dimension\");\nvar _measure_1 = require(\"../data-item/metadata/_measure\");\nvar specific_calc_window_definition_1 = require(\"../data-item/window-definition/specific-calc-window-definition\");\nvar _dimension_filter_values_1 = require(\"../data-item/_dimension-filter-values\");\nvar _data_field_1 = require(\"../data-sources/_data-field\");\nvar card_item_delta_format_rule_1 = require(\"../format-rules/card-item-delta-format-rule\");\nvar card_item_format_rule_1 = require(\"../format-rules/card-item-format-rule\");\nvar chart_item_format_rule_1 = require(\"../format-rules/chart-item-format-rule\");\nvar grid_item_format_rule_1 = require(\"../format-rules/grid-item-format-rule\");\nvar pivot_item_format_rule_1 = require(\"../format-rules/pivot-item-format-rule\");\nvar scatter_chart_item_format_rule_1 = require(\"../format-rules/scatter-chart-item-format-rule\");\nvar _array_utils_1 = require(\"../internal/_array-utils\");\nvar _dashboard_component_name_generator_1 = require(\"../internal/_dashboard-component-name-generator\");\nvar _date_utils_1 = require(\"../internal/_date-utils\");\nvar _expanding_manager_1 = require(\"../internal/_expanding-manager\");\nvar _helper_classes_1 = require(\"../internal/_helper-classes\");\nvar _knockout_utils_1 = require(\"../internal/_knockout-utils\");\nvar _obsolete_dashboard_state_1 = require(\"../internal/_obsolete-dashboard-state\");\nvar _utils_2 = require(\"../internal/_utils\");\nvar dashboard_item_1 = require(\"./dashboard-item\");\nvar _data_dashboard_item_1 = require(\"./metadata/_data-dashboard-item\");\nvar _limit_data_state_1 = require(\"./_limit-data-state\");\nvar DataDashboardItem = (function (_super) {\n    __extends(DataDashboardItem, _super);\n    function DataDashboardItem(dashboardItemJSON, serializer, info) {\n        if (dashboardItemJSON === void 0) { dashboardItemJSON = {}; }\n        if (serializer === void 0) { serializer = new analytics_utils_1.ModelSerializer(); }\n        if (info === void 0) { info = undefined; }\n        var _this = _super.call(this, dashboardItemJSON, serializer, info) || this;\n        _this.hiddenDimensions = ko.observableArray([]);\n        _this.hiddenMeasures = ko.observableArray([]);\n        _this.colorScheme = ko.observableArray();\n        _this._masterFilterMode = ko.computed(function () { return _this._getMasterFilterMode(); });\n        _this._isSingleMasterFilter = ko.computed(function () { return _this._masterFilterMode() === 'Single'; });\n        _this._isMultipleMasterFilter = ko.computed(function () { return _this._masterFilterMode() === 'Multiple'; });\n        _this._isDrillDownEnabled = ko.computed(function () { return _this._getDrillDownEnabled(); });\n        _this._isIgnoreMasterFilter = ko.computed(function () { return _this._getIgnoreMasterFilter(); });\n        _this._isMasterFilter = ko.computed(function () { return _this._getIsMasterFilter(); });\n        _this._clearMasterFilterSupported = ko.computed(function () { return _this._getClearMasterFilterSupported(); });\n        _this._fullRange = ko.observable();\n        _this._selectedElementIndex = ko.observable();\n        _this._beforeMasterFilterSetByUserInteraction = null;\n        _this._afterMasterFilterSetByUserInteraction = null;\n        _this._drillDownChangedByUserInteraction = null;\n        _this._masterFilterItems = ko.observable([]);\n        _this._dataManager = ko.observable();\n        _this._drillDownValues = ko.observableArray([]);\n        _this._clientState = ko.observable();\n        _this._dataRequestArgs = ko.observable();\n        _this._expandingManager = new _expanding_manager_1.ExpandingManager();\n        _this._selectionValues = ko.observable();\n        _this._supportedUIStates = ko.observable(['error', 'empty', 'loading']);\n        _this._limitDataState = new _limit_data_state_1.LimitDataState();\n        _this._isExcludingAllFilter = ko.computed(function () { return false; });\n        _this._processItemSelectionChange = function (itemElement, mode, selection) {\n            if (mode === _common_1.viewerActions.setMasterFilter || mode === _common_1.viewerActions.setMultipleValuesMasterFilter) {\n                _this._beforeMasterFilterSetByUserInteraction && _this._beforeMasterFilterSetByUserInteraction();\n                var itemState = _jquery_helpers_1.deepExtend({}, _this._state());\n                itemState = _this._removeSelectionFromState(itemState);\n                itemState = _this._setSelectionToState(itemState, selection);\n                _this._setState(itemState);\n                _this._afterMasterFilterSetByUserInteraction && _this._afterMasterFilterSetByUserInteraction();\n            }\n            else if (mode === _common_1.viewerActions.drillDown) {\n                _this._drillDownChangedByUserInteraction && _this._drillDownChangedByUserInteraction();\n                _this._drillDownValues.push(selection[0]);\n                _this._setSelectionData(null);\n            }\n        };\n        _this._processItemDrillUp = function () {\n            _this._drillDownChangedByUserInteraction && _this._drillDownChangedByUserInteraction();\n            var drillValue = _this._drillDownValues.pop();\n            _this._selectionValues(_this._isMasterFilter() ? [[drillValue]] : null);\n        };\n        _this._processItemClearMasterFilter = function (itemElement) {\n            _this._beforeMasterFilterSetByUserInteraction && _this._beforeMasterFilterSetByUserInteraction();\n            var itemState = _jquery_helpers_1.deepExtend({}, _this._state());\n            itemState = _this._removeSelectionFromState(itemState);\n            _this._setState(itemState);\n            _this._afterMasterFilterSetByUserInteraction && _this._afterMasterFilterSetByUserInteraction();\n        };\n        _this._processItemSetPredefinedPeriod = function (periodName) {\n            var itemState = _jquery_helpers_1.deepExtend({}, _this._state());\n            itemState = _this._removeSelectionFromState(itemState);\n            itemState = _this._setPredefinedPeriodToState(itemState, periodName);\n            _this._setState(itemState);\n        };\n        _this._processContentElementSelection = function (itemName, args) {\n            _this._selectedElementIndex(args.index);\n        };\n        _this._processDataRequest = function () { };\n        _this._processItemClientStateUpdate = function (itemName, clientState) {\n            _this._setClientState(clientState);\n        };\n        _this._processExpandingStateChanged = function (expandingParams, dxPivotState) {\n            _this._expandingManager.onViewStateChanged(expandingParams, dxPivotState);\n        };\n        _this._processItemExpandingChange = function (expandingParams) {\n            _this._expandingManager.setExpandingParams(expandingParams);\n            _this._dataQueryParams.notifySubscribers();\n        };\n        _this.dataItems = analytics_utils_1.deserializeArray(dashboardItemJSON.DataItems, function (dataItemJSON) { return DataDashboardItem._createDataItem(dataItemJSON['@ItemType'], dataItemJSON, serializer); });\n        _this.formatRules = analytics_utils_1.deserializeArray(dashboardItemJSON.FormatRules, function (rule) { return DataDashboardItem._createFormatRule(_this, rule, serializer); });\n        _this.__hiddenDimensions = analytics_utils_1.deserializeArray(dashboardItemJSON.HiddenDimensions, function (item) { return new data_item_1.DataItemLink(_this, item, serializer); });\n        _this.__hiddenMeasures = analytics_utils_1.deserializeArray(dashboardItemJSON.HiddenMeasures, function (item) { return new data_item_1.DataItemLink(_this, item, serializer); });\n        _this._subscribeDataItemLinkArrays(_data_dashboard_item_1.hiddenDimensions, _data_dashboard_item_1.hiddenMeasures);\n        _this.colorScheme(analytics_utils_1.deserializeArray(dashboardItemJSON.ColorScheme, function (item) { return new color_scheme_entry_1.ColorSchemeEntry(item, serializer, _this.componentName(), _this.name()); })());\n        _this.__hiddenMeasures.subscribe(function (links) {\n            _this._setLinkCollectionAcceptableShapingType(links, data_item_1.AcceptableShapingType.Hidden);\n        });\n        _this._setLinkCollectionAcceptableShapingType(_this.__hiddenMeasures(), data_item_1.AcceptableShapingType.Hidden);\n        _this._componentNameGenerator = new _dashboard_component_name_generator_1.DashboardUniqueNameGenerator('uniqueName', 0, _this.dataItems);\n        _this._state = ko.computed(function () {\n            var state = new dashboard_state_1.ItemState();\n            if (_this._drillDownValues().length) {\n                state.DrillDownValues = _date_utils_1.toStringArray(_this._drillDownValues());\n            }\n            if (_this._selectionValues()) {\n                state.MasterFilterValues = _date_utils_1.toStringArray(_this._selectionValues());\n            }\n            if (_this._selectedElementIndex()) {\n                state.SelectedLayerIndex = _this._selectedElementIndex();\n            }\n            return state;\n        });\n        _this._actions = ko.computed({\n            read: function () {\n                var newValue = [];\n                var interactivityDimensionCount = _this._interactivityDimensions.length;\n                var drillDownValuesCount = _this._drillDownValues().length;\n                if (_this._isMasterFilter() && interactivityDimensionCount > 0) {\n                    newValue.push(_common_1.viewerActions.setMasterFilter);\n                }\n                if (_this._isMultipleMasterFilter() && interactivityDimensionCount > 0) {\n                    newValue.push(_common_1.viewerActions.setMultipleValuesMasterFilter);\n                }\n                if (_this._isDrillDownEnabled() && (drillDownValuesCount < (interactivityDimensionCount - 1))) {\n                    newValue.push(_common_1.viewerActions.drillDown);\n                }\n                var isPreviousLevelSelection = false;\n                if (drillDownValuesCount > 0) {\n                    newValue.push(_common_1.viewerActions.drillUp);\n                    if (_this._selectionValues() && _this._selectionValues()[0] && _this._selectionValues()[0][0] === _this._drillDownValues()[drillDownValuesCount - 1]) {\n                        isPreviousLevelSelection = true;\n                    }\n                }\n                if (_this._hasSelection() && !isPreviousLevelSelection) {\n                    newValue.push(_common_1.viewerActions.clearMasterFilter);\n                }\n                return newValue;\n            },\n            deferEvaluation: true\n        });\n        _this._outputFilter = ko.computed(function () {\n            if (!_this._isMasterFilter())\n                return undefined;\n            var result = undefined, serializer = new analytics_utils_1.ModelSerializer(), selectionValues = _this._selectionValues(), selectionValuesCount = selectionValues ? selectionValues.length : 0, drillDownValuesCount = _this._drillDownValues.peek().length, dimensionality = selectionValuesCount > 0 ? selectionValues[0].length : 0, fullRange = _this._fullRange();\n            if (selectionValuesCount > 0 || drillDownValuesCount > 0) {\n                result = {\n                    dimensions: _this._interactivityDimensions.slice(0, drillDownValuesCount + dimensionality).map(function (dimension) { return serializer.serialize(dimension); })\n                };\n                if (result.dimensions.length === 1 && selectionValuesCount === 1 && dimensionality === 2) {\n                    result.range = selectionValues[0];\n                }\n                else {\n                    result.values = selectionValuesCount > 0 ? selectionValues.map(function (arr) { return _this._drillDownValues.peek().concat(arr); }) : [_this._drillDownValues.peek()];\n                }\n            }\n            if (!result) {\n                if (fullRange && fullRange.length && _this._interactivityDimensions.length) {\n                    result = {\n                        dimensions: _this._interactivityDimensions.map(function (dim) { return serializer.serialize(dim); }),\n                        range: fullRange\n                    };\n                }\n            }\n            if (_this._isExcludingAllFilter()) {\n                result = result || {};\n                result.isExcludingAllFilter = true;\n            }\n            result = _this._performOutputFilterOptimization(result);\n            return result;\n        });\n        _this._dataQueryParams = ko.computed(function () {\n            var result = {};\n            if (_this.dataItems().length > 0) {\n                var externalFilter = _this._masterFilterItems().filter(function (item) { return !!item._outputFilter(); }).map(function (item) { return item._outputFilter(); });\n                if (externalFilter.length) {\n                    result.Filter = externalFilter.map(function (f) {\n                        var v = {};\n                        if (!!f.dimensions) {\n                            v.dimensions = f.dimensions;\n                        }\n                        if (!!f.values) {\n                            v.values = _date_utils_1.toStringArray(f.values);\n                        }\n                        if (!!f.range) {\n                            v.range = _date_utils_1.toStringArray(f.range);\n                        }\n                        if (f.isExcludingAllFilter != undefined) {\n                            v.isExcludingAllFilter = f.isExcludingAllFilter;\n                        }\n                        return v;\n                    });\n                }\n                if (_this._drillDownValues().length) {\n                    result.DrillDown = _date_utils_1.toStringArray(_this._drillDownValues());\n                }\n                if (_this._dataRequestArgs()) {\n                    result.ClientState = _this._dataRequestArgs();\n                }\n                if (_this._selectedElementIndex()) {\n                    result.SelectedElementIndex = _this._selectedElementIndex();\n                }\n            }\n            return result;\n        });\n        _this._colorableItems = ko.observable([_this]);\n        _this._uiState && _this._uiState['dispose'] && _this._uiState['dispose']();\n        _this._uiState = ko.computed({\n            read: function () {\n                var result = 'live', errorState = _this._errorState(), previousState = _this._uiState(), paneValid = _this._paneContentHolder.valid(), viewerItemCreated = _this._viewerItemCreated(), hasDataItems = !!_this.dataSource.peek() && !!_this.dataItems.peek().length;\n                if (_this._stateSupported('error') && errorState) {\n                    result = 'error';\n                }\n                else if (_this._stateSupported('empty') && !hasDataItems) {\n                    result = 'empty';\n                }\n                else if (_this._stateSupported('loading') && !paneValid && (!viewerItemCreated || 'empty' === previousState || 'error' === previousState)) {\n                    result = 'loading';\n                }\n                else {\n                    result = 'live';\n                }\n                return result;\n            },\n            deferEvaluation: true\n        });\n        ko.computed(function () {\n            if (_this._selectedElementIndex() >= _this._getLayersCount()) {\n                _this._selectedElementIndex(null);\n            }\n        });\n        ko.computed(function () {\n            _this.dataItems()\n                .map(function (d) { return d instanceof measure_1.Measure ? d.windowDefinition.windowDefinition() : null; })\n                .filter(function (def) { return def != null; })\n                .forEach(function (def) {\n                if (def instanceof specific_calc_window_definition_1.SpecificWindowDefinition) {\n                    def.dimensions().forEach(function (link) { return link._updateProvider(_this); });\n                }\n            });\n        });\n        ko.computed(function () {\n            if (!_this.dataSource() || _this.dataItems().length === 0) {\n                _this._dataManager(null);\n            }\n        });\n        _knockout_utils_1.subscribeToArrayItemProperties(_this.dataItems, function (dataItem) {\n            if (dataItem instanceof dimension_1.Dimension) {\n                return dataItem.dateTimeGroupInterval.subscribe(function () {\n                    _this._removeFromFilters(dataItem);\n                });\n            }\n            return null;\n        });\n        return _this;\n    }\n    DataDashboardItem._createDataItem = function (itemTypeName, dataItemJSON, serializer) {\n        var itemType = DataDashboardItem._itemTypesMap[itemTypeName];\n        return new itemType(dataItemJSON, serializer);\n    };\n    DataDashboardItem._updateDataItemByField = function (dataField, newDataItem, summaryInfo) {\n        newDataItem.dataMember(dataField.dataMember());\n        if (newDataItem instanceof measure_1.Measure) {\n            if (!_data_field_1.DataField.isOlap(dataField.dataMember())) {\n                if (!!summaryInfo && summaryInfo.oldDataItem instanceof measure_1.Measure) {\n                    var avaliableSummaryTypes = DataDashboardItem._getAvaliableSummaryTypeInfo(dataField, summaryInfo.acceptableShapingType, newDataItem);\n                    if (avaliableSummaryTypes) {\n                        if (Object.keys(avaliableSummaryTypes.values).indexOf(summaryInfo.oldDataItem.summaryType()) !== -1) {\n                            newDataItem.summaryType(summaryInfo.oldDataItem.summaryType());\n                        }\n                        else {\n                            newDataItem.summaryType(avaliableSummaryTypes.defaultVal);\n                        }\n                    }\n                }\n                else {\n                    newDataItem.summaryType(getSummaryType(dataField));\n                }\n            }\n            else if (!!dataField['defaultNumericFormat']) {\n                var defaultNumericFormat = dataField['defaultNumericFormat'];\n                newDataItem.numericFormat.currencyCultureName(defaultNumericFormat.CurrencyCultureName);\n                newDataItem.numericFormat.formatType(defaultNumericFormat.FormatType);\n                newDataItem.numericFormat.includeGroupSeparator(defaultNumericFormat.IncludeGroupSeparator);\n                newDataItem.numericFormat.precision(defaultNumericFormat.Precision);\n                newDataItem.numericFormat.unit(defaultNumericFormat.Unit);\n            }\n        }\n    };\n    DataDashboardItem._createFormatRule = function (item, formatRuleJSON, serializer) {\n        var typeName = formatRuleJSON['@ItemType'];\n        var type = DataDashboardItem._formatRuleTypesMap[typeName];\n        return new type(formatRuleJSON, serializer);\n    };\n    DataDashboardItem._getAvaliableSummaryTypeInfo = function (dataField, acceptableShapingType, dataItem) {\n        if (!!dataItem && dataItem instanceof measure_1.Measure && !!dataItem.expression())\n            return null;\n        if (!_data_field_1.DataField.isOlap(dataField.dataMember()) && !(dataField.isAggregate && dataField.isAggregate())) {\n            if (_data_field_1.DataField.isNumeric(dataField)) {\n                return _measure_1.summaryTypeNumericToAny;\n            }\n            else {\n                switch (acceptableShapingType) {\n                    case data_item_1.AcceptableShapingType.Number:\n                        return _measure_1.summaryTypeNonNumericToNumeric;\n                    case data_item_1.AcceptableShapingType.Attribute:\n                        return _measure_1.summaryTypeAttribute;\n                    case data_item_1.AcceptableShapingType.String:\n                    case data_item_1.AcceptableShapingType.Hidden:\n                        return _measure_1.summaryTypeNonNumericToString;\n                }\n            }\n        }\n        return null;\n    };\n    Object.defineProperty(DataDashboardItem.prototype, \"_actualSelectionValues\", {\n        get: function () {\n            return this._selectionValues;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_canColorByMeasures\", {\n        get: function () { return this._getCanColorByMeasures(); },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_canColorByDimensions\", {\n        get: function () { return this._getCanColorByDimensions(); },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_isLocallyColored\", {\n        get: function () {\n            return (this._getAreMeasuresColoredByDefault() || this._getCanColorByDimensions()) && !this._getUseGlobalColors();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_isGloballyColored\", {\n        get: function () {\n            return (this._getAreMeasuresColoredByDefault() || this._getCanColorByDimensions()) && this._getUseGlobalColors();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_interactivityDimensions\", {\n        get: function () {\n            return this._getInteractivityDimensionLinks().map(function (link) { return link.dataItem(); }).filter(function (item) { return !!item; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_dimensions\", {\n        get: function () {\n            return this.dataItems && this.dataItems().filter(function (item) { return item instanceof dimension_1.Dimension; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_measures\", {\n        get: function () {\n            return this.dataItems && this.dataItems().filter(function (item) { return item instanceof measure_1.Measure; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_uniqueDataItems\", {\n        get: function () {\n            var uniqueDataItems = [];\n            this.dataItems.peek().forEach(function (dataItem) {\n                if (uniqueDataItems.filter(function (item) { return item.isDefinitionEquals(dataItem); }).length === 0) {\n                    uniqueDataItems.push(dataItem);\n                }\n            });\n            return uniqueDataItems;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(DataDashboardItem.prototype, \"_multiData\", {\n        get: function () {\n            var dataManager = this._dataManager.peek();\n            return dataManager && dataManager.getItemData();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DataDashboardItem.prototype._removeFromFilters = function (dataItem) {\n        this.filterString(removeDataItemFromCriteria(this.filterString(), dataItem.uniqueName()));\n        this.visibleDataFilterString((removeDataItemFromCriteria(this.visibleDataFilterString(), dataItem.uniqueName())));\n        this._measures.forEach(function (measure) {\n            measure.filterString(removeDataItemFromCriteria(measure.filterString(), dataItem.uniqueName()));\n        });\n    };\n    DataDashboardItem.prototype._clearBindings = function () {\n        this.dataSource(null);\n        this.dataMember(null);\n        this.dataItems.removeAll();\n        this.__hiddenDimensions.removeAll();\n        this.__hiddenMeasures.removeAll();\n        this.colorScheme.removeAll();\n    };\n    DataDashboardItem.prototype._clearInteractivityState = function () {\n        this._selectionValues(null);\n        this._drillDownValues([]);\n    };\n    DataDashboardItem.prototype._isCalculationSupported = function () {\n        return true;\n    };\n    DataDashboardItem.prototype._isSortingEnabled = function () {\n        return true;\n    };\n    DataDashboardItem.prototype._isTopNEnabled = function (dataItem) {\n        return this.hiddenDimensions().indexOf(dataItem) == -1;\n    };\n    DataDashboardItem.prototype._isColoringEnabled = function (dataItem) {\n        if (dataItem instanceof dimension_1.Dimension) {\n            if (this._canColorByDimensions) {\n                if (this._isHiddenDimension(dataItem) || dataItem.coloringMode() === 'None') {\n                    return false;\n                }\n                if (dataItem.coloringMode() === 'Hue') {\n                    return true;\n                }\n                return this._getIsDimensionColoredByDefault(dataItem);\n            }\n        }\n        else if (dataItem instanceof measure_1.Measure) {\n            if (this._canColorByMeasures) {\n                if (this._isHiddenMeasure(dataItem)) {\n                    return false;\n                }\n                return this._coloredByMeasures();\n            }\n            return false;\n        }\n    };\n    DataDashboardItem.prototype._getDataItem = function (uniqueName) {\n        return this.dataItems().filter(function (item) { return item.uniqueName() === uniqueName; })[0];\n    };\n    DataDashboardItem.prototype._getFinalDataType = function (dataItemId) {\n        var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n        return !!metaData ? metaData.getFinalDataType(dataItemId) : 'Unknown';\n    };\n    DataDashboardItem.prototype._createDataItem = function (dataField, binding) {\n        var itemTypeName = binding.dataItemType;\n        if (!itemTypeName) {\n            itemTypeName = _data_field_1.DataField.isMeasure(dataField) ? 'Measure' : 'Dimension';\n        }\n        var newDataItem = DataDashboardItem._createDataItem(itemTypeName);\n        DataDashboardItem._updateDataItemByField(dataField, newDataItem);\n        this.dataItems.push(newDataItem);\n        return newDataItem;\n    };\n    DataDashboardItem.prototype._updateDataItem = function (dataItem, binding, dataField, acceptableShapingType) {\n        _helper_classes_1.Guard.isNotFalsy(dataItem, 'dataItem');\n        var itemTypeName = binding.dataItemType || dataItem.itemType();\n        var newDataItem = (binding.dataItemType === dataItem.itemType()) ? dataItem : DataDashboardItem._createDataItem(itemTypeName);\n        DataDashboardItem._updateDataItemByField(dataField, newDataItem, { oldDataItem: dataItem, acceptableShapingType: acceptableShapingType });\n        this._unassignDataItem(dataItem, false);\n        if (newDataItem !== dataItem) {\n            this._removeDataItemCore(dataItem);\n            newDataItem.uniqueName(dataItem.uniqueName());\n            this.dataItems.push(newDataItem);\n        }\n    };\n    DataDashboardItem.prototype._removeDataItem = function (dataItem, skipGroups) {\n        this._removeDataItemCore(dataItem);\n        this._unassignDataItem(dataItem, skipGroups);\n    };\n    DataDashboardItem.prototype._attachDataItem = function (target, propertyName, link) {\n        var _this = this;\n        var dataItemLink = !!link ? link : new data_item_1.DataItemLink(this, { '@DefaultId': target[propertyName].uniqueName() });\n        target[propertyName] = dataItemLink;\n        target[propertyName.substring(2)] = ko.computed({\n            read: function () { return dataItemLink.dataItem(); },\n            write: function (value) {\n                if (!!value) {\n                    if (_this._getDataItem(value.uniqueName())) {\n                        throw Error(\"DataItemLink: DataItem \" + value.uniqueName() + \" already exists\");\n                    }\n                    else {\n                        _this.dataItems.push(value);\n                        dataItemLink.dataItem(value);\n                    }\n                }\n                else {\n                    if (dataItemLink.dataItem()) {\n                        _this._removeDataItem(dataItemLink.dataItem());\n                        dataItemLink.dataItem(null);\n                    }\n                }\n            }\n        });\n    };\n    DataDashboardItem.prototype._subscribeDataItemLinkArrays = function () {\n        var _this = this;\n        var propertyInfos = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            propertyInfos[_i] = arguments[_i];\n        }\n        propertyInfos.forEach(function (propertyInfo) {\n            var property = _this[propertyInfo.propertyName];\n            var realProperty = _this[propertyInfo.propertyName.substring(2)];\n            ko.computed(function () {\n                property().filter(function (value) { return !value.dataItem(); })\n                    .forEach(function (value) { return property.remove(value); });\n            });\n            ko.computed(function () {\n                var linkedDataItems = property().map(function (link) { return link.dataItem(); }).filter(function (dataItem) { return !!dataItem; });\n                realProperty.peek().filter(function (dataItem) { return linkedDataItems.indexOf(dataItem) === -1; })\n                    .forEach(function (itemToRemove) { return realProperty.remove(itemToRemove); });\n                linkedDataItems.filter(function (dataItem) { return realProperty.peek().indexOf(dataItem) === -1; })\n                    .forEach(function (itemToAdd) { return realProperty.splice(linkedDataItems.indexOf(itemToAdd), 0, itemToAdd); });\n            });\n            _knockout_utils_1.subscribeArrayChange(realProperty, {\n                added: function (dimension, index) {\n                    if (!property().some(function (link) { return link.dataItem() === dimension; })) {\n                        _this.dataItems.push(dimension);\n                        var link = new data_item_1.DataItemLink(_this);\n                        link.dataItem(dimension);\n                        property.splice(index, 0, link);\n                    }\n                },\n                deleted: function (dimension) {\n                    if (property().some(function (link) { return link.dataItem() === dimension; })) {\n                        _this.dataItems.remove(dimension);\n                        property.remove(function (link) { return link.dataItem() === dimension; });\n                    }\n                }\n            });\n        });\n    };\n    DataDashboardItem.prototype._getMasterFilterMode = function () { return 'None'; };\n    DataDashboardItem.prototype._getDrillDownEnabled = function () { return false; };\n    DataDashboardItem.prototype._getIgnoreMasterFilter = function () { return false; };\n    DataDashboardItem.prototype._getClearMasterFilterSupported = function () { return this._isMultipleMasterFilter(); };\n    DataDashboardItem.prototype._getIsMasterFilter = function () { return this._isSingleMasterFilter() || this._isMultipleMasterFilter(); };\n    DataDashboardItem.prototype._getInteractivityDimensionLinks = function () { return []; };\n    DataDashboardItem.prototype._getCanColorByMeasures = function () { return false; };\n    DataDashboardItem.prototype._getCanColorByDimensions = function () { return false; };\n    DataDashboardItem.prototype._getAreMeasuresColoredByDefault = function () { return false; };\n    DataDashboardItem.prototype._getIsDimensionColoredByDefault = function (dimension) { return false; };\n    DataDashboardItem.prototype._coloredDimensions = function () {\n        var _this = this;\n        return this._dimensions.filter(function (item) { return _this._isColoringEnabled(item); });\n    };\n    DataDashboardItem.prototype._coloredByMeasures = function () {\n        if (this.coloringOptions.measuresColoringMode() === 'Hue') {\n            return true;\n        }\n        if (this.coloringOptions.measuresColoringMode() === 'None') {\n            return false;\n        }\n        return this._getAreMeasuresColoredByDefault();\n    };\n    DataDashboardItem.prototype._getUseGlobalColors = function () { return this.coloringOptions && this.coloringOptions.useGlobalColors(); };\n    DataDashboardItem.prototype._getValidatedSelection = function (selectionValues) {\n        return selectionValues ? selectionValues.map(function (value) { return value.map(_date_utils_1.tryConvertToDateTime); }) : selectionValues;\n    };\n    DataDashboardItem.prototype._getClearMasterFilterState = function () {\n        if (this._clearMasterFilterSupported()) {\n            if (this._useNeutralFilterMode() && this._isSingleMasterFilter() && !this._allowAllValue()) {\n                return 'Disabled';\n            }\n            return this._actions().indexOf(_common_1.viewerActions.clearMasterFilter) !== -1 ? 'Enabled' : 'Hidden';\n        }\n        return 'Hidden';\n    };\n    DataDashboardItem.prototype._allowAllValue = function () { return false; };\n    DataDashboardItem.prototype._validateSelectionByData = function (selection) {\n        var activeDimensions = this._interactivityDimensions.slice(this._drillDownValues().length).map(function (d) { return d.uniqueName(); });\n        if (this._isSingleMasterFilter() && activeDimensions.length > 0) {\n            var allSelection = this._getAllSelectionValues(activeDimensions);\n            if (!selection || (!this._useNeutralFilterMode() && !_utils_1.arrayContains(allSelection, selection[0]))) {\n                this._setSelectionData(allSelection.length > 0 ? [allSelection[0]] : null);\n            }\n        }\n    };\n    DataDashboardItem.prototype._updateContentData = function (content) {\n        _super.prototype._updateContentData.call(this, content);\n        if (this.dataItems().length > 0 || !this._stateSupported('empty')) {\n            this._updateDataManager(content);\n        }\n        if (content.ItemData && content.ItemData.Reduced) {\n            this._limitDataState.setReduced();\n        }\n        this._validateSelectionByData(this._actualSelectionValues());\n        var drillDownValues = this._getDisplayDrillDownValues();\n        _jquery_helpers_1.deepExtend(content, {\n            multiData: this._multiData,\n            DrillDownValues: !!drillDownValues ? drillDownValues.map(function (fv) { return fv.Values; }).reduce(function (v1, v2) { return v1.concat(v2); }) : undefined,\n            DrillDownUniqueValues: this._drillDownValues.peek().length > 0 ? this._drillDownValues.peek() : undefined,\n            LimitDataState: this._limitDataState.getViewModel()\n        });\n    };\n    DataDashboardItem.prototype._extendContentState = function (content) {\n        _super.prototype._extendContentState.call(this, content);\n        content.SelectedValues = this._actualSelectionValues.peek();\n    };\n    DataDashboardItem.prototype._updateDataManager = function (content) {\n        var itemDataDTO = content.ItemData, contentType = content.ContentType;\n        if (itemDataDTO) {\n            _date_utils_1.patchDateTime(itemDataDTO.DataStorageDTO);\n        }\n        if (contentType === _common_1.contentType.partialDataSource && this._dataManager() && itemDataDTO) {\n            this._updateDataManagerByPartialDataSource(content, itemDataDTO);\n        }\n        else {\n            if ((contentType === _common_1.contentType.fullContent || contentType === _common_1.contentType.completeDataSource) && itemDataDTO && itemDataDTO.MetaData) {\n                var dataManager = new _item_data_manager_1.itemDataManager();\n                dataManager.initialize(itemDataDTO);\n                this._dataManager(dataManager);\n            }\n            if (contentType !== _common_1.contentType.completeDataSource) {\n            }\n        }\n        this._expandingManager.resetExpandingParams();\n    };\n    DataDashboardItem.prototype._updateDataManagerByPartialDataSource = function (content, itemDataDTO) {\n        content.Parameters[0] = !!content.Parameters[0] && content.Parameters[0].map(function (value) { return _date_utils_1.tryConvertToDateTime(value); });\n        this._dataManager().updateExpandedData(itemDataDTO, {\n            values: content.Parameters[0],\n            pivotArea: content.Parameters[1] ? _item_data_axis_builder_1.pivotAreaNames.columns : _item_data_axis_builder_1.pivotAreaNames.rows\n        });\n    };\n    DataDashboardItem.prototype._getAllSelectionValues = function (activeDimensions) {\n        return !!this._multiData ? this._multiData.getAllSelectionValues(activeDimensions) : [];\n    };\n    DataDashboardItem.prototype._getPointsByDimension = function (dimensionId, axisName) {\n        if (this._multiData) {\n            var axis = this._multiData.getAxis(axisName);\n            return axis ? axis.getPointsByDimension(dimensionId) : [];\n        }\n    };\n    DataDashboardItem.prototype._getColorizableDataItemsInfo = function () {\n        return [];\n    };\n    DataDashboardItem.prototype._getDefaultCalculationWindowDefinition = function () {\n        return undefined;\n    };\n    DataDashboardItem.prototype._getExportingSelection = function () {\n        return this._selectionValues();\n    };\n    DataDashboardItem.prototype._getDisplayFilterValues = function (limitCount) {\n        var _this = this;\n        var selection = this._outputFilter(), outFilterValues = [];\n        if (selection && selection.dimensions) {\n            selection.dimensions.forEach(function (dimensionDefinition, dimensionIndex) {\n                var dimension = _this._dimensions.filter(function (d) { return d.uniqueName() === dimensionDefinition['@DefaultId']; })[0];\n                var filterValues = new _dimension_filter_values_1.DimensionFilterValues(_this._getDimensionDisplayName(dimension.uniqueName()));\n                var uniqueValues = {};\n                for (var valueIndex = 0, valueCount = 0; valueIndex < selection.values.length; valueIndex++) {\n                    if (!!limitCount && valueCount >= limitCount) {\n                        filterValues.Truncated = true;\n                        break;\n                    }\n                    var value = selection.values[valueIndex][dimensionIndex];\n                    if (!uniqueValues[value]) {\n                        uniqueValues[value] = value;\n                        valueCount++;\n                    }\n                }\n                filterValues.Values = Object.keys(uniqueValues).map(function (v) { return _this._createFormattableValue(dimension, uniqueValues[v]); });\n                outFilterValues.push(filterValues);\n            });\n        }\n        return outFilterValues;\n    };\n    DataDashboardItem.prototype._createFormattableValue = function (dimension, value) {\n        var isOlap = _data_field_1.DataField.isOlap(dimension.dataMember());\n        var dimensionId = dimension.uniqueName();\n        if (isOlap) {\n            return {\n                Type: 'Value',\n                Value: this._getOlapDimensionDisplayText(value, dimensionId),\n                Format: undefined\n            };\n        }\n        else {\n            var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n            return {\n                Type: 'Value',\n                Value: value,\n                Format: metaData ? metaData.getDimensionFormat(dimensionId) : undefined\n            };\n        }\n    };\n    DataDashboardItem.prototype._getDisplayFilterValuesExternal = function () {\n        var externalFilter = this._masterFilterItems().filter(function (item) { return !!item._outputFilter(); });\n        return externalFilter\n            .map(function (item) { return item._getDisplayFilterValues(); })\n            .filter(function (arr) { return arr.length > 0; })\n            .reduce(function (acc, items) { return acc.concat(items); }, []);\n    };\n    DataDashboardItem.prototype._getDisplayDrillDownValues = function () {\n        var _this = this;\n        var drillDownUniqueValues = this._drillDownValues.peek();\n        if (!drillDownUniqueValues || drillDownUniqueValues.length == 0)\n            return undefined;\n        var values = new Array(), metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n        drillDownUniqueValues.forEach(function (value, valueIndex) {\n            var dimension = _this._interactivityDimensions[valueIndex];\n            var filterValues = new _dimension_filter_values_1.DimensionFilterValues(_this._getDimensionDisplayName(dimension.uniqueName()));\n            var isOlap = _data_field_1.DataField.isOlap(dimension.dataMember());\n            filterValues.Values.push(_this._createFormattableValue(dimension, value));\n            values.push(filterValues);\n        });\n        return values;\n    };\n    DataDashboardItem.prototype._getColoringSignature = function () {\n        return this._getColoringSignatureBase(this._coloredDimensions());\n    };\n    DataDashboardItem.prototype._getColoringSignatureOnCurrentDrillDownLevel = function () {\n        if (this._isDrillDownEnabled()) {\n            var coloredDimensions = [];\n            var currentDrillDownDimension = this._interactivityDimensions[this._drillDownValues().length];\n            var currentColored = null;\n            for (var i = 0; i < this._dimensions.length; i++) {\n                var dimension = this._dimensions[i];\n                if (this._isColoringEnabled(dimension))\n                    currentColored = dimension;\n                if (dimension === currentDrillDownDimension && currentColored !== null) {\n                    coloredDimensions = [currentColored];\n                    break;\n                }\n            }\n            return this._getColoringSignatureBase(coloredDimensions);\n        }\n        else {\n            return this._getColoringSignature();\n        }\n    };\n    DataDashboardItem.prototype._getColoringSignatureBase = function (coloredDimension) {\n        return new color_scheme_definition_1.ColorSchemeDefinition(this.dataSource(), this.dataMember(), coloredDimension.map(function (dimension) {\n            return {\n                dataMember: ko.observable(dimension.dataMember()),\n                dateTimeGroupInterval: ko.observable(dimension.dateTimeGroupInterval())\n            };\n        }), this._coloredByMeasures(), this._isGloballyColored ? '' : this.componentName(), this._isGloballyColored ? '' : this.name());\n    };\n    DataDashboardItem.prototype._isAttribute = function (dataItem) {\n        return false;\n    };\n    DataDashboardItem.prototype._getItemDataAxis = function () {\n        return item_data_axis_names_1.itemDataAxisNames.defaultAxis;\n    };\n    DataDashboardItem.prototype._getDataItemContainerDisplayName = function (dataItemContainer, dataItemDisplayNameGetter) {\n        var _this = this;\n        if (dataItemDisplayNameGetter === void 0) { dataItemDisplayNameGetter = null; }\n        var name = dataItemContainer.name && dataItemContainer.name() || null;\n        if (name) {\n            return name;\n        }\n        var bindingModel = dataItemContainer._getBindingModel(), separator = ' ' + (dataItemContainer._displayNameSeparator || '-') + ' ';\n        name = '';\n        bindingModel.forEach(function (binding) {\n            var dataItemLink = dataItemContainer[binding.propertyName];\n            var dataItem = dataItemLink.dataItem && dataItemLink.dataItem();\n            if (dataItem && dataItem.dataMember()) {\n                if (name) {\n                    name = name + separator;\n                }\n                name = name + (!!dataItemDisplayNameGetter ? dataItemDisplayNameGetter(dataItem) : _this._getDataItemDisplayName(dataItem));\n            }\n        });\n        return name;\n    };\n    DataDashboardItem.prototype._getDataItemDisplayName = function (dataItem) {\n        var uniqueName = dataItem.uniqueName();\n        return dataItem instanceof dimension_1.Dimension ? this._getDimensionDisplayName(uniqueName) : this._getMeasureDisplayName(uniqueName);\n    };\n    DataDashboardItem.prototype._getMeasureDisplayName = function (uniqueName) {\n        var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n        var measure = metaData.getMeasures().filter(function (m) { return m.id == uniqueName; })[0];\n        return !!measure ? measure.name : uniqueName;\n    };\n    DataDashboardItem.prototype._getDimensionDisplayName = function (uniqueName) {\n        var dimension = undefined;\n        var metaData = this._dataManager() ? this._dataManager().getMetaData() : undefined;\n        var axes = !!metaData && metaData.getAxisNames() || [];\n        axes.every(function (axisName) {\n            var dimensions = metaData.getDimensions(axisName) || [];\n            dimension = dimensions.filter(function (d) { return d.id == uniqueName; })[0];\n            return !dimension;\n        });\n        return !!dimension ? dimension.name : uniqueName;\n    };\n    DataDashboardItem.prototype._getOlapDimensionDisplayText = function (uniqueValue, dimensionId) {\n        var itemData = this._dataManager() ? this._dataManager().getItemData() : undefined;\n        var axes = !!itemData ? itemData.getAxisNames() : [];\n        var pt = undefined;\n        axes.every(function (axisName) {\n            var axis = itemData.getAxis(axisName);\n            pt = axis.getPointByUniqueValueAndDimension(uniqueValue, dimensionId);\n            return !pt;\n        });\n        if (!!pt) {\n            return pt.getUniqueValue() === special_values_1.specialValues.olapNullValueGuid ? _default_1.getLocalizationById('DashboardStringId.OlapRaggedHierarchyNoneItemCaption') : pt.getDisplayText();\n        }\n        else {\n            return uniqueValue;\n        }\n    };\n    DataDashboardItem.prototype._cleanDataItemDependencies = function () {\n    };\n    DataDashboardItem.prototype._setLinkCollectionAcceptableShapingType = function (links, type) {\n        links.forEach(function (l) { l._specifics.acceptableShapingType = type; });\n    };\n    DataDashboardItem.prototype._updateDataQueryParams = function (params) {\n        _super.prototype._updateDataQueryParams.call(this, params);\n        if (this._expandingManager.canProvideExpandingState()) {\n            params.ExpandingState = this._expandingManager.calculateExpandingState();\n        }\n    };\n    DataDashboardItem.prototype._stateSupported = function (state) {\n        return this._supportedUIStates().indexOf(state) !== -1;\n    };\n    DataDashboardItem.prototype._isHiddenDimension = function (dimension) {\n        return !!this.__hiddenDimensions().filter(function (link) { return link.dataItem() === dimension; })[0];\n    };\n    DataDashboardItem.prototype._isHiddenMeasure = function (measure) {\n        return !!this.__hiddenMeasures().filter(function (link) { return link.dataItem() === measure; })[0];\n    };\n    DataDashboardItem.prototype._setSelection = function (stateSelection) {\n        var validatedSelection = this._getValidatedSelection(stateSelection);\n        if (this._isSingleMasterFilter()) {\n            if ((!validatedSelection || validatedSelection.length === 0) && !this._clearMasterFilterSupported())\n                return;\n            if (validatedSelection && validatedSelection.length > 1)\n                validatedSelection = [validatedSelection[0]];\n        }\n        this._setSelectionData(validatedSelection);\n    };\n    DataDashboardItem.prototype._hasSelection = function () {\n        return !!this._selectionValues() && !!this._selectionValues()[0];\n    };\n    DataDashboardItem.prototype._performOutputFilterOptimization = function (filter) {\n        return filter;\n    };\n    DataDashboardItem.prototype._setState = function (parameter) {\n        _super.prototype._setState.call(this, parameter);\n        var itemState = parameter;\n        var obsoleteItemState = parameter;\n        var drillDownState = itemState.DrillDownValues || _obsolete_dashboard_state_1.ObsoleteItemState.unwrapDilldownValues(obsoleteItemState.DrillLevels) || [];\n        drillDownState = drillDownState.map(function (value) { return _date_utils_1.tryConvertToDateTime(value); });\n        if (!_array_utils_1.arrayEquals(this._drillDownValues(), drillDownState))\n            this._drillDownValues(drillDownState);\n        var selectionState = itemState.MasterFilterValues || obsoleteItemState.Selection;\n        this._setSelection(selectionState);\n        var selectedElementIndexState = itemState.SelectedLayerIndex || obsoleteItemState.SelectedElementIndex;\n        if (this._selectedElementIndex() !== selectedElementIndexState)\n            this._selectedElementIndex(selectedElementIndexState);\n    };\n    DataDashboardItem.prototype._setClientState = function (clientState) {\n        this._clientState(clientState);\n    };\n    DataDashboardItem.prototype._setSelectionData = function (selection, forceSetSelection) {\n        if (forceSetSelection === void 0) { forceSetSelection = false; }\n        if (!_array_utils_1.arrayEquals(this._selectionValues(), selection) || forceSetSelection) {\n            this._selectionValues(selection);\n        }\n    };\n    DataDashboardItem.prototype._itemInteractivityByColumnAxis = function () {\n        return true;\n    };\n    DataDashboardItem.prototype._getInteractivityAxisDimensionCount = function () {\n        return this._dimensions.length - this.hiddenDimensions().length;\n    };\n    DataDashboardItem.prototype._removeSelectionFromState = function (state) {\n        var itemState = _jquery_helpers_1.deepExtend({}, state);\n        itemState.MasterFilterValues = undefined;\n        return itemState;\n    };\n    DataDashboardItem.prototype._setSelectionToState = function (state, selection) {\n        var itemState = _jquery_helpers_1.deepExtend({}, state);\n        itemState.MasterFilterValues = selection;\n        return itemState;\n    };\n    DataDashboardItem.prototype._setPredefinedPeriodToState = function (itemState, periodName) {\n        return itemState;\n    };\n    DataDashboardItem.prototype._unassignDataItem = function (dataItem, skipGroups) {\n        this._clearInteractivityState();\n        this._removeFromFilters(dataItem);\n        if (!skipGroups && dataItem instanceof dimension_1.Dimension && _data_field_1.IsOlapHierarchyField(dataItem)) {\n            for (var i = this.dataItems().length - 1; i >= 0; i--) {\n                var item = this.dataItems()[i];\n                if (item instanceof dimension_1.Dimension && item.groupIndex() == dataItem.groupIndex() && item != dataItem) {\n                    this.dataItems.remove(item);\n                }\n            }\n            this._cleanDataItemDependencies();\n        }\n    };\n    DataDashboardItem.prototype._removeDataItemCore = function (dataItem) {\n        if (dataItem instanceof measure_1.Measure) {\n            this._dimensions.forEach(function (dimensionDataItem) {\n                var dimension = dimensionDataItem;\n                if (dimension.sortMeasure() === dataItem.uniqueName()) {\n                    dimension.sortMeasure(undefined);\n                }\n                if (dimension.topNOptionsMeasureName() === dataItem.uniqueName()) {\n                    dimension.topNOptionsMeasureName(undefined);\n                }\n            });\n        }\n        this.dataItems.remove(dataItem);\n    };\n    DataDashboardItem.prototype._getActiveDimensions = function () {\n        var drillDownValuesCount = this._drillDownValues().length;\n        if (this._getDrillDownEnabled()) {\n            return [this._interactivityDimensions[drillDownValuesCount]];\n        }\n        else {\n            return this._interactivityDimensions;\n        }\n    };\n    DataDashboardItem.prototype._getDimensionIdsByItemName = function () {\n        return this._getActiveDimensions().map(function (dim) { return dim.uniqueName(); });\n    };\n    DataDashboardItem.prototype._getValues = function (tuples) {\n        return _item_data_axis_helper_1.itemDataAxisHelper.getValuesByTuples(tuples, this._getDimensionIdsByItemName());\n    };\n    DataDashboardItem.prototype._getAvailableTuples = function () {\n        var that = this, data = that._getItemData(), dimensionIds = that._getDimensionIdsByItemName(), axisName = that._getCurrentAxisNameByItemName();\n        return data && data.getAvailableTuples(dimensionIds, axisName);\n    };\n    DataDashboardItem.prototype._getCurrentAxisNameByItemName = function () {\n        return this._getItemDataAxis();\n    };\n    DataDashboardItem.prototype._getSelectedValuesByItemName = function () {\n        return this._selectionValues();\n    };\n    DataDashboardItem.prototype._performSetMasterFilter = function (values) {\n        if (values) {\n            if (!Array.isArray(values) || (!(values[0] instanceof _item_data_tuple_1.itemDataTuple) && !Array.isArray(values[0]))) {\n                throw new Error('The type of the values parameter is not supported.');\n            }\n            var arrayValues = values[0] instanceof _item_data_tuple_1.itemDataTuple ? this._getValues(values) : values;\n            if (this._isSingleMasterFilter() && arrayValues.length !== 1) {\n                throw new Error('Only one filter value is allowed when the Master Filter mode is set to Single.');\n            }\n            this._processItemSelectionChange('', _common_1.viewerActions.setMasterFilter, arrayValues.map(function (selectionRow) { return selectionRow.map(_utils_1.unwrapSpecialNullValue); }));\n        }\n        else {\n            throw Error();\n        }\n    };\n    DataDashboardItem.prototype._performClearMasterFilter = function () {\n        this._processItemClearMasterFilter();\n    };\n    DataDashboardItem.prototype._performDrillDown = function (values) {\n        var realValues = values instanceof _item_data_tuple_1.itemDataTuple ? this._getValues([values]) : [[_utils_1.unwrapSpecialNullValue(values)]];\n        this._processItemSelectionChange('', _common_1.viewerActions.drillDown, realValues[0]);\n    };\n    DataDashboardItem.prototype._performDrillUp = function () {\n        this._processItemDrillUp();\n    };\n    DataDashboardItem.prototype._getAvailableDrillDownValues = function (itemName) {\n        return (this._getAvailableActions().indexOf(_common_1.viewerActions.drillDown) !== -1) ? this._getAvailableTuples() : null;\n    };\n    DataDashboardItem.prototype._getCurrentDrillDownValues = function () {\n        var data = this._getItemData(), dimensionIds = this._getDimensionIdsByItemName(), axisName = this._getCurrentAxisNameByItemName();\n        return data && data.getCurrentDrillDownValues(dimensionIds, axisName);\n    };\n    DataDashboardItem.prototype._getAvailableFilterValues = function (itemName) {\n        return (this._getAvailableActions().indexOf(_common_1.viewerActions.setMasterFilter) !== -1 ||\n            this._getAvailableActions().indexOf(_common_1.viewerActions.setMultipleValuesMasterFilter) !== -1) ? this._getAvailableTuples() : null;\n    };\n    DataDashboardItem.prototype._getAvailableActions = function () {\n        return this._actions();\n    };\n    DataDashboardItem.prototype._getItemData = function () {\n        var dataManager = this._dataManager();\n        return dataManager && dataManager.getItemData();\n    };\n    DataDashboardItem.prototype._getCurrentFilterValues = function () {\n        var that = this, data = that._getItemData(), dimensionIds = that._getDimensionIdsByItemName(), axisName = that._getCurrentAxisNameByItemName(), selectedValues = that._getSelectedValuesByItemName();\n        return data && data.getCurrentFilterValues(dimensionIds, axisName, selectedValues);\n    };\n    DataDashboardItem.prototype._conditionFormattingExpressionEditorFilter = function (dataItem) {\n        return !this.hiddenDimensions().filter(function (hd) { return hd.uniqueName() === dataItem.uniqueName(); })[0];\n    };\n    DataDashboardItem._itemTypesMap = {\n        Measure: measure_1.Measure,\n        Dimension: dimension_1.Dimension\n    };\n    DataDashboardItem._formatRuleTypesMap = {\n        GridItemFormatRule: grid_item_format_rule_1.GridItemFormatRule,\n        PivotItemFormatRule: pivot_item_format_rule_1.PivotItemFormatRule,\n        CardItemFormatRule: card_item_format_rule_1.CardItemFormatRule,\n        CardItemDeltaFormatRule: card_item_delta_format_rule_1.CardItemDeltaFormatRule,\n        ChartItemFormatRule: chart_item_format_rule_1.ChartItemFormatRule,\n        ScatterChartItemFormatRule: scatter_chart_item_format_rule_1.ScatterChartItemFormatRule\n    };\n    DataDashboardItem._addColoringMeta = function (links) {\n        links.forEach(function (link) {\n            if (!link._specifics.customDataShapingProperties.some(function (prop) { return prop.serializationInfo.propertyName === _dimension_1.coloringMode.propertyName; })) {\n                link._specifics.customDataShapingProperties = link._specifics.customDataShapingProperties.concat([{\n                        serializationInfo: _dimension_1.coloringMode\n                    }]);\n            }\n        });\n    };\n    __decorate([\n        _utils_2.collectionItemType('Dimension')\n    ], DataDashboardItem.prototype, \"__hiddenDimensions\", void 0);\n    __decorate([\n        _utils_2.collectionItemType('Measure')\n    ], DataDashboardItem.prototype, \"__hiddenMeasures\", void 0);\n    __decorate([\n        _utils_2.collectionItemType('Entry')\n    ], DataDashboardItem.prototype, \"colorScheme\", void 0);\n    return DataDashboardItem;\n}(dashboard_item_1.DashboardItem));\nexports.DataDashboardItem = DataDashboardItem;\nfunction getSummaryType(dataField) {\n    if (dataField) {\n        switch (dataField.fieldType()) {\n            case 'Bool':\n            case 'Text':\n            case 'DateTime':\n                return 'Count';\n            case 'Custom':\n                if (!dataField.isConvertible()) {\n                    return 'Count';\n                }\n        }\n    }\n    return _measure_1.summaryTypeNumericToAny.defaultVal;\n}\nfunction removePropertyFromCriteriaOperator(sourceCriteriaOperator, propertyName) {\n    if (sourceCriteriaOperator instanceof analytics_criteria_1.GroupOperator) {\n        sourceCriteriaOperator.operands = sourceCriteriaOperator.operands.map(function (operand) { return removePropertyFromCriteriaOperator(operand, propertyName); });\n        return sourceCriteriaOperator;\n    }\n    else if (sourceCriteriaOperator instanceof analytics_criteria_1.UnaryOperator) {\n        sourceCriteriaOperator.operand = removePropertyFromCriteriaOperator(sourceCriteriaOperator.operand, propertyName);\n        return sourceCriteriaOperator;\n    }\n    else if (!sourceCriteriaOperator.children().some(function (operand) { return operand instanceof analytics_criteria_1.OperandProperty && operand.propertyName === propertyName; })) {\n        return sourceCriteriaOperator;\n    }\n    return new analytics_criteria_1.GroupOperator(analytics_criteria_1.GroupOperatorType.And, []);\n}\nfunction removeDataItemFromCriteria(criteria, dataItemName) {\n    try {\n        if (!!criteria) {\n            var criteriaSerializer = new analytics_widgets_internal_1.FilterEditorSerializer();\n            var criteriaOperator = criteriaSerializer.deserialize(criteria);\n            var cleanedOperator = removePropertyFromCriteriaOperator(criteriaOperator, dataItemName);\n            return criteriaSerializer.serialize(cleanedOperator);\n        }\n        else {\n            return criteria;\n        }\n    }\n    catch (e) {\n        return '';\n    }\n}\n"]},"metadata":{},"sourceType":"script"}